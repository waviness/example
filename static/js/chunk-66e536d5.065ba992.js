(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66e536d5"],{"51b6":function(t,e,a){"use strict";a("6486")},"53ae":function(t,e,a){"use strict";var s=a("d4ec"),i=a("bee2"),r=a("262e"),n=a("2caf"),c=(a("b0c0"),a("9ab4")),o=a("1b40");o["a"].registerHooks(["beforeRouteEnter"]);var l=function(t){Object(r["a"])(a,t);var e=Object(n["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.page=1,t.total=0,t.dataList=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.finishText="",t.userIdList=[],t.error=!1,t}return Object(i["a"])(a,[{key:"beforeRouteEnter",value:function(t,e,a){a((function(t){"Home"!==e.name&&"TaskIndex"!==e.name||(t.dataList=[],t.page=1,t.loading=!1,t.finished=!0,t.refreshing=!1,t.$nextTick((function(){t.finished=!1})))}))}}]),a}(o["d"]);l=Object(c["a"])([Object(o["a"])({})],l),e["a"]=l},6486:function(t,e,a){},c415:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-sticky",[a("div",{staticClass:"header white-bg"},[a("van-tabs",{directives:[{name:"show",rawName:"v-show",value:(0===+t.entryObj.level||1===+t.entryObj.level||2===+t.entryObj.level)&&1===+t.active,expression:"(+entryObj.level === 0 || +entryObj.level === 1 || +entryObj.level === 2) && +active === 1"}],attrs:{color:"#2271F5"},on:{click:t.tabTypeClick},model:{value:t.tabType,callback:function(e){t.tabType=e},expression:"tabType"}},t._l(t.tabList,(function(t){return a("van-tab",{key:t,attrs:{title:t}})})),1)],1)]),a("div",{attrs:{id:"filterContainer"}},[a("div",{staticClass:"py-2 px-3 background-color-white"},[a("div",{staticClass:"numberWarp px-3 py-2"},[a("div",{staticClass:"fontWeight-500"},[a("span",{staticClass:"color-gray-5"},[t._v(t._s(t.entryObj.name))]),a("span",{directives:[{name:"show",rawName:"v-show",value:"2"===t.active,expression:"active === '2'"}],staticClass:"color-gray-4"},[t._v(" "+t._s(t.entryObj.date))])]),"2"===t.active?a("div",{staticClass:"header-amount-row mt-2"},[a("div",{staticClass:"header-amount-col"},[a("div",{staticClass:"header-amount-main color-main-3"},[t._v(t._s(t.overdueObj.thisAmount))]),a("div",{staticClass:"header-amount-label color-gray-5"},[t._v("本月应收账款")])]),a("div",{staticClass:"header-amount-divider"}),a("div",{staticClass:"header-amount-col"},[a("div",{staticClass:"header-amount-main color-main-3"},[t._v(t._s(t.overdueObj.amount))]),a("div",{staticClass:"header-amount-label color-gray-5"},[t._v("总应收账款")])])]):a("div",{staticClass:"font-26 py-2",class:"1"===t.active?"color-red":"2"===t.active?"color-main":""},[t._v(" "+t._s(0===t.tabType?t.overdueObj.overdueAmount:t.overdueObj.amount)+" ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:"1"===t.active&&0===t.tabType,expression:"active === '1' && tabType === 0"}],staticClass:"color-black-1"},[t._v(" 截止昨日，逾期账款总金额 ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:"1"===t.active&&1===t.tabType,expression:"active === '1' && tabType === 1"}],staticClass:"color-gray-4"},[t._v(" 长账龄总金额("+t._s(t.entryObj.date)+") ")])])]),a("div",{staticClass:"pt-2"},[t.loading||t.dataList.length?t._e():a("app-empty",{staticClass:"mt-6 white-bg"}),1===+t.active&&0===+t.tabType?a("div",{staticClass:"background-color-white px-10"},t._l(t.dataList,(function(e,s){return a("div",{key:s,staticClass:"listCard pa-1",on:{click:function(a){return t.cardClick(e)}}},[a("div",{staticClass:"d-flex justify-space-between align-center fontWeight-500"},[a("div",{staticClass:"left-col flex-1"},[a("div",{staticClass:"label py-2 d-flex align-center"},[a("div",{staticClass:"block"}),a("span",{staticClass:"color-gray-5 font-16 ml-2"},[t._v(t._s(e.deptName))])]),a("div",{staticClass:"color-red fontWeight-500 font-20 mt-1"},[t._v(t._s(e.overdueAmount))]),a("div",{staticClass:"color-black-1 font-14 mt-1 mb-2"},[t._v("逾期金额(截止昨日)")])]),a("div",{staticClass:"circle-chart-wrap flex-1"},[a("div",{staticClass:"circle-chart",attrs:{id:"circleChart"+s}})]),a("van-icon",{attrs:{size:"18px",name:"arrow"}})],1)])})),0):t._e(),1===+t.active&&1===+t.tabType?a("div",{staticClass:"background-color-white px-10"},t._l(t.dataList,(function(e,s){return a("div",{key:s,staticClass:"listCard pa-1",on:{click:function(a){return t.cardClick(e)}}},[a("div",{staticClass:"d-flex justify-space-between align-center fontWeight-500"},[a("div",{staticClass:"left-col flex-1"},[a("div",{staticClass:"label py-2 d-flex align-center"},[a("div",{staticClass:"block"}),a("span",{staticClass:"color-gray-5 font-16 ml-2"},[t._v(t._s(e.deptName))])]),a("div",{staticClass:"fontWeight-500 mt-1 font-20",class:"1"===t.active?"color-red ":"2"===t.active?"color-main-3 ":""},[t._v(" "+t._s(e.amount)+" ")]),a("div",{staticClass:"color-gray-4 font-14 mt-1 mb-2"},[t._v(" "+t._s("1"===t.active?"长账龄金额":"2"===t.active?"应收账款金额":"")+" ")])]),a("div",{staticClass:"circle-chart-wrap flex-1"},[a("div",{staticClass:"circle-chart",attrs:{id:"circleChart2"+s}})]),a("van-icon",{attrs:{size:"18px",name:"arrow"}})],1)])})),0):t._e(),2===+t.active?a("div",{staticClass:"background-color-white px-10"},t._l(t.dataList,(function(e,s){return a("div",{key:s,staticClass:"listCard pa-1",on:{click:function(a){return t.cardClick(e)}}},[a("div",{staticClass:"d-flex justify-space-between align-center fontWeight-500"},[a("div",{staticClass:"label py-2 d-flex align-center"},[a("div",{staticClass:"block"}),a("span",{staticClass:"color-gray-5 font-16 ml-2"},[t._v(t._s(e.deptName))])]),a("van-icon",{attrs:{size:"18px",name:"arrow"}})],1),a("div",{staticClass:"pb-2 font-16"},[a("van-progress",{staticClass:"mb-1 mt-2 mx-2",attrs:{percentage:e.percent,color:"#3561F2","show-pivot":!1,"stroke-width":"32"}}),a("div",{staticClass:"d-flex justify-space-between mt-2 progress-bottom-row"},[a("div",{staticClass:"progress-bottom-item"},[a("div",{staticClass:"progress-value-row"},[a("span",{staticClass:"dot color-main-3"},[t._v("•")]),a("span",{staticClass:"progress-bottom-value color-main-3"},[t._v(t._s(e.thisAmount))])]),a("div",{staticClass:"progress-bottom-label color-gray-5"},[t._v("本月应收账款")])]),a("div",{staticClass:"progress-bottom-item"},[a("div",{staticClass:"progress-value-row"},[a("span",{staticClass:"dot gray-dot"},[t._v("•")]),a("span",{staticClass:"progress-bottom-value color-main-3"},[t._v(t._s(e.amount))])]),a("div",{staticClass:"progress-bottom-label color-gray-5"},[t._v("总应收账款")])])])],1)])})),0):t._e()],1)])],1)},i=[],r=a("5530"),n=a("d4ec"),c=a("bee2"),o=a("262e"),l=a("2caf"),d=(a("d3b7"),a("159b"),a("d81d"),a("a9e3"),a("b680"),a("b0c0"),a("9ab4")),u=a("1b40"),v=a("53ae"),b=a("313e"),h=a("2279"),p=a("5b92"),m=a("4bb5"),f=Object(m["a"])("app"),y=function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(n["a"])(this,a),t=e.apply(this,arguments),t.active=t.$route.query.active,t.entryObj={},t.tabList=["逾期账款","长账龄"],t.tabType=0,t.overdueObj={},t.chartInstances=[],t.chartInstances2=[],t}return Object(c["a"])(a,[{key:"tabTypeClick",value:function(t){this.tabType=t,this.clearAllCharts(),0===+this.tabType?this._queryBigDataOverdueAmountDetail(this.entryObj):this._queryBigDataReceivableDetail(this.entryObj)}},{key:"clearAllCharts",value:function(){var t=this;this.chartInstances&&this.chartInstances.forEach((function(t){return t.dispose()})),this.chartInstances=[],this.chartInstances2&&this.chartInstances2.forEach((function(t){return t.dispose()})),this.chartInstances2=[],this.$nextTick((function(){t.dataList&&t.dataList.length&&(t.dataList.forEach((function(t,e){var a=document.getElementById("circleChart"+e);a&&(a.innerHTML="")})),t.dataList.forEach((function(t,e){var a=document.getElementById("circleChart2"+e);a&&(a.innerHTML="")})))}))}},{key:"cardClick",value:function(t){this.$router.push({name:"salesLineOverdue",query:{id:t.deptId,name:t.deptName,date:this.entryObj.date,active:this.active,tabType:this.tabType,level:this.entryObj.level}})}},{key:"_queryBigDataOverdueAmountDetail",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(h["V"])({deptId:e.id,selectDate:this.$dayjs().format("YYYY-MM-DD")}).then((function(e){t.dataList=e.data.children.map((function(t){return{deptId:t.deptId,deptName:t.deptName,overdueAmount:Object(p["c"])(t.overdueAmount),_rawValue:t.overdueAmount}})),t.overdueObj.overdueAmount=Object(p["c"])(e.data.parent.overdueAmount),t.$forceUpdate(),t.$nextTick((function(){t.chartInstances.forEach((function(t){return t.dispose()})),t.chartInstances=[],t.dataList.forEach((function(a,s){var i=Number(e.data.parent.overdueAmount),r=a._rawValue,n=i>0?(r/i*100).toFixed(1)+"%":"0%",c=document.getElementById("circleChart".concat(s));if(c){var o=b["b"](c);t.chartInstances.push(o);var l={series:[{name:"占比",type:"pie",radius:["70%","90%"],avoidLabelOverlap:!1,label:{show:!0,position:"center",formatter:n,fontSize:14,fontWeight:"bold",color:"#ea394b"},data:[{value:a._rawValue,name:a.deptName,itemStyle:{borderRadius:10,color:"#ea394b"}},{value:i-a._rawValue,itemStyle:{borderRadius:10,color:"#f5f5f5"}}]}]};o.setOption(l)}}))}))}))}},{key:"_queryBigDataReceivableDetail",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(h["ab"])({deptId:e.id,type:2===+this.active?1:2}).then((function(e){t.dataList=e.data.children.map((function(t){return{deptId:t.deptId,deptName:t.deptName,amount:Object(p["c"])(t.amount),_rawValue2:t.amount,thisAmount:Object(p["c"])(t.thisAmount),percent:t.thisAmount/t.amount*100}})),t.overdueObj.amount=Object(p["c"])(e.data.parent.amount),t.overdueObj.thisAmount=Object(p["c"])(e.data.parent.thisAmount),t.$forceUpdate(),t.$nextTick((function(){t.chartInstances2=[],t.dataList.forEach((function(a,s){var i=Number(e.data.parent.amount),r=a._rawValue2,n=i>0?(r/i*100).toFixed(1)+"%":"0%",c=document.getElementById("circleChart2".concat(s));if(c){var o=b["b"](c);t.chartInstances2.push(o);var l={series:[{name:"占比",type:"pie",radius:["70%","90%"],avoidLabelOverlap:!1,label:{show:!0,position:"center",formatter:n,fontSize:14,fontWeight:"bold",color:"#ea394b"},data:[{value:a._rawValue2,name:a.deptName,itemStyle:{borderRadius:10,color:"#ea394b"}},{value:i-a._rawValue2,itemStyle:{borderRadius:10,color:"#f5f5f5"}}]}]};o.setOption(l)}}))}))}))}},{key:"beforeRouteEnter",value:function(t,e,a){a((function(t){"salesLineHighRise0"!==e.name&&"salesLineHighRise1"!==e.name&&"salesLineHighRise1Inner"!==e.name&&"salesLineMiddleRise2"!==e.name&&"salesLineMiddleRise2Inner"!==e.name&&"salesLineMiddleRise3Inner"!==e.name&&"salesLineMiddleRise3"!==e.name||(t.tabType=0,t.active=t.$route.query.active,t.entryObj=Object(r["a"])({},t.$route.query),t.dataList=[],t.overdueObj={},1===+t.active?t._queryBigDataOverdueAmountDetail(t.entryObj):t._queryBigDataReceivableDetail(t.entryObj),t.filterShow=!1)}))}},{key:"created",value:function(){this.active=this.$route.query.active,this.entryObj=Object(r["a"])({},this.$route.query),this.dataList=[],this.overdueObj={},1===+this.active?this._queryBigDataOverdueAmountDetail(this.entryObj):this._queryBigDataReceivableDetail(this.entryObj)}}]),a}(Object(u["b"])(v["a"]));Object(d["a"])([f.Mutation],y.prototype,"SET_DETAILINFOR",void 0),y=Object(d["a"])([Object(u["a"])({})],y);var C=y,g=C,O=(a("51b6"),a("2877")),_=Object(O["a"])(g,s,i,!1,null,"69bb9c2e",null);e["default"]=_.exports}}]);