(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e328942"],{"418e":function(e,t,r){"use strict";r.d(t,"d",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"e",(function(){return o})),r.d(t,"a",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"c",(function(){return d}));var a=r("1da1"),n=(r("96cf"),r("90ae")),i=r("b32d"),s=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(n["c"],"/api/WeeklyReport/getReportDtl",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(n["c"],"/api/WeeklyReport/generateReport",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(n["c"],"/api/WeeklyReport/insOrUpdReport",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(n["c"],"/api/WeeklyReport/dltReport",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(n["c"],"/api/WeeklyReport/submitReport",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(n["c"],"/api/UserDep/getLeader",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},"4cd8":function(e,t,r){},"6e15":function(e,t,r){"use strict";r("7a1b")},"7a1b":function(e,t,r){},af71:function(e,t,r){"use strict";r("4cd8")},d3dc:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"weekly full-height boxSizing_border"},[r("van-sticky",[r("div",{staticClass:"weekly-header van-popup-bg pa-10"},[r("div",{staticClass:"d-flex"},[r("div",{staticClass:"flex-1 font-14 px-10 boxSizing_border weekly-header--item",on:{click:e.changeDate}},[e._v(" "+e._s(e.weekChangeString)+" "),r("span",{staticClass:"color-gray-2 font-12",on:{click:function(t){t.stopPropagation(),e.weekChangeString!==e.weekString?e.calendarConfirm(new Date):e.changeDate()}}},[e.weekChangeString!==e.weekString?r("svg",{staticClass:"icon",attrs:{color:"#2271f5","aria-hidden":"true"}},[r("use",{attrs:{"xlink:href":"#ytcrm-return1-copy"}})]):e._e(),r("span",{style:e.weekChangeString!==e.weekString?"color:#2271f5;":""},[e._v(e._s(e.weekChangeString!==e.weekString?"返回":"本周")+" ")])])]),e.checkedUsers.length?r("div",{staticClass:"flex-1 font-14 ml-2 px-10 boxSizing_border textAlignC weekly-header--item",staticStyle:{color:"white","background-color":"#2271f5"},on:{click:e.getUsersClick}},[e._v(" 已选"+e._s(e.checkedUsers.length)+"人 ")]):r("div",{staticClass:"flex-1 font-14 ml-2 px-10 boxSizing_border textAlignC weekly-header--item",on:{click:e.getUsersClick}},[e._v(" "+e._s(0===e.gatherFlag?"我的周报":"查看指定人员周报")),e.depTreeList&&e.depTreeList.length?r("van-icon",{staticClass:"ml-1",attrs:{name:"arrow-down"}}):e._e()],1)]),e.leaderList.length>0&&"weeklyReportErr400"!==e.weeklyReportError&&!e.isSubmit?r("div",{staticClass:"d-flex mt-2"},[r("div",{staticClass:"flex-2 font-14 textAlignC px-10 boxSizing_border weekly-header--item",class:e.submitLeaderId.length>0?"weekly-header--active":"",on:{click:function(t){e.leaderShow=!0,e.submitLeaderId=[],e.submitLeaderName=""}}},[e._v(" "+e._s(e.submitLeaderName||"请选择汇报对象")),r("van-icon",{staticClass:"ml-1",attrs:{name:"arrow-down"}})],1),e.leaderShow?r("van-action-sheet",{attrs:{title:"请选择汇报对象"},model:{value:e.leaderShow,callback:function(t){e.leaderShow=t},expression:"leaderShow"}},[r("van-checkbox-group",{on:{change:e.leaderSelect},model:{value:e.submitLeaderId,callback:function(t){e.submitLeaderId=t},expression:"submitLeaderId"}},[r("van-cell-group",e._l(e.leaderList,(function(t,a){return r("van-cell",{key:t.id,attrs:{clickable:"",title:t.name},on:{click:function(t){return e.$refs.checkboxes[a].toggle()}},scopedSlots:e._u([{key:"right-icon",fn:function(){return[r("van-checkbox",{ref:"checkboxes",refInFor:!0,attrs:{name:t.id}})]},proxy:!0}],null,!0)})})),1)],1)],1):e._e(),r("div",{staticClass:"flex-1 font-14 ml-2 px-10 boxSizing_border textAlignC weekly-header--item",class:e.selectLabelFlag?"weekly-header--active":"",on:{click:e.selectLabelClick}},[e._v(" "+e._s(e.selectLabelFlag?"取消选择":"选择标签")+" ")]),e.selectLabelFlag?r("div",{staticClass:"flex-1 font-14 ml-2 px-10 boxSizing_border textAlignC weekly-header--item",class:e.selectLabelAll?"weekly-header--active":"",on:{click:e.selectLabelAllClick}},[e._v(" "+e._s(e.selectLabelAll?"取消":"")+" 全选 ")]):e._e()],1):e._e(),e.weeklyReportObj.fullName?r("div",{staticClass:"d-flex pt-2 justify-space-between font-14"},[r("span",[e._v(e._s(e.weeklyReportObj.fullName&&e.weeklyReportObj.fullName.split("/")[0]))]),1===e.leaderList.length&&e.submitLeaderName?r("span",[e._v("汇报对象："+e._s(e.submitLeaderName))]):e._e(),0!==e.leaderList.length||e.submitLeaderName?e._e():r("span",{staticClass:"color-red"},[e._v("未维护汇报对象")]),e.isSubmit?r("span",{staticClass:"color-normal"},[e._v("已提交")]):e._e()]):e._e()])]),"weeklyReportErr400"===e.weeklyReportError?r("div",{staticClass:"weekly-content-empty"},[r("app-empty",{staticClass:"empty",attrs:{description:e.weeklyReportMsg}}),"本周周报还未生成"===e.weeklyReportMsg?r("div",{staticClass:"commonOpButton-footer"},[r("van-button",{attrs:{round:"",color:"#2271F5",type:"primary"},on:{click:e.generateClick},scopedSlots:e._u([{key:"icon",fn:function(){return[r("icon-Svg",{attrs:{size:"small",color:"white",name:"ytcrm-juxing"}})]},proxy:!0}],null,!1,1936505431)},[r("span",[e._v("周报生成")])])],1):e._e()],1):r("div",{staticClass:"weekly-content pb-100 boxSizing_border"},[r("van-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.weeklyReportObj.resultList,(function(t,a){return r("van-collapse-item",{key:"weeklyReport"+a,attrs:{name:t.majorClassLabelId},scopedSlots:e._u([{key:"title",fn:function(){return[r("div",[e._v(" "+e._s(t.majorClassLabelName)+" "),r("span",{class:t.labelNumber?"tag-number-blue":"tag-number-gray"},[e._v(e._s(t.labelNumber))])])]},proxy:!0}],null,!0)},[e._l(t.childList,(function(t,a){return r("div",{directives:[{name:"show",rawName:"v-show",value:t.reportDtoList.length>0,expression:"weeklyChild.reportDtoList.length > 0"}],key:"weeklyChild"+a},[r("span",[e._v(" "+e._s(t.subClassLabelName)+" "),r("span",{staticClass:"tag-number-blue-op"},[e._v(e._s(t.reportDtoList.length))])]),e._l(t.reportDtoList,(function(t,a){return r("list",{key:"reportDto"+a,attrs:{isSubmit:e.isSubmit,cwrdocId:e.weeklyReportObj.cwrdocId,selectLabelFlag:e.selectLabelFlag,item:t},on:{deleteClick:e.deleteClick}})}))],2)})),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.labelNumber,expression:"!weeklyReport.labelNumber"}]},[e._v("暂无信息")])],2)})),1)],1),"本周周报还未生成"===e.weeklyReportMsg||e.isSubmit?e.checkedUsers.length?r("div",{staticClass:"commonOpButton-footer"},[r("van-button",{attrs:{round:"",color:"#2271F5",type:"primary"},on:{click:function(t){e.checkedUsers=[],e.gatherFlag=e.userDataList.length?1:0,e.init(new Date(e.startTime))}},scopedSlots:e._u([{key:"icon",fn:function(){return[r("icon-Svg",{attrs:{size:"small",color:"white",name:"ytcrm-juxing1"}})]},proxy:!0}])},[r("span",[e._v("本人客情")])])],1):e._e():r("div",{staticClass:"commonOpButton-footer"},[r("div",{directives:[{name:"show",rawName:"v-show",value:!e.checkedUsers.length,expression:"!checkedUsers.length"}],staticClass:"weekly-button d-flex align-center justify-center"},[r("icon-svg",{attrs:{size:"large",color:"#2271F5",name:"ytcrm-zhongxin"},nativeOn:{click:function(t){return e.generateClick("reload")}}}),r("icon-svg",{staticClass:"mx-6 cursorP",attrs:{size:"large",color:"#2271F5",name:"ytcrm-baocun"},nativeOn:{click:function(t){return e.saveClick.apply(null,arguments)}}}),r("icon-svg",{attrs:{size:"large",color:"#2271F5",name:"ytcrm-tijiao"},nativeOn:{click:function(t){return e.submitReportClick.apply(null,arguments)}}})],1),e.checkedUsers.length?r("van-button",{attrs:{round:"",color:"#2271F5",type:"primary"},on:{click:function(t){e.checkedUsers=[],e.userDataList=[],e.init(e.dateRange[0])}},scopedSlots:e._u([{key:"icon",fn:function(){return[r("icon-Svg",{attrs:{size:"small",color:"white",name:"ytcrm-juxing1"}})]},proxy:!0}],null,!1,2380554150)},[r("span",[e._v("本人客情")])]):r("van-button",{attrs:{round:"",color:"#2271F5",type:"primary"},on:{click:e.addWeeklyClick},scopedSlots:e._u([{key:"icon",fn:function(){return[r("icon-Svg",{attrs:{size:"small",color:"white",name:"ytcrm-a-xingzhuang2"}})]},proxy:!0}],null,!1,780156825)},[r("span",[e._v("新增")])])],1),r("van-calendar",{attrs:{type:"range","default-date":e.dateRange,"min-date":new Date(2020,0,1),"first-day-of-week":"6",color:"#1989fa","show-confirm":!1},on:{select:e.selectCalendar},model:{value:e.calendarShow,callback:function(t){e.calendarShow=t},expression:"calendarShow"}}),e.hasDept?r("dept-user",{ref:"deptUer",attrs:{show:e.changeTypeShow,loading:e.getUserListLoading,depTreeList:e.depTreeList,deptUserData:e.deptUserData,searchList:e.userDataList},on:{search:e.refreshUserByKeywords,refresh:e.refreshUserByDepts,confirm:e.onTreeConfirm,cancel:e.cancelUserByDepts}}):e._e()],1)},n=[],i=r("2909"),s=r("1da1"),l=r("d4ec"),o=r("bee2"),c=r("262e"),u=r("2caf"),d=(r("96cf"),r("d81d"),r("b0c0"),r("7db0"),r("d3b7"),r("4de4"),r("99af"),r("caad"),r("2532"),r("9ab4")),h=r("1b40"),p=r("418e"),f=r("d926"),g=r("f727"),m=r("8393"),b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("van-swipe-cell",{staticClass:"my-2",scopedSlots:e._u([e.isSubmit?null:{key:"right",fn:function(){return[r("van-button",{staticClass:"delete-button",attrs:{square:"",text:"删除",type:"danger"},on:{click:e.deleteClick}})]},proxy:!0}],null,!0)},[r("van-cell-group",[4!==e.item.tableType?r("van-cell",{attrs:{value:1===e.item.objType?"供应商":2===e.item.objType?"下游客户":3===e.item.objType?"政府单位":"",title:"单位类型"}}):e._e(),4===e.item.tableType?r("van-cell",{attrs:{value:10052===e.item.objId?"客户拜访":10051===e.item.objId?"品种进院":10050===e.item.objId?"厂家协同":10049===e.item.objId?"货款催收":10048===e.item.objId?"其他事务":"",title:"类型"}}):e._e(),r("van-cell",{attrs:{readonly:"",value:e.item.objName?e.item.objName:"",title:"单位信息"}}),10041===e.item.objId?r("van-field",{attrs:{readonly:e.isSubmit,value:e.item.exceptTimeStr,label:"预期时间","input-align":"right"},on:{input:function(t){return e.inputChange(t,1)}}}):e._e(),4!==e.item.tableType?r("van-field",{attrs:{readonly:e.isSubmit,value:e.item.labelRemark,label:"详情",autosize:"",type:"textarea","input-align":"right"},on:{input:function(t){return e.inputChange(t,2)}}}):r("van-field",{attrs:{readonly:e.isSubmit,value:e.item.labelRemark,label:"计划",autosize:"",type:"textarea","input-align":"right"},on:{input:function(t){return e.inputChange(t,2)}}}),1!==e.weekType&&e.item.userId?r("van-cell",{attrs:{readonly:"",value:e.item.userId+"/"+e.item.userName,title:"填报人"}}):e._e(),e.item.submitUserName?r("van-cell",{attrs:{readonly:"",title:"提交对象"},scopedSlots:e._u([{key:"default",fn:function(){return e._l(e.item.submitUserName.split("/"),(function(t,a){return r("van-tag",{key:"submitUserName"+a,staticClass:"mr-2",attrs:{plain:"",type:"primary"}},[e._v(e._s(t))])}))},proxy:!0}],null,!1,2310267335)}):e._e()],1),e.selectLabelFlag?r("div",{staticClass:"changeClass",on:{click:e.changeCheckClick}},[r("van-checkbox",{attrs:{"icon-size":"30px"},model:{value:e.item.checked,callback:function(t){e.$set(e.item,"checked",t)},expression:"item.checked"}})],1):e._e()],1)},v=[],k=function(e){Object(c["a"])(r,e);var t=Object(u["a"])(r);function r(){return Object(l["a"])(this,r),t.apply(this,arguments)}return Object(o["a"])(r,[{key:"changeCheckClick",value:function(){this.$set(this.item,"checked",!this.item.checked)}},{key:"inputChange",value:function(e,t){1===t&&this.$set(this.item,"exceptTimeStr",e),2===t&&this.$set(this.item,"labelRemark",e),this.$set(this.item,"cwrdocId",this.cwrdocId)}},{key:"deleteClick",value:function(){var e=this;this.$dialog.confirm({title:"提示",confirmButtonColor:"#2271f5",message:"确定删除当前信息？",beforeClose:function(t,r){"confirm"===t?(e.$emit("deleteClick",e.item),r()):r()}})}}]),r}(h["d"]);Object(d["a"])([Object(h["c"])()],k.prototype,"item",void 0),Object(d["a"])([Object(h["c"])()],k.prototype,"selectLabelFlag",void 0),Object(d["a"])([Object(h["c"])()],k.prototype,"isSubmit",void 0),Object(d["a"])([Object(h["c"])()],k.prototype,"weekType",void 0),Object(d["a"])([Object(h["c"])()],k.prototype,"cwrdocId",void 0),Object(d["a"])([Object(h["c"])()],k.prototype,"needOptions",void 0),k=Object(d["a"])([Object(h["a"])({})],k);var y=k,w=y,L=(r("af71"),r("2877")),D=Object(L["a"])(w,b,v,!1,null,"00b87a12",null),j=D.exports,_=r("48b8"),C=r("4bb5"),O=Object(C["a"])("app"),R=Object(C["a"])("crm"),x=function(e){Object(c["a"])(r,e);var t=Object(u["a"])(r);function r(){var e;return Object(l["a"])(this,r),e=t.apply(this,arguments),e.labelTreeList=[],e.weeklyReportObj={},e.weeklyReportError="",e.weeklyReportMsg="",e.cwrdocId="",e.isSubmit=!1,e.weekNumber=0,e.weekString="",e.weekChangeString="",e.startTime="",e.endTime="",e.dateRange=[],e.calendarShow=!1,e.activeNames=[],e.leaderList=[],e.submitLeaderId=[],e.submitLeaderName="",e.leaderShow=!1,e.selectLabelFlag=!1,e.selectLabelAll=!1,e.authorizedFlag=!0,e.leaderFlag=!0,e.gatherFlag=0,e.needLoading=!1,e.reLoad=!0,e.needOptions=[{name:"客户拜访",id:10052},{name:"品种进院",id:10051},{name:"厂家协同",id:10050},{name:"货款催收",id:10049},{name:"其他事务",id:10048}],e}return Object(o["a"])(r,[{key:"changeDate",value:function(){this.calendarShow=!0}},{key:"selectCalendar",value:function(e){this.calendarConfirm(e[0])}},{key:"calendarConfirm",value:function(e){this.calendarShow=!1,this.init(e)}},{key:"_getLabelTree",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={type:"2"},e.next=3,Object(g["e"])(t);case 3:r=e.sent,this.labelTreeList=r.data.map((function(e){var t=[];return e.CHILD_LIST.length&&(t=e.CHILD_LIST.map((function(e){return{id:e.LABEL_ID,text:e.LABEL_NAME}}))),{id:e.LABEL_ID,text:e.LABEL_NAME,children:Object(i["a"])(t)}}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_getReportDtl",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.labelTreeList=[],this.weeklyReportMsg="",this.weeklyReportError="",this.leaderList.length>0&&(this.submitLeaderId=[],this.submitLeaderName="",this.selectLabelFlag=!1,this.selectLabelAll=!1),t={gatherFlag:this.gatherFlag,userIdList:this.checkedUsers,weekOfYear:this.weekNumber,startDate:this.startTime,endDate:this.endTime},e.next=7,Object(p["d"])(t).then(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,i,s,l,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("200"!==t.code){e.next=10;break}for(r.activeNames=[],r.cwrdocId=t.data.cwrdocId,r.weeklyReportObj=t.data,r.isSubmit=!!r.weeklyReportObj.commitFlag,a=0;a<r.weeklyReportObj.resultList.length;a++)for(n=r.weeklyReportObj.resultList[a],n.labelNumber=0,i=0;i<n.childList.length;i++)for(s=n.childList[i],s.reportDtoList.length&&(++n.labelNumber,r.activeNames.push(n.majorClassLabelId)),l=0;l<s.reportDtoList.length;l++)o=s.reportDtoList[l],"客户拜访"!==o.subClassLabelName&&0===r.weeklyReportObj.commitFlag&&r.$set(o,"editing",!0);r.$forceUpdate(),e.next=14;break;case 10:return r.weeklyReportMsg=t.msg,r.weeklyReportError=t.code,r.isSubmit=!1,e.abrupt("return");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_getLeader",value:function(){var e=this;this.leaderList=[];var t={userId:this.userInfor.userId};Object(p["c"])(t).then((function(t){e.submitLeaderId=[],e.submitLeaderName="";for(var r=0;r<t.data.length;r++){var a=t.data[r];a.leaderId&&e.leaderList.push({id:a.leaderId,name:a.leaderName})}1===e.leaderList.length&&(e.submitLeaderId=[e.leaderList[1].id],e.submitLeaderName=e.leaderList[1].name)}))}},{key:"leaderSelect",value:function(e){var t=this;this.submitLeaderName="";for(var r=function(r){var a=e[r];t.submitLeaderName+=t.leaderList.find((function(e){return+e.id===+a})).name+" "},a=0;a<e.length;a++)r(a)}},{key:"init",value:function(e){var t=this,r=(new Date).getFullYear(),a=6===(new Date).getDay()?(new Date).getTime():(new Date).getTime()-24*(1+(new Date).getDay())*60*60*1e3,n=6===e.getDay()?e.getTime():e.getTime()-24*(1+e.getDay())*60*60*1e3;this.startTime=this.$dayjs(n).format("YYYY-MM-DD"),this.endTime=this.$dayjs(n).add(6,"day").format("YYYY-MM-DD");var i=new Date(this.startTime).getFullYear();this.dateRange=[new Date(this.startTime),new Date(this.endTime)],Object(f["f"])(i).result6.filter((function(e,s){e===t.$dayjs(n).format("YYYY-MM-DD")&&(t.weekChangeString="".concat(i,"第").concat(s+1,"周"),t.weekNumber=s+1),e===t.$dayjs(a).format("YYYY-MM-DD")&&(t.weekString="".concat(r,"第").concat(s+1,"周"))})),this._getReportDtl()}},{key:"selectLabelClick",value:function(){var e=this;this.selectLabelFlag=!this.selectLabelFlag,this.selectLabelFlag||this.weeklyReportObj.resultList.filter((function(t){t.childList.filter((function(t){t.reportDtoList.length>0&&t.reportDtoList.map((function(t){e.$set(t,"checked",e.selectLabelFlag)}))}))}))}},{key:"selectLabelAllClick",value:function(){var e=this;this.selectLabelAll=!this.selectLabelAll,this.weeklyReportObj.resultList.filter((function(t){t.childList.filter((function(t){t.reportDtoList.length>0&&t.reportDtoList.map((function(t){e.$set(t,"checked",e.selectLabelAll)}))}))}))}},{key:"generateClick",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t?this.$dialog.confirm({title:"提示",message:"确定重新生成?",confirmButtonColor:"#2271f5",beforeClose:function(t,r){"confirm"===t?(e._generateReport(),r()):r()}}):this._generateReport()}},{key:"saveClick",value:function(){for(var e=[],t=0;t<this.weeklyReportObj.resultList.length;t++)for(var r=this.weeklyReportObj.resultList[t],a=0;a<r.childList.length;a++)for(var n=r.childList[a],i=0;i<n.reportDtoList.length;i++){var s=n.reportDtoList[i];s.cwrdocId&&(this.$set(s,"isSaveClick",!0),e.push(s))}var l=this.Yz(e);l||this._insOrUpdReport(e)}},{key:"Yz",value:function(e){if(0===e.length)return this.$toast.fail("没有要新增或编辑的信息"),!0;for(var t=0;t<e.length;t++){var r=e[t];switch(r.tableType){case 1:if(!r.objId)return this.$toast.fail("政府单位不能为空"),!0;if(!r.labelRemark)return this.$toast.fail("详情不能为空"),!0;break;case 2:if(!r.objType)return this.$toast.fail("类型不能为空"),!0;if(!r.objId)return this.$toast.fail("客户信息不能为空"),!0;break;case 3:if(!r.objType)return this.$toast.fail("类型不能为空"),!0;if(!r.objId)return this.$toast.fail("客户信息不能为空"),!0;if(!r.labelRemark)return this.$toast.fail("详情不能为空"),!0;break;case 4:if(!r.objId)return this.$toast.fail("事项类型不能为空"),!0;if(!r.labelRemark)return this.$toast.fail("计划不能为空"),!0;break;default:break}}}},{key:"_insOrUpdReport",value:function(e){var t=this;Object(p["e"])(e).then((function(e){"200"===e.code&&(t.$toast({type:"success",message:e.msg}),t._getReportDtl())}))}},{key:"_generateReport",value:function(){var e=this;Object(p["b"])({startTime:this.startTime,endTime:this.endTime}).then((function(t){"200"===t.code&&e._getReportDtl()}))}},{key:"submitReportClick",value:function(){var e=this,t=[];if(this.leaderList.length>1)for(var r=0;r<this.weeklyReportObj.resultList.length;r++)for(var a=this.weeklyReportObj.resultList[r],n=0;n<a.childList.length;n++)for(var i=a.childList[n],l=0;l<i.reportDtoList.length;l++){var o=i.reportDtoList[l];o.checked&&t.push(o.cwrdtlId)}else for(var c=0;c<this.weeklyReportObj.resultList.length;c++)for(var u=this.weeklyReportObj.resultList[c],d=0;d<u.childList.length;d++)for(var h=u.childList[d],p=0;p<h.reportDtoList.length;p++){var f=h.reportDtoList[p];t.push(f.cwrdtlId)}if(this.submitLeaderId.length)if(t.length)if(this.leaderList.length>1)this.$dialog.confirm({title:"提示",confirmButtonColor:"#2271f5",message:"单个汇报领导只能提交一次，请确定选择提交信息无遗漏！",beforeClose:function(){var r=Object(s["a"])(regeneratorRuntime.mark((function r(a,n){var i,s,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if("confirm"!==a){r.next=13;break}i=0;case 2:if(!(i<e.submitLeaderId.length)){r.next=10;break}return s=e.submitLeaderId[i],l={cwrdocId:e.weeklyReportObj.cwrdocId,leaderId:s,cwrdtlIdList:t},r.next=7,e._submitReport(l);case 7:i++,r.next=2;break;case 10:n(),r.next=14;break;case 13:n();case 14:case"end":return r.stop()}}),r)})));function a(e,t){return r.apply(this,arguments)}return a}()});else{var g={cwrdocId:this.weeklyReportObj.cwrdocId,leaderId:this.submitLeaderId[0],cwrdtlIdList:t};this._submitReport(g)}else this.$toast.fail("请选择要提交的信息");else this.$toast.fail("请选择汇报领导")}},{key:"_submitReport",value:function(e){var t=this,r=this.$toast.loading({duration:0,message:"提交中..."});Object(p["f"])(e).then((function(e){r.clear(),"200"===e.code?t._getReportDtl():t.$dialog.confirm({title:"提示",message:e.msg,confirmButtonColor:"#2271F5"})}))}},{key:"deleteClick",value:function(e){var t=this;Object(p["a"])([e.cwrdtlId]).then((function(e){"200"===e.code&&(t.$toast({type:"success",message:e.msg}),t._getReportDtl())}))}},{key:"onTreeConfirm",value:function(e){var t=this;this.checkedUsers=e;var r=this.userDataList.filter((function(t){return e.includes(t.userId)}));this.checkDetailList=this.checkDetailList.concat(r);for(var a=[],n=function(r){var n=t.checkDetailList[r];-1===e.indexOf(n.userId)||a.some((function(e){return n.userId===e.userId}))||a.push(n)},i=0;i<this.checkDetailList.length;i++)n(i);this.checkDetailList=a,this.changeTypeShow=!1,this.checkedUsers.length?this.gatherFlag=2:this.gatherFlag=1,this.init(this.dateRange[0])}},{key:"addWeeklyClick",value:function(){this.$router.push({name:"weeklyAdd",query:{cwrdocId:this.weeklyReportObj.cwrdocId}})}},{key:"activated",value:function(){var e=this;this.reLoad&&(this._getLeader(),this.actionGetDepTree({treeType:1,authorizedFlag:!0}).then((function(){var t;e.hasDept=!0;var r=Object(_["c"])((null===(t=e.userInfor)||void 0===t?void 0:t.resListTree)||"","周报",[],1);e.leaderFlag=!r.some((function(e){return"周报查询所有权限"===e.pmsName})),e.authorizedFlag=!0,e._getUserByParams({depIdList:e.mapTreeList(e.depTreeList,[]),leaderFlag:e.leaderFlag,authorizedFlag:e.authorizedFlag}).then((function(t){t.data.length&&(e.gatherFlag=1),e.init(new Date)}))})),this.reLoad=!1),"add"===this.dataChangeOp&&(this.init(this.dateRange[0]),this.SET_DATACHANGEOP(""))}},{key:"mounted",value:function(){var e=this;this._getLeader(),this.actionGetDepTree({treeType:1,authorizedFlag:!0}).then((function(){var t;e.hasDept=!0;var r=Object(_["c"])((null===(t=e.userInfor)||void 0===t?void 0:t.resListTree)||"","周报",[],1);e.leaderFlag=!r.some((function(e){return"周报查询所有权限"===e.pmsName})),e.authorizedFlag=!0,e._getUserByParams({depIdList:e.mapTreeList(e.depTreeList,[]),leaderFlag:e.leaderFlag,authorizedFlag:e.authorizedFlag}).then((function(t){t.data.length&&(e.gatherFlag=1),e.init(new Date)}))}))}}]),r}(Object(h["b"])(m["a"]));Object(d["a"])([O.Getter],x.prototype,"userInfor",void 0),Object(d["a"])([R.Getter],x.prototype,"dataChangeOp",void 0),Object(d["a"])([R.Mutation],x.prototype,"SET_DATACHANGEOP",void 0),x=Object(d["a"])([Object(h["a"])({components:{list:j},beforeRouteLeave:function(e,t,r){"CrmIndex"===e.name&&(this.reLoad=!0),r()}})],x);var I=x,S=I,T=(r("6e15"),Object(L["a"])(S,a,n,!1,null,"19f0102b",null));t["default"]=T.exports},d926:function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return h})),r.d(t,"j",(function(){return p})),r.d(t,"i",(function(){return f})),r.d(t,"k",(function(){return g})),r.d(t,"b",(function(){return m})),r.d(t,"e",(function(){return b})),r.d(t,"g",(function(){return v})),r.d(t,"f",(function(){return k})),r.d(t,"a",(function(){return y})),r.d(t,"h",(function(){return w}));r("d3b7"),r("25f0"),r("ac1f"),r("1276");var a=r("5a0c"),n=r.n(a),i=new Date,s=i.getDay(),l=i.getDate(),o=i.getMonth(),c=i.getYear();c+=c<2e3?1900:0;var u=new Date;function d(e){var t=new Date(e),r=t.getFullYear(),a=(t.getMonth()+1).toString(),n=t.getDate().toString();return+a<10&&(a="0"+a),+n<10&&(n="0"+n),r+"-"+a+"-"+n}function h(e){var t=new Date(e),r=t.getFullYear(),a=(t.getMonth()+1).toString(),n=t.getDate().toString();return+a<10&&(a="0"+a),+n<10&&(n="0"+n),r+"/"+a+"/"+n}function p(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t){var r=new Date(t),a=r.getDay();a=0===a?7:a;var n=r.getDate(),i=r.getMonth(),u=r.getYear();u+=u<2e3?1900:0,e=new Date(u,i,n-(a-1))}else e=new Date(c,o,l-(s-1));return d(e)}function f(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t){var r=new Date(t),a=r.getDay();a=0===a?7:a;var n=r.getDate(),i=r.getMonth(),u=r.getYear();u+=u<2e3?1900:0,e=new Date(u,i,n+(6-(a-1)))}else e=new Date(c,o,l+(6-(s-1)));return d(e)}function g(e){return 0===n()(e).day()?n()(e).startOf("week").subtract(6,"day").format("YYYY-MM-DD"):n()(e).startOf("week").add(1,"day").format("YYYY-MM-DD")}function m(e){return 0===n()(e).day()?n()(e).endOf("week").subtract(6,"day").format("YYYY-MM-DD"):n()(e).endOf("week").add(1,"day").format("YYYY-MM-DD")}u.setDate(1),u.setMonth(u.getMonth()-1);var b=function(e,t){var r=[],a=e.split("-"),n=t.split("-"),i=new Date(a+" 08:00:00");i.setUTCFullYear(a[0],a[1]-1,a[2]);var s=new Date(n+" 08:00:00");s.setUTCFullYear(n[0],n[1]-1,n[2]);var l,o=i.getTime(),c=s.getTime(),u=864e5;for(l=o;l<=c;)r.push(d(new Date(parseInt(String(l))))),l+=u;return r},v=function(e,t){var r=new Date(e),a="";r.setDate(r.getDate()+t);var n=r.getFullYear(),i=r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1,s=r.getDate()<10?"0"+r.getDate():r.getDate();return a=n+"-"+i+"-"+s,a},k=function(e){var t,r,a,n,i=new Date(e+"-01-01"),s=i.getFullYear(),l={result0:[],result1:[],result2:[],result3:[],result4:[],result5:[],result6:[]};for(t=1;t<=12;t++){switch(t){case 1:case 3:case 5:case 7:case 8:case 10:case 12:n=31;break;case 4:case 6:case 9:case 11:n=30;break;case 2:n=s%4===0&&s%100!==0||s%400===0?29:28;break}for(r=1;r<=n;r++){i.setMonth(t-1,r),a=i.getDay();var o=i.getFullYear(),c=i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1,u=i.getDate()<10?"0"+i.getDate():i.getDate();l["result"+a].push(o+"-"+c+"-"+u)}}return l};function y(e){switch(e){case 0:return"日";case 1:return"一";case 2:return"二";case 3:return"三";case 4:return"四";case 5:return"五";case 6:return"六";default:break}}var w=function(e){var t=new Date,r=t.getFullYear(),a=t.getMonth()+1,n=t.getDate(),i=e.split("-"),s=0;if(a>parseInt(i[0])||a==parseInt(i[0])&&n>parseInt(i[1])){var l=new Date(r+1,parseInt(i[0])-1,parseInt(i[1])).toLocaleDateString(),o=Date.parse(l),c=Date.parse(t.toLocaleDateString());s=(o-c)/864e5}else{var u=new Date(r,parseInt(i[1])-1,parseInt(i[2])).toLocaleDateString(),d=Date.parse(u),h=Date.parse(t.toLocaleDateString());s=(d-h)/864e5}if(s<0){var p=r+1,f=p%4===0&&p%100!==0||p%400===0?366:365;s+=f}return s}}}]);