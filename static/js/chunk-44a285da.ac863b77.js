(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44a285da"],{"025b":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"warp"},[a("van-search",{attrs:{placeholder:"搜索","input-align":"center"},on:{input:t.onRefresh,clear:t.onRefresh},model:{value:t.searchValueCustom,callback:function(e){t.searchValueCustom=e},expression:"searchValueCustom"}}),a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.customList,(function(e,n){return a("div",{key:e.customid+n,staticClass:"warp"},[e.contactList&&0!==e.contactList.length?a("van-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("van-collapse-item",{attrs:{name:e.customid},scopedSlots:t._u([{key:"title",fn:function(){return[a("ul",[a("li",{staticClass:"customerValue"},[t._v(t._s(e.customid)+"/"+t._s(e.customname))]),a("li",{directives:[{name:"show",rawName:"v-show",value:e.entryid,expression:"item.entryid"}],staticClass:"color-gray-4 font-12"},[t._v(t._s(e.entryid)+"/"+t._s(e.entryname))])])]},proxy:!0}],null,!0)},t._l(e.contactList,(function(n,s){return a("van-cell",{key:n.CONTACTID+s,attrs:{"is-link":""},on:{click:function(a){return t.chooseCustomClick(e,n)}},scopedSlots:t._u([{key:"title",fn:function(){return[a("span",{style:n.dialyPass?"color: #AAA":""},[t._v(" "+t._s(n.CONTACTID+n.CONTACTMAN)+" "),a("br"),n.dialyPass&&!t.requestChange?a("i",{staticClass:"fontSize-12 text-orange"},[t._v("最小效期为:"+t._s(new Date(n.miniTime).toLocaleDateString()))]):t._e()])]},proxy:!0}],null,!0)})})),1)],1):a("van-cell",{attrs:{"is-link":!e.contactFlag},on:{click:function(a){return t.chooseCustomClick(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[a("ul",[a("li",{staticClass:"customerValue"},[t._v(" "+t._s(e.customid)+"/"+t._s(e.customname)+" "),t._t("default")],2),a("li",{directives:[{name:"show",rawName:"v-show",value:e.entryid,expression:"item.entryid"}],staticClass:"color-gray-4 font-12"},[t._v(t._s(e.entryid)+"/"+t._s(e.entryname))]),e.contactFlag?a("li",{staticClass:"color-never font-12"},[t._v("无可下单分支机构（不在效期），不可下单")]):t._e()])]},proxy:!0}],null,!0)})],1)})),0)],1)],1)},s=[],o=a("5530"),r=a("d4ec"),i=a("bee2"),c=a("262e"),u=a("2caf"),l=(a("99af"),a("d3b7"),a("159b"),a("9ab4")),f=a("1b40"),p=a("53ae"),h=a("f727"),m=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.customList=[],t.searchValueCustom="",t.activeNames=[],t}return Object(i["a"])(a,[{key:"chooseCustomClick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t.contactFlag)this.$toast.fail("无可下单分支机构（不在效期），不可下单");else{var a=Object.assign({customid:t.customid,customname:t.customname},e);e&&e.dialyPass?this.$dialog.alert({confirmButtonColor:"rgb(34, 113, 245)",message:"".concat(e.CONTACTMAN,"有多个不同的有效期且已过期，不允许选择，最小效期为:").concat(new Date(e.miniTime).toLocaleDateString())}).then((function(){})):this.$emit("chooseCustomClick",a)}}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!1,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.customList=[],this.refreshing=!1),this.loading=!0,this.requestChange?this.$emit("getList",{condition:this.searchValueCustom,pageNum:this.page,pageSize:10}):this._getCustom()}},{key:"_getCustom",value:function(){var t=this;1===this.page&&(this.customList=[]);var e=Object(o["a"])(Object(o["a"])({condition:this.searchValueCustom},this.params),{},{pageNum:this.page,pageSize:10});Object(h["f"])(e).then((function(e){t.customList=t.customList.concat(e.data.list);for(var a=0;a<t.customList.length;a++){var n=t.customList[a];n.contactList&&n.contactList.length>0&&t.needDialyPass&&n.contactList.forEach((function(t){var e=0;t.dates&&t.dates.length>0&&(t.dates.forEach((function(t){e?e>new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()&&(e=new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()):e=new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()})),e<new Date((new Date).toLocaleDateString()).getTime()&&(t.dialyPass=!0,t.miniTime=e))}))}e.data.hasNextPage?t.page++:t.finished=!0,t.loading=!1}))}}]),a}(Object(f["b"])(p["a"]));Object(l["a"])([Object(f["c"])({default:!1})],m.prototype,"requestChange",void 0),Object(l["a"])([Object(f["c"])({default:!1})],m.prototype,"needDialyPass",void 0),Object(l["a"])([Object(f["c"])()],m.prototype,"params",void 0),m=Object(l["a"])([Object(f["a"])({})],m);var d=m,g=d,v=(a("27ba"),a("2877")),b=Object(v["a"])(g,n,s,!1,null,"12f3a2f4",null);e["a"]=b.exports},"27ba":function(t,e,a){"use strict";a("6b64")},"53ae":function(t,e,a){"use strict";var n=a("d4ec"),s=a("bee2"),o=a("262e"),r=a("2caf"),i=(a("b0c0"),a("9ab4")),c=a("1b40");c["a"].registerHooks(["beforeRouteEnter"]);var u=function(t){Object(o["a"])(a,t);var e=Object(r["a"])(a);function a(){var t;return Object(n["a"])(this,a),t=e.apply(this,arguments),t.page=1,t.total=0,t.dataList=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.finishText="",t.userIdList=[],t.error=!1,t}return Object(s["a"])(a,[{key:"beforeRouteEnter",value:function(t,e,a){a((function(t){"Home"!==e.name&&"TaskIndex"!==e.name||(t.dataList=[],t.page=1,t.loading=!1,t.finished=!0,t.refreshing=!1,t.$nextTick((function(){t.finished=!1})))}))}}]),a}(c["d"]);u=Object(i["a"])([Object(c["a"])({})],u),e["a"]=u},"6b64":function(t,e,a){},ab70:function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return i})),a.d(e,"a",(function(){return c})),a.d(e,"g",(function(){return u})),a.d(e,"h",(function(){return l})),a.d(e,"c",(function(){return f})),a.d(e,"f",(function(){return p})),a.d(e,"b",(function(){return h}));var n=a("1da1"),s=(a("96cf"),a("b32d")),o=a("90ae"),r=function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].post(o["d"],"/api/crmGoods/getGoodsDoc",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),i=function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].post(o["d"],"/api/crmGoods/getGoodsDtl",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),c=function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].post(o["d"],"/api/cart/addCartSaler",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),u=function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].formDataPost(o["d"],"/api/cart/queryCartSaler",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].post(o["d"],"/api/cart/updateCartsQtySaler",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),f=function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].post(o["d"],"/api/cart/delCart",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p=function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].post(o["d"],"/api/order/preCreateInvoiceSaler",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),h=function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].post(o["d"],"/api/orderNew/createInvoiceSaler",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},e0ca:function(t,e,a){"use strict";a("fd43")},f4e7:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"reportCustomDetail"},[a("van-sticky",[a("van-cell",{staticClass:"vant-cell-pa",attrs:{title:(t.customParams.CONTACTID||t.customParams.customid)+"/"+(t.customParams.CONTACTMAN||t.customParams.customname),"is-link":"","arrow-direction":"down"},on:{click:function(e){t.customShow=!0}},scopedSlots:t._u([{key:"icon",fn:function(){return[a("icon-Svg",{staticClass:"mt-1 mr-1",attrs:{size:"small",color:"#323233",name:"ytcrm-xiaoshou_sales-report"}})]},proxy:!0}])}),a("van-cell",{staticClass:"vant-cell-pa",attrs:{"is-link":"","arrow-direction":"down"},on:{click:function(e){t.contactShow=!0}},scopedSlots:t._u([{key:"icon",fn:function(){return[a("icon-Svg",{staticClass:"mt-1 mr-1",attrs:{size:"small",color:t.contactObj.ADDRESSID?"#2271F5":"#323233",name:"ytcrm-bendi_local-pin"}})]},proxy:!0},{key:"title",fn:function(){return[a("span",{class:t.contactObj.ADDRESSID?"color-main-2":""},[t._v(t._s(t.contactObj.ADDRESSID?t.contactObj.ADDRESSID+"/"+t.contactObj.ADDRESS:"请选择运输地址"))])]},proxy:!0}])}),a("van-search",{attrs:{placeholder:"请输入搜索关键词"},on:{search:t.onRefresh,clear:t.onRefresh},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}}),a("div",{staticClass:"color-main-2 pa-2 van-popup-bg"},[t._v(t._s(t.chooseEntry.entryid)+"/"+t._s(t.chooseEntry.entryname))])],1),a("van-pull-refresh",{staticClass:"pb-100",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{staticClass:"px-2",attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e,n){return a("report-goods-List",{key:n,staticClass:"mb-2",attrs:{item:e},nativeOn:{click:function(a){return t.goodsClick(e)}}})})),1)],1),a("van-popup",{staticClass:"van-popup-bg",style:{height:"90%",width:"100%"},attrs:{round:"",position:"bottom",closeable:""},model:{value:t.customShow,callback:function(e){t.customShow=e},expression:"customShow"}},[a("div",{staticClass:"header font-16 py-4 fontWeight textAlignC"},[t._v("单位信息")]),a("app-custom",{ref:"appCustom",attrs:{params:{entryid:t.chooseEntry.entryid}},on:{chooseCustomClick:t.chooseCustomClick}})],1),a("van-action-sheet",{attrs:{"cancel-text":"取消","close-on-click-action":""},scopedSlots:t._u([{key:"default",fn:function(){return t._l(t.contactList,(function(e,n){return a("van-cell",{key:n,attrs:{"is-link":""},on:{click:function(a){return t.chooseClick(e)}}},[t._v(t._s(e.ADDRESSID)+"/ "+t._s(e.ADDRESS))])}))},proxy:!0}]),model:{value:t.contactShow,callback:function(e){t.contactShow=e},expression:"contactShow"}}),a("van-button",{directives:[{name:"show",rawName:"v-show",value:!t.cartShow,expression:"!cartShow"}],staticClass:"cartButton",attrs:{round:"",color:"#2271F5",type:"primary"},on:{click:function(e){return t.$router.push({name:"ReportShopCart"})}},scopedSlots:t._u([{key:"icon",fn:function(){return[a("van-icon",{attrs:{size:"20px",name:"cart-o",color:"#ffffff"}})]},proxy:!0}])})],1)},s=[],o=a("5530"),r=a("d4ec"),i=a("bee2"),c=a("262e"),u=a("2caf"),l=(a("99af"),a("b0c0"),a("9ab4")),f=a("1b40"),p=a("4bb5"),h=a("53ae"),m=a("025b"),d=a("a403"),g=a("ab70"),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"reportGoodsList d-flex align-center"},[a("van-image",{attrs:{width:"80",height:"80",src:t.item.smallimglink&&"http://pic.drugoogle.com/medicine/75x66/2010070114525558283.jpg"!=t.item.smallimglink?t.item.smallimglink:""}}),a("div",{staticClass:"pl-2"},[a("div",{staticClass:"tag"},[262==t.item.narcoticId?a("van-tag",{staticClass:"mr-1",attrs:{color:"rgb(213, 73, 65, 0.1)","text-color":"rgb(213, 73, 65)",size:"large"}},[t._v(" 麻醉药品 ")]):t._e(),263==t.item.narcoticId?a("van-tag",{staticClass:"mr-1",attrs:{color:"rgb(213, 73, 65, 0.1)","text-color":"rgb(213, 73, 65)",size:"large"}},[t._v(" 第一类精神药品 ")]):t._e(),t.item.hadsale?a("van-tag",{staticClass:"mr-1",attrs:{color:"rgb(0, 168, 112, 0.1)","text-color":"#00A870",size:"large"}},[t._v(" 卖过 ")]):t._e(),t.item.coldflag?a("van-tag",{staticClass:"mr-1",attrs:{color:"rgba(34, 113, 245, 0.1)","text-color":"#2271F5",size:"large"}},[t._v(" 冷链 ")]):t._e(),t.item.fsCollection.length>0?a("van-tag",{attrs:{color:"rgba(34, 113, 245, 0.1)","text-color":"#2271F5",size:"large"}},[t._v(" "+t._s(t.fsCollectionName(t.item.fsCollection))+" ")]):t._e()],1),a("div",{staticClass:"font-14 fontWeight"},[t._v(t._s(t.item.goodsId)+"/"+t._s(t.item.goodsName))]),a("div",{staticClass:"color-gray-7 pt-1"},[t._v(t._s(t.item.goodstype)+"/"+t._s(t.item.goodsunit))]),a("div",{staticClass:"color-gray-7 pt-1"},[t._v(t._s(t.item.factoryid)+"/"+t._s(t.item.factoryname))]),t.item.sausestatus&&(t.item.gspusestatus||0===t.item.gspusestatus)?a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[1!==t.item.sausestatus?a("p",[a("span",{staticClass:"color-gray-7"},[t._v("销售状态：")]),a("span",{class:1===t.item.sausestatus?"color-normal":"color-never fontWeight"},[t._v(t._s(1===t.item.sausestatus?"可销":"不可销"))])]):t._e(),1!==t.item.gspusestatus?a("p",[a("span",{staticClass:"color-gray-7"},[t._v("质量状态：")]),a("span",{class:1===t.item.gspusestatus?"color-normal":"color-never fontWeight"},[t._v(" "+t._s(1===t.item.gspusestatus?"质量可用":2===t.item.gspusestatus?"待首营":3===t.item.gspusestatus?"质量禁止":2===t.item.gspusestatus?"首营不通过":5===t.item.gspusestatus?"未首营":"")+" ")])]):t._e()]):t._e()])],1)},b=[],y=(a("d3b7"),function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(i["a"])(a,[{key:"fsCollectionName",get:function(){return function(t){if(t.every((function(t){return 0===t.controllevel})))return t[0].typename;for(var e=0;e<t.length;e++){var a=t[e];if(1===a.controllevel)return a.typename}}}}]),a}(f["d"]));Object(l["a"])([Object(f["c"])()],y.prototype,"item",void 0),y=Object(l["a"])([Object(f["a"])({})],y);var C=y,_=C,O=(a("e0ca"),a("2877")),k=Object(O["a"])(_,v,b,!1,null,"fa15ef98",null),w=k.exports,j=Object(p["a"])("twoPinDic"),S=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.contactList=[],t.contactObj={},t.customShow=!1,t.contactShow=!1,t.searchValue="",t}return Object(i["a"])(a,[{key:"chooseCustomClick",value:function(t){this.SET_CUSTOMPARAMS(t),this.customShow=!1,this.contactObj={},this._queryContact(),this.onRefresh()}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.dataList=[],this.refreshing=!1);var t={entryId:this.chooseEntry.entryid,customId:this.customParams.customid,contactId:this.customParams.contactid||"",goodsNameOrId:this.searchValue,pageNum:this.page,pageSize:10};this._getGoodsDoc(t)}},{key:"_getGoodsDoc",value:function(t){var e=this;1===this.page&&(this.dataList=[]),Object(g["d"])(t).then((function(t){e.dataList=e.dataList.concat(t.data.list),t.data.hasNextPage?(e.page++,e.finished=!1):e.finished=!0,e.loading=!1}))}},{key:"_queryContact",value:function(){var t=this,e={entryid:this.chooseEntry.entryid,customid:this.customParams.customid||"",contactid:this.customParams.CONTACTID||""};Object(d["s"])(e).then((function(e){t.contactList=e.data,1===t.contactList.length&&(t.contactObj=t.contactList[0])}))}},{key:"chooseClick",value:function(t){this.contactObj=t,this.contactShow=!1}},{key:"goodsClick",value:function(t){if(262!=t.narcoticId&&263!=t.narcoticId)if(this.contactObj.ADDRESSID)if(t.sausestatus&&1!==t.sausestatus){var e="当前货品状态不可销，不可加购";this.$toast.fail(e)}else if(!t.gspusestatus&&0!==t.gspusestatus||1===t.gspusestatus)this.SET_GOODSDETAIL(Object.assign(Object(o["a"])(Object(o["a"])({},this.customParams),this.contactObj),t)),this.$router.push({name:"ReportGoodsDetail"});else{var a="当前货品".concat(2===t.gspusestatus?"待首营":3===t.gspusestatus?"质量禁止":2===t.gspusestatus?"首营不通过":5===t.gspusestatus?"未首营":"","，不可加购");this.$toast.fail(a)}else this.$toast.fail("请先选择运输地址");else this.$toast.fail((262==t.narcoticId?"麻醉药品":"第一类精神药品")+"不允许下单")}},{key:"mounted",value:function(){this._queryContact()}}]),a}(Object(f["b"])(h["a"]));Object(l["a"])([j.Mutation],S.prototype,"SET_CUSTOMPARAMS",void 0),Object(l["a"])([j.Mutation],S.prototype,"SET_GOODSDETAIL",void 0),Object(l["a"])([j.Mutation],S.prototype,"SET_CARTSHOW",void 0),Object(l["a"])([j.Getter],S.prototype,"customParams",void 0),Object(l["a"])([j.Getter],S.prototype,"chooseEntry",void 0),Object(l["a"])([j.Getter],S.prototype,"cartShow",void 0),S=Object(l["a"])([Object(f["a"])({components:{AppCustom:m["a"],reportGoodsList:w},beforeRouteEnter:function(t,e,a){"Report"===e.name&&a((function(t){t.contactList=[],t.contactObj={},t.customShow=!1,t.contactShow=!1,t.searchValue="",t._queryContact(),t.onRefresh()})),a()}})],S);var D=S,x=D,L=Object(O["a"])(x,n,s,!1,null,"439df9b2",null);e["default"]=L.exports},fd43:function(t,e,a){}}]);