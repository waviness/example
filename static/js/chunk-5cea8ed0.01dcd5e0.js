(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cea8ed0"],{2008:function(e,t,a){},d9b1:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"background-color-white"},[a("van-sticky",[a("div",{staticClass:"header background-color-white pa-4 d-flex align-center"},[a("div",{staticClass:"flex-3 d-flex flex-column"},[a("span",{staticClass:"font-24 fontWeight color-black-1",staticStyle:{"font-family":"'HarmonyOS Sans SC Black'"}},[e._v("客户趋势")]),a("span",{staticClass:"font-12 color-gray-5"},[e._v(e._s(e.entryObj.name))])]),a("div",{staticClass:"flex-2 font-16 textAlignR",staticStyle:{"font-family":"'HarmonyOS Sans SC Bold'"},on:{click:e.calendarClick}},[a("span",{staticClass:"time color-gray-4 fontWeight"},[e._v(e._s(e.dateTime))]),a("van-icon",{staticClass:"pl-1",attrs:{size:"14px",name:"arrow-down"}})],1)])]),a("div",{staticClass:"px-2 pb-100"},[e.loading?a("div",{staticClass:"d-flex justify-center pa-8"},[a("van-loading",{attrs:{type:"spinner",color:"#3561F2"}})],1):e._e(),a("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},e._l(e.dataList,(function(t,s){return a("div",{key:s,staticClass:"card-2 px-2 mb-2",on:{click:function(a){return e.detailClick(t)}}},[a("div",{staticClass:"title d-flex justify-space-between"},[a("span",{staticClass:"font-18"},[e._v(e._s(t.customerOpClassName))]),a("div",{staticClass:"d-flex align-center"},[a("app-icon",{staticClass:"iconSvg",staticStyle:{width:"20px",height:"20px"},attrs:{name:t.periodComparePercent<0?"#ytcrm-rise-red":"#ytcrm-fall-green"}}),a("span",{staticClass:"pl-1 font-20",class:e.getColor(t.periodComparePercent)},[e._v(" "+e._s(Math.abs(t.periodComparePercent))+"%")]),a("van-icon",{staticClass:"ml-4",attrs:{size:"18px",name:"arrow",color:"#dcdcdc"}})],1)]),a("div",{staticClass:"d-flex px-2"},[a("div",{staticClass:"flex-2 d-flex py-2 flex-column justify-space-around"},[a("div",{staticClass:"progressWarp positionR mb-1"},[a("div",{staticClass:"text font-12 py-1"},[e._v("销售实绩："+e._s(t.salesAmount)+"万元")]),a("div",{staticClass:"progress background-color-main",style:"width:"+t.progress+"%;"})]),a("div",{staticClass:"progressWarp positionR"},[a("div",{staticClass:"text font-12 py-1"},[e._v("去年同期销售实绩："+e._s(t.lastSalesAmount)+"万元")]),a("div",{staticClass:"progress background-color-main-4",style:"width:"+t.lastProgress+"%;"})])])])])})),0)],1),a("van-calendar",{attrs:{"default-date":e.csjNowTime,"min-date":new Date(2021,0,1),"max-date":new Date((new Date).getTime()-864e5),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{select:e.calendarConfirm},model:{value:e.calendarShow,callback:function(t){e.calendarShow=t},expression:"calendarShow"}})],1)},n=[],r=a("5530"),i=a("1da1"),o=a("d4ec"),l=a("bee2"),c=a("262e"),d=a("2caf"),u=(a("96cf"),a("ac1f"),a("5319"),a("d81d"),a("b680"),a("a9e3"),a("d3b7"),a("4de4"),a("b0c0"),a("9ab4")),m=a("1b40"),p=a("2279"),f=a("5b92"),h=a("7909"),C=a("4bb5"),b=Object(C["a"])("app"),g=function(e){Object(c["a"])(a,e);var t=Object(d["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.entryObj={},e.calendarShow=!1,e.refreshing=!1,e.loading=!1,e.dateTime="",e.dataList=[],e}return Object(l["a"])(a,[{key:"getColor",get:function(){return function(e){if(e){var t=String(e).replace(",","");return+t>0?"color-normal":"color-never"}}}},{key:"getFH",get:function(){return function(e){if(e){var t=String(e).replace(",","");return+t>0?"+":""}}}},{key:"onRefresh",value:function(){this._getCustomerCategorySales(),this.refreshing=!1}},{key:"calendarClick",value:function(){this.calendarShow=!0}},{key:"calendarConfirm",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.calendarShow=!1,this.SET_CSJNOWTIME(t),this.SET_CSJCHANGETIME(!0),this.dateTime=this.$dayjs(t).format("YYYY-MM-DD"),this._getCustomerCategorySales();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_getCustomerCategorySales",value:function(){var e=this;this.loading=!0,this.dataList=[];var t={deptId:this.entryObj.id,orderColumn:"salesAmount",orderType:"0",selectDate:this.dateTime,deptSalesFlag:1,timeDimFlag:1};Object(p["g"])(t).then((function(t){e.loading=!1;var a=t.data.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{lastSalesAmount:Number(h["f"](e.salesAmount,e.periodCompareNetIncrease)).toFixed(2)})})),s=a.reduce((function(e,t){var a=t.salesAmount,s=t.lastSalesAmount;return{maxSalesAmount:Math.max(+e.maxSalesAmount,a),maxLastSalesAmount:Math.max(+e.maxLastSalesAmount,s)}}),{maxSalesAmount:-1/0,maxLastSalesAmount:-1/0}),n=Math.max(s.maxLastSalesAmount,s.maxSalesAmount);e.dataList=a.map((function(e,t){return e.totalValueArr=[],e.cstmCtgryDeptSalesResList.filter((function(t){e.totalValueArr.push(Number(t.salesAmount))})),e.totalValue=h["g"](e.totalValueArr),{salesAmount:Object(f["d"])(e.salesAmount,1),lastSalesAmount:Object(f["d"])(e.lastSalesAmount,1),lastProgress:e.lastSalesAmount<0?0:Number(h["d"](h["c"](e.lastSalesAmount,n),100)).toFixed(1),progress:Number(h["d"](h["c"](e.salesAmount,n),100)).toFixed(1),periodComparePercent:Object(f["d"])(e.periodComparePercent,2),periodCompareNetIncrease:Object(f["d"])(e.periodCompareNetIncrease,1),customerOpClassName:e.customerOpClassName,customerOpClassId:e.customerOpClassId,isExp:0===t,cstmCtgryDeptSalesResList:e.cstmCtgryDeptSalesResList.map((function(t){return{salesAmount:Object(f["d"])(t.salesAmount,1),periodComparePercent:Object(f["d"])(t.periodComparePercent,2),periodCompareNetIncrease:Object(f["d"])(t.periodCompareNetIncrease,1),deptName:t.deptName,deptId:t.deptId,progress:Number(h["d"](h["c"](Number(t.salesAmount),e.totalValue),100)).toFixed(1)}}))}}))}))}},{key:"detailClick",value:function(e){this.SET_DETAILINFOR(e),this.$router.push({name:"customerTrendPageDetail",query:Object(r["a"])({},this.entryObj)})}},{key:"activated",value:function(){this.dateTime&&this.dateTime!==this.$dayjs(this.csjNowTime).format("YYYY-MM-DD")&&(this.dateTime=this.$dayjs(this.csjNowTime).format("YYYY-MM-DD"),this.onRefresh())}},{key:"created",value:function(){this.entryObj=this.$route.query,this.dateTime=this.$dayjs(this.csjNowTime).format("YYYY-MM-DD")}},{key:"mounted",value:function(){this._getCustomerCategorySales()}}]),a}(m["d"]);Object(u["a"])([b.Getter],g.prototype,"csjNowTime",void 0),Object(u["a"])([b.Getter],g.prototype,"csjChangeTime",void 0),Object(u["a"])([b.Mutation],g.prototype,"SET_CSJNOWTIME",void 0),Object(u["a"])([b.Mutation],g.prototype,"SET_CSJCHANGETIME",void 0),Object(u["a"])([b.Mutation],g.prototype,"SET_DETAILINFOR",void 0),g=Object(u["a"])([Object(m["a"])({beforeRouteEnter:function(e,t,a){a((function(e){"salesLineHighRise0"!==t.name&&"salesLineHighRise1"!==t.name&&"salesLineHighRise1Inner"!==t.name&&"salesLineMiddleRise2"!==t.name&&"salesLineMiddleRise2Inner"!==t.name&&"salesLineMiddleRise3"!==t.name&&"salesLineMiddleRise3Inner"!==t.name||(e.dataList=[],e.entryObj=Object(r["a"])({},e.$route.query),e.onRefresh())}))}})],g);var v=g,y=v,S=(a("dcfb"),a("2877")),j=Object(S["a"])(y,s,n,!1,null,"5e44e60c",null);t["default"]=j.exports},dcfb:function(e,t,a){"use strict";a("2008")}}]);