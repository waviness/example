(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c782e81"],{"025b":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"warp"},[n("van-search",{attrs:{placeholder:"搜索","input-align":"center"},on:{input:e.onRefresh,clear:e.onRefresh},model:{value:e.searchValueCustom,callback:function(t){e.searchValueCustom=t},expression:"searchValueCustom"}}),n("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[n("van-list",{attrs:{offset:20,finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.customList,(function(t,a){return n("div",{key:t.customid+a,staticClass:"warp"},[t.contactList&&0!==t.contactList.length?n("van-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[n("van-collapse-item",{attrs:{name:t.customid},scopedSlots:e._u([{key:"title",fn:function(){return[n("ul",[n("li",{staticClass:"customerValue"},[e._v(e._s(t.customid)+"/"+e._s(t.customname))]),n("li",{directives:[{name:"show",rawName:"v-show",value:t.entryid,expression:"item.entryid"}],staticClass:"color-gray-4 font-12"},[e._v(e._s(t.entryid)+"/"+e._s(t.entryname))])])]},proxy:!0}],null,!0)},e._l(t.contactList,(function(a,i){return n("van-cell",{key:a.CONTACTID+i,attrs:{"is-link":""},on:{click:function(n){return e.chooseCustomClick(t,a)}},scopedSlots:e._u([{key:"title",fn:function(){return[n("span",{style:a.dialyPass?"color: #AAA":""},[e._v(" "+e._s(a.CONTACTID+a.CONTACTMAN)+" "),n("br"),a.dialyPass&&!e.requestChange?n("i",{staticClass:"fontSize-12 text-orange"},[e._v("最小效期为:"+e._s(new Date(a.miniTime).toLocaleDateString()))]):e._e()])]},proxy:!0}],null,!0)})})),1)],1):n("van-cell",{attrs:{"is-link":!t.contactFlag},on:{click:function(n){return e.chooseCustomClick(t)}},scopedSlots:e._u([{key:"title",fn:function(){return[n("ul",[n("li",{staticClass:"customerValue"},[e._v(" "+e._s(t.customid)+"/"+e._s(t.customname)+" "),e._t("default")],2),n("li",{directives:[{name:"show",rawName:"v-show",value:t.entryid,expression:"item.entryid"}],staticClass:"color-gray-4 font-12"},[e._v(e._s(t.entryid)+"/"+e._s(t.entryname))]),t.contactFlag?n("li",{staticClass:"color-never font-12"},[e._v("无可下单分支机构（不在效期），不可下单")]):e._e()])]},proxy:!0}],null,!0)})],1)})),0)],1)],1)},i=[],r=n("5530"),s=n("d4ec"),c=n("bee2"),o=n("262e"),u=n("2caf"),l=(n("99af"),n("d3b7"),n("159b"),n("9ab4")),f=n("1b40"),d=n("53ae"),h=n("f727"),p=function(e){Object(o["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(s["a"])(this,n),e=t.apply(this,arguments),e.customList=[],e.searchValueCustom="",e.activeNames=[],e}return Object(c["a"])(n,[{key:"chooseCustomClick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e.contactFlag)this.$toast.fail("无可下单分支机构（不在效期），不可下单");else{var n=Object.assign({customid:e.customid,customname:e.customname},t);t&&t.dialyPass?this.$dialog.alert({confirmButtonColor:"rgb(34, 113, 245)",message:"".concat(t.CONTACTMAN,"有多个不同的有效期且已过期，不允许选择，最小效期为:").concat(new Date(t.miniTime).toLocaleDateString())}).then((function(){})):this.$emit("chooseCustomClick",n)}}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!1,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.customList=[],this.refreshing=!1),this.loading=!0,this.requestChange?this.$emit("getList",{condition:this.searchValueCustom,pageNum:this.page,pageSize:10}):this._getCustom()}},{key:"_getCustom",value:function(){var e=this;1===this.page&&(this.customList=[]);var t=Object(r["a"])(Object(r["a"])({condition:this.searchValueCustom},this.params),{},{pageNum:this.page,pageSize:10});Object(h["f"])(t).then((function(t){e.customList=e.customList.concat(t.data.list);for(var n=0;n<e.customList.length;n++){var a=e.customList[n];a.contactList&&a.contactList.length>0&&e.needDialyPass&&a.contactList.forEach((function(e){var t=0;e.dates&&e.dates.length>0&&(e.dates.forEach((function(e){t?t>new Date(new Date(e.ENDDATE).toLocaleDateString()).getTime()&&(t=new Date(new Date(e.ENDDATE).toLocaleDateString()).getTime()):t=new Date(new Date(e.ENDDATE).toLocaleDateString()).getTime()})),t<new Date((new Date).toLocaleDateString()).getTime()&&(e.dialyPass=!0,e.miniTime=t))}))}t.data.hasNextPage?e.page++:e.finished=!0,e.loading=!1}))}}]),n}(Object(f["b"])(d["a"]));Object(l["a"])([Object(f["c"])({default:!1})],p.prototype,"requestChange",void 0),Object(l["a"])([Object(f["c"])({default:!1})],p.prototype,"needDialyPass",void 0),Object(l["a"])([Object(f["c"])()],p.prototype,"params",void 0),p=Object(l["a"])([Object(f["a"])({})],p);var m=p,b=m,v=(n("27ba"),n("2877")),g=Object(v["a"])(b,a,i,!1,null,"12f3a2f4",null);t["a"]=g.exports},"268a":function(e,t,n){},"27ba":function(e,t,n){"use strict";n("6b64")},"3f32":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"add"},[n("div",{staticClass:"header pt-10 pb-4 font-14 px-10"},[e._v("新增客户信息")]),n("van-form",[n("van-field",{staticClass:"mb-2",attrs:{readonly:"",clickable:"",label:"核算单元","input-align":"right",placeholder:"点击选择核算单元"},on:{click:function(t){e.entryShow=!0}},model:{value:e.filterObj.entryname,callback:function(t){e.$set(e.filterObj,"entryname",t)},expression:"filterObj.entryname"}}),n("van-field",{staticClass:"mb-2",attrs:{readonly:"",clickable:"",value:e.filterObj.CONTACTMAN||e.filterObj.customname,label:"客户信息","input-align":"right",placeholder:"点击选择客户信息"},on:{click:e.customClick}}),n("van-field",{staticClass:"flex-column",attrs:{type:"textarea",label:"询证函备注","input-align":"left",placeholder:"请输入询证函备注"},model:{value:e.filterObj.inquiryMessage,callback:function(t){e.$set(e.filterObj,"inquiryMessage",t)},expression:"filterObj.inquiryMessage"}}),n("van-notice-bar",{staticClass:"mt-2",attrs:{scrollable:!1,"left-icon":"volume-o",color:"#ED6A0C",text:"请选择对应的财务人员"}}),n("van-field",{staticClass:"mb-2",attrs:{readonly:"",clickable:"",value:e.checkedUsers.length?"已选"+e.checkedUsers.length+"人":"",label:"提醒谁看","input-align":"right",placeholder:"点击选择对应的财务人员"},on:{click:e.getUsersClick}}),n("van-field",{staticClass:"flex-column",attrs:{label:"附件上传"},scopedSlots:e._u([{key:"input",fn:function(){return[n("van-uploader",{staticClass:"mt-3",attrs:{"after-read":e.afterRead,multiple:""},model:{value:e.addfileList,callback:function(t){e.addfileList=t},expression:"addfileList"}})]},proxy:!0}])})],1),n("div",{staticClass:"commonButton-footer d-flex justify-center"},[n("van-button",{attrs:{size:"small",round:"",plain:""},on:{click:e.cancelClick}},[e._v("取消")]),n("van-button",{attrs:{size:"small",color:"#2271F5",type:"info","native-type":"submit",round:""},on:{click:e.afterReadSure}},[e._v("确定")])],1),n("van-action-sheet",{attrs:{"cancel-text":"取消",description:"核算单元选择","close-on-click-action":""},model:{value:e.entryShow,callback:function(t){e.entryShow=t},expression:"entryShow"}},[0===e.entryList.length?n("app-empty",{attrs:{description:"'暂无核算单元信息'"}}):e._e(),e._l(e.entryList,(function(t,a){return n("van-cell",{key:a,attrs:{value:t.entryid+"/"+t.entryname},on:{click:function(n){return n.stopPropagation(),e.entryChangeClick(t)}}})}))],2),n("van-popup",{staticClass:"van-popup-bg",style:{height:"90%",width:"100%"},attrs:{round:"",position:"bottom",closeable:""},model:{value:e.customShow,callback:function(t){e.customShow=t},expression:"customShow"}},[n("div",{staticClass:"header font-16 py-4 fontWeight textAlignC"},[e._v("单位信息")]),e.customShow?n("app-custom",{attrs:{params:{entryid:e.filterObj.entryid}},on:{chooseCustomClick:e.chooseCustomClick}}):e._e()],1),e.hasDept?n("dept-user",{ref:"deptUer",attrs:{show:e.changeTypeShow,loading:e.getUserListLoading,depTreeList:e.depTreeList,deptUserData:e.deptUserData,searchList:e.userDataList},on:{search:e.refreshUserByKeywords,refresh:e.refreshUserByDepts,confirm:e.onTreeConfirm,cancel:e.cancelUserByDepts}}):e._e()],1)},i=[],r=n("1da1"),s=n("d4ec"),c=n("bee2"),o=n("262e"),u=n("2caf"),l=(n("96cf"),n("4de4"),n("d3b7"),n("caad"),n("2532"),n("99af"),n("ac1f"),n("1276"),n("b0c0"),n("a15b"),n("a434"),n("9ab4")),f=n("1b40"),d=n("f727"),h=n("c68a"),p=n("025b"),m=n("8393"),b=function(e){Object(o["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(s["a"])(this,n),e=t.apply(this,arguments),e.entryShow=!1,e.customShow=!1,e.filterObj={entryname:"",entryid:"",customname:"",customid:"",CONTACTID:"",CONTACTMAN:"",inquiryMessage:"",userIdList:"",userIdDetailList:[]},e.addfileList=[],e.entryList=[],e.authorizedFlag=!1,e}return Object(c["a"])(n,[{key:"cancelClick",value:function(){this.$router.go(-1)}},{key:"_queryEntryid",value:function(){var e=this;Object(d["k"])().then((function(t){e.entryList=t.data,1===t.data.length&&e.entryChangeClick(t[0])}))}},{key:"entryChangeClick",value:function(e){var t=e.entryid,n=e.entryname;this.filterObj.entryid=t,this.filterObj.entryname=n,this.entryShow=!1}},{key:"customClick",value:function(){this.filterObj.entryid?this.customShow=!0:this.$toast.fail("请先选择核算单元")}},{key:"chooseCustomClick",value:function(e){var t=e.CONTACTID,n=e.CONTACTMAN,a=e.customid,i=e.customname;this.filterObj.CONTACTID=t,this.filterObj.CONTACTMAN=n,this.filterObj.customid=a,this.filterObj.customname=i,this.customShow=!1}},{key:"onTreeConfirm",value:function(e){var t=this;this.checkedUsers=e;var n=this.userDataList.filter((function(t){return e.includes(t.userId)}));this.checkDetailList=this.checkDetailList.concat(n);for(var a=[],i=function(n){var i=t.checkDetailList[n];-1===e.indexOf(i.userId)||a.some((function(e){return i.userId===e.userId}))||a.push(i)},r=0;r<this.checkDetailList.length;r++)i(r);this.checkDetailList=a,this.changeTypeShow=!1}},{key:"afterReadSure",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a,i,r,s,c,o,u=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.checkDetailList.length){e.next=3;break}return this.$toast.fail("请选择要提示的财务人员信息"),e.abrupt("return");case 3:t=new FormData,n=[],a=0;case 6:if(!(a<this.addfileList.length)){e.next=19;break}return i=this.addfileList[a],i.status="uploading",i.message="上传中...",r=i.file.name.split("."),e.next=13,this.$heic2anyFun(i.file,r);case 13:s=e.sent,n.push(s),t.append("imageList",s);case 16:a++,e.next=6;break;case 19:for(t.append("customerId",this.filterObj.customid),t.append("customerName",this.filterObj.customname),t.append("entryId",this.filterObj.entryid),t.append("entryName",this.filterObj.entryname),t.append("contactId",this.filterObj.CONTACTID||""),t.append("contactName",this.filterObj.CONTACTMAN||""),t.append("confirmationRequestContent",this.filterObj.inquiryMessage),c=0;c<this.checkDetailList.length;c++)o=this.checkDetailList[c],t.append("userPhoneNumberList",o.phoneNum);Object(h["a"])(t).then((function(e){if("200"===e.code){for(var t=0;t<u.addfileList.length;t++){var n=u.addfileList[t];n.status="success",n.message="上传成功"}u.$toast.success("上传成功"),u.$router.go(-1)}else for(var a=0;a<u.addfileList.length;a++){var i=u.addfileList[a];i.status="failed",i.message="上传失败"}}));case 28:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"afterRead",value:function(e){for(var t=["jpg","jpeg","png","heic","pdf"],n=0;n<e.length;n++){var a=e[n].file,i=a.name.split("."),r=i[i.length-1].toLowerCase();-1===t.indexOf(r)&&(this.$toast.fail("上传的图片格式不对, 仅支持".concat(t.join(","),"格式")),this.addfileList.splice(n,1))}}},{key:"mounted",value:function(){this._queryEntryid()}}]),n}(Object(f["b"])(m["a"]));b=Object(l["a"])([Object(f["a"])({components:{AppCustom:p["a"]}})],b);var v=b,g=v,y=(n("8f46"),n("2877")),k=Object(y["a"])(g,a,i,!1,null,"1605cf5c",null);t["default"]=k.exports},"53ae":function(e,t,n){"use strict";var a=n("d4ec"),i=n("bee2"),r=n("262e"),s=n("2caf"),c=(n("b0c0"),n("9ab4")),o=n("1b40");o["a"].registerHooks(["beforeRouteEnter"]);var u=function(e){Object(r["a"])(n,e);var t=Object(s["a"])(n);function n(){var e;return Object(a["a"])(this,n),e=t.apply(this,arguments),e.page=1,e.total=0,e.dataList=[],e.loading=!1,e.finished=!1,e.refreshing=!1,e.finishText="",e.userIdList=[],e.error=!1,e}return Object(i["a"])(n,[{key:"beforeRouteEnter",value:function(e,t,n){n((function(e){"Home"!==t.name&&"TaskIndex"!==t.name||(e.dataList=[],e.page=1,e.loading=!1,e.finished=!0,e.refreshing=!1,e.$nextTick((function(){e.finished=!1})))}))}}]),n}(o["d"]);u=Object(c["a"])([Object(o["a"])({})],u),t["a"]=u},"6b64":function(e,t,n){},"8f46":function(e,t,n){"use strict";n("268a")},c68a:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return h}));var a=n("1da1"),i=(n("96cf"),n("b32d")),r=n("90ae"),s=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(r["d"],"/api/task/getConfirmationRequestList",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].get(r["d"],"/api/task/updateConfirmationRequestStatue",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(r["d"],"/api/task/uploadConfirmationRequestPictures",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(r["d"],"/api/task/downloadConfirmationRequestPictures",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].get(r["d"],"/api/task/exceedTimeLimitTask",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].post(r["d"],"/api/task/activeInitiateConfirmationRequest",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].get(r["d"],"/api/task/initiatedConfirmationRequest",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].putGet(r["d"],"/api/task/handleConfirmationRequest/".concat(t),n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}}]);