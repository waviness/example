(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-677598b6"],{"0026":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"full-HW order-manage-list"},[i("div",{staticClass:"white-bg filter-div",class:e.getOtherClass},[i("div",{staticClass:"d-flex align-center justify-space-between common-filter full-height px-3 font-14 filter-button",on:{click:e.showPopup}},[i("span",[e._v("条件筛选")]),i("van-icon",{attrs:{name:"arrow-down"}})],1)]),i("div",{staticClass:"block-div"}),i("card-detail",{attrs:{info:e.customer,cardType:1,fatherType:parseInt(e.cardType),isAll:1==e.tabActiveIndex}}),i("van-tabs",{directives:[{name:"show",rawName:"v-show",value:2!=e.cardType,expression:"cardType != 2"}],on:{change:e.onRefresh},model:{value:e.tabActiveIndex,callback:function(t){e.tabActiveIndex=t},expression:"tabActiveIndex"}},[i("van-tab",{attrs:{title:"未完成订单",name:0}}),i("van-tab",{attrs:{title:"正常订单",name:1}})],1),i("div",{staticClass:"overflow-x-hidden card-list pt-2",class:2!=e.cardType?"active":""},[i("van-pull-refresh",{staticStyle:{"min-height":"100%"},on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[i("van-list",{directives:[{name:"show",rawName:"v-show",value:!e.finished||e.dataList.length>0,expression:"!finished || dataList.length > 0"}],attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.dataList,(function(t,s){return i("card-detail",{key:s,attrs:{info:t,cardType:parseInt(e.cardType)+2,isAll:1==e.tabActiveIndex,managementOpflagForSaler:e.managementOpflagForSaler,managementOpflagForPurchaser:e.managementOpflagForPurchaser,querySelfFlag:e.needQueryAll||e.needQueryAllEntrys||e.needQueryAllDept?e.isJustSelf?1:2:1}})})),1),e.loading||e.dataList.length?e._e():i("app-empty",{staticClass:"mt-6 white-bg",attrs:{description:"暂无数据"}})],1)],1),i("van-popup",{attrs:{round:"",position:"top"},on:{"click-overlay":e.closePupup},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("div",{staticClass:"white-bg filter-div show-div"},[i("div",{staticClass:"d-flex align-center justify-space-between common-filter full-height px-3 font-14 filter-button"},[i("span",[e._v("条件筛选")]),i("van-icon",{attrs:{name:"arrow-down"}})],1)]),i("div",{staticClass:"popup-line"}),i("van-field",{attrs:{label:"货品ID",placeholder:"请输入货品ID","input-align":"right",clearable:""},model:{value:e.filterObj.goodsId,callback:function(t){e.$set(e.filterObj,"goodsId",t)},expression:"filterObj.goodsId"}}),i("van-field",{attrs:{label:"货品名称",placeholder:"请输入货品名称","input-align":"right",clearable:""},model:{value:e.filterObj.goodsName,callback:function(t){e.$set(e.filterObj,"goodsName",t)},expression:"filterObj.goodsName"}}),i("van-field",{attrs:{label:"锁控类型",placeholder:"请选择锁控类型","input-align":"right"},on:{click:function(t){e.showCont=!0}},model:{value:e.filterObj.conType,callback:function(t){e.$set(e.filterObj,"conType",t)},expression:"filterObj.conType"}}),i("van-field",{attrs:{label:"人员选择",placeholder:"请选择人员","input-align":"right"},on:{click:e.getUsersClick},model:{value:e.filterObj.userNames,callback:function(t){e.$set(e.filterObj,"userNames",t)},expression:"filterObj.userNames"}}),i("van-field",{attrs:{label:"核算单元",placeholder:"请选择核算单元","input-align":"right"},on:{click:function(t){e.entryShow=!0}},model:{value:e.filterObj.entryName,callback:function(t){e.$set(e.filterObj,"entryName",t)},expression:"filterObj.entryName"}}),i("van-field",{attrs:{label:"订阅状态",placeholder:"请选择订阅状态","input-align":"right"},on:{click:function(t){e.statusShow=!0}},model:{value:e.filterObj.subArriveName,callback:function(t){e.$set(e.filterObj,"subArriveName",t)},expression:"filterObj.subArriveName"}}),i("div",{staticClass:"d-flex justify-center mt-4 mb-5"},[i("van-button",{staticClass:"popup-button mr-3",attrs:{round:""},on:{click:e.refreshFilter}},[e._v("重置")]),i("van-button",{staticClass:"popup-button",attrs:{round:"",type:"info"},on:{click:e.handleFilter}},[e._v("确认")])],1)],1),e.needQueryAll||e.needQueryAllEntrys||e.needQueryAllDept?i("div",{staticClass:"commonOpButton-footer commonOpButton-footer-1"},[i("van-button",{attrs:{round:"",plain:"",color:"#2271F5",type:"primary"},on:{click:e.justSelfClick}},[e._v(" "+e._s(e.isJustSelf?"显示全部":"显示与我相关")+" ")])],1):e._e(),i("van-calendar",{attrs:{"min-date":new Date(2020,0,1),type:"range"},on:{confirm:e.onConfirm},model:{value:e.showTime,callback:function(t){e.showTime=t},expression:"showTime"}}),i("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.showCont,callback:function(t){e.showCont=t},expression:"showCont"}},[i("van-picker",{attrs:{"show-toolbar":"",columns:e.conList},on:{confirm:e.onPickConfirm,cancel:function(t){e.showCont=!1}}})],1),e.hasDept?i("dept-user",{ref:"deptUer",attrs:{show:e.changeTypeShow,loading:e.getUserListLoading,depTreeList:e.depTreeList,deptUserData:e.deptUserData,searchList:e.userDataList,isSelect:!0,needName:!0},on:{search:e.refreshUserByKeywords,refresh:e.refreshUserByDepts,confirm:e.onTreeConfirm,cancel:e.handleCancel}}):e._e(),i("van-action-sheet",{attrs:{"cancel-text":"取消",description:"核算单元选择","close-on-click-action":""},on:{cancel:e.onCancelEntry},model:{value:e.entryShow,callback:function(t){e.entryShow=t},expression:"entryShow"}},[0===e.entryList.length?i("app-empty",{attrs:{description:"'暂无核算单元信息'"}}):e._e(),e._l(e.entryList,(function(t,s){return i("van-cell",{key:s,attrs:{value:t.entryid+"/"+t.entryname},on:{click:function(i){return i.stopPropagation(),e.entryChangeClick(t)}}})}))],2),i("van-action-sheet",{attrs:{"cancel-text":"取消",description:"订阅状态选择","close-on-click-action":""},on:{cancel:e.onCancelStatus},model:{value:e.statusShow,callback:function(t){e.statusShow=t},expression:"statusShow"}},e._l(e.statusList,(function(t,s){return i("van-cell",{key:s,attrs:{value:t.label},on:{click:function(i){return i.stopPropagation(),e.statusChangeClick(t)}}})})),1)],1)},r=[],n=i("d4ec"),a=i("bee2"),o=i("262e"),l=i("2caf"),c=(i("e9c4"),i("99af"),i("b0c0"),i("d3b7"),i("25f0"),i("9ab4")),u=i("1b40"),h=i("53ae"),d=i("bdee"),f=i("8393"),m=i("27f3"),b=i("211c"),y=i("f727"),p=i("d926"),g=function(e){Object(o["a"])(i,e);var t=Object(l["a"])(i);function i(){var e;return Object(n["a"])(this,i),e=t.apply(this,arguments),e.show=!1,e.filterObj={goodsId:"",goodsName:"",time:"",conType:null,userNames:"",entryId:"",entryName:"",subArriveType:"",subArriveName:""},e.originFilter={goodsId:"",goodsName:"",time:"",conType:null,userNames:"",entryId:"",entryName:"",subArriveType:"",subArriveName:""},e.conList=["缺货","区域限销","价格限销","下限锁","两票制提醒","紧俏药品","禁限销","库存状态","近效期"],e.timeList=[],e.userIdLists=[],e.showTime=!1,e.showCont=!1,e.isJustSelf=!1,e.cardType=0,e.customer={},e.entryList=[],e.entryShow=!1,e.statusList=[{label:"未订阅到货品种",value:"0"},{label:"未订阅到票品种",value:"1"},{label:"已订阅到货品种",value:"2"},{label:"已订阅到票品种",value:"3"}],e.statusShow=!1,e.needQueryAll=!1,e.needQueryAllEntrys=!1,e.needQueryAllDept=!1,e.tabActiveIndex=0,e.managementOpflagForSaler=!1,e.managementOpflagForPurchaser=!1,e}return Object(a["a"])(i,[{key:"getOtherClass",get:function(){var e="";return(this.filterObj.goodsId||this.filterObj.goodsName||this.filterObj.time||this.filterObj.conType||this.filterObj.userNames||this.filterObj.entryId||this.filterObj.subArriveType)&&(e="have-filter"),e}},{key:"showPopup",value:function(){this.originFilter=JSON.parse(JSON.stringify(this.filterObj)),this.show=!0}},{key:"onRefresh",value:function(){this.page=1,this.finished=!1,this.refreshing=!1,this._getCstmOrderList()}},{key:"onLoad",value:function(){var e=this;this.$nextTick((function(){e._getCstmOrderList()}))}},{key:"refreshFilter",value:function(){this.filterObj.time="",this.filterObj.conType=null,this.filterObj.userNames="",this.filterObj.entryId="",this.filterObj.entryName="",this.filterObj.subArriveType="",this.filterObj.subArriveName=""}},{key:"handleFilter",value:function(){this.show=!1,this.filterObj.goodsId===this.originFilter.goodsId&&this.filterObj.goodsName===this.originFilter.goodsName&&this.filterObj.time===this.originFilter.time&&this.filterObj.conType===this.originFilter.conType&&this.filterObj.userNames===this.originFilter.userNames&&this.filterObj.entryId===this.originFilter.entryId&&this.filterObj.subArriveType===this.originFilter.subArriveType||(this.page=1,this.finished=!1,this._getCstmOrderList())}},{key:"onConfirm",value:function(e){this.filterObj.time=Object(p["c"])(e[0])+" ~ "+Object(p["c"])(e[1]),this.timeList=[Object(p["c"])(e[0]),Object(p["c"])(e[1])],this.showTime=!1}},{key:"onPickConfirm",value:function(e){this.filterObj.conType=e,this.showCont=!1}},{key:"closePupup",value:function(){this.filterObj.goodsId=this.originFilter.goodsId,this.filterObj.goodsName=this.originFilter.goodsName,this.filterObj.entryKeyword=this.originFilter.entryKeyword,this.filterObj.time=this.originFilter.time,this.filterObj.conType=this.originFilter.conType,this.filterObj.userNames=this.originFilter.userNames,this.filterObj.entryId=this.originFilter.entryId,this.filterObj.entryName=this.originFilter.entryName,this.filterObj.subArriveType=this.originFilter.subArriveType,this.filterObj.subArriveName=this.originFilter.subArriveName}},{key:"_getCstmOrderList",value:function(){var e=this;this.customer?(this.loading=!0,1===this.page&&(this.dataList=[]),Object(b["c"])({dtlUsestatus:this.tabActiveIndex,customerId:this.customer.customerId,goodsName:this.filterObj.goodsName,entryKeyword:this.filterObj.entryKeyword,goodsId:this.filterObj.goodsId,conType:this.filterObj.conType?this.conList.indexOf(this.filterObj.conType):null,userIdList:this.filterObj.userNames?this.userIdLists:[],subArriveType:this.filterObj.subArriveType,entryId:this.filterObj.entryId,orderType:this.cardType,selectType:this.isJustSelf?0:3,startTime:2==this.timeList.length?this.timeList[0]+" 00:00:00":null,endTime:2==this.timeList.length?this.timeList[1]+" 23:59:59":null,pageNum:this.page,pageSize:10}).then((function(t){"200"==t.code&&t.data&&t.data.list||(e.finished=!0,e.loading=!1,e.$toast.fail(t.msg)),e.dataList=e.dataList.concat(t.data.list),e.loading=!1,t.data.hasNextPage?e.page++:e.finished=!0}))):this.finished=!0}},{key:"justSelfClick",value:function(){this.isJustSelf=!this.isJustSelf,this.onRefresh()}},{key:"onTreeConfirm",value:function(e){this.userIdLists=e.list,this.filterObj.userNames=e.name,this.changeTypeShow=!1}},{key:"handleCancel",value:function(){this.userIdLists=[],this.filterObj.userNames="",this.changeTypeShow=!1}},{key:"_queryEntryid",value:function(){var e=this;Object(y["k"])().then((function(t){e.entryList=t.data}))}},{key:"entryChangeClick",value:function(e){var t=e.entryid,i=e.entryname;this.filterObj.entryId=t,this.filterObj.entryName=i,this.entryShow=!1}},{key:"onCancelEntry",value:function(){this.filterObj.entryId="",this.filterObj.entryName="",this.entryShow=!1}},{key:"statusChangeClick",value:function(e){var t=e.label,i=e.value;this.filterObj.subArriveName=t,this.filterObj.subArriveType=i,this.statusShow=!1}},{key:"onCancelStatus",value:function(){this.filterObj.subArriveName="",this.filterObj.subArriveType="",this.statusShow=!1}},{key:"mounted",value:function(){this._queryEntryid()}},{key:"activated",value:function(){if(this.show=!1,this.$route.query){var e=this.$route.query.customer?JSON.parse(this.$route.query.customer.toString()):{};(this.customer.customerId!=e.customerId||this.cardType!=this.$route.query.type||this.filterObj.goodsId!=this.$route.query.goodsId||this.filterObj.goodsName!=this.$route.query.goodsName||this.timeList.length>0&&this.$route.query.startTime&&(this.timeList[0]!=this.$route.query.startTime||this.timeList[1]!=this.$route.query.endTime)||0==this.timeList.length&&this.$route.query.startTime||this.timeList.length>0&&!this.$route.query.startTime)&&(this.cardType=this.$route.query.type,2==this.cardType&&(this.tabActiveIndex=0),this.customer=e,this.$route.query.startTime?this.timeList=[this.$route.query.startTime,this.$route.query.endTime]:this.timeList=[],this.filterObj.goodsId=this.$route.query.goodsId,this.filterObj.goodsName=this.$route.query.goodsName,this.onRefresh())}var t=JSON.parse(localStorage.getItem("permissions")||"");this.needQueryAll=t.some((function(e){return"orderintegrateWx-query-all"===e})),this.needQueryAllEntrys=t.some((function(e){return"orderintegrateWx-query-entry"===e})),this.needQueryAllDept=t.some((function(e){return"orderintegrateWx-query-dept"===e})),this.managementOpflagForSaler=t.some((function(e){return"ManagementPermissionsAllowOperationsForSaler"===e})),this.managementOpflagForPurchaser=t.some((function(e){return"ManagementPermissionsAllowOperationsForPurchaser"===e}))}}]),i}(Object(u["b"])(h["a"],f["a"],d["a"]));g=Object(c["a"])([Object(u["a"])({components:{cardDetail:m["a"]},beforeRouteLeave:function(e,t,i){"orderManage"===e.name?(this.refreshFilter(),i(!0)):i(!0)}})],g);var v=g,O=v,j=(i("ec43"),i("2877")),w=Object(j["a"])(O,s,r,!1,null,"2d9fae0f",null);t["default"]=w.exports},aef0:function(e,t,i){},ec43:function(e,t,i){"use strict";i("aef0")}}]);