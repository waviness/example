(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5bc4b7b2"],{7234:function(t,e,i){},acd0:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"detail"},[i("div",{staticClass:"common-list"},[i("div",{staticClass:"common-list-content"},[i("div",{staticClass:"common-list-one font-14"},[t._v(" "+t._s(t.inquiryDetailObj.customid)+"/"+t._s(t.inquiryDetailObj.customerName&&t.inquiryDetailObj.customerName.split("/")[0])+" ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.inquiryDetailObj.contactId,expression:"inquiryDetailObj.contactId"}],staticClass:"common-list-one color-gray-5"},[t._v(" "+t._s(t.inquiryDetailObj.contactId)+t._s(t.inquiryDetailObj.contactMan)+" ")]),i("div",{staticClass:"common-list-two"},[i("div",[i("span",{staticClass:"color-gray-5"},[t._v("总单编号：")]),t._v(" "+t._s(t.inquiryDetailObj.confirmadocid))]),i("div",{staticClass:"fontWeight-500"},[i("span",{staticClass:"color-gray-5"},[t._v("核算单元：")]),t._v(" "),i("span",{staticClass:"fontWeight-500"},[t._v(t._s(t.inquiryDetailObj.entryid))])])]),i("div",{staticClass:"common-list-two"},[i("div",[i("span",{staticClass:"color-gray-5"},[t._v("出函金额：")]),t._v("  "),i("span",{staticClass:"fontWeight"},[t._v(t._s(t.inquiryDetailObj.total))])]),5!==t.inquiryDetailObj.usestate&&6!==t.inquiryDetailObj.usestate?i("div",[t.inquiryDetailObj.validDays<0?i("van-tag",{attrs:{color:"rgba(227, 77, 89, 0.1)","text-color":"#E34D59"}},[t._v("已过期"+t._s(Math.abs(t.inquiryDetailObj.validDays))+"天")]):i("van-tag",{attrs:{color:"rgba(0, 168, 112, 0.1)","text-color":"#00A870"}},[t._v("距到期还剩"+t._s(Math.abs(t.inquiryDetailObj.validDays))+"天")])],1):t._e()]),t.inquiryDetailObj.customsuredate?i("div",{staticClass:"common-list-one"},[i("span",{staticClass:"color-gray-5"},[t._v("业务处理时间：")]),t._v("  "),i("span",{staticClass:"fontWeight-500"},[t._v(t._s(t.inquiryDetailObj.customsuredate))])]):t._e()])]),i("div",{staticClass:"color-red tips"},[t._v("请核对财务下发的纸质材料，确认无误后点击下方 “确定”！当前操作默认点击 “启动询证”")]),i("van-field",{staticClass:"my-2",attrs:{label:"询函结果","input-align":"right"},scopedSlots:t._u([{key:"input",fn:function(){return[6!==t.inquiryDetailObj.usestate?i("van-radio-group",{attrs:{direction:"horizontal","checked-color":"#2271F5"},model:{value:t.inquiryDetailObj.returnFlag,callback:function(e){t.$set(t.inquiryDetailObj,"returnFlag",e)},expression:"inquiryDetailObj.returnFlag"}},[i("van-radio",{attrs:{name:1}},[t._v("一致")]),i("van-radio",{attrs:{name:2}},[t._v("有异")]),i("van-radio",{attrs:{name:3}},[t._v("报错")])],1):i("span",{class:1===t.inquiryDetailObj.returnFlag?"color-normal":2===t.inquiryDetailObj.returnFlag?"color-advanced":3===t.inquiryDetailObj.returnFlag?"color-never":""},[t._v(t._s(1===t.inquiryDetailObj.returnFlag?"一致":2===t.inquiryDetailObj.returnFlag?"有异":3===t.inquiryDetailObj.returnFlag?"报错":""))])]},proxy:!0}])}),6!==t.inquiryDetailObj.usestate?i("van-field",{staticClass:"flex-column",attrs:{label:"附件上传"},scopedSlots:t._u([{key:"input",fn:function(){return[i("van-uploader",{staticClass:"mt-3",attrs:{"after-read":t.afterRead,multiple:""},model:{value:t.addfileList,callback:function(e){t.addfileList=e},expression:"addfileList"}})]},proxy:!0}],null,!1,1971873559)}):t._e(),i("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"py-4 d-flex justify-center align-center",attrs:{color:"rgb(34, 113, 245)"}},[t._v("图片获取中...")]),t.imgList.length>0||t.pdfList.length>0?i("div",{staticClass:"image pl-10 mt-2 white-bg",class:6!==t.inquiryDetailObj.usestate?"marginBottom-60":"",staticStyle:{"min-height":"140px"}},[t._m(0),i("van-uploader",{attrs:{deletable:!1},model:{value:t.imgList,callback:function(e){t.imgList=e},expression:"imgList"}}),i("div",t._l(t.pdfList,(function(e,a){return i("a",{key:a,staticClass:"mr-4",attrs:{href:e,target:"_blank"}},[t._v(t._s(a+1)+"~文件查看")])})),0)],1):t._e(),t.imgList.length||t.pdfList.length||t.loading?t._e():i("div",{staticClass:"noImage mt-2 white-bg",class:6!==t.inquiryDetailObj.usestate?"marginBottom-60":""},[i("app-empty",{attrs:{description:"暂无图片"}})],1),6!==t.inquiryDetailObj.usestate?i("div",{staticClass:"commonButton-footer d-flex justify-center"},[i("van-button",{attrs:{size:"small",round:"",plain:""},on:{click:t.cancelClick}},[t._v("取消")]),i("van-button",{attrs:{size:"small",color:"#2271F5",type:"info","native-type":"submit",round:""},on:{click:t.sureRead}},[t._v("确认上传")])],1):t._e()],1)},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-header font-14 pa-2"},[i("span",{staticClass:"color-gray-5"},[t._v("已上传附件")])])}],r=i("5530"),s=i("1da1"),o=i("d4ec"),c=i("bee2"),u=i("262e"),l=i("2caf"),d=(i("96cf"),i("d3b7"),i("d81d"),i("ac1f"),i("1276"),i("b0c0"),i("a15b"),i("a434"),i("9ab4")),m=i("1b40"),f=i("c68a"),p=i("e6a1"),v=i("4bb5"),b=Object(v["a"])("crm"),h=Object(v["a"])("app"),g=function(t){Object(u["a"])(i,t);var e=Object(l["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.inquiryDetailObj={},t.addfileList=[],t.imgList=[],t.loading=!1,t.pdfList=[],t}return Object(c["a"])(i,[{key:"cancelClick",value:function(){this.$router.go(-1)}},{key:"_getConfirmationRequestList",value:function(){var t=this;this.loading=!0,Object(f["d"])({confirmadocid:this.$route.query.confirmadocid||this.detailObj.confirmadocid,pageNum:1,pageSize:1,needLoading:!0,full:!0}).then((function(e){if("200"===e.code){t.inquiryDetailObj=e.data.list[0];var i=localStorage.getItem("userId");t.inquiryDetailObj.filledReasonList&&t.inquiryDetailObj.filledReasonList.some((function(t){return t.userId===i}))&&(t.inquiryDetailObj.filledReasonFlag=!0),t._downloadConfirmationRequestPictures()}}))}},{key:"_downloadConfirmationRequestPictures",value:function(){var t=this;Object(f["b"])({confirmadocid:this.inquiryDetailObj.confirmadocid,entryId:this.detailObj.entryid,customerId:this.detailObj.customid,settleAccountsMonth:this.detailObj.usemm}).then((function(e){t.loading=!1,t.imgList=[];var i=[];t.pdfList=[],e.data.map((function(e){var a=e.split(".");"pdf"!==a[a.length-1].toLowerCase()?i.push(e):t.pdfList.push(e)})),t.imgList=i.map((function(t){var e=t.split(".");return{url:"svg"!==e[e.length-1]?t+"?x-oss-process=image%2Fresize%2Cm_fixed%2Cw_800%2Ch_1000":t}}))}))}},{key:"sureRead",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,i,a,n,r,s,o=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=new FormData,0!==this.addfileList.length){t.next=4;break}return this.$toast.fail("请选择要上传的图片"),t.abrupt("return");case 4:if(this.inquiryDetailObj.returnFlag){t.next=7;break}return this.$toast.fail("请选择询函结果"),t.abrupt("return");case 7:i=[],a=0;case 9:if(!(a<this.addfileList.length)){t.next=22;break}return n=this.addfileList[a],n.status="uploading",n.message="上传中...",r=a+n.file.name,t.next=16,this.$heic2anyFun(n.file,r);case 16:s=t.sent,i.push(s),e.append("imageList",s);case 19:a++,t.next=9;break;case 22:e.append("confirmadocid",this.inquiryDetailObj.confirmadocid),e.append("customerId",this.inquiryDetailObj.customid),e.append("entryId",this.inquiryDetailObj.entryid),e.append("settleAccountsMonth",this.inquiryDetailObj.usemm),e.append("createId",this.inquiryDetailObj.cremanid),e.append("salesPersonName",this.inquiryDetailObj.salesPersonName),e.append("replyFlag",this.inquiryDetailObj.returnFlag),Object(f["h"])(e).then((function(t){if("200"===t.code){for(var e=0;e<o.addfileList.length;e++){var i=o.addfileList[e];i.status="success",i.message="上传成功"}o.$toast.success("上传成功"),o.SET_HADDONEONDETAIL(!0),o.$router.go(-1)}else for(var a=0;a<o.addfileList.length;a++){var n=o.addfileList[a];n.status="failed",n.message="上传失败"}}));case 30:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"afterRead",value:function(t){for(var e=["jpg","jpeg","png","heic","pdf"],i=0;i<t.length;i++){var a=t[i].file,n=a.name.split("."),r=n[n.length-1].toLowerCase();-1===e.indexOf(r)&&(this.$toast.fail("上传的图片格式不对, 仅支持".concat(e.join(","),"格式")),this.addfileList.splice(i,1))}}},{key:"mounted",value:function(){this.inquiryDetailObj=Object(r["a"])({},this.detailObj),this._getConfirmationRequestList()}}]),i}(m["d"]);Object(d["a"])([b.Getter],g.prototype,"detailObj",void 0),Object(d["a"])([h.Mutation],g.prototype,"SET_HADDONEONDETAIL",void 0),g=Object(d["a"])([Object(m["a"])({components:{list:p["a"]}})],g);var y=g,j=y,O=(i("cc59"),i("2877")),_=Object(O["a"])(j,a,n,!1,null,"3ac54824",null);e["default"]=_.exports},c68a:function(t,e,i){"use strict";i.d(e,"d",(function(){return s})),i.d(e,"g",(function(){return o})),i.d(e,"h",(function(){return c})),i.d(e,"b",(function(){return u})),i.d(e,"c",(function(){return l})),i.d(e,"a",(function(){return d})),i.d(e,"f",(function(){return m})),i.d(e,"e",(function(){return f}));var a=i("1da1"),n=(i("96cf"),i("b32d")),r=i("90ae"),s=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n["a"].post(r["d"],"/api/task/getConfirmationRequestList",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n["a"].get(r["d"],"/api/task/updateConfirmationRequestStatue",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),c=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n["a"].post(r["d"],"/api/task/uploadConfirmationRequestPictures",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),u=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n["a"].post(r["d"],"/api/task/downloadConfirmationRequestPictures",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n["a"].get(r["d"],"/api/task/exceedTimeLimitTask",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n["a"].post(r["d"],"/api/task/activeInitiateConfirmationRequest",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),m=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n["a"].get(r["d"],"/api/task/initiatedConfirmationRequest",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),f=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n["a"].putGet(r["d"],"/api/task/handleConfirmationRequest/".concat(e),i);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}()},cc59:function(t,e,i){"use strict";i("7234")},e6a1:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-list mb-2",on:{click:t.detailClick}},[i("div",{staticClass:"common-list-content"},[i("div",{staticClass:"common-list-two"},[i("div",{staticClass:"fontWeight"},[t._v("#"+t._s(t.item.confirmadocid))]),i("div",{staticClass:"fontWeight-500 color-gray-4"},[t._v(t._s(t.item.credate&&t.item.credate.substring(0,10)))])]),i("div",{staticClass:"common-list-two"},[i("div",{staticClass:"fontWeight-500 color-gray-5"},[t._v(t._s(t.item.customid)+"/"+t._s(t.item.customerName.split("/")[0]))]),i("div",{staticClass:"fontWeight-500 common-list-minWidth"},[t._v("核算单元 "+t._s(t.item.entryid))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.item.contactId,expression:"item.contactId"}],staticClass:"common-list-one color-gray-4"},[t._v(t._s(t.item.contactId)+t._s(t.item.contactMan))]),i("div",{staticClass:"common-list-two"},[i("div",{staticClass:"fontWeight-500 font-14"},[t._v("出函金额 "+t._s(t.item.total))]),5!==t.item.usestate&&6!==t.item.usestate?i("div",[t.item.validDays<0?i("van-tag",{attrs:{color:"rgba(227, 77, 89, 0.1)","text-color":"#E34D59"}},[t._v("已过期"+t._s(Math.abs(t.item.validDays))+"天")]):i("van-tag",{attrs:{color:"rgba(0, 168, 112, 0.1)","text-color":"#00A870"}},[t._v("距到期还剩"+t._s(Math.abs(t.item.validDays))+"天")])],1):t._e()])]),2===t.item.usestate||6!==t.item.usestate?i("div",{staticClass:"common-list-button clearfix"},[i("div",{staticClass:"right"},[2===t.item.usestate?i("van-button",{attrs:{size:"small",color:"#2271F5",round:"",type:"info"},on:{click:t.changeStatus}},[t._v("启动询证")]):t._e(),6!==t.item.usestate?i("van-button",{staticClass:"ml-4",attrs:{size:"small",color:"#2271F5",round:"",type:"info"},on:{click:t.detailClick}},[t._v("上传照片")]):t._e()],1)]):t._e()])},n=[],r=i("d4ec"),s=i("bee2"),o=i("262e"),c=i("2caf"),u=i("9ab4"),l=i("1b40"),d=function(t){Object(o["a"])(i,t);var e=Object(c["a"])(i);function i(){return Object(r["a"])(this,i),e.apply(this,arguments)}return Object(s["a"])(i,[{key:"detailClick",value:function(){this.$emit("detailClick",{item:this.item,index:this.index})}},{key:"changeStatus",value:function(){var t=this,e="请核对财务下发的纸质材料，确认无误后点击下方“确定”！";this.$dialog.confirm({message:e,allowHtml:!0,confirmButtonText:"确定",confirmButtonColor:"#2271F5",beforeClose:function(e,i){if("confirm"===e){var a={index:t.index,confirmadocid:t.item.confirmadocid,statue:4};t.$emit("changeStatus",a),i()}else i()}})}}]),i}(l["d"]);Object(u["a"])([Object(l["c"])()],d.prototype,"item",void 0),Object(u["a"])([Object(l["c"])()],d.prototype,"index",void 0),d=Object(u["a"])([Object(l["a"])({})],d);var m=d,f=m,p=i("2877"),v=Object(p["a"])(f,a,n,!1,null,"e3e2f2d8",null);e["a"]=v.exports}}]);