(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e37adb2"],{"0a98":function(e,t,a){"use strict";a("bdb5")},bdb5:function(e,t,a){},ec86:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("van-sticky",[a("div",{staticClass:"white-block van-clearfix px-2 pt-4"},[a("div",{staticClass:"d-flex justify-space-between pt-2 px-2"},[a("div",[a("div",{staticClass:"font-bold font-14 pb-1"},[e._v(" "+e._s(e.detailVal.customerName&&e.detailVal.customerName.split("/")[0]||"")+" ")]),e.detailVal&&e.detailVal.relCustomerId?a("div",{staticClass:"font-12 color-normal pb-1"},[e._v(" 已关联至"+e._s(e.detailVal&&e.detailVal.relCustomerId)+"/"+e._s(e.detailVal&&e.detailVal.relCustomerName||"--")+" ")]):a("div",{staticClass:"color-gray-7 pb-1"},[e._v("暂未关联业务系统内客户")])]),a("div",{staticClass:"d-flex flex-column align-end",staticStyle:{"margin-left":"90px","min-width":"fit-content"}},[a("span",{staticClass:"tag-primary-plain mb-2"},[e._v(" "+e._s(e.detailVal&&0===e.detailVal.sourceType?"拓展客户":"业务系统内客户")+" ")]),a("span",{staticClass:"tag-primary-plain"},[e._v(" "+e._s(e.detailVal&&e.detailVal.customerTypeName)+" ")])])]),a("div",{staticClass:"px-2"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.detailVal.registerAddress,expression:"detailVal.registerAddress"}],staticClass:"color-second pb-2"},[e._v(e._s(e.detailVal.registerAddress))]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.detailVal.contactName,expression:"detailVal.contactName"}],staticClass:"color-second pb-2"},[e._v(e._s(e.detailVal.contactName))])])])]),a("div",{staticClass:"content pa-2"},[a("div",{staticClass:"border-radius-10 mb-2 white-bg"},[a("ul",{staticClass:"pa-2"},[a("li",{staticClass:"d-flex flex-column font-14 color-second"},[a("div",{staticClass:"d-flex justify-space-between"},[a("span",{staticClass:"pb-1"},[e._v("打卡签到")]),a("van-button",{directives:[{name:"show",rawName:"v-show",value:!e.$route.query.userId,expression:"!$route.query.userId"}],attrs:{color:"#2271f5",size:"mini",plain:""},on:{click:e.editClockClick}},[e._v("编辑打卡信息")])],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.detailVal.signinCciTime,expression:"detailVal.signinCciTime"}]},[e._v(e._s(e.detailVal.signinCciTime))])]),a("li",{directives:[{name:"show",rawName:"v-show",value:e.detailVal.signinCciId,expression:"detailVal.signinCciId"}]},[e._v(e._s(e.detailVal.signinCciId)+"/"+e._s(e.detailVal.signinCciAddress))]),a("li",{directives:[{name:"show",rawName:"v-show",value:!e.detailVal.signinCciId,expression:"!detailVal.signinCciId"}],staticClass:"color-gray-7 py-1"},[e._v("暂无打卡签到信息")])]),a("ul",{staticClass:"pa-2"},[a("li",{staticClass:"d-flex flex-column font-14 color-second"},[a("span",{staticClass:"pb-1"},[e._v("打卡签退")]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.detailVal.signoutCciTime,expression:"detailVal.signoutCciTime"}],staticClass:"pb-1"},[e._v(e._s(e.detailVal.signoutCciTime))])]),a("li",{directives:[{name:"show",rawName:"v-show",value:e.detailVal.signoutCciId,expression:"detailVal.signoutCciId"}],staticClass:"pb-1"},[e._v(" "+e._s(e.detailVal.signoutCciId)+"/"+e._s(e.detailVal.signoutCciAddress)+" ")]),a("li",{directives:[{name:"show",rawName:"v-show",value:!e.detailVal.signoutCciId,expression:"!detailVal.signoutCciId"}],staticClass:"color-gray-7 py-1"},[e._v("暂无打卡签退信息")])])]),a("div",{staticClass:"border-radius-10 pa-2 my-2 white-bg font-14"},[a("div",[a("div",{staticClass:"color-second pb-2 d-flex justify-space-between"},[a("span",[e._v("客情事件")]),a("van-button",{directives:[{name:"show",rawName:"v-show",value:!e.$route.query.userId,expression:"!$route.query.userId"}],attrs:{color:"#2271f5",size:"mini",plain:""},on:{click:e.editLabelClick}},[e._v("编辑客情事件")])],1),a("div",{staticClass:"pb-2"},[e._v(e._s(e.detailVal.visitUserName))]),a("div",{staticClass:"pb-2"},[a("span",{staticClass:"color-gray-5 pr-6"},[e._v("人员职务")]),a("span",[e._v(e._s(e.detailVal.positionName))])]),e._l(e.detailVal.szymLabelRemarkDOResList,(function(t,i){return a("ul",{key:i,staticClass:"mb-2"},[a("li",{staticClass:"pb-2"},[a("span",{staticClass:"color-gray-5 pr-6"},[e._v("客情事件"+e._s(i+1))]),a("span",{staticClass:"color-main"},[e._v(e._s(t.labelName))])]),a("li",{staticClass:"pb-2"},[a("span",{staticClass:"color-gray-5 pr-6"},[e._v("关联项目")]),a("span",e._l(t.szymProjectResList,(function(t,i){return a("span",{key:i,staticClass:"pr-2"},[e._v(" "+e._s(t.projectName)+" ")])})),0)]),a("div",{staticClass:"color-second pb-2"},[e._v("附件")]),t.fileVOList.length?e._e():a("span",{staticClass:"color-second"},[e._v("暂无附件信息")]),t.fileVOList?a("ul",e._l(t.fileVOList,(function(t,i){return a("li",{key:i,staticClass:"fileList",on:{click:function(a){return e._downloadFile(t)}}},[a("app-icon",{staticClass:"pr-2",attrs:{name:"#ytcrm-file"}}),e._v(e._s(t.fileName)+" ")],1)})),0):e._e()])}))],2)]),a("div",{staticClass:"border-radius-10 pa-2 white-bg"},[a("div",{staticClass:"color-second pb-3 d-flex justify-space-between"},[a("span",[e._v("医院合影")]),a("van-button",{directives:[{name:"show",rawName:"v-show",value:e.imgButton&&!e.$route.query.userId,expression:"imgButton && !$route.query.userId"}],attrs:{color:"#2271f5",size:"mini",plain:""},on:{click:e.uploadImageClick}},[e._v("上传照片")])],1),a("van-uploader",{directives:[{name:"show",rawName:"v-show",value:e.$route.query.userId,expression:"$route.query.userId"}],attrs:{"max-count":e.imageList.length},model:{value:e.imageList,callback:function(t){e.imageList=t},expression:"imageList"}}),a("van-uploader",{directives:[{name:"show",rawName:"v-show",value:!e.$route.query.userId,expression:"!$route.query.userId"}],attrs:{"before-delete":e.deleteImageClick,multiple:""},model:{value:e.imageList,callback:function(t){e.imageList=t},expression:"imageList"}})],1)]),e.customerLabelShow?a("custom-label",{attrs:{suvId:e.detailVal.suvId,staffMemberCheckDetail:e.staffMemberCheckDetail,labelTreeList:e.labelTreeList,customerLabelShow:e.customerLabelShow,customerId:e.detailVal.szymCustomerId},on:{closeClick:function(t){e.customerLabelShow=!1},addCustomSure:e.addCustomSure}}):e._e(),e.clockShow?a("edit-clock",{attrs:{visitDate:e.detailVal.visitTime,clockObj:e.clockObj,clockShow:e.clockShow},on:{clockCancel:function(t){e.clockShow=!1},clockSure:e.clockSure}}):e._e()],1)},s=[],l=a("1da1"),c=a("5530"),r=a("d4ec"),n=a("bee2"),o=a("262e"),u=a("2caf"),d=(a("96cf"),a("caad"),a("ac1f"),a("1276"),a("d3b7"),a("7db0"),a("b0c0"),a("3ca3"),a("ddb0"),a("99af"),a("d81d"),a("9ab4")),h=a("1b40"),v=a("6e5a"),m=a("f727"),p=a("c9f1"),f=a("4bb5"),k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("van-popup",{style:{height:"85%"},attrs:{round:"",position:"bottom",closeable:""},on:{close:e.clockCancel},model:{value:e.innerClockShow,callback:function(t){e.innerClockShow=t},expression:"innerClockShow"}},[a("div",{staticClass:"textAlignC pa-3 font-16"},[e._v("编辑打卡信息")]),a("van-field",{attrs:{readonly:"",clickable:"","input-align":"right",label:"打卡签到",placeholder:"点击选择打卡签到信息",value:e.addressInDeatilValue},on:{click:function(t){e.clickType=1,e.showAdressPicker=!0}}}),a("van-field",{attrs:{readonly:"",clickable:"","input-align":"right",label:"打卡签退",placeholder:"点击选择打卡签退信息",value:e.addressOutDeatilValue},on:{click:function(t){e.clickType=2,e.showAdressPicker=!0}}}),a("div",{staticClass:"commonButton-footer d-flex justify-center"},[a("van-button",{attrs:{size:"small",round:"",plain:""},on:{click:e.clockCancel}},[e._v("取消")]),a("van-button",{attrs:{size:"small",color:"#2271F5",type:"info","native-type":"submit",round:""},on:{click:e.clockSure}},[e._v("确定")])],1),e.showAdressPicker?a("clock-in",{attrs:{visitDate:e.visitDate,showAdressPicker:e.showAdressPicker},on:{adressOnConfirm:e.adressOnConfirm,addressChoose:e.addressChoose,adressCancel:e.adressCancel}}):e._e()],1)},b=[],C=a("a7dc"),V=function(e){Object(o["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.showAdressPicker=!1,e.innerClockShow=!0,e.clickType=0,e.clickInValue="",e.clickOutValue="",e.addressInDeatilValue="",e.addressOutDeatilValue="",e}return Object(n["a"])(a,[{key:"adressOnConfirm",value:function(e){if(!e)return 1===this.clickType?(this.clickInValue="",this.addressInDeatilValue=""):2===this.clickType&&(this.clickOutValue="",this.addressOutDeatilValue=""),void(this.showAdressPicker=!1);1===this.clickType?(this.clickInValue=e.cciId,this.addressInDeatilValue=e.cciId+"/"+e.address):2===this.clickType&&(this.clickOutValue=e.cciId,this.addressOutDeatilValue=e.cciId+"/"+e.address),this.showAdressPicker=!1}},{key:"addressChoose",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:1===this.clickType?(this.clickInValue=t.addressID,this.addressInDeatilValue=t.addressDetail):2===this.clickType&&(this.clickOutValue=t.addressID,this.addressOutDeatilValue=t.addressDetail),this.showAdressPicker=!1;case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"adressCancel",value:function(){this.showAdressPicker=!1}},{key:"clockCancel",value:function(){this.$emit("clockCancel")}},{key:"clockSure",value:function(){var e={clickInValue:this.clickInValue,clickOutValue:this.clickOutValue,addressInDeatilValue:this.addressInDeatilValue,addressOutDeatilValue:this.addressOutDeatilValue};this.$emit("clockSure",e)}},{key:"mounted",value:function(){this.innerClockShow=this.clockShow,this.clickInValue=this.clockObj.clickInValue,this.clickOutValue=this.clockObj.clickOutValue,this.addressInDeatilValue=this.clockObj.addressInDeatilValue,this.addressOutDeatilValue=this.clockObj.addressOutDeatilValue}}]),a}(h["d"]);Object(d["a"])([Object(h["c"])()],V.prototype,"clockObj",void 0),Object(d["a"])([Object(h["c"])()],V.prototype,"clockShow",void 0),Object(d["a"])([Object(h["c"])()],V.prototype,"visitDate",void 0),V=Object(d["a"])([Object(h["a"])({components:{clockIn:C["a"]}})],V);var g=V,y=g,w=a("2877"),I=Object(w["a"])(y,k,b,!1,null,"21ee9515",null),O=I.exports,_=Object(f["a"])("app"),j=function(e){Object(o["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.labelTreeList=[],e.detailVal={},e.imageList=[],e.deleteImageList=[],e.customerLabelShow=!1,e.staffMemberCheckDetail=[],e.clockObj={},e.clockShow=!1,e}return Object(n["a"])(a,[{key:"_downloadFile",value:function(e){var t=e.fileName,a=e.fileType,i=e.fileUrl,s=["png","jpg","jpeg","svg","heic"];s.includes(a.toLowerCase())?window.location.href=i:this.$router.push({path:"/task/download",query:{fileName:t,fileType:a,fileUrl:i.split(".com/")[1]}})}},{key:"imgButton",get:function(){return this.imageList.some((function(e){return e.content}))}},{key:"_getSzymUserVisitBySuvId",value:function(){var e=this;Object(v["j"])({suvId:this.detailInfor.suvId}).then((function(t){e.detailVal=t.data,e.imageList=[],e.detailVal.fileVOList.length||(e.imageList=[]);for(var a=0;a<e.detailVal.fileVOList.length;a++){var i=e.detailVal.fileVOList[a];e.imageList.push(Object(c["a"])(Object(c["a"])({},i),{},{url:i.fileUrl,deletable:!e.$route.query.userId}))}}))}},{key:"deleteImageClick",value:function(e){var t=this;if(e.content)return!0;var a=this.detailVal.fileVOList.find((function(t){return t.fileUrl===e.url}));this.$dialog.confirm({title:"确认",confirmButtonColor:"#2271f5",message:"确定删除当前图片"}).then(Object(l["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i={deleteFlag:!0,suvId:t.detailInfor.suvId},t._optSzymUserVisitPic(i,[a]);case 2:case"end":return e.stop()}}),e)}))))}},{key:"uploadImageClick",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s,l,c,r,n,o,u,d=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t={deleteFlag:!1,suvId:this.detailInfor.suvId},a=this.$toast.loading("上传操作中..."),i=[],s=[],l=0;case 6:if(!(l<this.imageList.length)){e.next=19;break}if(c=this.imageList[l],!c.file){e.next=15;break}return e.next=11,this.$heic2anyFun(c.file,l+""+c.file.name);case 11:r=e.sent,i.push(r),e.next=16;break;case 15:c.fileName&&s.push(c);case 16:l++,e.next=6;break;case 19:for(n=[],o=0;o<i.length;o++)u=i[o],n.push(Object(m["l"])({file:u,length:1,full:!0}));Promise.all(n).then((function(e){for(var i=[],l=0;l<e.length;l++){var c=e[l].data;i.push({fileName:c.fileName,fileType:c.suffix,fileUrl:c.url})}d._optSzymUserVisitPic(t,i.concat(s),a)}));case 22:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_optSzymUserVisitPic",value:function(e,t){var a=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;0!==t.length?Object(v["q"])(Object(c["a"])(Object(c["a"])({},e),{},{list:t})).then((function(e){"200"===e.code&&(a.$toast.success(e.msg),a._getSzymUserVisitBySuvId(),null===i||void 0===i||i.clear())})):this.$toast.fail("请选择照片上传！")}},{key:"addCustomSure",value:function(e){this.$set(this.staffMemberCheckDetail[0],"remarkValueList",e),this._optSzymUserVisitLabelRemark()}},{key:"_optSzymUserVisitLabelRemark",value:function(){var e=this;Object(v["p"])(this.staffMemberCheckDetail[0].remarkValueList).then((function(t){"200"===t.code&&(e._getSzymUserVisitBySuvId(),e.customerLabelShow=!1)}))}},{key:"editLabelClick",value:function(){for(var e=[],t=0;t<this.detailVal.szymLabelRemarkDOResList.length;t++){for(var a=this.detailVal.szymLabelRemarkDOResList[t],i="",s=[],l=0;l<a.szymProjectResList.length;l++){var c=a.szymProjectResList[l];i+=c.projectName,s.push(c.projectId)}e.push({slrId:a.slrId,suvId:a.suvId,keyString:i,keyList:s,keyCheckDetail:a.szymProjectResList,remarkChangeIdValue:a.labelId,remarkChangeNameValue:a.labelName,fileList:a.fileVOList})}this.staffMemberCheckDetail[0]={},this.$set(this.staffMemberCheckDetail[0],"remarkValueList",e),this.customerLabelShow=!0}},{key:"editClockClick",value:function(){this.clockShow=!0,this.clockObj={clickInValue:this.detailVal.signinCciId,clickOutValue:this.detailVal.signoutCciId,addressInDeatilValue:this.detailVal.signinCciAddress,addressOutDeatilValue:this.detailVal.signoutCciAddress}}},{key:"clockSure",value:function(e){this._relateClockIn(e)}},{key:"_relateClockIn",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={suvId:this.detailVal.suvId,signinCciId:t.clickInValue,signoutCciId:t.clickOutValue},e.next=3,Object(v["o"])(a);case 3:i=e.sent,"200"===i.code&&(this.clockShow=!1,this.$toast.success(i.msg),this._getSzymUserVisitBySuvId());case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTypeList",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},a={full:!0,pageNum:1,pageSize:1e5,usestatus:1,typeId:t},e.next=4,Object(m["d"])(a);case 4:return i=e.sent,s=i.data.list.map((function(e){var t=e.DIC_SELECT_ID,a=e.DIC_SELECT_NAME;return{value:t,name:a}})),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=this;this._getSzymUserVisitBySuvId(),this.getTypeList(73).then((function(t){e.labelTreeList=t}))}}]),a}(h["d"]);Object(d["a"])([_.Mutation],j.prototype,"SET_HADDONEONDETAIL",void 0),Object(d["a"])([_.Getter],j.prototype,"detailInfor",void 0),j=Object(d["a"])([Object(h["a"])({components:{customLabel:p["a"],editClock:O}})],j);var L=j,S=L,x=(a("0a98"),Object(w["a"])(S,i,s,!1,null,"b22d846a",null));t["default"]=x.exports}}]);