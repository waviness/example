(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b608ce9"],{"025b":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"warp"},[i("van-search",{attrs:{placeholder:"搜索","input-align":"center"},on:{input:t.onRefresh,clear:t.onRefresh},model:{value:t.searchValueCustom,callback:function(e){t.searchValueCustom=e},expression:"searchValueCustom"}}),i("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[i("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.customList,(function(e,a){return i("div",{key:e.customid+a,staticClass:"warp"},[e.contactList&&0!==e.contactList.length?i("van-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("van-collapse-item",{attrs:{name:e.customid},scopedSlots:t._u([{key:"title",fn:function(){return[i("ul",[i("li",{staticClass:"customerValue"},[t._v(t._s(e.customid)+"/"+t._s(e.customname))]),i("li",{directives:[{name:"show",rawName:"v-show",value:e.entryid,expression:"item.entryid"}],staticClass:"color-gray-4 font-12"},[t._v(t._s(e.entryid)+"/"+t._s(e.entryname))])])]},proxy:!0}],null,!0)},t._l(e.contactList,(function(a,s){return i("van-cell",{key:a.CONTACTID+s,attrs:{"is-link":""},on:{click:function(i){return t.chooseCustomClick(e,a)}},scopedSlots:t._u([{key:"title",fn:function(){return[i("span",{style:a.dialyPass?"color: #AAA":""},[t._v(" "+t._s(a.CONTACTID+a.CONTACTMAN)+" "),i("br"),a.dialyPass&&!t.requestChange?i("i",{staticClass:"fontSize-12 text-orange"},[t._v("最小效期为:"+t._s(new Date(a.miniTime).toLocaleDateString()))]):t._e()])]},proxy:!0}],null,!0)})})),1)],1):i("van-cell",{attrs:{"is-link":!e.contactFlag},on:{click:function(i){return t.chooseCustomClick(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[i("ul",[i("li",{staticClass:"customerValue"},[t._v(" "+t._s(e.customid)+"/"+t._s(e.customname)+" "),t._t("default")],2),i("li",{directives:[{name:"show",rawName:"v-show",value:e.entryid,expression:"item.entryid"}],staticClass:"color-gray-4 font-12"},[t._v(t._s(e.entryid)+"/"+t._s(e.entryname))]),e.contactFlag?i("li",{staticClass:"color-never font-12"},[t._v("无可下单分支机构（不在效期），不可下单")]):t._e()])]},proxy:!0}],null,!0)})],1)})),0)],1)],1)},s=[],n=i("5530"),o=i("d4ec"),r=i("bee2"),c=i("262e"),l=i("2caf"),u=(i("99af"),i("d3b7"),i("159b"),i("9ab4")),f=i("1b40"),h=i("53ae"),d=i("f727"),m=function(t){Object(c["a"])(i,t);var e=Object(l["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.customList=[],t.searchValueCustom="",t.activeNames=[],t}return Object(r["a"])(i,[{key:"chooseCustomClick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t.contactFlag)this.$toast.fail("无可下单分支机构（不在效期），不可下单");else{var i=Object.assign({customid:t.customid,customname:t.customname},e);e&&e.dialyPass?this.$dialog.alert({confirmButtonColor:"rgb(34, 113, 245)",message:"".concat(e.CONTACTMAN,"有多个不同的有效期且已过期，不允许选择，最小效期为:").concat(new Date(e.miniTime).toLocaleDateString())}).then((function(){})):this.$emit("chooseCustomClick",i)}}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!1,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.customList=[],this.refreshing=!1),this.loading=!0,this.requestChange?this.$emit("getList",{condition:this.searchValueCustom,pageNum:this.page,pageSize:10}):this._getCustom()}},{key:"_getCustom",value:function(){var t=this;1===this.page&&(this.customList=[]);var e=Object(n["a"])(Object(n["a"])({condition:this.searchValueCustom},this.params),{},{pageNum:this.page,pageSize:10});Object(d["f"])(e).then((function(e){t.customList=t.customList.concat(e.data.list);for(var i=0;i<t.customList.length;i++){var a=t.customList[i];a.contactList&&a.contactList.length>0&&t.needDialyPass&&a.contactList.forEach((function(t){var e=0;t.dates&&t.dates.length>0&&(t.dates.forEach((function(t){e?e>new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()&&(e=new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()):e=new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()})),e<new Date((new Date).toLocaleDateString()).getTime()&&(t.dialyPass=!0,t.miniTime=e))}))}e.data.hasNextPage?t.page++:t.finished=!0,t.loading=!1}))}}]),i}(Object(f["b"])(h["a"]));Object(u["a"])([Object(f["c"])({default:!1})],m.prototype,"requestChange",void 0),Object(u["a"])([Object(f["c"])({default:!1})],m.prototype,"needDialyPass",void 0),Object(u["a"])([Object(f["c"])()],m.prototype,"params",void 0),m=Object(u["a"])([Object(f["a"])({})],m);var p=m,b=p,v=(i("27ba"),i("2877")),y=Object(v["a"])(b,a,s,!1,null,"12f3a2f4",null);e["a"]=y.exports},"27ba":function(t,e,i){"use strict";i("6b64")},"437a":function(t,e,i){"use strict";var a=i("bee2"),s=i("d4ec"),n=i("262e"),o=i("2caf"),r=i("9ab4"),c=i("1b40"),l=i("4bb5"),u=Object(l["a"])("app"),f=Object(l["a"])("crm");c["a"].registerHooks(["beforeRouteEnter"]);var h=function(t){Object(n["a"])(i,t);var e=Object(o["a"])(i);function i(){var t;return Object(s["a"])(this,i),t=e.apply(this,arguments),t.filterShow=!1,t.filterActive=!1,t.tabType=0,t}return Object(a["a"])(i)}(c["d"]);Object(r["a"])([u.Getter],h.prototype,"userInfor",void 0),Object(r["a"])([f.Mutation],h.prototype,"SET_DETAILOBJ",void 0),Object(r["a"])([u.Mutation],h.prototype,"SET_QUERYPARAMA",void 0),Object(r["a"])([u.Mutation],h.prototype,"SET_HADDONEONDETAIL",void 0),Object(r["a"])([u.Getter],h.prototype,"hadDoneOnDetail",void 0),h=Object(r["a"])([Object(c["a"])({})],h),e["a"]=h},"6b64":function(t,e,i){},7654:function(t,e,i){},"81fd":function(t,e,i){},"95bf":function(t,e,i){"use strict";i("81fd")},b9e5:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"full-height"},[t.entryChange?i("div",{staticClass:"entryWarp"},[i("entry-module",{on:{entryChangeClick:t.entryChangeClick}})],1):i("div",{staticClass:"main full-height"},[i("van-tabs",{directives:[{name:"show",rawName:"v-show",value:!t.filterShow,expression:"!filterShow"}],attrs:{color:"#2271F5"},model:{value:t.tabType,callback:function(e){t.tabType=e},expression:"tabType"}},[i("van-tab",{attrs:{title:"按客户下单"}}),i("van-tab",{attrs:{title:"报货单查询"}})],1),0===t.tabType?i("app-custom",{ref:"appCustom",attrs:{params:{entryid:t.chooseEntry.entryid}},on:{chooseCustomClick:t.chooseCustomClick}}):t._e(),1===+t.tabType?i("div",{class:["pa-10 common-filter ma-2",t.filterShow?"color-main-2":"",t.filterActive?"common-filter--active":""],on:{click:function(e){t.filterShow=!t.filterShow}}},[i("div",[t._v("条件筛选")]),i("van-icon",{attrs:{name:"arrow-"+(t.filterShow?"up":"down"),size:"16px"}})],1):t._e(),1===+t.tabType?i("van-pull-refresh",{ref:"listWarp",attrs:{id:"filterContainer"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[i("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":t.finishText},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t.loading||t.dataList.length?t._e():i("app-empty",{staticClass:"pb-6 white-bg",attrs:{description:"暂无数据"}}),t._l(t.dataList,(function(e,a){return i("AppOrderList",{key:"orderList"+a,staticClass:"mx-2",attrs:{listItem:e},on:{orderClick:function(i){return t.orderClick(e)}}})}))],2),i("van-popup",{attrs:{position:"top","get-container":"#filterContainer"},model:{value:t.filterShow,callback:function(e){t.filterShow=e},expression:"filterShow"}},[i("filter-module",{ref:"filterModule",attrs:{defaultDate:{startTime:t.filterObj.startTime,endTime:t.filterObj.endTime}},on:{reset:t.resertClick,filterSubmit:t.filterSubmit}})],1)],1):t._e(),i("div",{staticClass:"commonOpButton-footer"},[i("van-button",{attrs:{round:"",color:"#2271F5",type:"primary",plain:""},on:{click:function(e){t.entryChange=!0,t.finished=!1,t.loading=!1,t.refreshing=!1,t.twoPinActive=0}},scopedSlots:t._u([{key:"icon",fn:function(){return[i("icon-Svg",{attrs:{size:"small",color:"#2271F5",name:"ytcrm-a-xingzhuang4"}})]},proxy:!0}])},[i("span",[t._v("切换核算单元 当前("+t._s(t.chooseEntry.entryid)+")")])])],1),i("van-button",{directives:[{name:"show",rawName:"v-show",value:!t.cartShow&&!t.entryChange,expression:"!cartShow && !entryChange"}],staticClass:"cartButton",attrs:{round:"",color:"#2271F5",type:"primary"},on:{click:function(e){return t.$router.push({name:"ReportShopCart"})}},scopedSlots:t._u([{key:"icon",fn:function(){return[i("van-icon",{attrs:{size:"20px",name:"cart-o",color:"#ffffff"}})]},proxy:!0}])})],1)])},s=[],n=i("5530"),o=i("d4ec"),r=i("bee2"),c=i("262e"),l=i("2caf"),u=(i("99af"),i("b0c0"),i("9ab4")),f=i("1b40"),h=i("f806"),d=i("025b"),m=i("4724"),p=i("d13f"),b=i("53ae"),v=i("4bb5"),y=i("437a"),g=i("a403"),O=Object(v["a"])("twoPinDic"),C=function(t){Object(c["a"])(i,t);var e=Object(l["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.entryChange=!0,t.scroll="",t.filterObj={customerId:"",customName:"",startTime:"",endTime:"",codDocId:""},t}return Object(r["a"])(i,[{key:"entryChangeClick",value:function(t){var e=t.entryid,i=t.entryname;this.entryChange=!1,this.SET_ENTRYINFOR({entryid:e,entryname:i})}},{key:"chooseCustomClick",value:function(t){var e=this.$refs.appCustom.$el.children[1].scrollTop;this.scroll=e,this.SET_CUSTOMPARAMS(t),this.$router.push({path:"/report/customDetail"})}},{key:"orderClick",value:function(t){var e=this.$refs.listWarp.$el.scrollTop;this.scroll=e,this.$router.push({name:"ReportDtlOrder",query:{codDocId:t.codDocId}})}},{key:"resertClick",value:function(){this.filterActive=!1,this.filterObj={customerId:"",customName:"",startTime:"",endTime:"",codDocId:""},this.onRefresh()}},{key:"filterSubmit",value:function(t){this.filterObj=Object(n["a"])({},t),this.filterObj.customerId||this.filterObj.customName||this.filterObj.codDocId||this.filterObj.startTime||this.filterObj.endTime?this.filterActive=!0:this.filterActive=!1,this.filterShow=!1,this.onRefresh()}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.dataList=[],this.refreshing=!1),this._getOrderDoc()}},{key:"_getOrderDoc",value:function(){var t=this;1===this.page&&(this.dataList=[]),Object(g["k"])({orderType:6,codDocId:this.filterObj.codDocId,customId:this.filterObj.customerId,customName:this.filterObj.customName,entryId:this.chooseEntry.entryid,endtime:this.filterObj.endTime?this.filterObj.endTime+" 23:59:59":"",starttime:this.filterObj.startTime?this.filterObj.startTime+" 00:00:00":"",pageNum:this.page,pageSize:7}).then((function(e){t.dataList=t.dataList.concat(e.data.list),e.data.hasNextPage?t.page++:t.finished=!0,t.loading=!1}))}},{key:"activated",value:function(){this.filterObj.startTime=this.$dayjs().subtract(10,"day").format("YYYY-MM-DD"),this.filterObj.endTime=this.$dayjs().format("YYYY-MM-DD"),this.filterActive=!0,this.$refs.appCustom?this.$refs.appCustom.$el.children[1].scrollTop=this.scroll:this.$refs.listWarp&&(this.$refs.listWarp.$el.scrollTop=this.scroll)}}]),i}(Object(f["b"])(y["a"],b["a"]));Object(u["a"])([O.Mutation],C.prototype,"SET_ENTRYINFOR",void 0),Object(u["a"])([O.Mutation],C.prototype,"SET_CUSTOMPARAMS",void 0),Object(u["a"])([O.Mutation],C.prototype,"SET_GOODSDETAIL",void 0),Object(u["a"])([O.Mutation],C.prototype,"SET_CARTSHOW",void 0),Object(u["a"])([O.Getter],C.prototype,"chooseEntry",void 0),Object(u["a"])([O.Getter],C.prototype,"cartShow",void 0),C=Object(u["a"])([Object(f["a"])({components:{entryModule:h["a"],AppCustom:d["a"],AppOrderList:m["a"],FilterModule:p["a"]},beforeRouteLeave:function(t,e,i){if("Home"===t.name){this.$set(this.filterObj,"codDocId",""),this.$set(this.filterObj,"customerId",""),this.$set(this.filterObj,"customName",""),this.$set(this.filterObj,"startTime",""),this.$set(this.filterObj,"endTime","");var a=this.$refs.filterModule;a&&a.reset()}i()}})],C);var j=C,_=j,k=(i("95bf"),i("2877")),T=Object(k["a"])(_,a,s,!1,null,"f37d571a",null);e["default"]=T.exports},e028:function(t,e,i){"use strict";i("7654")},f806:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"entryModule full-height"},[t._m(0),t._l(t.entryList,(function(e,a){return i("van-cell",{key:"entry"+a,staticClass:"mb-2",on:{click:function(i){return t.cellClick(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[i("div",{staticClass:"d-flex align-center justify-space-between"},[i("span",[t._v(t._s(e.entryid)+"/"+t._s(e.entryname))]),i("van-icon",{staticClass:"right",attrs:{color:"#969799",size:"20px",name:"arrow"}})],1)]},proxy:!0}],null,!0)})}))],2)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"header px-10 py-2"},[t._v("请选择 "),i("span",{staticClass:"color-main-2"},[t._v("核算单元")]),t._v("进入")])}],n=i("d4ec"),o=i("bee2"),r=i("262e"),c=i("2caf"),l=i("9ab4"),u=i("1b40"),f=i("a403"),h=function(t){Object(r["a"])(i,t);var e=Object(c["a"])(i);function i(){var t;return Object(n["a"])(this,i),t=e.apply(this,arguments),t.entryList=[],t}return Object(o["a"])(i,[{key:"_queryEntryid",value:function(){var t=this;Object(f["t"])().then((function(e){t.entryList=e.data,1===e.data.length&&t.$emit("entryChangeClick",e[0])}))}},{key:"cellClick",value:function(t){this.$emit("entryChangeClick",t)}},{key:"mounted",value:function(){this._queryEntryid()}}]),i}(u["d"]);h=Object(l["a"])([Object(u["a"])({})],h);var d=h,m=d,p=(i("e028"),i("2877")),b=Object(p["a"])(m,a,s,!1,null,"92b1c30c",null);e["a"]=b.exports}}]);