(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-09f6130d"],{2835:function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"m",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return y})),n.d(t,"k",(function(){return x})),n.d(t,"n",(function(){return D})),n.d(t,"j",(function(){return j})),n.d(t,"l",(function(){return C})),n.d(t,"o",(function(){return _})),n.d(t,"d",(function(){return S})),n.d(t,"a",(function(){return U}));var a=n("1da1"),r=(n("96cf"),n("b32d")),i=n("90ae");function s(e){return c.apply(this,arguments)}function c(){return c=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/taskApproval/queryCountReceive",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function o(){return u.apply(this,arguments)}function u(){return u=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].get(i["d"],"/api/task/specific",{},!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return d=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/receive/queryCount",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return f=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(i["d"],"/api/crmCollectionClaim/getUnUploadNum",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return v=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(i["c"],"/api/taskApproval/querySend",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function g(e){return b.apply(this,arguments)}function b(){return b=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(i["c"],"/api/taskApproval/queryReceive",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function m(e){return k.apply(this,arguments)}function k(){return k=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/taskApproval/delete",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return w=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/taskApproval/queryDepOrGroup",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function x(e){return T.apply(this,arguments)}function T(){return T=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/taskApproval/queryTag",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function D(e){return O.apply(this,arguments)}function O(){return O=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/taskApproval/submitReturn",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function j(e){return L.apply(this,arguments)}function L(){return L=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/taskApproval/querySendMsgDetail",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}function C(e){return R.apply(this,arguments)}function R(){return R=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/taskApproval/queryWxMsg",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function _(e){return I.apply(this,arguments)}function I(){return I=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/taskApproval/urgeReply",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function S(e){return P.apply(this,arguments)}function P(){return P=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].formDataPost(i["c"],"/api/taskApproval/modifyReceiveStatus",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}function U(e){return A.apply(this,arguments)}function A(){return A=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(i["c"],"/api/taskApproval/add",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}},"388f":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"d-flex align-center pa-10 white-bg"},[e.isImage(e.data.fileType)?n("van-image",{attrs:{src:""+e.$root.domainUrl+e.data.fileUrl,width:"30",height:"30"},on:{click:function(t){return e.previewFile(e.data)}}}):n("app-icon",{staticClass:"font-30",attrs:{name:"#ytcrm-word"},on:{click:function(t){return e.previewFile(e.data)}}}),n("div",{staticClass:"flex-1 mx-2 slh color-main-2 text-underline",on:{click:function(t){return e.previewFile(e.data)}}},[e._v(" "+e._s(e.data.fileName)+"."+e._s(e.data.fileType)+" ")]),e.isUpload?n("div",{staticClass:"color-red",on:{click:function(t){return e.removeFile(e.data)}}},[e._v("删除")]):n("div",{staticClass:"color-main-2",on:{click:function(t){return e._downloadFile(e.data)}}},[e._v("点击下载")])],1),n("van-popup",{staticClass:"full-HW",attrs:{closeable:""},model:{value:e.fileShow,callback:function(t){e.fileShow=t},expression:"fileShow"}},[n("iframe",{staticClass:"file-div",attrs:{src:e.fileUrl,frameborder:"0"}})]),e.previewShow?n("OfficePreview",{attrs:{fileUrl:e.fileUrl,show:e.previewShow},on:{"update:show":function(t){e.previewShow=t}}}):e._e()],1)},r=[],i=(n("4662"),n("28a2")),s=n("d4ec"),c=n("bee2"),o=n("262e"),u=n("2caf"),l=(n("caad"),n("99af"),n("2532"),n("9ab4")),d=n("1b40"),p=n("4915"),f=n.n(p),h=["xls","xlsx"],v=["docx","doc","xls","xlsx","xlsb","xlsm","pdf","pptx","ppsx","ppt","pps","potx","ppsm"],g=function(e){Object(o["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(s["a"])(this,n),e=t.apply(this,arguments),e.fileShow=!1,e.previewShow=!1,e.fileUrl="",e.excelTypes=h,e.officeTypes=v,e}return Object(c["a"])(n,[{key:"isImage",value:function(e){var t=["png","jpg","jpeg","bmp","gif","webp","psd","svg","tiff"];return t.includes(e)}},{key:"previewFile",value:function(e){var t="".concat(this.$root.domainUrl).concat(e.fileUrl);this.isImage(e.fileType)?Object(i["a"])([t]):this.officeTypes.includes(e.fileType)?(this.fileUrl=t,this.previewShow=!0):this.$toast("该类型文件暂不支持预览")}},{key:"_downloadFile",value:function(e){this.$emit("download",e)}},{key:"removeFile",value:function(e){this.$emit("remove",e)}},{key:"onDataChange",value:function(e){this.data=e,this.$forceUpdate()}}]),n}(d["d"]);Object(l["a"])([Object(d["c"])({type:Object,default:{}})],g.prototype,"data",void 0),Object(l["a"])([Object(d["c"])({type:Boolean,default:!1})],g.prototype,"isUpload",void 0),Object(l["a"])([Object(d["e"])("data",{deep:!0})],g.prototype,"onDataChange",null),g=Object(l["a"])([Object(d["a"])({components:{OfficePreview:f.a}})],g);var b=g,m=b,k=(n("82b5"),n("2877")),y=Object(k["a"])(m,a,r,!1,null,"aae349d4",null);t["a"]=y.exports},4376:function(e,t,n){"use strict";n("bc4d")},"82b5":function(e,t,n){"use strict";n("aa75")},8642:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pb-100"},[n("div",{staticClass:"font-14 pa-10"},[e._v("新增任务")]),n("van-form",{attrs:{"validate-first":""},on:{failed:e.onFailed}},[n("van-field",{attrs:{clickable:"",required:"",label:"事件分类","input-align":"right",placeholder:"点击选择事件分类",rules:[{validator:e.validator,message:"请选择事件分类"}]},on:{click:function(t){return e.chooseFilter(2)}},model:{value:e.labelText,callback:function(t){e.labelText=t},expression:"labelText"}}),n("div",{staticClass:"white-bg d-flex justify-space-between px-4 mt-2 van-cell"},[n("div",{staticClass:"font-14 color-gray-5"},[e._v("事件时效")]),n("div",{staticClass:"d-flex align-center"},[n("div",{class:e.dateRangeText?"":"color-gray-3",on:{click:function(t){return e.chooseFilter(1)}}},[e._v(" "+e._s(e.dateRangeText||"点击选择事件时效")+" ")]),e.dateRangeText?n("van-icon",{staticClass:"ml-2",attrs:{name:"close"},on:{click:function(t){e.dateRange=[]}}}):e._e()],1)]),n("div",{staticClass:"white-bg d-flex justify-space-between px-4 mt-2 van-cell van-cell--required"},[n("div",{staticClass:"font-14 color-gray-5"},[e._v("紧急程度")]),n("app-radio",{attrs:{status:e.urgency,options:e.urgencyList},on:{"update:status":function(t){e.urgency=t}}})],1),n("div",{staticClass:"white-bg d-flex justify-space-between px-4 mt-2 van-cell van-cell--required"},[n("div",{staticClass:"font-14 color-gray-5"},[e._v("是否需要回执")]),n("app-radio",{attrs:{status:e.isReturn,options:e.isReturnList},on:{"update:status":function(t){e.isReturn=t}}})],1),n("van-field",{staticClass:"mt-2",attrs:{clickable:"",required:"",label:"发送至","input-align":"right",placeholder:"点击选择人员",rules:[{validator:e.validator,message:"请选择人员"}]},on:{click:function(t){return e.chooseFilter(5)}},model:{value:e.sendPersonsText,callback:function(t){e.sendPersonsText=t},expression:"sendPersonsText"}}),n("van-field",{staticClass:"mt-2",attrs:{clearable:"",required:"",label:"标题","input-align":"right",placeholder:"请输入标题",rules:[{validator:e.validator,message:"请输入标题"}]},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),n("van-field",{staticClass:"mt-2",staticStyle:{display:"block"},attrs:{clearable:"",required:"",rows:"2",autosize:"",type:"textarea",label:"内容",placeholder:"请输入内容",rules:[{validator:e.validator,message:"请输入内容"}]},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),n("app-cell",{staticClass:"mt-2",attrs:{title:"附件"}},[n("van-uploader",{staticClass:"color-main-2",attrs:{"after-read":e.afterRead,"preview-image":!1,"max-size":10485760,accept:""},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}},[e._v(" 点击添加附件 ")])],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.fileList.length,expression:"fileList.length"}],staticClass:"mt-1"},e._l(e.fileList,(function(t){return n("file-item",{key:t.index,attrs:{data:t,isUpload:""},on:{remove:function(n){return e.removeFile(t)}}})})),1),n("div",{staticClass:"footer d-flex justify-center"},[n("submit-btn",{staticClass:"mr-3",attrs:{disabled:e.publishLoading,title:"取消",type:"cancel"},on:{click:e.goBack}}),n("submit-btn",{attrs:{loading:e.publishLoading,title:"提交"},on:{click:e.submit}})],1),1===e.actionType?n("van-calendar",{attrs:{color:"#2271f5",type:"range",title:"选择时间范围","allow-same-day":"","min-date":e.minDate,"default-date":e.dateRange[0]?[new Date(e.dateRange[0]),new Date(e.dateRange[1])]:[]},on:{confirm:e.onDateChange},model:{value:e.actionShow,callback:function(t){e.actionShow=t},expression:"actionShow"}}):e._e(),2===e.actionType?n("van-popup",{attrs:{position:"bottom",round:""},model:{value:e.actionShow,callback:function(t){e.actionShow=t},expression:"actionShow"}},[n("van-tree-select",{attrs:{"active-color":"#363636",items:e.labelTreeList,"active-id":e.activeId,"main-active-index":e.activeIndex},on:{"update:activeId":function(t){e.activeId=t},"update:active-id":function(t){e.activeId=t},"update:mainActiveIndex":function(t){e.activeIndex=t},"update:main-active-index":function(t){e.activeIndex=t},"click-item":e.onLabelChange}})],1):e._e(),5===e.actionType?n("send-person-popup",{attrs:{show:e.actionShow,sendPersons:e.sendPersons,checkedTree:e.checkedTree,depTreeList:e.depTreeList,tagDataList:e.tagDataList,groupTreeList:e.groupTreeList},on:{confirm:e.onSendConfirm,cancel:function(t){e.actionShow=!1}}}):e._e()],1)},r=[],i=n("2909"),s=n("1da1"),c=n("d4ec"),o=n("bee2"),u=n("262e"),l=n("2caf"),d=(n("96cf"),n("99af"),n("d81d"),n("b0c0"),n("4de4"),n("d3b7"),n("159b"),n("caad"),n("2532"),n("9ab4")),p=n("1b40"),f=n("4bb5"),h=n("388f"),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-popup",{staticClass:"full-height d-flex flex-column",attrs:{position:"bottom"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("van-tabs",{staticClass:"flex-1 overflow-hidden",attrs:{color:"#2271f5","title-inactive-color":"#969799","lazy-render":!1},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("van-search",{attrs:{placeholder:"搜索","input-align":"center"},on:{input:e.onInput},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),n("van-tab",{attrs:{title:"部门/人员"}},[n("vs-tree",{ref:"depTree",staticClass:"tree-div",attrs:{data:e.depTreeList,maxHeight:"100%",options:e.options,showLine:"",expandLevel:-1,checkedKeys:e.checkedTree.checkedDep,showCheckbox:""},on:{change:e.onCheckedChange}}),e.depTreeList.length?e._e():n("app-empty",{staticClass:"mt-7",attrs:{description:"暂无部门/人员"}})],1),n("van-tab",{attrs:{title:"标签"}},[n("vs-tree",{ref:"tagTree",staticClass:"tree-div",attrs:{data:e.tagDataList,maxHeight:"100%",options:e.options,checkedKeys:e.checkedTree.checkedTag,showCheckbox:"",checkOnClickNode:""},on:{change:e.onCheckedChange}}),e.tagDataList.length?e._e():n("app-empty",{staticClass:"mt-7",attrs:{description:"暂无标签"}})],1),n("van-tab",{attrs:{title:"小组"}},[n("vs-tree",{ref:"groupTree",staticClass:"tree-div",attrs:{data:e.groupTreeList,maxHeight:"100%",options:e.options,checkedKeys:e.checkedTree.checkedGroup,showCheckbox:"",checkOnClickNode:""},on:{change:e.onCheckedChange}}),e.groupTreeList.length?e._e():n("app-empty",{staticClass:"mt-7",attrs:{description:"暂无小组"}})],1)],1),n("div",{staticClass:"d-flex align-center px-4 py-10",staticStyle:{background:"#f7f8fa"}},[n("div",{staticClass:"flex-1 color-main-2 font-14 d-flex align-center",on:{click:function(t){e.checkedShow=!0}}},[e._v(" 已选"+e._s(e.checkedPersons.length)+"人 "),n("van-icon",{staticClass:"ml-3",attrs:{name:"arrow-"+(e.checkedShow?"up":"down"),size:"16px"}})],1),n("van-button",{staticStyle:{width:"72px"},attrs:{size:"small",block:"",round:""},on:{click:e.cancel}},[e._v("取消")]),n("van-button",{staticClass:"ml-4",staticStyle:{width:"72px"},attrs:{type:"info",size:"small",block:"",round:"",color:"#3561F2"},on:{click:e.onTreeConfirm}},[e._v("确认")])],1),n("van-popup",{style:{height:"60%"},attrs:{position:"bottom",round:"",closeable:""},model:{value:e.checkedShow,callback:function(t){e.checkedShow=t},expression:"checkedShow"}},[n("div",{staticClass:"font-16 font-bold textAlignC my-3"},[e._v("已选"+e._s(e.checkedPersons.length)+"人")]),n("div",{staticClass:"overflow-y-auto",staticStyle:{height:"calc(100% - 125px)"}},e._l(e.checkedPersons,(function(t){return n("van-cell",{key:t.userId,attrs:{clickable:""},scopedSlots:e._u([{key:"title",fn:function(){return[n("span",[e._v(e._s(t.sendUserId)+"/"+e._s(t.sendUser))])]},proxy:!0}],null,!0)})})),1),n("div",{staticClass:"dropdown-opts"},[n("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:function(t){e.checkedShow=!1}}},[e._v("取消")]),n("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",block:"",round:"",color:"#2271F5"},on:{click:function(t){e.checkedShow=!1}}},[e._v("确认")])],1)])],1)},g=[],b=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.keywords="",e.active=0,e.checkedShow=!1,e.checkedPersons=[],e.options={virtual:{showCount:40}},e}return Object(o["a"])(n,[{key:"onInput",value:function(e){switch(this.active){case 0:this.$refs.depTree.filter(e);break;case 1:this.$refs.tagTree.filter(e);break;case 2:this.$refs.groupTree.filter(e);break;default:break}}},{key:"onCheckedChange",value:function(){var e=this;this.checkedPersons=[];var t=this.$refs.depTree;t&&t.getCheckedNodes().forEach((function(t){t.isUser&&e.checkedPersons.push({distributeId:t.depId,distribute:t.depName,orderType:1,sendUserId:t.userId,sendUser:t.name})}));var n=this.$refs.tagTree;n&&n.getCheckedNodes().forEach((function(t){t.targetUsers&&(e.checkedPersons=[].concat(Object(i["a"])(e.checkedPersons),Object(i["a"])(t.targetUsers)))}));var a=this.$refs.groupTree;a&&a.getCheckedNodes().forEach((function(t){t.users&&(e.checkedPersons=[].concat(Object(i["a"])(e.checkedPersons),Object(i["a"])(t.users)))}))}},{key:"onTreeConfirm",value:function(){this.$emit("confirm",this.checkedPersons)}},{key:"cancel",value:function(){this.$emit("cancel")}},{key:"mounted",value:function(){this.checkedPersons=Object(i["a"])(this.sendPersons)}}]),n}(p["d"]);Object(d["a"])([Object(p["c"])({type:Boolean,default:!1})],b.prototype,"show",void 0),Object(d["a"])([Object(p["c"])({type:Array,default:[]})],b.prototype,"depTreeList",void 0),Object(d["a"])([Object(p["c"])({type:Array,default:[]})],b.prototype,"tagDataList",void 0),Object(d["a"])([Object(p["c"])({type:Array,default:[]})],b.prototype,"groupTreeList",void 0),Object(d["a"])([Object(p["c"])({type:Array,default:[]})],b.prototype,"sendPersons",void 0),Object(d["a"])([Object(p["c"])({type:Object,default:{}})],b.prototype,"checkedTree",void 0),b=Object(d["a"])([Object(p["a"])({})],b);var m=b,k=m,y=(n("fa65"),n("2877")),w=Object(y["a"])(k,v,g,!1,null,"ea710628",null),x=w.exports,T=n("d926"),D=n("2835"),O=n("f727"),j=Object(f["a"])("app"),L=[{name:1,label:"普通"},{name:2,label:"重要"},{name:3,label:"紧急"}],C=[{name:1,label:"需要"},{name:0,label:"不需要"}],R=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.activeId=-1,e.activeIndex=0,e.labelTreeList=[],e.loading=!1,e.publishLoading=!1,e.actionShow=!1,e.actionType=0,e.minDate=new Date(2010,0,1),e.urgencyList=L,e.isReturnList=C,e.dateRange=[],e.bigLabelValue={},e.labelValue={},e.urgency=1,e.isReturn=1,e.title="",e.content="",e.depTreeList=[],e.groupTreeList=[],e.tagDataList=[],e.active=0,e.sendPersons=[],e.fileList=[],e.searchTreeValue="",e.checkedTree={},e.idxKey=1,e}return Object(o["a"])(n,[{key:"labelText",get:function(){return this.labelValue.id?"".concat(this.bigLabelValue.text,"/").concat(this.labelValue.text):""}},{key:"dateRangeText",get:function(){return this.dateRange[0]?"".concat(this.dateRange[0]," 至 ").concat(this.dateRange[1]):""}},{key:"sendPersonsText",get:function(){return this.sendPersons.length?"".concat(this.sendPersons.length,"人"):""}},{key:"_getLabelTree",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={type:"1"},e.next=3,Object(O["e"])(t);case 3:n=e.sent,this.labelTreeList=n.data.map((function(e){var t=[];return e.CHILD_LIST.length&&(t=e.CHILD_LIST.map((function(e){var t=e.LABEL_ID,n=e.LABEL_NAME;return{id:t,text:n}}))),e.LABEL_ID===a.bigLabelValue.id&&a.$set(a.bigLabelValue,"text",e.LABEL_NAME),{id:e.LABEL_ID,text:e.LABEL_NAME,children:t}})),this.$forceUpdate();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_getDepTree",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,Object(D["g"])({type:1});case 3:t=e.sent,this.loading=!1,t.success&&(this.depTreeList=this.formatTreeData(t.data)),this._geGroupTree();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_geGroupTree",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,Object(D["g"])({type:2});case 3:t=e.sent,this.loading=!1,t.success&&(this.groupTreeList=this.formatTreeDataWithoutUser(t.data));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"formatTreeData",value:function(e){var t=this,n=e.map((function(e){var n=e.depId,a=e.depName,r=e.childDeps,s=e.depUsers,c=t.formatTreeData(r),o=s.map((function(e){var t=e.userId,r=e.userName;return{id:"".concat(n,"-").concat(t),name:r,isUser:1,userId:t,depId:n,depName:a}}));return{id:n,name:a,children:[].concat(Object(i["a"])(c),Object(i["a"])(o)),depUsers:s}}));return n}},{key:"formatTreeDataWithoutUser",value:function(e){var t=this,n=e.map((function(e){var n=e.depId,a=e.depName,r=e.childDeps,s=e.depUsers,c=t.formatTreeDataWithoutUser(r),o=s.map((function(e){return{distributeId:n,distribute:a,orderType:3,sendUserId:e.userId,sendUser:e.userName}}));return{id:n,name:a,children:Object(i["a"])(c),users:o}}));return n}},{key:"_getTags",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,this.tagDataList=[],e.next=4,Object(D["k"])({});case 4:t=e.sent,this.loading=!1,t.success&&(this.tagDataList=t.data.map((function(e){var t=e.tagId,n=e.tagName,a=e.users,r=a.map((function(e){return{distributeId:t,distribute:n,orderType:2,sendUserId:e.userId,sendUser:e.userName}}));return{id:t,name:n,targetUsers:r}})));case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"chooseFilter",value:function(e){this.actionShow=!0,this.actionType=e}},{key:"onDateChange",value:function(e){this.isValidDate(e[0])&&this.isValidDate(e[1])?(this.actionShow=!1,this.dateRange=[Object(T["c"])(e[0]),Object(T["c"])(e[1])]):this.$toast("请选择时间范围")}},{key:"isValidDate",value:function(e){return e instanceof Date&&!isNaN(e.getTime())}},{key:"onLabelChange",value:function(e){this.actionShow=!1,this.labelValue=e,this.bigLabelValue=this.labelTreeList[this.activeIndex]}},{key:"onSendConfirm",value:function(e){this.sendPersons=e,this.actionShow=!1}},{key:"validator",value:function(e){}},{key:"onFailed",value:function(e){}},{key:"afterRead",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.status="uploading",t.message="上传中...",t.index="".concat(t.file.name,"-").concat(this.idxKey++),e.next=6,Object(O["l"])({file:t.file});case 6:n=e.sent,n.success?(t.status="success",t.message="上传成功",t.result=n.data,a=t.result,r=a.fileName,i=a.suffix,s=a.fullPath,t.fileName=r,t.fileType=i,t.fileUrl=s,this.$forceUpdate()):(t.status="failed",t.message="上传失败");case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"removeFile",value:function(e){this.fileList=this.fileList.filter((function(t){return t.index!==e.index}))}},{key:"submit",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.fileList.map((function(e){var t=e.result,n=t.fileName,a=t.suffix,r=t.fullPath;return{fileName:n,fileType:a,fileUrl:r}})),n={bigTagId:this.bigLabelValue.id,smallTagId:this.labelValue.id,eventAgeingStart:this.dateRange[0]||"",eventAgeingEnd:this.dateRange[1]||"",emergencyLevel:this.urgency,isReturn:this.isReturn,orderTitle:this.title,orderContent:this.content,files:t,sendPersons:this.sendPersons,synergiaType:0},n.smallTagId){e.next=5;break}return this.$toast("事件分类不能为空"),e.abrupt("return");case 5:if(n.emergencyLevel){e.next=8;break}return this.$toast("紧急程度不能为空"),e.abrupt("return");case 8:if(0===+n.isReturn||1===+n.isReturn){e.next=11;break}return this.$toast("是否需要回执不能为空"),e.abrupt("return");case 11:if(n.sendPersons.length){e.next=14;break}return this.$toast("发送至不能为空"),e.abrupt("return");case 14:if(n.orderTitle){e.next=17;break}return this.$toast("标题不能为空"),e.abrupt("return");case 17:if(n.orderContent){e.next=20;break}return this.$toast("内容不能为空"),e.abrupt("return");case 20:return this.publishLoading=!0,this.publishLoading=!1,e.next=24,Object(D["a"])(n);case 24:a=e.sent,a.success&&(this.SET_HADDONEONDETAIL(!0),this.$toast.success(a.msg||"发送成功"),setTimeout((function(){r.$router.back()}),500));case 26:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"goBack",value:function(){this.$router.back()}},{key:"created",value:function(){var e=this,t=this.$route.params.detail;t&&(this.urgency=t.emergencyLevel,this.isReturn=t.isReturn,this.dateRange=[t.eventAgeingStart,t.eventAgeingEnd],this.bigLabelValue={id:t.bigTagId},this.labelValue={id:t.smallTagId,text:t.smallTag},this.title=t.orderTitle,this.content=t.orderContent,this.fileList=t.files.map((function(e,t){var n=e.fileName,a=e.fileType,r=e.fileUrl;return{fileName:n,fileType:a,fileUrl:r,index:"".concat(n,"-").concat(t),result:{fileName:n,suffix:a,fullPath:r}}})),this.idxKey=this.fileList.length,this.sendPersons=[],this.checkedTree={checkedDep:[],checkedTag:[],checkedGroup:[]},t.sendList.map((function(t){var n=t.sendUserId,a=t.sendUserName,r=t.sendTypeList;r.forEach((function(t){var r=t.distributeId,i=t.distribute,s=t.orderType;e.sendPersons.push({distributeId:r,distribute:i,orderType:s,sendUserId:n,sendUser:a}),1===s?e.checkedTree.checkedDep.push("".concat(r,"-").concat(n)):2!==s||e.checkedTree.checkedTag.includes(r)?3!==s||e.checkedTree.checkedGroup.includes(r)||e.checkedTree.checkedGroup.push(r):e.checkedTree.checkedTag.push(r)}))}))),this._getLabelTree(),this._getDepTree(),this._getTags()}}]),n}(p["d"]);Object(d["a"])([j.Mutation],R.prototype,"SET_HADDONEONDETAIL",void 0),R=Object(d["a"])([Object(p["a"])({components:{SendPersonPopup:x,FileItem:h["a"]}})],R);var _=R,I=_,S=(n("4376"),Object(y["a"])(I,a,r,!1,null,"3417d6fd",null));t["default"]=S.exports},aa75:function(e,t,n){},bc4d:function(e,t,n){},c2fd:function(e,t,n){},d926:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"i",(function(){return h})),n.d(t,"k",(function(){return v})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return m})),n.d(t,"f",(function(){return k})),n.d(t,"a",(function(){return y})),n.d(t,"h",(function(){return w}));n("d3b7"),n("25f0"),n("ac1f"),n("1276");var a=n("5a0c"),r=n.n(a),i=new Date,s=i.getDay(),c=i.getDate(),o=i.getMonth(),u=i.getYear();u+=u<2e3?1900:0;var l=new Date;function d(e){var t=new Date(e),n=t.getFullYear(),a=(t.getMonth()+1).toString(),r=t.getDate().toString();return+a<10&&(a="0"+a),+r<10&&(r="0"+r),n+"-"+a+"-"+r}function p(e){var t=new Date(e),n=t.getFullYear(),a=(t.getMonth()+1).toString(),r=t.getDate().toString();return+a<10&&(a="0"+a),+r<10&&(r="0"+r),n+"/"+a+"/"+r}function f(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t){var n=new Date(t),a=n.getDay();a=0===a?7:a;var r=n.getDate(),i=n.getMonth(),l=n.getYear();l+=l<2e3?1900:0,e=new Date(l,i,r-(a-1))}else e=new Date(u,o,c-(s-1));return d(e)}function h(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t){var n=new Date(t),a=n.getDay();a=0===a?7:a;var r=n.getDate(),i=n.getMonth(),l=n.getYear();l+=l<2e3?1900:0,e=new Date(l,i,r+(6-(a-1)))}else e=new Date(u,o,c+(6-(s-1)));return d(e)}function v(e){return 0===r()(e).day()?r()(e).startOf("week").subtract(6,"day").format("YYYY-MM-DD"):r()(e).startOf("week").add(1,"day").format("YYYY-MM-DD")}function g(e){return 0===r()(e).day()?r()(e).endOf("week").subtract(6,"day").format("YYYY-MM-DD"):r()(e).endOf("week").add(1,"day").format("YYYY-MM-DD")}l.setDate(1),l.setMonth(l.getMonth()-1);var b=function(e,t){var n=[],a=e.split("-"),r=t.split("-"),i=new Date(a+" 08:00:00");i.setUTCFullYear(a[0],a[1]-1,a[2]);var s=new Date(r+" 08:00:00");s.setUTCFullYear(r[0],r[1]-1,r[2]);var c,o=i.getTime(),u=s.getTime(),l=864e5;for(c=o;c<=u;)n.push(d(new Date(parseInt(String(c))))),c+=l;return n},m=function(e,t){var n=new Date(e),a="";n.setDate(n.getDate()+t);var r=n.getFullYear(),i=n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,s=n.getDate()<10?"0"+n.getDate():n.getDate();return a=r+"-"+i+"-"+s,a},k=function(e){var t,n,a,r,i=new Date(e+"-01-01"),s=i.getFullYear(),c={result0:[],result1:[],result2:[],result3:[],result4:[],result5:[],result6:[]};for(t=1;t<=12;t++){switch(t){case 1:case 3:case 5:case 7:case 8:case 10:case 12:r=31;break;case 4:case 6:case 9:case 11:r=30;break;case 2:r=s%4===0&&s%100!==0||s%400===0?29:28;break}for(n=1;n<=r;n++){i.setMonth(t-1,n),a=i.getDay();var o=i.getFullYear(),u=i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1,l=i.getDate()<10?"0"+i.getDate():i.getDate();c["result"+a].push(o+"-"+u+"-"+l)}}return c};function y(e){switch(e){case 0:return"日";case 1:return"一";case 2:return"二";case 3:return"三";case 4:return"四";case 5:return"五";case 6:return"六";default:break}}var w=function(e){var t=new Date,n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),i=e.split("-"),s=0;if(a>parseInt(i[0])||a==parseInt(i[0])&&r>parseInt(i[1])){var c=new Date(n+1,parseInt(i[0])-1,parseInt(i[1])).toLocaleDateString(),o=Date.parse(c),u=Date.parse(t.toLocaleDateString());s=(o-u)/864e5}else{var l=new Date(n,parseInt(i[1])-1,parseInt(i[2])).toLocaleDateString(),d=Date.parse(l),p=Date.parse(t.toLocaleDateString());s=(d-p)/864e5}if(s<0){var f=n+1,h=f%4===0&&f%100!==0||f%400===0?366:365;s+=h}return s}},fa65:function(e,t,n){"use strict";n("c2fd")}}]);