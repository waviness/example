(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-89bdb1f4"],{"0bc2":function(t,e,n){},"447f":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pb-100"},[n("div",{staticClass:"pa-10"},[t._v(" "+t._s(1===t.statusType?"初次填报":2===t.statusType?"再次上报":3===t.statusType?"修订上报":4===t.statusType?"回款填报详情":"")+" ")]),1===t.statusType||3===t.statusType?n("div",{},[n("van-cell",{attrs:{title:"部门",value:t.detailObj.deptName,"title-class":"color-gray-5","value-class":"color-black-2"}}),1===t.statusType||2===t.statusType?n("van-field",{attrs:{type:"number",label:"月初上报销售(含税)(万元)",placeholder:"点击输入月初上报销售","input-align":"right"},model:{value:t.inputObj.xsAmount,callback:function(e){t.$set(t.inputObj,"xsAmount",e)},expression:"inputObj.xsAmount"}}):t._e(),n("van-field",{attrs:{type:"number",label:"电汇(万元)",placeholder:"点击输入电汇金额","input-align":"right"},on:{input:t.onInputChange},model:{value:t.inputObj.dhAmount,callback:function(e){t.$set(t.inputObj,"dhAmount",e)},expression:"inputObj.dhAmount"}}),n("van-field",{attrs:{type:"number",label:"承兑(万元)",placeholder:"点击输入承兑金额","input-align":"right"},on:{input:t.onInputChange},model:{value:t.inputObj.chAmount,callback:function(e){t.$set(t.inputObj,"chAmount",e)},expression:"inputObj.chAmount"}}),3===t.statusType?n("van-field",{attrs:{label:"原因",placeholder:"点击输入原因","input-align":"right"},model:{value:t.inputObj.reason,callback:function(e){t.$set(t.inputObj,"reason",e)},expression:"inputObj.reason"}}):t._e(),n("van-cell",{attrs:{title:"合计",value:t.inputObj.total,"title-class":"color-gray-5","value-class":"color-black-2"}})],1):t._e(),2===t.statusType||4===t.statusType?n("div",{},[n("fund-detail-item",{attrs:{data:t.detailObj,lastModify:!!t.historyList.length}}),t.historyList.length?n("van-cell",{staticClass:"mt-3",attrs:{title:"历史记录","is-link":"","arrow-direction":t.arrow},on:{click:function(e){return t.changeArrow()}}}):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:"up"===t.arrow,expression:"arrow === 'up'"}]},t._l(t.historyList,(function(t,e){return n("fund-detail-item",{key:e,attrs:{data:t,useOld:""}})})),1)],1):t._e(),t.readonly||1!==t.statusType&&3!==t.statusType?t._e():n("div",{staticClass:"footer d-flex justify-space-between mx-4"},[n("van-button",{staticClass:"flex-1",attrs:{round:""},on:{click:t.goBack}},[t._v("取消")]),n("van-button",{staticClass:"ml-3 flex-1",attrs:{round:"",color:"#2271F5"},on:{click:t.submit}},[t._v("提交")])],1),!t.readonly&&2===t.statusType&&t.detailObj.isFill?n("div",{staticClass:"footer d-flex justify-space-between mx-7"},[n("van-button",{staticClass:"mx-7 flex-1",attrs:{round:"",color:"#2271F5"},on:{click:function(e){t.statusType=1}}},[t._v("再次上报")])],1):t._e(),!t.readonly&&4===t.statusType&&t.detailObj.isFill?n("div",{staticClass:"footer d-flex justify-space-between mx-7"},[n("van-button",{staticClass:"mx-7 flex-1",attrs:{round:"",color:"#2271F5"},on:{click:t.modifySubmit}},[t._v("修订上报")])],1):t._e()])},r=[],s=n("1da1"),u=n("d4ec"),i=n("bee2"),o=n("262e"),c=n("2caf"),l=(n("d3b7"),n("96cf"),n("9ab4")),d=n("1b40"),p=n("4bb5"),h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("div",{staticClass:"color-gray-4 mx-4 my-2"},[t._v(t._s(t.data.creTime)),t.lastModify?n("span",[t._v("(最近一次修改)")]):t._e()]),n("van-cell-group",[n("van-cell",{attrs:{title:"部门",value:t.data.deptName,"title-class":"color-gray-5","value-class":"color-black-2"}}),n("van-cell",{attrs:{title:"电汇(万元)",value:t.useOld?t.data.oldDhAmount:t.data.dhAmount,"title-class":"color-gray-5","value-class":"color-black-2"}}),n("van-cell",{attrs:{title:"承兑(万元)",value:t.useOld?t.data.oldChAmount:t.data.chAmount,"title-class":"color-gray-5","value-class":"color-black-2"}}),n("van-cell",{attrs:{title:"合计",value:t.useOld?(1e6*t.data.oldDhAmount+1e6*t.data.oldChAmount)/1e6:(1e6*t.data.dhAmount+1e6*t.data.chAmount)/1e6,"title-class":"color-gray-5","value-class":"color-black-2"}})],1)],1)},f=[],b=function(t){Object(o["a"])(n,t);var e=Object(c["a"])(n);function n(){return Object(u["a"])(this,n),e.apply(this,arguments)}return Object(i["a"])(n,[{key:"onClick",value:function(t){this.$emit("click",t,this.data)}}]),n}(d["d"]);Object(l["a"])([Object(d["c"])({type:Object,default:{}})],b.prototype,"data",void 0),Object(l["a"])([Object(d["c"])({type:Boolean,default:!1})],b.prototype,"lastModify",void 0),Object(l["a"])([Object(d["c"])({type:Boolean,default:!1})],b.prototype,"useOld",void 0),b=Object(l["a"])([Object(d["a"])({})],b);var m=b,y=m,v=(n("f294"),n("2877")),O=Object(v["a"])(y,h,f,!1,null,"e4d83e64",null),j=O.exports,g=n("48b8"),w=n("e6bf"),x=Object(p["a"])("app"),k=function(t){Object(o["a"])(n,t);var e=Object(c["a"])(n);function n(){var t;return Object(u["a"])(this,n),t=e.apply(this,arguments),t.modifyAuth=!1,t.statusType=-1,t.detailObj={},t.cffId=t.$route.params.cffId,t.year=t.$route.params.year,t.month=t.$route.params.month,t.readonly=!1,t.loading=!1,t.arrow="down",t.historyList=[],t.inputObj={xsAmount:"",dhAmount:"",chAmount:"",reason:""},t}return Object(i["a"])(n,[{key:"changeArrow",value:function(){this.arrow="down"===this.arrow?"up":"down"}},{key:"onInputChange",value:function(){this.inputObj.total=(1e6*+this.inputObj.dhAmount+1e6*+this.inputObj.chAmount)/1e6}},{key:"getHistory",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(w["g"])({cffId:this.cffId});case 2:e=t.sent,e.success&&(this.historyList=e.data);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getDetail",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,Object(w["f"])({cffId:this.cffId});case 3:e=t.sent,this.loading=!1,e.success&&(this.detailObj=e.data),this.detailObj.isFill&&this.getHistory(),n=(new Date).getFullYear(),a=(new Date).getMonth()+1,r=(new Date).getDate(),this.year>n||this.year===n&&this.month>a?r>=26?(this.statusType=this.detailObj.addFlag>=2?4:+this.detailObj.addFlag+1,this.readonly=this.detailObj.addFlag>=2):(this.statusType=4,this.readonly=!0):this.year===n&&this.month===a?r>=25?(this.statusType=4,this.readonly=this.detailObj.modifyFlag>=1&&!this.modifyAuth):r<=4?(this.statusType=this.detailObj.addFlag>=2?4:+this.detailObj.addFlag+1,this.readonly=this.detailObj.addFlag>=2):(this.statusType=4,this.readonly=!this.modifyAuth):(this.statusType=4,this.readonly=!this.modifyAuth);case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"modifySubmit",value:function(){this.statusType=3,this.inputObj={xsAmount:"",dhAmount:"",chAmount:"",reason:""}}},{key:"goBack",value:function(){1===this.statusType||2===this.statusType?this.$router.back():this.statusType=4}},{key:"submit",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,a,r,s,u,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.detailObj.isFill||this.inputObj.xsAmount){t.next=3;break}return this.$toast("请输入月初上报销售"),t.abrupt("return");case 3:if(this.inputObj.dhAmount){t.next=6;break}return this.$toast("请输入电汇金额"),t.abrupt("return");case 6:if(this.inputObj.chAmount){t.next=9;break}return this.$toast("请输入承兑金额"),t.abrupt("return");case 9:if(!(this.detailObj.addFlag>=2)||this.inputObj.reason){t.next=12;break}return this.$toast("请输入原因"),t.abrupt("return");case 12:if(e=this.inputObj,n=e.xsAmount,a=e.dhAmount,r=e.chAmount,s=e.reason,u={},1!==this.statusType){t.next=21;break}return i={cffId:this.cffId,xsAmount:n,dhAmount:a,chAmount:r,addFlag:this.detailObj.addFlag},t.next=18,Object(w["a"])(i);case 18:u=t.sent,t.next=25;break;case 21:return o={cffId:this.cffId,dhAmount:a,chAmount:r,reason:s,modifyFlag:this.detailObj.modifyFlag},t.next=24,Object(w["c"])(o);case 24:u=t.sent;case 25:u.success?(this.$toast.success(u.msg||"提交成功"),this.SET_HADDONEONDETAIL(!0),1===this.statusType?this.$router.back():(this.statusType=4,this.getDetail())):this.$toast.fail(u.msg||"提交失败");case 26:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){var t,e=Object(g["c"])((null===(t=this.userInfor)||void 0===t?void 0:t.resListTree)||"","回款填报",[],1);this.modifyAuth=e.some((function(t){return"全局修改权限"===t.pmsName})),this.cffId=this.$route.params.cffId,this.year=this.$route.params.year,this.month=this.$route.params.month,this.getDetail()}}]),n}(d["d"]);Object(l["a"])([x.Getter],k.prototype,"userInfor",void 0),Object(l["a"])([x.Mutation],k.prototype,"SET_HADDONEONDETAIL",void 0),k=Object(l["a"])([Object(d["a"])({components:{FundDetailItem:j}})],k);var A=k,T=A,F=(n("94b2"),Object(v["a"])(T,a,r,!1,null,"f65efe6a",null));e["default"]=F.exports},"94b2":function(t,e,n){"use strict";n("0bc2")},dad5:function(t,e,n){},e6bf:function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return o})),n.d(e,"g",(function(){return l})),n.d(e,"f",(function(){return p})),n.d(e,"a",(function(){return f})),n.d(e,"c",(function(){return m})),n.d(e,"i",(function(){return v})),n.d(e,"h",(function(){return O})),n.d(e,"b",(function(){return j}));var a=n("1da1"),r=(n("96cf"),n("b32d")),s=n("90ae");function u(t){return i.apply(this,arguments)}function i(){return i=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].formDataPost(s["c"],"/api/fund/queryFundForm",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}function o(t){return c.apply(this,arguments)}function c(){return c=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].formDataPost(s["c"],"/api/fund/queryFundDept",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function l(t){return d.apply(this,arguments)}function d(){return d=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].formDataPost(s["c"],"/api/fund/queryFundFormHistory",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}function p(t){return h.apply(this,arguments)}function h(){return h=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].formDataPost(s["c"],"/api/fund/queryFundFormDtl",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}function f(t){return b.apply(this,arguments)}function b(){return b=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].formDataPost(s["c"],"/api/fund/addFundForm",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}function m(t){return y.apply(this,arguments)}function y(){return y=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].formDataPost(s["c"],"/api/fund/modifyFundForm",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}var v=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].formDataPost(s["c"],"/api/fund/queryFundTableBar",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].formDataPost(s["c"],"/api/fund/queryFundTable",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].formDataPost(s["c"],"/api/fund/addPaymentAmount",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},f294:function(t,e,n){"use strict";n("dad5")}}]);