(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74ef60d8"],{"411c":function(e,t,i){"use strict";i("5b7a")},"437a":function(e,t,i){"use strict";var a=i("bee2"),s=i("d4ec"),l=i("262e"),r=i("2caf"),n=i("9ab4"),c=i("1b40"),o=i("4bb5"),d=Object(o["a"])("app"),f=Object(o["a"])("crm");c["a"].registerHooks(["beforeRouteEnter"]);var u=function(e){Object(l["a"])(i,e);var t=Object(r["a"])(i);function i(){var e;return Object(s["a"])(this,i),e=t.apply(this,arguments),e.filterShow=!1,e.filterActive=!1,e.tabType=0,e}return Object(a["a"])(i)}(c["d"]);Object(n["a"])([d.Getter],u.prototype,"userInfor",void 0),Object(n["a"])([f.Mutation],u.prototype,"SET_DETAILOBJ",void 0),Object(n["a"])([d.Mutation],u.prototype,"SET_QUERYPARAMA",void 0),Object(n["a"])([d.Mutation],u.prototype,"SET_HADDONEONDETAIL",void 0),Object(n["a"])([d.Getter],u.prototype,"hadDoneOnDetail",void 0),u=Object(n["a"])([Object(c["a"])({})],u),t["a"]=u},"5b7a":function(e,t,i){},"79de":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"background-color-white full-height overflow-auto"},[i("van-sticky",[i("div",{staticClass:"header pt-10 white-bg"},[i("div",{staticClass:"px-10"},[i("div",{class:["pa-10 common-filter",e.filterShow?"color-main-2":"",e.filterActive?"common-filter--active":""],on:{click:function(t){e.filterShow=!e.filterShow}}},[i("div",[e._v("条件筛选")]),i("van-icon",{attrs:{name:"arrow-"+(e.filterShow?"up":"down"),size:"16px"}})],1)])]),i("div",{staticClass:"font-14 px-4 py-3 background-color-white color-main-2"},[e._v(e._s(e.dateRange)+" (共"+e._s(e.totalDays)+"天)")]),i("div",{staticClass:"font-14 px-4 pb-3 background-color-white"},[e._v(" "+e._s(e.$route.query.companyId)+"/"+e._s(e.$route.query.customerName)+" ")])]),i("div",{staticClass:"px-10 pb-100",attrs:{id:"filterContainer"}},[i("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[i("app-empty",{directives:[{name:"show",rawName:"v-show",value:!e.loading&&!e.dataList.length,expression:"!loading && !dataList.length"}],staticClass:"mt-7",attrs:{description:"暂无数据"}}),e._l(e.dataList,(function(t,a){return i("div",{key:a,staticClass:"card mb-2",on:{click:function(i){return e.visitClick(t)}}},[i("div",{staticClass:"card-header font-16 d-flex align-center justify-space-between"},[i("div",{staticClass:"d-flex align-center"},[i("div",{staticClass:"card-header_block",class:0==t.flag?"height-34":"height-16"}),i("div",{staticClass:"user-info-column"},[i("div",{staticClass:"color-main-3 pl-1"},[e._v(e._s(t.userName))]),0==t.flag?i("div",{staticClass:"remove-tip pl-1 font-10"},[e._v(e._s("客户业务员关系已解除"))]):e._e()])]),i("div",[e._v(" 时间范围内总拜访 "),i("span",{staticClass:"color-main-3"},[e._v(e._s(t.totalNum)+"次")])])]),i("div",{staticClass:"card-content d-flex"},[i("div",{staticClass:"echartsWarp",attrs:{id:"echartsWarp"+a}}),i("div",{staticClass:"d-flex flex-2 font-14 justify-space-between pl-4 pt-4"},[i("ul",[i("li",{staticClass:"d-flex align-center"},[i("span",{staticClass:"cicle cicle-1"}),i("span",{staticClass:"pl-2"},[e._v("拜访")])]),i("li",{staticClass:"pl-4 pt-1 color-main-3"},[e._v(e._s(t.num1))])]),i("ul",[i("li",{staticClass:"d-flex align-center"},[i("span",{staticClass:"cicle cicle-2"}),i("span",{staticClass:"pl-2"},[e._v("协访")])]),i("li",{staticClass:"pl-4 pt-1 color-main-3"},[e._v(e._s(t.num2))])]),i("ul",[i("li",{staticClass:"d-flex align-center"},[i("span",{staticClass:"cicle cicle-3"}),i("span",{staticClass:"pl-2"},[e._v("接待")])]),i("li",{staticClass:"pl-4 pt-1 color-main-3"},[e._v(e._s(t.num3))])])])])])}))],2)],1),i("van-popup",{attrs:{position:"top","get-container":"#filterContainer"},model:{value:e.filterShow,callback:function(t){e.filterShow=t},expression:"filterShow"}},[i("div",[i("van-field",{attrs:{clickable:"",readonly:"",label:"时间范围",placeholder:"点击选择时间范围","input-align":"right"},on:{click:e.showPickerDateClick},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}),i("van-field",{attrs:{readonly:"",clickable:"",label:"事件分类",value:e.filterObj.labelName,"input-align":"right",placeholder:"点击维护事件分类"},on:{click:function(t){e.labelShow=!0}}}),i("van-field",{attrs:{clearable:"",label:"客户职员","input-align":"right",placeholder:"输入客户职员名称"},model:{value:e.filterObj.staffKeyword,callback:function(t){e.$set(e.filterObj,"staffKeyword",t)},expression:"filterObj.staffKeyword"}}),i("div",{staticClass:"dropdown-opts"},[i("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:e.reset}},[e._v("重置")]),i("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",block:"",round:"",color:"#2271F5"},on:{click:e.filterSubmit}},[e._v("确认")])],1)],1)]),e.showPickerDate?i("van-calendar",{attrs:{"default-date":[new Date(e.filterObj.startTime),new Date(e.filterObj.endTime)],"get-container":"#app",type:"range","min-date":e.minDate,maxDate:e.maxDate,color:"#2271F5","allow-same-day":""},on:{confirm:e.onConfirmDate},model:{value:e.showPickerDate,callback:function(t){e.showPickerDate=t},expression:"showPickerDate"}}):e._e(),i("van-popup",{style:{height:"65%"},attrs:{round:"",position:"bottom"},model:{value:e.labelShow,callback:function(t){e.labelShow=t},expression:"labelShow"}},[i("van-tree-select",{attrs:{height:"100%",items:e.labelTreeList,"main-active-index":e.activeIndex},on:{"update:mainActiveIndex":function(t){e.activeIndex=t},"update:main-active-index":function(t){e.activeIndex=t}},scopedSlots:e._u([{key:"content",fn:function(){return[e.labelTreeList.length>0&&e.labelTreeList[e.activeIndex].children?i("ul",{staticClass:"labelTreeWarp"},e._l(e.labelTreeList[e.activeIndex].children,(function(t,a){return i("li",{key:a,class:e.filterObj.labelId===t.LABEL_ID?"active":"",on:{click:function(i){return e.labelTreeItemClick(t)}}},[e._v(" "+e._s(t.LABEL_NAME)+" "),e.filterObj.labelId===t.LABEL_ID?i("van-icon",{staticClass:"right",attrs:{name:"success"}}):e._e()],1)})),0):e._e(),e.labelTreeList.length>0&&0===e.labelTreeList[e.activeIndex].children.length?i("van-empty",{attrs:{description:"暂无信息"}}):e._e()]},proxy:!0}])})],1)],1)},s=[],l=i("5530"),r=i("3835"),n=i("d4ec"),c=i("bee2"),o=i("262e"),d=i("2caf"),f=(i("fb6a"),i("99af"),i("d81d"),i("4de4"),i("d3b7"),i("b0c0"),i("9ab4")),u=i("1b40"),b=i("437a"),h=i("313e"),m=i("e906"),p=i("4bb5"),v=Object(p["a"])("crm"),j=function(e){Object(o["a"])(i,e);var t=Object(d["a"])(i);function i(){var e;return Object(n["a"])(this,i),e=t.apply(this,arguments),e.showPickerDate=!1,e.loading=!1,e.dateRange="",e.minDate=new Date(2010,0,1),e.maxDate=new Date,e.filterObj={startTime:"",endTime:"",staffKeyword:"",labelId:"",labelName:""},e.activeIndex=0,e.labelShow=!1,e.refreshing=!1,e.dataList=[],e}return Object(c["a"])(i,[{key:"showPickerDateClick",value:function(){this.showPickerDate=!0}},{key:"totalDays",get:function(){if(!this.filterObj.startTime||!this.filterObj.endTime)return"";var e=new Date(this.filterObj.startTime.slice(0,10)),t=new Date(this.filterObj.endTime.slice(0,10)),i=Math.floor((t.getTime()-e.getTime())/864e5)+1;return i>0?i:""}},{key:"labelTreeItemClick",value:function(e){this.filterObj.labelId=e.LABEL_ID,this.filterObj.labelName=e.LABEL_NAME,this.labelShow=!1}},{key:"onConfirmDate",value:function(e){var t=Object(r["a"])(e,2),i=t[0],a=t[1];this.filterObj.startTime=this.$dayjs(i).format("YYYY-MM-DD")+" 00:00:00",this.filterObj.endTime=this.$dayjs(a).format("YYYY-MM-DD")+" 23:59:59",this.showPickerDate=!1,this.dateRange="".concat(this.filterObj.startTime.slice(0,10)," 至 ").concat(this.filterObj.endTime.slice(0,10))}},{key:"onRefresh",value:function(){this._chashujuGetUserListVisitWx(),this.refreshing=!1}},{key:"filterSubmit",value:function(){this.onRefresh(),this.filterShow=!1}},{key:"reset",value:function(){this.filterObj.startTime=this.$route.query.startTime,this.filterObj.endTime=this.$route.query.endTime,this.filterObj.labelId="",this.filterObj.labelName="",this.dateRange="".concat(this.filterObj.startTime.slice(0,10)," 至 ").concat(this.filterObj.endTime.slice(0,10)),this.filterObj.staffKeyword="",this.filterShow=!1}},{key:"_chashujuGetUserListVisitWx",value:function(){var e=this;this.loading=!0,Object(m["a"])({companyId:this.$route.query.companyId,startTime:this.filterObj.startTime,endTime:this.filterObj.endTime,depId:this.$route.query.depId,labelIdList:this.filterObj.labelId?[this.filterObj.labelId]:[],visitKeyword:this.filterObj.staffKeyword}).then((function(t){e.loading=!1,t.data&&(e.dataList=t.data.map((function(t,i){return t.crmUserVisitNumListDtos.filter((function(e){t["num"+e.taskType]=e.num})),e.$nextTick((function(){e.getEchartsBar(t,i)})),Object(l["a"])({},t)})))}))}},{key:"getEchartsBar",value:function(e,t){var i=null;i&&i.clear();var a=document.getElementById("echartsWarp"+t);i=h["b"](a);var s,l=["#4970f3","#ffa500","#ff4d4d"];s={color:l,tooltip:{trigger:"item"},series:[{name:"Access From",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},itemStyle:{normal:{color:function(e){return 0===e.value?"#ccc":l[e.dataIndex]}}},labelLine:{show:!1},data:[{value:+e.num1},{value:+e.num2},{value:+e.num3}]}]},s&&i.setOption(s)}},{key:"beforeRouteEnter",value:function(e,t,i){i((function(e){"salesLineCustomerSalesPage"===t.name&&(e.filterObj={startTime:"",endTime:"",staffKeyword:"",labelId:"",labelName:""},e.filterObj.startTime=e.$route.query.startTime,e.filterObj.endTime=e.$route.query.endTime,e.dateRange="".concat(e.filterObj.startTime.slice(0,10)," 至 ").concat(e.filterObj.endTime.slice(0,10)),e.filterActive=!0,e.onRefresh(),e.filterShow=!1)}))}},{key:"created",value:function(){this.labelTreeList.length||this._getLabelTree({type:"1"}),this.filterObj.startTime=this.$route.query.startTime,this.filterObj.endTime=this.$route.query.endTime,this.dateRange="".concat(this.filterObj.startTime.slice(0,10)," 至 ").concat(this.filterObj.endTime.slice(0,10)),this.filterActive=!0}},{key:"visitClick",value:function(e){this.SET_QUERYPARAMA({startTime:this.filterObj.startTime,endTime:this.$route.query.endTime,userIdList:[e.userId],companyId:this.$route.query.companyId}),this.$router.push({name:"salesLineVisitPage"})}},{key:"mounted",value:function(){this._chashujuGetUserListVisitWx()}}]),i}(Object(u["b"])(b["a"]));Object(f["a"])([v.Getter],j.prototype,"labelTreeList",void 0),Object(f["a"])([v.Action],j.prototype,"_getLabelTree",void 0),j=Object(f["a"])([Object(u["a"])({})],j);var y=j,O=y,g=(i("411c"),i("2877")),w=Object(g["a"])(O,a,s,!1,null,"5dc2e083",null);t["default"]=w.exports}}]);