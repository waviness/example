(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app"],{0:function(t,e,a){t.exports=a("cd49")},"027f":function(t,e,a){},"0316":function(t,e,a){},"0490":function(t,e,a){},"04a2":function(t,e,a){},"0575":function(t,e,a){},"064f":function(t,e,a){},"067d":function(t,e,a){},"0959":function(t,e,a){"use strict";a("49be")},"0981":function(t,e,a){t.exports=a.p+"static/img/noImg.53370aff.png"},"09cd":function(t,e,a){"use strict";a("a60b")},"0ea9":function(t,e,a){"use strict";a("1c24")},"0ffc":function(t,e,a){},"11b7":function(t,e,a){},"122b":function(t,e,a){},"12af":function(t,e,a){"use strict";a("d020")},1454:function(t,e,a){},"14fb":function(t,e,a){},"156f":function(t,e,a){"use strict";a("9503")},"17ac":function(t,e,a){},"1a20":function(t,e,a){},"1c24":function(t,e,a){},"1db7":function(t,e,a){"use strict";a("f5df4")},2076:function(t,e,a){"use strict";a("dda5")},2081:function(t,e,a){"use strict";a("9963")},"20f7":function(t,e,a){"use strict";a("edd7")},2112:function(t,e,a){},"23aa":function(t,e,a){},"23eb":function(t,e,a){"use strict";a("8095")},"29af":function(t,e,a){t.exports=a.p+"static/img/inverQuery.1e57041b.jpg"},"29fb":function(t,e,a){"use strict";a("df06")},"2bb5":function(t,e,a){},"2e64":function(t,e,a){"use strict";a("6d87")},"2e68":function(t,e,a){"use strict";a("14fb")},3096:function(t,e,a){"use strict";a("f0ee")},"31f6":function(t,e,a){"use strict";a("71e0")},3318:function(t,e,a){"use strict";a("23aa")},"34af":function(t,e,a){"use strict";a("17ac")},"35d7":function(t,e,a){},"36bf":function(t,e,a){},3776:function(t,e,a){},3931:function(t,e,a){},"3bc3":function(t,e,a){"use strict";a("8852")},"3d65":function(t,e,a){},"3f06":function(t,e,a){"use strict";a("9f1b")},4060:function(t,e,a){"use strict";a("b91a")},4186:function(t,e,a){"use strict";a("514b")},4437:function(t,e,a){"use strict";a("9709")},4482:function(t,e,a){"use strict";a("cd95")},4705:function(t,e,a){},"47a2":function(t,e,a){"use strict";a("0490")},"47f7":function(t,e,a){t.exports=a.p+"static/img/tobrowser.3d8f7c99.png"},"49be":function(t,e,a){},"4f2e":function(t,e,a){"use strict";a("eeeb")},"4f56":function(t,e,a){"use strict";a("a418")},"514b":function(t,e,a){},5549:function(t,e,a){"use strict";a("b23f")},5857:function(t,e,a){"use strict";a("3d65")},"5ac7":function(t,e,a){"use strict";a("cfd6")},"5b61":function(t,e,a){"use strict";a("e66c")},"5c0b":function(t,e,a){"use strict";a("9c0c")},"5c41":function(t,e,a){"use strict";a("36bf")},6472:function(t,e,a){},"6d87":function(t,e,a){},"6dcc":function(t,e,a){},"6df0":function(t,e,a){"use strict";a("122b")},"6ed8":function(t,e,a){},7094:function(t,e,a){},"71e0":function(t,e,a){},7252:function(t,e,a){"use strict";a("0ffc")},"763e":function(t,e,a){"use strict";a("c546")},"765b":function(t,e,a){"use strict";a("9569")},"768d":function(t,e,a){},"783e":function(t,e,a){},"7c7f":function(t,e,a){},"7d38":function(t,e,a){"use strict";a("d0c6")},"7d98":function(t,e,a){"use strict";a("8d97")},"7e39":function(t,e,a){"use strict";a("b74d")},"7ef7":function(t,e,a){},"7ff1":function(t,e,a){"use strict";a("aa5a")},8095:function(t,e,a){},"84bc":function(t,e,a){"use strict";a("2bb5")},"865a":function(t,e,a){"use strict";a("cabb")},8852:function(t,e,a){},"8d97":function(t,e,a){},"8e93":function(t,e,a){"use strict";a("b75e")},9413:function(t,e,a){},"942e":function(t,e,a){"use strict";a("04a2")},"94db":function(t,e,a){},9503:function(t,e,a){},9569:function(t,e,a){},9673:function(t,e,a){"use strict";a("3776")},9709:function(t,e,a){},9963:function(t,e,a){},"9b67":function(t,e,a){"use strict";a("f7f3")},"9c0c":function(t,e,a){},"9e79":function(t,e,a){t.exports=a.p+"static/img/finished.99ff41c6.png"},"9ee2":function(t,e,a){"use strict";a("064f")},"9f1b":function(t,e,a){},a0ff:function(t,e,a){"use strict";a("a4b3")},a274:function(t,e,a){"use strict";a("0575")},a2f0:function(t,e,a){},a418:function(t,e,a){},a4b3:function(t,e,a){},a60b:function(t,e,a){},aa5a:function(t,e,a){},abbd:function(t,e,a){"use strict";a("4705")},acc2:function(t,e,a){"use strict";a("c647")},ae08:function(t,e,a){},af39:function(t,e,a){},b120:function(t,e,a){"use strict";a("1454")},b219:function(t,e,a){"use strict";a("2112")},b23f:function(t,e,a){},b566:function(t,e,a){"use strict";a("6dcc")},b63f:function(t,e,a){},b74d:function(t,e,a){},b75e:function(t,e,a){},b806:function(t,e,a){"use strict";a("f82b")},b91a:function(t,e,a){},bdde:function(t,e,a){"use strict";a("cb34")},bdf3:function(t,e,a){"use strict";a("35d7")},c014:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAdCAYAAADLnm6HAAAAAXNSR0IArs4c6QAABMFJREFUSEvFln1MVXUYx7/n/d7LvagRqEglU+ESGCmKucxMzUy8WYQGhbLcarjZ1mprraWZtdUfblkumxNnQ2hYljh0VibLWSriaxogdoNpvkACCvfl3PP2a+d37CqDe3kJ7ffXvef3nN/z/T3P53mewxBCCO7GIgTa5RPQLh0HIzggpD4N1hEH5k4LMPytUBv2QGnYDaPzUviqjONeuF4ouzMCiK5Caz4IpaEK2sUagBjUMZfwIMTUHMg1X4AoPjie+mhoBejtf0JtqIJybi+IfJ06ZWzDIabMh+D2gIsbB72jGb6KfLrnLNj+3wUQxQ/1j31Q6qugt/5uhZhhwd83DaLbA37sY2A4IRx6+VgJQrUl4OImwLlk2yAFmEBdOWXd1lsNaDJ1wMYmUqdC6gKwzpG9ot1VkQ+joxm2aSsgTS4amADDfw3quZtA3bhoOeAkCOOegOheCD4xC2CYiDWlt3vh2/4S3Xe9uAPssKS+BRBDg9b8iwXUhcO3gIp3Q0zzQBg/D4zk6lchy0c3IXR8K7j4NDjztlrZilSGekcT1PoqKI17QYIdlrEUawGVZgI1IaJTU6jqrYY4qRDc8AfCdl1fLYZx4yJs01dCeriwpwCiBKB6bwLVcvYWUElTLaCSZ4LhxIiOiRqAfOhTKHW7qI1txhuQJi6hv/VrjfB9s8wKf+FOsK7RtwSQUBfkI59DafwB0IIWUK7RENwLad2yrlF9hli7chrB6vdhdF4GeAn2R1ZCzMgLMyEf2YjQyVJwIzPgzC0Jn0dTINdsROhEKX0oJM+CmJELfswUWk59LaIrCB3djNDpcsoHl5AOx5zVYG8LPUDQVZ5HO6Ht0dchPWT1gTADqvcnBH5cBdPQvLltWjGFKxrRVljPI7B/DYx2L8DysE1ZDmlSEcBy3XTrrfXwffuySRFcS3eBdSZ0F0APazmL4KEN0K+epptcvBu26a+BH5PVMwhER+hkGeTazYChgR2RDMec9+g7vS358AaETpWDG50J57Obupn0qAK16WeY+TKuX6CG/NiZcDy5Fgxvo/9NigPVa6FfPUNvJGXmQ8ouBsNLvWeLEHSVPQfDdxX2GW9CnLg4ugBz16x9ta4S8rEtMMl25VfQ1Kje/QhUf0hBNf/bZ68Cnzg5KiZayxn4v3uF8uRaVkVH8O0r6jg2AYOughFj6Du+r5dCbzsPIflx2GevDj+PpiD463oov1VQoTGLNvYwHdD3QFdFAYyOJthnvQMx7Zm+CoRWRee2RSD+v2Gf+RbE9Ny7K8AcWP7KYoDhEFu0G4x9xNAKIJpMGxiROyFlFvSoguDBdVDO7gCflI0Yz2e9RmzwKXB7ENj3LgXzZkuBkDIPtuwVVuc0w1/qAQm0RU3ZoAWYLTd04kuAEyClP0+npflxAk6k/Z8blYHA92/TBhVbtAeMbdjQRYBPmgrtr1p6oGPOGggp82EEOxA6tgVK3U7A0MPO+PunIybnk4jADioC/54mZS2HLfvVboebDcz86FSbDtDx7ViwDvzIjKEXIIyfC8fcDyLOC6IGaXoYlo9argOKQPDAx1DqKsEnToIjZ33k9tt3hwhbDEgAnQWBNrD2e/qclP3VMGAB/T24v3b/u4B/AKrwXhXjlwXAAAAAAElFTkSuQmCC"},c266:function(t,e,a){"use strict";a("af39")},c3b0:function(t,e,a){"use strict";a("783e")},c3e9:function(t,e,a){"use strict";a("f09c")},c546:function(t,e,a){},c647:function(t,e,a){},cabb:function(t,e,a){},cacf:function(t,e,a){},cb34:function(t,e,a){},cc6e:function(t,e,a){"use strict";a("1a20")},cd49:function(t,e,a){"use strict";a.r(e);a("ac1f"),a("466d"),a("5319"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("keep-alive",[t.$route.meta.keepAlive?a("router-view"):t._e()],1),t.$route.meta.keepAlive?t._e():a("router-view"),t.shopCartType&&t.chooseEntry.entryId?a("div",{staticClass:"shopingCartButton",on:{click:function(e){return t.shopingCartClick(!0)}}},[a("van-icon",{attrs:{name:"cart-o"}})],1):t._e(),a("van-popup",{style:{height:"100%"},attrs:{position:"bottom",closeable:""},on:{close:function(e){return t.shopingCartClick(!1)}},model:{value:t.useShopingCartShow,callback:function(e){t.useShopingCartShow=e},expression:"useShopingCartShow"}},[t.useShopingCartShow?a("shop-cart"):t._e()],1)],1)},n=[],r=(a("c975"),a("d4ec")),o=a("bee2"),c=a("262e"),l=a("2caf"),u=a("9ab4"),d=(a("a2f0"),a("1b40")),h=a("4bb5"),p={},m=function(t,e){var a="1.23452384164.123412415";if(void 0!==e){if(null!==document.getElementById(a)){var s=document.getElementById(a);s.parentNode.removeChild(s)}e.style.position="relative";var i=document.createElement("canvas");i.width=250,i.height=200;var n=i.getContext("2d");n.rotate(-20*Math.PI/180),n.font="20px Vedana",n.fillStyle="rgba(200, 200, 200, 0.20)",n.textAlign="left",n.textBaseline="Middle",n.fillText(t,0,4*i.height/5);var r=document.createElement("div");return r.id=a,r.style.pointerEvents="none",r.style.top="0px",r.style.left="0px",r.style.position="absolute",r.style.zIndex="100000",r.style.width="100%",r.style.height="100%",r.style.background="url("+i.toDataURL("image/png")+") left top repeat",e.appendChild(r),a}};p.set=function(t,e){var a=m(t,e);setInterval((function(){null===document.getElementById(a)&&(a=m(t,e))}),500),window.onresize=function(){m(t,e)}};var v=p,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shopCart",attrs:{id:"shopCart"}},[a("div",{staticClass:"shopCartHeader"},[a("div",{staticClass:" fontWeight value header fontSize-16"},[t._v(" 购物车 "),t.dataList.length>0?a("van-button",{staticClass:"right",attrs:{size:"small",plain:"",hairline:"",icon:"exchange",type:"info"},on:{click:function(e){return t.chooseWms("")}}},[t._v(" 批量选择物流中心 ")]):t._e()],1)]),a("div",{staticClass:"shopCartContent"},[t._l(t.dataList,(function(e,s){return a("van-checkbox-group",{key:s,ref:"checkboxGroup",refInFor:!0,on:{change:t.chooseChange},scopedSlots:t._u([{key:"default",fn:function(){return[a("van-checkbox",{attrs:{"icon-size":"18px",name:"all-"+s},on:{click:function(a){return t.handleCheckedAll(s,e.crmCartDtlVOS)}},model:{value:t.chooseLineResult[s],callback:function(e){t.$set(t.chooseLineResult,s,e)},expression:"chooseLineResult[index]"}},[a("span",{staticClass:"fontWeight fontSize-14"},[t._v(t._s(e.customName))])]),a("ul",{staticClass:"commonLine"},[a("li",{staticClass:"oneLine",staticStyle:{"text-indent":"10px",background:"##f5f5f5"}},[a("span",{staticClass:"value fontSize-12"},[t._v(" "+t._s(e.addressId)+"/"+t._s(e.addressName)+" "),a("span",{staticClass:"title"},[t._v("(运输地址)")])])])]),a("van-field",{attrs:{readonly:"",required:"",clickable:"","is-link":"",label:"运输地址",placeholder:"请选择运输地址",value:e.addressName},on:{click:function(a){return t.chooseContact(e,s)}}}),a("van-field",{attrs:{readonly:"",required:"",clickable:"","is-link":"",label:"物流中心",placeholder:"请选择物流中心",value:e.logistcenterName},on:{click:function(e){return t.chooseWms(s)}}}),a("van-field",{attrs:{rows:"1",autosize:"",label:"备注",type:"textarea",placeholder:"请输入总单备注"},model:{value:t.twoPinTotalMemo,callback:function(e){t.twoPinTotalMemo=e},expression:"twoPinTotalMemo"}}),t._l(e.crmCartDtlVOS,(function(i,n){return a("van-checkbox",{key:n,staticClass:"paddingLeft-20 goodsList clearfix",attrs:{"icon-size":"18px",name:i.ccdDocId+"-"+i.ccdDtlId},on:{click:function(a){return t.handleCheckedLine(s,e.crmCartDtlVOS)}}},[a("div",{staticClass:"img left"},[a("img",{attrs:{src:i.smallimglink,alt:""}})]),a("ul",{staticClass:"detail left commonLine"},[a("li",{staticClass:"oneLine"},[i.goodsStatusId?a("van-tag",{attrs:{color:3===i.goodsStatusId?"#FC923F":"rgb(255, 126, 132)"}},[t._v(t._s(i.goodsStatus))]):t._e(),a("span",{class:i.goodsStatusId?"paddingLeft-5":""},[t._v(t._s(i.goodsId)+"/"+t._s(i.goodsName))])],1),a("li",{staticClass:"oneLine"},[a("span",{staticClass:"title"},[t._v("批号信息：")]),a("span",{staticClass:"value fontSize-12"},[t._v(" "+t._s(i.lotNo)+" ")])]),a("li",{staticClass:"oneLine"},[a("span",{staticClass:"title"},[t._v("可销库存：")]),a("span",{staticClass:"value fontSize-12"},[t._v(" "+t._s(i.minQty)+" ")])]),a("li",{staticClass:"oneLine",staticStyle:{"line-height":"28px"}},[a("span",{staticClass:"price text-orange fontSize-14"},[t._v("￥"+t._s(i.price))]),a("span",{staticClass:"right stepper"},[a("span",{staticClass:"right",on:{click:t.overlimit}},[a("van-stepper",{attrs:{step:i.leastsaleqty,integer:"",max:i.minQty},on:{change:function(a){return t.stepperChange(e,i)}},model:{value:i.goodsQty,callback:function(e){t.$set(i,"goodsQty",e)},expression:"cartItem.goodsQty"}})],1)])])])])}))]},proxy:!0}],null,!0),model:{value:t.chooseResult[s],callback:function(e){t.$set(t.chooseResult,s,e)},expression:"chooseResult[index]"}})})),a("van-empty",{directives:[{name:"show",rawName:"v-show",value:0===t.dataList.length,expression:"dataList.length === 0"}],attrs:{description:"暂无数据"}})],2),a("van-submit-bar",{attrs:{price:t.totalPrice},scopedSlots:t._u([{key:"button",fn:function(){return[a("span",{staticClass:"deleteShopCart",on:{click:t.deleteSubmit}},[t._v("删除")]),a("van-goods-action-button",{attrs:{type:"danger",text:"提交订单"},on:{click:t.onSubmit}})]},proxy:!0}])},[a("van-checkbox",{on:{click:t.checkAllClick},model:{value:t.checkedAll,callback:function(e){t.checkedAll=e},expression:"checkedAll"}},[t._v("全选")])],1),a("van-action-sheet",{attrs:{"cancel-text":"取消","close-on-click-action":""},scopedSlots:t._u([{key:"default",fn:function(){return t._l(t.wmsList,(function(e,s){return a("van-cell",{key:s,attrs:{"is-link":""},on:{click:function(a){return t.chooseClick(e)}}},[t._v(t._s(e.wmscenteruOpcode)+"/ "+t._s(e.wmscenterucodename))])}))},proxy:!0}]),model:{value:t.getWmsShow,callback:function(e){t.getWmsShow=e},expression:"getWmsShow"}}),a("van-action-sheet",{attrs:{"cancel-text":"取消","close-on-click-action":""},scopedSlots:t._u([{key:"default",fn:function(){return t._l(t.contactList,(function(e,s){return a("van-cell",{key:s,attrs:{"is-link":""},on:{click:function(a){return t.chooseContactClick(e)}}},[t._v(t._s(e.ADDRESSID)+"/ "+t._s(e.ADDRESS))])}))},proxy:!0}]),model:{value:t.getContactShow,callback:function(e){t.getContactShow=e},expression:"getContactShow"}})],1)},g=[],b=(a("99af"),a("4160"),a("d81d"),a("13d5"),a("45fc"),a("a434"),a("b680"),a("1276"),a("159b"),a("5530")),y=a("2909"),_=(a("b64b"),a("96cf"),a("1da1")),k=(a("a623"),a("caad"),a("d3b7"),a("2532"),a("bc3a")),C=a.n(k),w=a("8c4f"),L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"layout"},[a("div",{staticClass:"layout-content"},[a("keep-alive",[t.$route.meta.keepAlive?a("router-view"):t._e()],1),t.$route.meta.keepAlive?t._e():a("router-view")],1),a("van-tabbar",{attrs:{"active-color":"#363636","inactive-color":"#9b9b9b"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabbarList,(function(e,s){return a("van-tabbar-item",{key:s,attrs:{to:e.to}},[e.isVant?a("van-icon",{attrs:{slot:"icon",name:s===t.active?e.solidIcon:e.lineIcon},slot:"icon"}):a("i",{class:s===t.active?e.solidIcon:e.lineIcon,attrs:{slot:"icon"},slot:"icon"}),t._v(" "+t._s(e.label)+" ")],1)})),1)],1)},x=[],I=(a("841c"),""),S=1,D="",O="";switch(S){case 1:I="http://10.18.14.225:8080//crmweb",D="http://10.18.14.225:8080//authorization",O="http://10.18.14.225:8080//wx";break;case 0:I="";break;default:break}var j=I;function T(t,e,a){return R.apply(this,arguments)}function R(){return R=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new FormData,Object.keys(s).forEach((function(t){i.append(t,s[t]||"")})),t.next=4,iv({url:e+a,method:"post",data:i});case 4:return n=t.sent,t.abrupt("return",n.data);case 6:case"end":return t.stop()}}),t)}))),R.apply(this,arguments)}var N=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",T(D,"/api/login/doLogin",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),A=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:D+"/api/login/agreeAgreement",method:"post",data:e});case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),P=Object(h["b"])("user"),E=Object(h["b"])("commonStore"),M=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.active=0,t.tabbarList=[],t.getCode={},t}return Object(o["a"])(a,[{key:"compareRoute",value:function(t){var e=0;switch(this.tabbarList.map((function(a,s){t===a.to&&(e=s)})),t){case"/home":this.active=e;break;case"/taskIndex":this.active=e;break;case"/customerAnalysis":this.active=e;break;case"/cabinIndex":this.active=e;break;case"/user":this.active=e;break;default:break}}},{key:"getUrlCode",value:function(){var t=location.search,e={};if(-1!==t.indexOf("?"))for(var a=t.substr(1),s=a.split("&"),i=0;i<s.length;i++)e[s[i].split("=")[0]]=s[i].split("=")[1];return e}},{key:"_wxlogin",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s,i,n,r,o,c,l,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,N(e);case 2:if(a=t.sent,!a.success){t.next=31;break}if(1===+a.data.phoneAgreementStatus){t.next=15;break}return s="",s=a.data.phoneReadTime?"登陆协议更新":"登陆协议",i='<h2 style="text-align: center;"><strong>英特集团 CRM 商秘保护及技术应用管理办法</strong></h2>\n        <h2 style="text-align: center;"><strong><strong>（CRM 安全协议）</strong></strong></h2>\n        <p style="text-align: center;">拟 / 版本 21Y0419A</p>\n        <p style="margin: 10px 0 5px 0"><strong><strong>目的</strong></strong></p>\n        <p>依据英特集团《信息化管理制度》《保密管理办法》以及CRM智慧服务项目实施方案管理需求。为防止客情资源作为企业无形资产和核心商密因人为、病毒或黑客攻击造成的重要数据或机密材料丢失、泄露、篡改等严重后果甚至不可挽回损失，确保CRM相关信息的完整性、安全性、可靠性，进一步保证公司各项业务安全、稳定、高效运行，能持续、健康、优质地服务公司内外，同时深度贯彻全面风险管控，结合公司发展实际等，特制定《英特集团 CRM 商秘保护及技术应用管理办法》（以下简称为管理办法），用于指导CRM所有相关工作开展，并作为CRM相关操作、开发、管理等的基石和底层协议。防御外部攻击，防范内部泄露。</p>\n        <p style="margin: 10px 0 5px 0"><strong><strong>总则</strong></strong></p>\n        <p>目标：为内化管理提升，建设卓越CRM平台，制订执行高标准且面向未来，不断适应公司发展需要的CRM相关管理办法，形成对本项目相关涉及保密内容和保密工作的明确执行措施。</p>\n        <p><u>声明：CRM项目所涉及的战略规划、管理方法、客户信息、用户信息、各类数据及设计为公司开发或掌握的核心技术和信息，一旦泄露，无论出于无意还是恶意，都会给公司安全、名誉和利益造成严重甚至重大风险。因此本项目必须全程使用、执行和遵守保密措施。</u></p>\n        <p style="margin: 10px 0 5px 0"><strong><strong>适用范围</strong></strong></p>\n        <p><u>一、本管理办法适用于英特集团及下属企业所有员工（以下简称为内部用户），以及公司外的本软件的授权用户（以下简称为外部用户）。</u>如无特指，以上全部简称为人员或用户。</p>\n        <p>二、本管理办法视同与之相关的信息开发、使用、运维的安全协议。并在其账号第一次登陆时强制弹出，签署同意后方可进入系统。</p>\n        <p style="margin: 10px 0 5px 0"><strong><strong>专有术语和标准定义</strong></strong></p>\n        <ol type="1" style="margin:0pt; padding-left:0pt">\n        <li>1.CRM项目：即&ldquo;客情关系管理智慧服务项目&rdquo;代称（以下简称为CRM），项目总体分为四个阶段，共计五期。项目依托CRM系统软件平台（以下简称为CRM系统或系统）。</li>\n        <li>2.服务：特指项目为授权用户提供的软件服务和数据支持。</li>\n        <li>3.CRM项目组：受集团委托，由集团运营管理部、集团信息中心以及英特药业营运部门共同组成的数字英特下的项目行动专组（以下简称项目组）进行CRM系统设计、开发及运维。在项目筹备前期又称为CRM方案组。</li>\n        <li>4.客户单位：与CRM客情有关的上、下游或平行公司的主体的简称。</li>\n        <li>5.客户人员：与CRM客情有关的上、下游或平行公司的员工的简称。</li>\n        <li>6.系统客户：指在PM4系统中有登记注册的上、下游客户单位的简称。</li>\n        <li>7.内部单位：特指集团内部各下属企业、经营单位等。</li>\n        <li>8.非系统客户：与CRM客情有关，但在PM4系统中没有登记注册的上、下游客户单位的简称。</li>\n        <li>9.外部用户：指经过授权的，可登录CRM系统并访问相关资源的系统或非系统客户人员。外部用户的授权由其关联的业务人员向项目组申请获得。</li>\n        <li>10.字典：定义所有属性的集成面板和描述规范，字典的内容可来自PM4、OA经过项目组审核的内容。</li>\n        <li>11.身份字段：分为必要身份字段和非必要身份字段。前者包含层级和角色，后者为标签、超级组等。身份字段是用户在系统内活动的标识。</li>\n        <li>12.层级：在CRM系统中指各类人员的汇报层级，相比OA中的部门或主职的管理层级更加精细，主要突出各管理层级人员之间的业务属性，明确其一对一或多对一的强汇报关系。CRM内的所有人员，尤其是内部用户，都有各自被系统定义的层级。层级是各类人员尤其是内部用户的必要身份字段之一。</li>\n        <li>13.角色：在CRM系统中指各类人员的工作职责和服务领域，类似于PM4的角色，角色与标签完全锁定，职责内可视。角色是各类人员尤其是内部用户的必要身份字段之一。</li>\n        <li>14.标签：主要指事件、任务、项目的类别，在CRM中延伸成为各个角色能明确或强相关的工作或服务内容。例如，所有的客情事件都必须定义标签（强制标记）。标签必须由项目组核定后加入字典才能使用。</li>\n        <li>15.超级组：另称为项目小组，允许跨部门甚至跨单位的授权内部用户组成小组，组内包含角色和简单层级的定义，同时拥有其相关的标签。与公司重大项目、重要工作等有战略意义相关的小组可通过项目组创建和拥有独立的标签。</li>\n        <li>16.公海数据：基于PM4日常使用范围内可见的，以及内部用户提供的共享资源数据信息。该类信息字段的范围由项目组论证确认后写入字典，在全系统可见。</li>\n        <li>17.敏感数据：通常为一些部门或组织在系统内录入的专用数据，包括机密消息、隐私信息等。也可泛指非公海数据。该类信息字段的范围由项目组论证确认后写入字典。</li>\n        <li>18.权限内可视：另称为向下可视，即用户在各自所在层级以及角色范围内被授权对部分数据可视。例如业务部门经理对其下属负责的客户单位/人员的所有客情事件可视，财务部门经理对财务类标签的所有客情事件可视。</li>\n        <li>19.安全分享（SafeShare）：CRM允许内部用户通过审批，在被授权的情况下将自有创建的敏感数据分享给其他内部用户使之可见的行为。</li>\n        <li>20.静态档：包括以下几种，（1）客户单位及人员的基本信息或数据中取自PM4系统的，随着证照或证明材料而变动的内容，如客户单位的名称、单位性质等；（2）客户单位及人员的相关信息，如姓名、电话、地址、微信号等；（3）通过PM4系统或CRM内建数据计算得到的字段，如客户规模、热力值、活跃度等；（4）用户标记的内容，如项目、学术专线等。</li>\n        <li>21.动态挡：包括以下几种，（1）用户记录的客情事件消息，如日志、拜访、随访等；（2）固定格式汇报，如周报、月报等；（3）用户与客户，或客户与客户间的互动，如任务流转、协同处理、消息通知等。</li>\n        </ol>\n        <p style="margin: 10px 0 5px 0"><strong><strong>信息系统和网络传输安全？</strong></strong>@</p>\n        <p>使用的开发套件、插件、平台以及网络传输协议、服务器等：</p>\n        <p>应对意外或突发事件时的保障机制（灾备措施）：</p>\n        <p style="margin: 10px 0 5px 0"><strong><strong>项目开发和专班</strong></strong></p>\n        <ol>\n        <li>1.受项目领导小组授权委托，项目组制定软件选型及架构蓝图，配置开发套件和环境标准；项目所有技术细节或第三方产品的选用，需向项目领导小组汇报审核后方可使用。</li>\n        <li>2.项目专班开发人员合理授权和使用资源，在开发中确保代码安全，定期排查，及时发现和清理包含其硬件设备在内的安全漏洞，使程序本身以及配套的插件、数据库等处于受控安全状态；</li>\n        <li>3.项目专班开发人员将长期常态化负责本系统的日常升级、维护和管理。</li>\n        <li>4.开发、运维用户（Id、Io）由项目组直接授权并接受管理。遵守项目组相关管理办法和技术规范，主动配合项目组开展工作，项目组对其亦赋有监督权力。授权到期时，以上人员应向项目组提交所有信息并归还相应权限和资源，不可私自带离。</li>\n        <li>5.<u>无论事中还是事后，一旦发现任何人员有违反信息安全相关制度规定或触及本管理办法的相关行为，项目组将立即上报上级部门并根据严重性追究其责任。</u></li>\n        </ol>\n        <p style="margin: 10px 0 5px 0"><strong><strong>权限管理和授权</strong></strong></p>\n        <ol>\n        <li>1.系统的设计、开发及运维以及权限控制由项目组全权负责和执行。项目组内成员未经上级授权，不得向其他部门、组织及个人提供任何系统内资源；不得向其开放任何访问或调用权限；不得擅自扩大或变更授权范围；不得擅自调整或提高权限等级。</li>\n        <li>2.项目组应确保系统设计的高度安全性，通过技术手段和权限管理等，有效防范不安全登录和访问系统资源，避免请求提交后过量数据返回；重点保护数据的完整性，从底层设计到应用环境，加强包括和不限于防篡改、防删库、防插入的安全保障能力。</li>\n        <li>3.任何人未经授权使用任何系统数据的行为均视为触及公司重大风险。任何人在未经公司授意、授权的情况下，不得以任何方式将包含并不限于本系统的设计、结构、代码、数据等的内容向外提及、引用、展示或泄露，否则视同泄露公司机密。</li>\n        <li>4.任何人一旦发现泄漏，应高度重视，立即上报事件，不可有瞒报、漏报的行为，并同时通过OA协同或CRM任务通告项目组。</li>\n        <li>5.系统全局使用软件内行为记录（痕迹追踪），所有用户默认同意接受该监控。项目组及受管理委托的部门保障监督全程在位，定期进行风险行为的排查和调查，并根据实际情况向相关部门、组织及个人通报情况。</li>\n        <li>6.系统信息密集且敏感区域使用防扩散水印，防止恶意扩散，在一定情况下能帮助责任追溯。</li>\n        <li>7.内部单位经授权的部门、组织及个人，经OA协同或CRM任务申请，由项目组在系统后台给予相匹配的权限，成为系统授权的部门、小组或内部用户，从而得到相匹配的服务。其权限依次向上可分为普通用户（IV）、基层管理者用户（III）、部门管理者用户（II）、中心及以上管理者用户（I）。</li>\n        <li>8.系统授权的内部用户一旦离职，则立即失去授权，原所在部门或人力资源部门有义务立即通过OA协同或CRM任务告知项目组处理；若遇到岗位调整等，项目组经由原所在部门、新加入部门以及人力资源部门共同申请确认后办理交接；部门、小组经由其所在的上级部门申报后调整。(离职程序)</li>\n        <li>9.内部用户必须由其部门、组织向项目组提供其标准的必要身份字段的信息，或按需提供非必要身份字段的信息。项目组经确认后在系统内录入或更新。</li>\n        <li>10.外部用户经对应业务人员、业务部门确认，由后者代其通过CRM任务向项目组提交使用申请，核实后成为授权外部用户，得到相匹配的服务。业务人员、部门应关注其动态，及时更新信息，清理停用账号等。</li>\n        </ol>\n        <p style="margin: 10px 0 5px 0" style="margin: 10px 0 5px 0"><strong><strong>常规使用和许可</strong></strong></p>\n        <ol>\n        <li>1.所有用户均应按系统要求的规范进行操作，根据实际职责授权，确保严格把控、专人专事、专事专权。使用时必须遵守有关的国家、企业的法律和规定。公司有权收回违反者的使用权限并追究其责任。</li>\n        <li>2.用户应在安全的环境下使用本服务，确保硬件设备或软件系统的运行状态无异常，防止周围无关人员窥探、拍照、录像等。如自身信息发生变更，应及时通过OA协同或CRM任务告知项目组处理。使用后或离开工位时，应及时关闭退出。避免出现因主观原因导致的疏漏或意外泄露。</li>\n        <li>3.一般情况下，在系统层级中，下一层级内容对上级可见，以此类推；敏感数据仅被专门授权的上级管理人员可见；职能类或运营类部门因在PM4不与客户单位有直接对应关系，须根据角色和所在核算单元，通过标签关联和访问资源内容。</li>\n        <li>4.一般情况下，无论是否同一核算单元/经营单位的客户资料等系统资源，若非设置为公海，则默认横向间不可互通。如确需共享，相关人员必须通过系统内置的可记录的方式（如安全分享）或其他公司内部软件进行，禁止截图并通过第三方软件发送。</li>\n        <li>5.客户资料使用增量修改模式，即在上线期间开放批量写入，而上线后客户资料的修改由其直管领导核准后方可保存。如发现错报、误报，管理人员可撤回并责成有关人员进行核实订正。所有修改记录都将保存在系统中。</li>\n        </ol>\n        <p style="margin: 10px 0 5px 0"><strong><strong>附则</strong></strong></p>\n        <ol>\n        <li>1.本管理办法由公司运营管理部门负责修订和解释。</li>\n        <li>2.本管理办法技术性内容由CRM项目组提供日常更新和维护，并作为一切与CRM相关的开发、引用和使用的基础安全协议。</li>\n        <li>3.本管理办法未尽事宜，参照集团《信息化管理制度》《保密管理办法》以及国家有关规定执行。</li>\n        <li>4.本管理办法自公布之日起施行。（完）</li>\n        </ol>\n        <p>&nbsp;</p>',t.next=10,this.$dialog.alert({title:s,message:i,confirmButtonColor:"#1989fa"});case 10:return t.next=12,A({loginType:2,agreementStatus:1,userIdList:[a.data.userId]});case 12:if(n=t.sent,n.success){t.next=15;break}return t.abrupt("return",!1);case 15:for(localStorage.setItem("tokenValue",a.data.token),localStorage.setItem("userCode",a.data.userCode),localStorage.setItem("userId",a.data.userId),localStorage.setItem("userName",a.data.userName),localStorage.setItem("headImgUrl",a.data.headImgUrl),r=a.data.userCode+"  "+a.data.userName,v.set(r,document.getElementsByTagName("body")[0]),o=[],c=0;c<a.data.resListTree.length;c++)l=a.data.resListTree[c],("首页"!==l.pmsName||l.children)&&o.push(l);this.tabbarList=o.map((function(t){return{label:t.pmsName,lineIcon:t.icon,solidIcon:t.icon+"-f",to:t.path,isVant:!1}})),localStorage.setItem("menuTree",JSON.stringify(o)),this.SET_INFORMATION(a.data),this.$router.replace({path:o[0].path}),this.$forceUpdate(),t.next=35;break;case 31:this.$toast.fail({message:a.msg,duration:1e3}),u=localStorage.getItem("menuTree"),d=JSON.parse(u),u&&(this.tabbarList=d.map((function(t){return{label:t.pmsName,lineIcon:t.icon,solidIcon:t.icon+"-f",to:t.path,isVant:!1}})),this.$router.replace({path:d[0].path}));case 35:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.getCode=this.getUrlCode()}},{key:"mounted",value:function(){this.compareRoute(this.$route.path);var t={code:this.getCode.code,type:2};this._wxlogin(t)}},{key:"onRouteChanged",value:function(t){if(this.compareRoute(t.path),t.path.indexOf("twoPinDic")>=0){if(2===this.shopCartType)return;this.SET_SHOPCARTTYPE(2)}else{if(0===this.shopCartType)return;this.SET_SHOPCARTTYPE(0)}}}]),a}(d["c"]);Object(u["a"])([P.Mutation],M.prototype,"SET_INFORMATION",void 0),Object(u["a"])([E.Mutation],M.prototype,"SET_SHOPCARTTYPE",void 0),Object(u["a"])([h["a"]],M.prototype,"shopCartType",void 0),Object(u["a"])([Object(d["d"])("$route")],M.prototype,"onRouteChanged",null),M=Object(u["a"])([Object(d["a"])({})],M);var $=M,q=$,V=(a("dac8"),a("2877")),U=Object(V["a"])(q,L,x,!1,null,null,null),F=U.exports,z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("div",{staticClass:"header"},[a("div",{staticClass:"welcome"},[a("ul",[a("li",[a("span",{staticClass:"fontWeight",staticStyle:{"font-size":"22px"}},[t._v(t._s(t.userInfor&&t.userInfor.userName?t.userInfor.userName:t.userName))])]),a("li",{staticClass:"SourceHanSerifCNRegular",staticStyle:{"font-size":"14px","font-weight":"100"}},[t._v(" 你好, 欢迎登陆移动CRM系统！ ")])])]),a("div",{staticClass:"location clearfix"},[a("van-icon",{staticClass:"left",attrs:{name:"location-o"}}),a("div",{staticClass:"msgWeather left"},[a("span",{staticClass:"locationMsg left"},[t._v(t._s(t.locationCity||"- - - -"))]),a("span",{staticClass:"locationWeather left"},[t._v(t._s(t.nowWeather.weather||"--")+" "+t._s(t.nowWeather.temperature||"？")+"℃")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.clickInbuttonShow&&t.lnglatXY.length>0,expression:"clickInbuttonShow && lnglatXY.length > 0"}],staticClass:"right"},[a("span",{staticClass:"clockIn",on:{click:t.clockInClick}},[t._v("立即打卡")])])],1)]),a("div",{staticClass:"content"},t._l(t.indexMenu,(function(e,s){return a("div",{key:s,staticClass:"warp"},[a("router-link",{attrs:{to:e.path}},[a("div",{class:e.icon},[a("span",[t._v(t._s(e.pmsName))])])])],1)})),0),a("van-popup",{style:{height:"95%"},attrs:{round:"",position:"bottom"},on:{close:t.adressPopColse},model:{value:t.mapShow,callback:function(e){t.mapShow=e},expression:"mapShow"}},[t.mapShow?a("div",{staticClass:"inforList",staticStyle:{height:"60%"}},[a("div",{staticClass:"header clearfix"},[a("van-search",{staticClass:"left",attrs:{"show-action":"",placeholder:"请输入地址关键词"},on:{search:t.onSearch,clear:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}],null,!1,3446203101),model:{value:t.nowChoosePlace,callback:function(e){t.nowChoosePlace=e},expression:"nowChoosePlace"}})],1),a("div",{staticClass:"content"},[a("van-list",{ref:"addressWarp",attrs:{error:t.addresserror,"error-text":"请求失败，点击重新加载",finished:t.addressfinished,"finished-text":"没有更多了"},on:{"update:error":function(e){t.addresserror=e},load:t.onLoad},model:{value:t.addressloading,callback:function(e){t.addressloading=e},expression:"addressloading"}},[a("van-radio-group",{model:{value:t.nowChooseId,callback:function(e){t.nowChooseId=e},expression:"nowChooseId"}},[a("van-cell-group",t._l(t.locationList,(function(e){return a("van-cell",{key:e.id,ref:"address"+e.id,refInFor:!0,attrs:{name:e.id,clickable:""},on:{click:function(a){return t.nowChooseClick(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[a("span",[t._v(t._s(e.name))]),a("br"),a("i",{staticStyle:{"font-size":"12px",color:"#bbb"}},[t._v("-- "+t._s(e.pname+e.cityname+e.adname+e.address))])]},proxy:!0},{key:"right-icon",fn:function(){return[a("van-radio",{attrs:{name:e.id}})]},proxy:!0}],null,!0)})})),1)],1)],1),a("van-button",{staticClass:"right",attrs:{size:"small",round:"",type:"info"},on:{click:t.sureClick}},[t._v("确定打卡")])],1)]):t._e(),a("div",{staticStyle:{height:"40%"},attrs:{id:"container"}})])],1)},W=[],B=(a("b0c0"),a("1246"));function G(t,e,a){return H.apply(this,arguments)}function H(){return H=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new FormData,Object.keys(s).forEach((function(t){i.append(t,s[t]||"")})),t.next=4,iv({url:e+a,method:"post",data:i});case 4:return n=t.sent,t.abrupt("return",n.data);case 6:case"end":return t.stop()}}),t)}))),H.apply(this,arguments)}function Y(t,e,a){return Q.apply(this,arguments)}function Q(){return Q=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:e+a,method:"post",data:s});case 2:return i=t.sent,t.abrupt("return",i.data);case 4:case"end":return t.stop()}}),t)}))),Q.apply(this,arguments)}var K=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",G(O,"/api/jsSign/getSign",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Y(j,"/api/UserVisit/insCrmClockIn",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),X=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Y(j,"/api/UserVisit/getCrmClockIn",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Z=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Y(O,"/api/suggestion/insertSuggestion",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),tt=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Y(O,"/api/suggestion/querySuggestion",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),et=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",G(D,"/api/login/plaintextLogin",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),at=(a("a15b"),a("4d63"),a("25f0"),function t(e,a,s){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,n=0;n<e.length;n++){var r=e[n];r.children&&r.children.length>0?t(r.children,a,s,i):r.pmsType===i&&r.parentName===a&&s.push(r)}return s});function st(t,e){var a=new e.$Clipboard(t);console.log(a),a.on("success",(function(){e.$toast.success("复制成功"),a.destroy()})),a.on("error",(function(){e.$toast.fail("该浏览器不支持自动复制"),a.destroy()}))}var it=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.userName=localStorage.getItem("userName")||"",t.locationCity="",t.nowWeather={},t.ToastLoading=null,t.indexMenu=[],t.clickInbuttonShow=!1,t.mapShow=!1,t.locationList=[],t.nowChoosePlace="",t.nowChooseObj="",t.nowChooseId="",t.addressloading=!1,t.addresserror=!1,t.addressfinished=!1,t.addressPage=1,t.lnglatXY=[],t.map=null,t.AMAP=null,t}return Object(o["a"])(a,[{key:"wxRegister",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=location.href.split("#")[0];console.log(a);var s={url:a};K(s).then((function(a){var s=a.data;B["a"].config({debug:!1,appId:"ww2170b959e5dac682",timestamp:s.timestamp,nonceStr:s.nonceStr,signature:s.signature,jsApiList:["getLocation"]}),B["a"].error((function(t){console.log(t)})),B["a"].ready((function(){B["a"].getLocation({type:"gcj02",success:function(a){t.lnglatXY=[a.longitude,a.latitude],console.log(e),"click"===e?(t.mapShow=!0,t.ToastLoading.clear()):t.getPositionByLonLats(a.longitude,a.latitude)},cancel:function(e){t.ToastLoading.clear(),console.log(e),console.log("用户拒绝授权获取地理位置"),alert("用户拒绝授权获取地理位置")}})}))})).catch((function(t){console.log(t)}))}},{key:"getPositionByLonLats",value:function(t,e){var a=this;this.AMAP.service("AMap.Geocoder",(function(){var s=new a.AMAP.Geocoder({});s.getAddress([t,e],(function(t,e){"complete"===t&&"OK"===e.info&&(a.locationCity=e.regeocode.addressComponent.city,a.AMAP.plugin("AMap.Weather",(function(){var t=new a.AMAP.Weather;t.getLive(a.locationCity,(function(t,e){a.nowWeather=t?{}:e}))})))}))}))}},{key:"_insCrmClockIn",value:function(t){var e=this;J(t).then((function(t){e.ToastLoading.clear(),"200"===t.code&&(e.mapShow=!1,e.$toast.success({message:"打卡成功",duration:2e3}))}))}},{key:"clockInClick",value:function(){this.ToastLoading=this.$toast.loading({message:"定位中...",duration:0,forbidClick:!0}),this.init("click")}},{key:"onLoad",value:function(){var t=this;this.$nextTick((function(){t.aMapSearchNearBy(t.lnglatXY,t.locationCity,t)}))}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$cancelAxios(["getSign"]),this.wxRegister(t)}},{key:"onSearch",value:function(){this.addressPage=1,this.locationList=[],this.addressloading=!1,this.addressfinished=!1,this.aMapSearchNearBy(this.lnglatXY,this.locationCity,this,this.nowChoosePlace)}},{key:"aMapSearchNearBy",value:function(t,e,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.addressloading=!0,this.map=new this.AMAP.Map("container",{resizeEnable:!0}),this.AMAP.plugin(["AMap.Autocomplete","AMap.PlaceSearch","AMap.Geolocation"],(function(){var t=new a.AMAP.Geolocation({enableHighAccuracy:!0,timeout:1e4,maximumAge:0,convert:!0,showButton:!0,buttonPosition:"LB",buttonOffset:new a.AMAP.Pixel(10,20),showMarker:!0,showCircle:!0,panToLocation:!0,zoomToAccuracy:!0});a.map.addControl(t)})),1===a.addressPage&&(a.locationList=[]),this.AMAP.service(["AMap.PlaceSearch"],(function(){var i=new a.AMAP.PlaceSearch({pageSize:50,pageIndex:a.addressPage,citylimit:!1,map:a.map,city:e});i.searchNearBy(s,t,500,(function(t,e){"OK"===e.info?(console.log(e),a.locationList=a.locationList.concat(e.poiList.pois),a.nowChooseObj=a.locationList[0],a.nowChooseId=a.locationList[0].id,e.poiList.count<=50*a.addressPage?a.addressfinished=!0:(a.addressloading=!1,a.addressPage++)):(a.addressloading=!1,a.addresserror=!0,console.log("获取位置信息失败!"))})),a.AMAP.event.addListener(i,"markerClick",(function(t){a.nowChooseId=t.data.id,console.log(a.$refs["address"+t.data.id][0].offsetTop);var e=a.$refs.addressWarp.scroller;e.scrollTo(0,a.$refs["address"+t.data.id][0].offsetTop)}))}))}},{key:"sureClick",value:function(){this.ToastLoading=this.$toast.loading({message:"打卡中...",duration:0,forbidClick:!0});var t={address:this.nowChooseObj.pname+this.nowChooseObj.cityname+this.nowChooseObj.adname+this.nowChooseObj.address+this.nowChooseObj.name,latitude:this.nowChooseObj.location.lat,longitude:this.nowChooseObj.location.lng,city:this.nowChooseObj.cityname,province:this.nowChooseObj.pname};this._insCrmClockIn(t)}},{key:"nowChooseClick",value:function(t){var e=this;this.nowChooseObj=t,this.nowChooseId=t.id;var a=new this.AMAP.InfoWindow({offset:new this.AMAP.Pixel(0,-30)}),s=new this.AMAP.Marker({position:[t.location.lng,t.location.lat],map:this.map});s.content='<ul style="min-width: 200px; max-width: 240px;"><li style="border-bottom: 1px #99adce solid;line-height: 20px">'.concat(t.name,'</li><li style=";line-height: 20px">地址：').concat(t.address,"</li></ul>"),s.on("click",(function(t){a.setContent(t.target.content),a.open(e.map,t.target.getPosition())})),s.emit("click",{target:s})}},{key:"adressPopColse",value:function(){this.locationList=[],this.addressPage=1,this.addressloading=!1,this.addressfinished=!1,this.nowChoosePlace=""}},{key:"activated",value:function(){var t=this,e=localStorage.getItem("menuTree"),a=JSON.parse(e);this.AMAP=window.AMap,this.indexMenu=[],a.forEach((function(e){"首页"===e.pmsName&&e.children&&e.children.forEach((function(e){3===e.pmsType&&t.indexMenu.push(e)}))}));var s=at(a,"首页",[]);this.clickInbuttonShow=s.some((function(t){return"打卡按钮"===t.pmsName})),this.locationCity||this.init("dW")}}]),a}(d["c"]);Object(u["a"])([h["a"]],it.prototype,"userInfor",void 0),it=Object(u["a"])([Object(d["a"])({})],it);var nt=it,rt=nt,ot=(a("7252"),Object(V["a"])(rt,z,W,!1,null,null,null)),ct=ot.exports,lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"message"},[a("van-dropdown-menu",{attrs:{"active-color":"#1989fa"}},[a("van-dropdown-item",{attrs:{options:t.option},on:{change:t.getMsgList},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),a("van-dropdown-item",{ref:"filter",attrs:{title:"筛选"}},[a("van-tree-select",{attrs:{"active-color":"#363636",items:t.labelTreeList,"active-id":t.activeId,"main-active-index":t.activeIndex},on:{"update:activeId":function(e){t.activeId=e},"update:active-id":function(e){t.activeId=e},"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e}}}),a("div",{staticClass:"dropdown-opts"},[a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:t.reset}},[t._v("重置")]),a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",plain:"",block:"",round:""},on:{click:t.onConfirm}},[t._v("确认")])],1)],1)],1),a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.getMsgList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return a("div",{key:e.cmsId,staticClass:"msg-item"},[a("van-swipe-cell",{scopedSlots:t._u([{key:"right",fn:function(){return[a("van-button",{staticClass:"msg-btn",attrs:{square:"",type:"warning",text:"标记已读"}})]},proxy:!0}],null,!0)},[a("div",{staticClass:"msg-item__line"},[a("van-tag",{staticClass:"msg-item__type",attrs:{type:"warning"}},[t._v(t._s(1===e.messageType?"任务":""))]),a("div",{staticClass:"msg-item__time"},[t._v(t._s(e.sendTime))])],1),a("div",{staticClass:"msg-item__content",style:1===+e.useStatus?"color: #999":""},[t._v(" "+t._s("【"+e.smallTag+"】"+e.content)+" ")])])],1)})),0)],1)},ut=[];a("4de4");function dt(t,e,a){return ht.apply(this,arguments)}function ht(){return ht=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:e+a,method:"post",data:s});case 2:return i=t.sent,t.abrupt("return",i.data);case 4:case"end":return t.stop()}}),t)}))),ht.apply(this,arguments)}function pt(t,e,a){return mt.apply(this,arguments)}function mt(){return mt=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new FormData,Object.keys(s).forEach((function(t){i.append(t,s[t]||"")})),t.next=4,iv({url:e+a,method:"post",data:i});case 4:return n=t.sent,t.abrupt("return",n.data);case 6:case"end":return t.stop()}}),t)}))),mt.apply(this,arguments)}var vt=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,dt(j,"/api/UserVisit/getUserVisit",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ft=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,dt(j,"/api/UserVisit/insVisit",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),gt=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,dt(j,"/api/UserVisit/insOrUpdRemark",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),bt=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,dt(j,"/api/UserVisit/insOrUpdComment",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),yt=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pt(j,"/api/UserVisit/raiseStarLevel",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),_t=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,dt(j,"/api/custom/queryCustListByUserId",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),kt=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pt(j,"/api/custom/queryPersonByCustId",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ct=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pt(j,"/api/UserVisit/getLabelTree",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),wt=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",dt(j,"/api/UserVisit/getCrmClockIn",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Lt=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",pt(j,"/api/UserVisit/relateClockIn",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),xt=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",dt(j,"/api/crmProvider/queryProviderForVisit",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),It=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",dt(j,"/api/crmGovernment/queryGovernmentForVisit",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),St=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",dt(j,"/api/crmGovernment/queryGovernmentUserMsgForVisit",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Dt=a("f564");function Ot(t,e){return jt.apply(this,arguments)}function jt(){return jt=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:j+e,method:"post",data:a});case 2:return s=t.sent,s.data.success||Object(Dt["a"])({type:"warning",message:s.data.msg}),t.abrupt("return",s.data);case 5:case"end":return t.stop()}}),t)}))),jt.apply(this,arguments)}function Tt(t,e){return Rt.apply(this,arguments)}function Rt(){return Rt=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=new FormData,Object.keys(a).forEach((function(t){s.append(t,a[t]||"")})),t.next=4,iv({url:j+e,method:"post",data:s});case 4:return i=t.sent,i.data.success||Object(Dt["a"])({type:"warning",message:i.data.msg}),t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t)}))),Rt.apply(this,arguments)}function Nt(t){return At.apply(this,arguments)}function At(){return At=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ot("/api/taskApproval/add",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),At.apply(this,arguments)}function Pt(t){return Et.apply(this,arguments)}function Et(){return Et=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/delete",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Et.apply(this,arguments)}function Mt(t){return $t.apply(this,arguments)}function $t(){return $t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/modifyMsgStatus",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),$t.apply(this,arguments)}function qt(t){return Vt.apply(this,arguments)}function Vt(){return Vt=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/queryCountReceive",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Vt.apply(this,arguments)}function Ut(t){return Ft.apply(this,arguments)}function Ft(){return Ft=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/queryCountSend",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ft.apply(this,arguments)}function zt(t){return Wt.apply(this,arguments)}function Wt(){return Wt=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/queryMsg",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Wt.apply(this,arguments)}function Bt(t){return Gt.apply(this,arguments)}function Gt(){return Gt=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ot("/api/taskApproval/queryReceive",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Gt.apply(this,arguments)}function Ht(t){return Yt.apply(this,arguments)}function Yt(){return Yt=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ot("/api/taskApproval/querySend",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Yt.apply(this,arguments)}function Qt(t){return Kt.apply(this,arguments)}function Kt(){return Kt=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/submitReturn",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Kt.apply(this,arguments)}function Jt(t){return Xt.apply(this,arguments)}function Xt(){return Xt=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/queryDepOrGroup",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Xt.apply(this,arguments)}function Zt(t){return te.apply(this,arguments)}function te(){return te=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/queryTag",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),te.apply(this,arguments)}function ee(t){return ae.apply(this,arguments)}function ae(){return ae=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/modifyReceiveStatus",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ae.apply(this,arguments)}function se(t){return ie.apply(this,arguments)}function ie(){return ie=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/querySendMsgDetail",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ie.apply(this,arguments)}function ne(t){return re.apply(this,arguments)}function re(){return re=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/queryWxMsg",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),re.apply(this,arguments)}function oe(t){return ce.apply(this,arguments)}function ce(){return ce=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("/api/taskApproval/urgeReply",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ce.apply(this,arguments)}var le=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.value=0,t.option=[{text:"全部",value:0},{text:"已读",value:1},{text:"未读",value:2}],t.labelTreeList=[],t.activeId=-1,t.activeIndex=0,t.list=[],t.loading=!1,t.finished=!1,t}return Object(o["a"])(a,[{key:"_getLabelTree",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={type:"1"},t.next=3,Ct(e);case 3:a=t.sent,this.labelTreeList=a.data.map((function(t){var e=[];return t.CHILD_LIST.length&&(e=t.CHILD_LIST.map((function(t){return{id:t.LABEL_ID,text:t.LABEL_NAME}}))),{id:t.LABEL_ID,text:t.LABEL_NAME,children:e}}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getMsgList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.list=[],t.next=3,zt({status:+this.value,smallTagId:-1===this.activeId?"":this.activeId,type:1});case 3:e=t.sent,e.success&&(this.list=e.data),this.loading=!1,this.finished=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"reset",value:function(){this.activeId=-1,this.activeIndex=0;var t=this.$refs.filter;t.toggle(),this.getMsgList()}},{key:"onConfirm",value:function(){var t=this.$refs.filter;t.toggle(),this.getMsgList()}},{key:"onClickRead",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Mt({cmsId:e.cmsId});case 2:a=t.sent,a.success?e.useStatus=1:this.$toast(a.msg||"已读失败");case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this._getLabelTree()}}]),a}(d["c"]);le=Object(u["a"])([Object(d["a"])({})],le);var ue=le,de=ue,he=(a("bdf3"),Object(V["a"])(de,lt,ut,!1,null,"16a615c6",null)),pe=he.exports,me=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"customerAnalysis"},[s("van-search",{attrs:{value:e.searchValue,placeholder:e.placeholder},on:{click:function(){t.fullPopShow=!0}}}),e.curCustom.custName?s("div",[s("div",{staticClass:"customer-info"},[s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("客户信息")]),s("div",{staticClass:"customer__content"},[e._v(e._s(e.dataSource.custId?e.dataSource.custId+"/"+e.dataSource.custName:""))])]),s("div",{staticClass:"customer__linetwo"},[s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("医院等级")]),s("div",{staticClass:"customer__content"},[e._v(e._s(e.dataSource.className))])]),s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("年药品销售规模")]),s("div",{staticClass:"customer__content"},[e._v(e._s(e.dataSource.yearSalesVolumeName))])])]),s("div",{staticClass:"customer__linetwo"},[s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("经营性质")]),s("div",{staticClass:"customer__content"},[e._v(e._s(1===+e.dataSource.isProfit?"政府办":2===+e.dataSource.isProfit?"非政府办营利":3===+e.dataSource.isProfit?"非政府办非营利":""))])]),s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("学术专线")]),s("div",{staticClass:"customer__content"},[e._v(e._s(e.dataSource.scienceLineName))])])]),s("div",{staticClass:"customer__linetwo"},[s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("股东成分")]),s("div",{staticClass:"customer__content"},[e._v(e._s(e.dataSource.shareholderCompose))])]),s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("活跃度")]),s("div",{staticClass:"customer__content"},[e._v("--")])])]),s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("业务员")]),s("div",{staticClass:"customer__content"},[e._v(e._s(e.salersText))])])]),s("div",{staticClass:"task-item"},[s("div",{staticClass:"task-item__top"},[s("div",{staticClass:"task-item__title"},[e._v("业态排名")])]),s("div",{staticClass:"data-total"},[e._v("截止"+e._s((new Date).getFullYear())+"年"+e._s((new Date).getMonth()||12)+"月底")]),s("div",{staticClass:"data-total"},[e._v("在同类业务中该单位营收排名"),s("div",{staticClass:"blue big-num"},[e._v(e._s(e.rankData.monthRank))]),e._v(" / "+e._s(e.rankData.orgTypeNum))]),s("div",{ref:"rank",staticClass:"rank"},[s("div",{staticClass:"rank__max"},[e._v(e._s(e.rankData.orgTypeNum))]),s("i",{staticClass:"iconfont ytcrm-jiantou rank__pos",style:"right: "+(e.rankData.monthRank/e.rankData.orgTypeNum*e.rankWidth-12)+"px"}),s("div",{staticClass:"rank__cur"},[e._v("1")])]),s("div",{staticClass:"data-total"},[e._v("较上月营收排名"),s("div",{staticClass:"red big-num"},[e._v(e._s(e.rankData.lastMonthRank-e.rankData.monthRank>0?"+"+(e.rankData.lastMonthRank-e.rankData.monthRank):e.rankData.lastMonthRank-e.rankData.monthRank))])]),s("div",{staticClass:"data-total"},[e._v(e._s((new Date).getMonth()||12)+"月单月同比"),s("div",{staticClass:"blue big-num"},[e._v(e._s(e.rankData.monthRate)+"%")]),e._v(" 本年累计同比"),s("div",{staticClass:"blue big-num"},[e._v(e._s(e.rankData.yearRate)+"%")])]),s("div",{staticClass:"data-total"},[e._v("增长跑赢"),s("div",{staticClass:"blue big-num"},[e._v(e._s(e.rankData.growthRank?(100-e.rankData.growthRank/e.rankData.orgTypeNum*100).toFixed(2):"")+"%")]),e._v(" 的同类客户单位")]),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.rankLoading,expression:"rankLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),s("div",{staticClass:"task-item",on:{click:e.toList}},[s("div",{staticClass:"task-item__top"},[s("div",{staticClass:"task-item__title"},[e._v("近100天")]),s("div",{staticClass:"task-item__desc"},[e._v(" 全部 "),s("van-icon",{attrs:{name:"arrow",size:"18px"}})],1)]),s("div",{staticClass:"task-block"},[s("div",{staticClass:"task-block__item"},[s("div",{staticClass:"task-block__item__desc"},[e._v("累计客勤事件/次")]),s("div",{staticClass:"task-block__item__value"},[e._v(e._s(e.eventCount.custEventCount))])]),s("div",{staticClass:"task-block__item"},[s("div",{staticClass:"task-block__item__desc"},[e._v("累计外勤拜访/次")]),s("div",{staticClass:"task-block__item__value"},[e._v(e._s(e.eventCount.legWorkCount))])]),s("div",{staticClass:"task-block__item"},[s("div",{staticClass:"task-block__item__desc"},[e._v("累计客户随访/次")]),s("div",{staticClass:"task-block__item__value"},[e._v(e._s(e.eventCount.followCount))])]),s("div",{staticClass:"task-block__item"},[s("div",{staticClass:"task-block__item__desc"},[e._v("累计客户协防/次")]),s("div",{staticClass:"task-block__item__value"},[e._v(e._s(e.eventCount.assistCount))])]),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.countLoading,expression:"countLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1)]),s("div",{staticClass:"task-item"},[s("div",{staticClass:"task-item__top"},[s("div",{staticClass:"task-item__title"},[e._v("相关人员")])]),s("van-tabs",{directives:[{name:"show",rawName:"v-show",value:e.dataSource.saleManList&&e.dataSource.saleManList.length>1,expression:"dataSource.saleManList && dataSource.saleManList.length > 1"}],attrs:{color:"#554d62",ellipsis:!1},on:{change:e.getPersonList},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.dataSource.saleManList,(function(t){return s("van-tab",{key:t.userId,attrs:{title:t.userName}})})),1),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.personLoading,expression:"personLoading"}],attrs:{type:"spinner",color:"#1989fa"}}),e.personLoading||e.personList.length?s("div",{staticClass:"person-list"},e._l(e.personList,(function(t,a){return s("div",{key:a,staticClass:"person",on:{click:function(a){return e.toPerson(t)}}},[s("div",{staticClass:"person__name"},[e._v(e._s(t.userName)+"（"+e._s(t.position)+"）")]),s("van-tag",{directives:[{name:"show",rawName:"v-show",value:t.warmthNum,expression:"item.warmthNum"}],staticClass:"person__tag",attrs:{type:1===t.warmthNum?"primary":2===t.warmthNum?"success":"danger",plain:""}},[e._v(e._s(e.warmthNumOptions[t.warmthNum]))]),s("van-icon",{attrs:{name:"arrow",size:"18px"}})],1)})),0):s("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无相关人员"}})],1)]):s("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"请先输入指定客户"}}),s("full-pop",{directives:[{name:"show",rawName:"v-show",value:e.fullPopShow,expression:"fullPopShow"}],attrs:{placeholder:e.placeholder,loading:e.custLoading,list:e.custList},on:{cancel:function(t){e.fullPopShow=!1},input:e.getCustList,select:e.onSelectCustomer}})],1)},ve=[],fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"full-pop"},[a("van-search",{attrs:{autofocus:"","show-action":"",placeholder:t.placeholder||"请输入搜索关键词"},on:{input:t.onInput,cancel:t.cancel},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),a("div",{staticClass:"result-list"},[t._l(t.list,(function(e){return a("div",{key:e.custId,staticClass:"result-item",on:{click:function(a){return t.onSelectCustomer(e)}}},[t._v(" "+t._s(e.custId)+"/"+t._s(e.custName)+" ")])})),a("van-empty",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.list.length&&t.keywords,expression:"!loading && !list.length && keywords"}],staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无数据"}}),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{color:"#1989fa"}})],2)],1)},ge=[],be=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.keywords="",t}return Object(o["a"])(a,[{key:"cancel",value:function(){this.$emit("cancel")}},{key:"onInput",value:function(t){this.$emit("input",t)}},{key:"onSelectCustomer",value:function(t){this.$emit("select",t)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],be.prototype,"list",void 0),Object(u["a"])([Object(d["b"])()],be.prototype,"loading",void 0),Object(u["a"])([Object(d["b"])()],be.prototype,"placeholder",void 0),be=Object(u["a"])([Object(d["a"])({})],be);var ye=be,_e=ye,ke=(a("84bc"),Object(V["a"])(_e,fe,ge,!1,null,"407ebb9a",null)),Ce=ke.exports;function we(t,e){return Le.apply(this,arguments)}function Le(){return Le=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:j+e,method:"post",data:a});case 2:return s=t.sent,s.data.success||Object(Dt["a"])({type:"warning",message:s.data.msg}),t.abrupt("return",s.data);case 5:case"end":return t.stop()}}),t)}))),Le.apply(this,arguments)}function xe(t,e){return Ie.apply(this,arguments)}function Ie(){return Ie=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=new FormData,Object.keys(a).forEach((function(t){s.append(t,a[t]||"")})),t.next=4,iv({url:j+e,method:"post",data:s});case 4:return i=t.sent,i.data.success||Object(Dt["a"])({type:"warning",message:i.data.msg}),t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t)}))),Ie.apply(this,arguments)}function Se(t){return De.apply(this,arguments)}function De(){return De=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custom/query",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),De.apply(this,arguments)}function Oe(t){return je.apply(this,arguments)}function je(){return je=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custom/update",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),je.apply(this,arguments)}function Te(t){return Re.apply(this,arguments)}function Re(){return Re=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/queryShareList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Re.apply(this,arguments)}function Ne(t){return Ae.apply(this,arguments)}function Ae(){return Ae=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/queryShareCust",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ae.apply(this,arguments)}function Pe(t){return Ee.apply(this,arguments)}function Ee(){return Ee=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custom/share",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ee.apply(this,arguments)}function Me(t){return $e.apply(this,arguments)}function $e(){return $e=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custom/updateShare",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),$e.apply(this,arguments)}function qe(t){return Ve.apply(this,arguments)}function Ve(){return Ve=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/delectShare",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ve.apply(this,arguments)}function Ue(t){return Fe.apply(this,arguments)}function Fe(){return Fe=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/isAllowUpdateOrgRole",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Fe.apply(this,arguments)}function ze(t){return We.apply(this,arguments)}function We(){return We=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/queryPersonList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),We.apply(this,arguments)}function Be(t){return Ge.apply(this,arguments)}function Ge(){return Ge=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/queryPerson",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ge.apply(this,arguments)}function He(t){return Ye.apply(this,arguments)}function Ye(){return Ye=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custom/addPerson",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ye.apply(this,arguments)}function Qe(t){return Ke.apply(this,arguments)}function Ke(){return Ke=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custom/updatePerson",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ke.apply(this,arguments)}function Je(t){return Xe.apply(this,arguments)}function Xe(){return Xe=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/delectPerson",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Xe.apply(this,arguments)}function Ze(t){return ta.apply(this,arguments)}function ta(){return ta=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custom/personTransfer",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ta.apply(this,arguments)}function ea(t){return aa.apply(this,arguments)}function aa(){return aa=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/queryPM4CustList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),aa.apply(this,arguments)}function sa(t){return ia.apply(this,arguments)}function ia(){return ia=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/queryOrgRoleList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ia.apply(this,arguments)}function na(t){return ra.apply(this,arguments)}function ra(){return ra=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/querySharePersonList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ra.apply(this,arguments)}function oa(t){return ca.apply(this,arguments)}function ca(){return ca=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/queryPersonShareUser",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ca.apply(this,arguments)}function la(t){return ua.apply(this,arguments)}function ua(){return ua=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custom/sharePerson",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ua.apply(this,arguments)}function da(t){return ha.apply(this,arguments)}function ha(){return ha=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custom/updateSharePerson",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ha.apply(this,arguments)}function pa(t){return ma.apply(this,arguments)}function ma(){return ma=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custom/delectSharePerson",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ma.apply(this,arguments)}function va(t){return fa.apply(this,arguments)}function fa(){return fa=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/customView/queryCust",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),fa.apply(this,arguments)}function ga(t){return ba.apply(this,arguments)}function ba(){return ba=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/customView/queryCustEventCount",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ba.apply(this,arguments)}function ya(t){return _a.apply(this,arguments)}function _a(){return _a=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/customView/queryCustList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),_a.apply(this,arguments)}function ka(t){return Ca.apply(this,arguments)}function Ca(){return Ca=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/customView/queryCustEvent",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ca.apply(this,arguments)}function wa(t){return La.apply(this,arguments)}function La(){return La=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/customView/queryPersonList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),La.apply(this,arguments)}function xa(t){return Ia.apply(this,arguments)}function Ia(){return Ia=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/customView/queryPersonDetail",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ia.apply(this,arguments)}function Sa(t){return Da.apply(this,arguments)}function Da(){return Da=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/customView/queryCustRank",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Da.apply(this,arguments)}function Oa(t){return ja.apply(this,arguments)}function ja(){return ja=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/queryCust",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ja.apply(this,arguments)}function Ta(t){return Ra.apply(this,arguments)}function Ra(){return Ra=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/queryByLeader",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ra.apply(this,arguments)}function Na(t){return Aa.apply(this,arguments)}function Aa(){return Aa=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/queryBusiness",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Aa.apply(this,arguments)}function Pa(t){return Ea.apply(this,arguments)}function Ea(){return Ea=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/queryTopic",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ea.apply(this,arguments)}function Ma(t){return $a.apply(this,arguments)}function $a(){return $a=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custGrid/queryPlanListByPage",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),$a.apply(this,arguments)}function qa(t){return Va.apply(this,arguments)}function Va(){return Va=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custGrid/addPlan",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Va.apply(this,arguments)}function Ua(t){return Fa.apply(this,arguments)}function Fa(){return Fa=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custGrid/modifyPlan",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Fa.apply(this,arguments)}function za(t){return Wa.apply(this,arguments)}function Wa(){return Wa=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/delPlan",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Wa.apply(this,arguments)}function Ba(t){return Ga.apply(this,arguments)}function Ga(){return Ga=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custGrid/queryTargetListByPage",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ga.apply(this,arguments)}function Ha(t){return Ya.apply(this,arguments)}function Ya(){return Ya=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custGrid/addTarget",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ya.apply(this,arguments)}function Qa(t){return Ka.apply(this,arguments)}function Ka(){return Ka=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custGrid/modifyTarget",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ka.apply(this,arguments)}function Ja(t){return Xa.apply(this,arguments)}function Xa(){return Xa=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/delTarget",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Xa.apply(this,arguments)}function Za(t){return ts.apply(this,arguments)}function ts(){return ts=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/queryPerson",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ts.apply(this,arguments)}function es(t){return as.apply(this,arguments)}function as(){return as=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/pushGridMsg",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),as.apply(this,arguments)}function ss(t){return is.apply(this,arguments)}function is(){return is=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/queryPushGridMsg",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),is.apply(this,arguments)}function ns(t){return rs.apply(this,arguments)}function rs(){return rs=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/queryIncrease",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),rs.apply(this,arguments)}function os(t){return cs.apply(this,arguments)}function cs(){return cs=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/queryGoods",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),cs.apply(this,arguments)}function ls(t){return us.apply(this,arguments)}function us(){return us=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custGrid/queryGridGoodsListByPage",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),us.apply(this,arguments)}function ds(t){return hs.apply(this,arguments)}function hs(){return hs=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/custGrid/addGridGoods",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),hs.apply(this,arguments)}function ps(t){return ms.apply(this,arguments)}function ms(){return ms=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/custGrid/delGridGoods",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ms.apply(this,arguments)}function vs(t){return fs.apply(this,arguments)}function fs(){return fs=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/cockpit/queryTopTenCustomers",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),fs.apply(this,arguments)}function gs(t){return bs.apply(this,arguments)}function bs(){return bs=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/cockpit/getUserVisit",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),bs.apply(this,arguments)}function ys(t){return _s.apply(this,arguments)}function _s(){return _s=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/cockpit/queryCustList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),_s.apply(this,arguments)}function ks(t){return Cs.apply(this,arguments)}function Cs(){return Cs=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/cockpit/queryCustEventCount",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Cs.apply(this,arguments)}function ws(t){return Ls.apply(this,arguments)}function Ls(){return Ls=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/cockpit/queryPersonList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ls.apply(this,arguments)}function xs(t){return Is.apply(this,arguments)}function Is(){return Is=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we("/api/cockpit/queryCustEvent",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Is.apply(this,arguments)}function Ss(t){return Ds.apply(this,arguments)}function Ds(){return Ds=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/cockpit/queryCustView",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Ds.apply(this,arguments)}function Os(t){return js.apply(this,arguments)}function js(){return js=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/cockpit/queryHomeRate",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),js.apply(this,arguments)}function Ts(t){return Rs.apply(this,arguments)}function Rs(){return Rs=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe("/api/cockpit/queryGrowthRate",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),Rs.apply(this,arguments)}var Ns=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.placeholder="请输入客户ID|名称",t.searchValue="",t.fullPopShow=!1,t.custLoading=!1,t.custList=[],t.showAll=!1,t.curCustom={},t.rankWidth=0,t.rankLoading=!1,t.rankData={},t.countLoading=!1,t.eventCount={},t.personLoading=!1,t.personList=[],t.dataLoading=!1,t.dataSource={},t.active=0,t.isCabin=!1,t.warmthNumOptions=["","一般客情","需要进阶的客情","从未接触的客情"],t}return Object(o["a"])(a,[{key:"getCustList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$cancelAxios(["queryCustList"]),this.custList=[],""===e){t.next=15;break}if(this.custLoading=!0,!this.isCabin){t.next=10;break}return t.next=7,ys({custom:e});case 7:t.t0=t.sent,t.next=13;break;case 10:return t.next=12,ya({custom:e});case 12:t.t0=t.sent;case 13:a=t.t0,a.success&&(this.custLoading=!1,this.custList=a.data);case 15:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onSelectCustomer",value:function(t){this.curCustom=t,this.searchValue=t.custId+"/"+t.custName,this.fullPopShow=!1,this.personList=[],this.getData(t.custId),this.getRank(t.custId),this.getEventCount()}},{key:"getData",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.dataSource={},this.dataLoading=!0,t.next=4,va({custId:e});case 4:a=t.sent,this.dataLoading=!1,this.dataSource=a.data,this.dataSource.saleManList.length&&(this.active=0,this.getPersonList());case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRank",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.rankData={},this.rankLoading=!0,t.next=4,Sa({custId:e});case 4:a=t.sent,this.rankLoading=!1,this.rankData=a.data||{monthRank:"",orgTypeNum:"",lastMonthRank:"",monthRate:"",yearRate:"",growthRank:""},this.rankWidth=this.$refs.rank.offsetWidth;case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getEventCount",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.eventCount={},this.countLoading=!0,!this.isCabin){t.next=8;break}return t.next=5,ks({custId:this.curCustom.custId});case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,ga({custId:this.curCustom.custId});case 10:t.t0=t.sent;case 11:e=t.t0,this.countLoading=!1,this.eventCount=e.data;case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getPersonList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.personLoading=!0,this.personList=[],e={custId:this.curCustom.custId,userId:this.dataSource.saleManList[this.active].userId},!this.isCabin){t.next=9;break}return t.next=6,ws(e);case 6:t.t0=t.sent,t.next=12;break;case 9:return t.next=11,wa(e);case 11:t.t0=t.sent;case 12:a=t.t0,this.personLoading=!1,this.personList=a.data;case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"toList",value:function(){this.$router.push({name:"CustomerAnalysisList",params:{custId:this.curCustom.custId,isCabin:String(this.isCabin)}})}},{key:"toPerson",value:function(t){this.$router.push({name:"CustomerAnalysisPerson",params:{item:t,custId:this.curCustom.custId,isCabin:String(this.isCabin)}})}},{key:"activated",value:function(){this.isCabin=!1,this.$route.params.custId&&(this.isCabin=!0,this.curCustom=this.$route.params,this.fullPopShow=!this.curCustom.custId,this.searchValue=this.curCustom.custId+"/"+this.curCustom.custName,this.personList=[],this.getData(this.curCustom.custId),this.getRank(this.curCustom.custId),this.getEventCount())}},{key:"salersText",get:function(){var t=[];return this.dataSource&&this.dataSource.saleManList&&(t=this.dataSource.saleManList.map((function(t){return"".concat(t.userName,"(").concat(t.orgName,")")}))),t.join("、")}}]),a}(d["c"]);Ns=Object(u["a"])([Object(d["a"])({components:{fullPop:Ce}})],Ns);var As=Ns,Ps=As,Es=(a("7d38"),Object(V["a"])(Ps,me,ve,!1,null,"600c9037",null)),Ms=Es.exports,$s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user"},[a("div",{staticClass:"userHeader"},[a("ul",{staticClass:"clearfix"},[a("li",{staticClass:"left imgWarp"},[a("img",{attrs:{src:t.headerImg}})]),a("li",{staticClass:"left userInfor"},[a("p",{staticClass:"userName"},[t._v(t._s(t.userName))]),a("p",{staticClass:"userId"},[t._v("工号: "+t._s(t.userCode))])])])]),a("div",{staticClass:"userMainWarp"},[a("van-cell-group",t._l(t.userMenu,(function(e,s){return a("van-cell",{key:s,attrs:{title:e.pmsName,"is-link":""},on:{click:function(a){return t.cellClick(e)}},scopedSlots:t._u([{key:"icon",fn:function(){return[a("van-icon",{staticStyle:{"margin-right":"10px",color:"#363636"},attrs:{name:e.icon}})]},proxy:!0}],null,!0)})})),1)],1),a("van-dialog",{attrs:{showCancelButton:"",title:"意见反馈",theme:"round-button","before-close":t._insertSuggestion},model:{value:t.suggestionShow,callback:function(e){t.suggestionShow=e},expression:"suggestionShow"}},[a("div",{staticClass:"suggestWarp"},[a("van-field",{attrs:{rows:"3",autosize:"",type:"textarea",placeholder:"请输入意见反馈"},model:{value:t.suggestMessage,callback:function(e){t.suggestMessage=e},expression:"suggestMessage"}})],1)]),a("van-popup",{style:{height:"70%"},attrs:{round:"",position:"bottom"},model:{value:t.clickInShow,callback:function(e){t.clickInShow=e},expression:"clickInShow"}},[a("div",{staticClass:"clearfix"},[a("van-search",{staticClass:"left",staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请输入搜索关键词"},on:{input:t.addressSearchValueInput},model:{value:t.addressSearchValue,callback:function(e){t.addressSearchValue=e},expression:"addressSearchValue"}}),a("van-field",{staticClass:"left",staticStyle:{margin:"10px",padding:"5px",background:"#f7f8fa",width:"30%"},attrs:{readonly:"",clickable:"",name:"datePicker",value:t.addresschangeTime,label:"",placeholder:"点击选择时间"},on:{click:function(e){t.addresstimeShowPicker=!0}}})],1),a("van-popup",{attrs:{position:"bottom"},model:{value:t.addresstimeShowPicker,callback:function(e){t.addresstimeShowPicker=e},expression:"addresstimeShowPicker"}},[a("van-datetime-picker",{attrs:{type:"date",title:"选择完整时间","min-date":t.minDate,"max-date":t.maxDate},on:{cancel:t.addressCancel,confirm:t.addressconfirmTime},model:{value:t.timeValue,callback:function(e){t.timeValue=e},expression:"timeValue"}})],1),a("ul",{staticClass:"clickInListWarp"},[a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.clickInLoading,expression:"clickInLoading"}],staticClass:"paddingChange",attrs:{color:"#0094ff"}},[t._v("加载中...")]),t._l(t.clickInList,(function(e,s){return a("li",{key:s},[a("p",{staticClass:"clickInListHeader"},[t._v(" 打卡时间： "+t._s(e.credate.substring(0,e.credate.length-3))+" "),a("span",{staticClass:"clickInId right"},[t._v("ID: "+t._s(e.cciId))])]),a("p",{staticClass:"clickInListCommon"},[t._v("打卡地址： "+t._s(e.address))]),a("p",{staticClass:"clickInListCommon"},[t._v("打卡经纬度： "+t._s(e.longitude)+"/"+t._s(e.latitude))])])})),a("van-empty",{directives:[{name:"show",rawName:"v-show",value:0===t.clickInList.length&&!t.clickInLoading,expression:"clickInList.length === 0 && !clickInLoading"}],attrs:{description:"暂无打卡记录"}})],2)],1),a("van-popup",{style:{height:"70%"},attrs:{round:"",position:"bottom"},model:{value:t.queryMessageShow,callback:function(e){t.queryMessageShow=e},expression:"queryMessageShow"}},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.queryMessagerefreshing,callback:function(e){t.queryMessagerefreshing=e},expression:"queryMessagerefreshing"}},[a("van-list",{attrs:{offset:20,"finished-text":"",finished:t.queryMessagefinished},on:{load:t.onLoad},model:{value:t.queryMessageLoading,callback:function(e){t.queryMessageLoading=e},expression:"queryMessageLoading"}},[a("ul",{staticClass:"querySuggestWarp"},t._l(t.queryMessageList,(function(e,s){return a("li",{key:s},[a("p",{staticClass:"clickInListHeader"},[t._v(" 时间： "+t._s(e.credate.substring(0,e.credate.length-3))+" "),a("span",{staticClass:"clickInId right"},[t._v("ID: "+t._s(e.suggestionid))])]),a("p",{staticClass:"clickInListCommon"},[t._v("反馈建议： "+t._s(e.advicemsg))]),a("p",{staticClass:"clickInListCommon"},[t._v("提出人： "+t._s(e.creId)+"/"+t._s(e.creName))])])})),0)])],1),a("van-empty",{directives:[{name:"show",rawName:"v-show",value:0===t.queryMessageList.length&&!t.queryMessageLoading,expression:"queryMessageList.length === 0 && !queryMessageLoading"}],attrs:{description:"暂无反馈信息"}})],1)],1)},qs=[],Vs=new Date,Us=Vs.getDay(),Fs=Vs.getDate(),zs=Vs.getMonth(),Ws=Vs.getYear();Ws+=Ws<2e3?1900:0;var Bs=new Date;function Gs(t){var e=new Date(t),a=e.getFullYear(),s=(e.getMonth()+1).toString(),i=e.getDate().toString();return+s<10&&(s="0"+s),+i<10&&(i="0"+i),a+"-"+s+"-"+i}function Hs(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var a=new Date(e),s=a.getDay();s=0===s?7:s;var i=a.getDate(),n=a.getMonth(),r=a.getYear();r+=r<2e3?1900:0,t=new Date(r,n,i-(s-1))}else t=new Date(Ws,zs,Fs-(Us-1));return Gs(t)}function Ys(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var a=new Date(e),s=a.getDay();s=0===s?7:s;var i=a.getDate(),n=a.getMonth(),r=a.getYear();r+=r<2e3?1900:0,t=new Date(r,n,i+(6-(s-1)))}else t=new Date(Ws,zs,Fs+(6-(Us-1)));return Gs(t)}Bs.setDate(1),Bs.setMonth(Bs.getMonth()-1);var Qs=function(t,e){var a=[],s=t.split("-"),i=e.split("-"),n=new Date(s+" 08:00:00");n.setUTCFullYear(s[0],s[1]-1,s[2]);var r=new Date(i+" 08:00:00");r.setUTCFullYear(i[0],i[1]-1,i[2]);var o,c=n.getTime(),l=r.getTime(),u=864e5;for(o=c;o<=l;)a.push(Gs(new Date(parseInt(String(o))))),o+=u;return a},Ks=function(t,e){var a=new Date(t),s="";a.setDate(a.getDate()+e);var i=a.getFullYear(),n=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,r=a.getDate()<10?"0"+a.getDate():a.getDate();return s=i+"-"+n+"-"+r,s},Js=function(t){var e,a,s,i,n=new Date(t+"-01-01"),r=n.getFullYear(),o={result0:[],result1:[],result2:[],result3:[],result4:[],result5:[],result6:[]};for(e=1;e<=12;e++){switch(e){case 1:case 3:case 5:case 7:case 8:case 10:case 12:i=31;break;case 4:case 6:case 9:case 11:i=30;break;case 2:i=r%4===0&&r%100!==0||r%400===0?29:28;break}for(a=1;a<=i;a++){n.setMonth(e-1,a),s=n.getDay();var c=n.getFullYear(),l=n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,u=n.getDate()<10?"0"+n.getDate():n.getDate();o["result"+s].push(c+"-"+l+"-"+u)}}return o},Xs=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.headerImg="",t.userName="",t.userCode="",t.userMenu=[],t.suggestionShow=!1,t.clickInShow=!1,t.suggestMessage="",t.clickInList=[],t.clickInLoading=!1,t.queryMessageShow=!1,t.queryMessageLoading=!1,t.queryMessagefinished=!1,t.queryMessagerefreshing=!1,t.queryMessageList=[],t.messagePage=1,t.addressSearchValue="",t.addresschangeTime="",t.addresstimeShowPicker=!1,t.minDate=new Date(2020,0,1),t.maxDate=new Date(2025,10,1),t.timeValue=new Date,t}return Object(o["a"])(a,[{key:"addressSearchValueInput",value:function(){this._getCrmClockIn()}},{key:"addressCancel",value:function(){this.addresstimeShowPicker=!1,this.addresschangeTime="",this._getCrmClockIn()}},{key:"addressconfirmTime",value:function(t){console.log(Gs(t)),this.addresschangeTime=Gs(t),this._getCrmClockIn(),this.addresstimeShowPicker=!1}},{key:"_getCrmClockIn",value:function(){var t=this;this.clickInLoading=!0;var e={detailFlag:!1,startTime:this.addresschangeTime,keyword:this.addressSearchValue};X(e).then((function(e){"200"===e.code&&(t.clickInList=e.data),t.clickInLoading=!1}))}},{key:"cellClick",value:function(t){switch(t.keyword){case"insertSuggest":this.insertSuggestClick();break;case"querySuggest":this.querySuggestClick();break;case"getClickIn":this.getClickInMsg();break;default:break}}},{key:"getClickInMsg",value:function(){this._getCrmClockIn(),this.clickInShow=!0}},{key:"insertSuggestClick",value:function(){this.suggestionShow=!0}},{key:"querySuggestClick",value:function(){this.queryMessageShow=!0,this.queryMessageLoading=!1,this.queryMessagefinished=!1,this.queryMessagerefreshing=!1,this.queryMessageList=[],this.messagePage=1,this.onRefresh()}},{key:"_insertSuggestion",value:function(t,e){var a=this;if(console.log(t),"cancel"!==t){if(!this.suggestMessage)return e(),void this.$nextTick((function(){a.suggestionShow=!0,setTimeout((function(){a.$toast.fail("请输入内容")}))}));var s={advicemsg:this.suggestMessage};Z(s).then((function(t){"200"===t.code?(a.suggestionShow=!1,e(),a.$toast.success(t.msg)):a.$toast.fail(t.msg)}))}else e()}},{key:"_querySuggestion",value:function(){var t=this;1===this.messagePage&&(this.queryMessageList=[]),this.queryMessageLoading=!0,tt({pageNum:this.messagePage,pageSize:10}).then((function(e){"200"===e.code?(t.queryMessageList=t.queryMessageList.concat(e.data.list),e.data.hasNextPage?t.messagePage++:t.queryMessagefinished=!0):(t.queryMessagerefreshing=!0,t.$toast.fail(e.msg)),t.queryMessageLoading=!1}))}},{key:"onRefresh",value:function(){this.queryMessagerefreshing=!1,this.queryMessageLoading=!0,this.onLoad()}},{key:"onLoad",value:function(){this.queryMessagerefreshing&&(this.messagePage=1,this.queryMessageList=[],this.queryMessagerefreshing=!1),this._querySuggestion()}},{key:"mounted",value:function(){var t=this,e=this.$root;this.headerImg=e.domainUrl+localStorage.getItem("headImgUrl"),this.userName=localStorage.getItem("userName"),this.userCode=localStorage.getItem("userCode");var a=localStorage.getItem("menuTree"),s=JSON.parse(a);this.userMenu=[],s.forEach((function(e){"我的"===e.pmsName&&e.children.forEach((function(e){3===e.pmsType&&t.userMenu.push(e)}))})),console.log(this.userMenu)}}]),a}(d["c"]);Xs=Object(u["a"])([Object(d["a"])({})],Xs);var Zs=Xs,ti=Zs,ei=(a("4482"),Object(V["a"])(ti,$s,qs,!1,null,"511646d4",null)),ai=ei.exports,si=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"schedule"},[a("div",{staticClass:"userHeader clearfix"},[a("span",{staticClass:"headerType left",on:{click:t.depPersonClick}},[a("i",{staticClass:"left"},[t._v(t._s(t.userName))]),a("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.depTreeList.length>0,expression:"depTreeList.length > 0"}],staticClass:"left",attrs:{name:"arrow-down"}})],1),t.userId?a("van-button",{staticClass:"left",attrs:{size:"mini",type:"default",round:!0},on:{click:t.backMine}},[t._v("返回我的日程")]):t._e(),a("div",{staticClass:"btnWarp right"},[a("i",{staticClass:"iconfont ytcrm-center left",on:{click:t.back}})])],1),a("div",{staticClass:"schedule-header clearfix"},[(new Date).toLocaleDateString()!==new Date(t.nowClickDay).toLocaleDateString()?a("span",{staticClass:"date left",on:{click:t.changeDate}},[t._v(" "+t._s(t.nowOrClickMonth)+"月"+t._s(new Date(t.nowClickDay).getDate())+"日 "),a("i",{staticClass:"year"},[t._v(t._s(t.nowOrClickYear))])]):a("span",{staticClass:"date left",on:{click:t.changeDate}},[t._v(" 今日 "),a("i",{staticClass:"iconfont ytcrm-qiehuan"})]),(new Date).toLocaleDateString()!==new Date(t.nowClickDay).toLocaleDateString()?a("van-button",{staticClass:"left",attrs:{size:"mini",type:"default",round:!0},on:{click:t.backToday}},[t._v("回今日")]):t._e(),a("div",{staticClass:"weekChange right"},[a("van-icon",{attrs:{name:"arrow-left"},on:{click:t.preWeek}}),a("van-icon",{attrs:{name:"arrow"},on:{click:t.nextWeek}})],1),t.userId?t._e():a("van-button",{staticClass:"right",attrs:{round:"",type:"info",size:"mini"},on:{click:t.autoClick}},[t._v("auto")])],1),t._m(0),a("div",{staticClass:"scheduleContent"},[a("ul",{staticClass:"weekWarp"},t._l(t.nowdataList,(function(e){return a("li",{key:e,on:{click:function(a){return t.clickChange(e)}}},[a("span",{class:new Date(e).toLocaleDateString()===(new Date).toLocaleDateString()?"dayClickBgColor":new Date(e).getTime()<=(new Date).getTime()?"passBg":""},[a("i",{class:+e.substring(e.length-2,e.length)===+new Date(t.nowClickDay).getDate()?"nowChoose":""},[t._v(" "+t._s(e.substring(e.length-2,e.length))+" ")])]),a("div",{class:+e.substring(e.length-2,e.length)===+new Date(t.nowClickDay).getDate()?"circle":""})])})),0)]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"warp"},[a("div",{staticClass:"showSchedule clearfix"},[a("schedule-List",{ref:"scheduleList",staticClass:"left",attrs:{userId:t.userId,nowClickDay:t.nowClickDay,nowDetailList:t.nowDetailList},on:{insertScheduleSuccess:t.insertScheduleSuccess}})],1),t.nowDetailList.mor&&t.nowDetailList.mor.visitNum?a("div",{staticClass:"customer clearfix"},[t._m(1),a("div",{staticClass:"remarkContent",on:{click:t.queryCustomer}},[t.nowDetailList.mor.starNum?a("van-icon",{staticClass:"left",attrs:{name:"star"}}):t._e(),t._v(" 点击查看当日全部客情消息 "),a("van-icon",{staticClass:"right",attrs:{name:"arrow"}})],1)]):t._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"warp"},[a("van-loading",{staticClass:"paddingChange",attrs:{color:"#0094ff"}})],1),a("van-calendar",{attrs:{type:"range","default-date":t.dateRange,"min-date":new Date(2020,0,1),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{select:t.selectCalendar},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}}),t.depPersonShow?a("dep-person",{attrs:{userIdList:[t.userId],depPersonShow:t.depPersonShow},on:{closeDepPerson:t.closeDepPerson,radioClick:t.radioClick}}):t._e(),a("van-popup",{style:{height:"80%"},attrs:{round:"",position:"bottom",closeable:"","close-icon":"close"},model:{value:t.customInforShow,callback:function(e){t.customInforShow=e},expression:"customInforShow"}},[t.getUserVisitLoading?a("van-loading",{staticClass:"paddingChange",attrs:{color:"#0094ff"}},[t._v("加载中...")]):a("div",{staticClass:"coustomerInfor"},t._l(t.tableDataList,(function(e,s){return a("ul",{key:s},[a("li",{staticClass:"taskType clearfix"},[e.starFlag?a("van-icon",{staticClass:"left",attrs:{name:"star"}}):t._e(),0===e.whetherLegwork?a("i",{staticClass:"left always iconfont ytcrm-zaigangguanli"}):t._e(),1===e.whetherLegwork?a("i",{staticClass:"left need iconfont ytcrm-waiqin"}):t._e(),a("span",{staticClass:"right time"},[t._v(" "+t._s(e.visitTime.substring(0,e.visitTime.length-3))+" ")])],1),a("li",{staticClass:"header"},[t._v(" "+t._s(e.companyName)+" "),a("span",{staticClass:"type fontWeight"},[t._v("("+t._s(1===e.companyType?"供应商":2===e.companyType?"下游客户":3===e.companyType?"政府单位":"")+")")])]),a("li",{staticClass:"person clearfix"},[a("span",{staticClass:"personTitle left"},[t._v("客户人员：")]),a("span",{staticClass:"value left"},[t._v(t._s(e.visitUserName))]),1===e.warmthNum?a("van-icon",{staticClass:"always left",attrs:{name:"smile"}}):t._e(),2===e.warmthNum?a("van-icon",{staticClass:"need left",attrs:{name:"clock"}}):t._e(),3===e.warmthNum?a("van-icon",{staticClass:"never left",attrs:{name:"warning"}}):t._e()],1),e.visitUserPosition?a("li",{staticClass:"personDetail clearfix"}):t._e(),a("li",{directives:[{name:"show",rawName:"v-show",value:e.crmLabelRemarkDtoList.length>0,expression:"item.crmLabelRemarkDtoList.length > 0"}],staticClass:"crmLabelRemarkDtoList"},t._l(e.crmLabelRemarkDtoList,(function(e,s){return a("p",{key:s},[a("span",{staticClass:"title"},[t._v(" "+t._s(e.labelName)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.expectTimeStr,expression:"crmLabelRemarkitem.expectTimeStr"}],staticClass:"time"},[t._v("("+t._s(e.expectTimeStr)+")")]),t._v(" : ")]),a("span",{staticClass:"value"},[t._v(t._s(e.remark))])])})),0),e.crmVisitCommentDtoList&&e.crmVisitCommentDtoList.length>0?a("li",{staticClass:"crmVisitCommentDtoList"},t._l(e.crmVisitCommentDtoList,(function(e,s){return a("p",{key:s,staticClass:"crmVisitItem"},[a("span",{staticClass:"value"},[a("span",{staticClass:"title"},[t._v("批注:")]),t._v(" "+t._s(e.commentRemark)+" ")]),a("span",{staticClass:"personValue"},[t._v(" "+t._s(e.creId)+"/"+t._s(e.creName)+" "),a("i",{staticClass:"time right"},[t._v(t._s(e.credate))])])])})),0):t._e()])})),0)],1),a("van-dialog",{attrs:{"show-cancel-button":"",beforeClose:t.confirmDialog},on:{open:t.openDialog},model:{value:t.dialogShow,callback:function(e){t.dialogShow=e},expression:"dialogShow"}},[a("van-field",{attrs:{name:"radio",label:"上午"},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.morSchedule,callback:function(e){t.morSchedule=e},expression:"morSchedule"}},[a("van-radio",{attrs:{name:"0"}},[t._v("在岗办公")]),a("van-radio",{attrs:{name:"1"}},[t._v("本地出差")]),a("van-radio",{attrs:{name:"2"}},[t._v("外地出差")]),a("van-radio",{attrs:{name:"3"}},[t._v("请假/调休")])],1)]},proxy:!0}])}),a("van-field",{attrs:{rows:"2",autosize:"",label:"备注",type:"textarea",placeholder:"请输入上午的备注","show-word-limit":""},model:{value:t.morRemark,callback:function(e){t.morRemark=e},expression:"morRemark"}}),a("div",{staticClass:"tbSuccess clearfix"},[a("van-button",{staticClass:"right",attrs:{icon:"description",size:"mini",round:"",type:"primary"},on:{click:t.tbSubmit}},[t._v("同步下午并提交")])],1),a("van-field",{attrs:{name:"radio",label:"下午"},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.aftSchedule,callback:function(e){t.aftSchedule=e},expression:"aftSchedule"}},[a("van-radio",{attrs:{name:"0"}},[t._v("在岗办公")]),a("van-radio",{attrs:{name:"1"}},[t._v("本地出差")]),a("van-radio",{attrs:{name:"2"}},[t._v("外地出差")]),a("van-radio",{attrs:{name:"3"}},[t._v("请假/调休")])],1)]},proxy:!0}])}),a("van-field",{attrs:{rows:"2",autosize:"",label:"备注",type:"textarea",placeholder:"请输入下午的备注","show-word-limit":""},model:{value:t.aftRemark,callback:function(e){t.aftRemark=e},expression:"aftRemark"}})],1)],1)},ii=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"middleHeader"},[a("ul",{staticClass:"weekWarp"},[a("li",[t._v("一")]),a("li",[t._v("二")]),a("li",[t._v("三")]),a("li",[t._v("四")]),a("li",[t._v("五")]),a("li",[t._v("六")]),a("li",[t._v("日")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"remarkHeader"},[a("li",{staticClass:"title"},[t._v("客情信息")])])}];a("fb6a"),a("a9e3");function ni(t,e,a){return ri.apply(this,arguments)}function ri(){return ri=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:e+a,method:"post",data:s});case 2:return i=t.sent,t.abrupt("return",i.data);case 4:case"end":return t.stop()}}),t)}))),ri.apply(this,arguments)}var oi=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ni(j,"/api/schedule/getScheduleOfDateList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ci=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ni(j,"/api/schedule/insertSchedule",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),li=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"scheduleListWarp"},[+t.date1<+t.date2?a("van-notice-bar",{attrs:{"left-icon":"info-o"}},[t._v(" 已过去时间不可编辑或修改日程 ")]):t._e(),t.nowDetailList.mor||t.nowDetailList.aft?a("div",{staticClass:"hasSchedule"},[a("div",{staticClass:"APPMWarp"},[a("div",{staticClass:"AM AMPM",on:{click:t.scheduleClick}},[t.nowDetailList.mor?a("schedule-type",{attrs:{nowDetailListType:t.nowDetailList.mor}}):a("div",{staticClass:"changeSchedule clearfix"},[a("div",{staticClass:"text left clearfix"},[a("van-icon",{staticClass:"left",attrs:{name:"plus"}}),a("span",{staticClass:"left"},[t._v("选择日程")])],1),a("div",{staticClass:"scheduleList left clearfix"},[a("ul",{staticClass:"left  slh"},[a("span",{staticClass:"circle",staticStyle:{background:"#57c393"}}),t._v(" 在岗办公 ")]),a("ul",{staticClass:"left  slh"},[a("li",{staticClass:"circle",staticStyle:{background:"#2f9dff"}}),t._v(" 本地出差 ")]),a("ul",{staticClass:"left slh"},[a("li",{staticClass:"circle",staticStyle:{background:"#ffae5a"}}),t._v(" 外地出差 ")]),a("ul",{staticClass:"left slh"},[a("li",{staticClass:"circle",staticStyle:{background:"#ff7e84"}}),t._v(" 请假/调休 ")])])])],1),a("div",{staticClass:"addRemark clearfix"},[t._m(4),t.nowDetailList.morRemark?a("div",{staticClass:"remarkContent",on:{click:t.scheduleClick}},[t.nowDetailList.mor.remark?a("li",[t._v(" "+t._s(t.nowDetailList.mor.remark)+" ")]):t._e(),a("div",{staticClass:"time"},[t._v(" "+t._s(t.nowDetailList.mor?t.nowDetailList.mor.operationTime.substring(0,t.nowDetailList.mor.operationTime.length-3):"")+" ")])]):a("div",{staticClass:"remarkContent",on:{click:t.scheduleClick}},[a("li",[t._v(" 暂未维护 ")])])])]),a("div",{staticClass:"APPMWarp"},[a("div",{staticClass:"PM AMPM",on:{click:t.scheduleClick}},[t.nowDetailList.aft?a("schedule-type",{attrs:{nowDetailListType:t.nowDetailList.aft}}):a("div",{staticClass:"changeSchedule clearfix",on:{click:t.scheduleClick}},[a("div",{staticClass:"text left clearfix"},[a("van-icon",{staticClass:"left",attrs:{name:"plus"}}),a("span",{staticClass:"left"},[t._v("选择日程")])],1),a("div",{staticClass:"scheduleList left clearfix"},[a("ul",{staticClass:"left slh"},[a("span",{staticClass:"circle",staticStyle:{background:"#57c393"}}),t._v(" 在岗办公 ")]),a("ul",{staticClass:"left slh"},[a("li",{staticClass:"circle",staticStyle:{background:"#2f9dff"}}),t._v(" 本地出差 ")]),a("ul",{staticClass:"left slh"},[a("li",{staticClass:"circle",staticStyle:{background:"#ffae5a"}}),t._v(" 外地出差 ")]),a("ul",{staticClass:"left slh"},[a("li",{staticClass:"circle",staticStyle:{background:"#ff7e84"}}),t._v(" 请假/调休 ")])])])],1),a("div",{staticClass:"addRemark clearfix"},[t._m(5),t.nowDetailList.aft.remark?a("div",{staticClass:"remarkContent",on:{click:t.scheduleClick}},[a("li",[t._v(" "+t._s(t.nowDetailList.aft.remark)+" ")]),a("div",{staticClass:"time"},[t._v(" "+t._s(t.nowDetailList.aft?t.nowDetailList.aft.operationTime.substring(0,t.nowDetailList.aft.operationTime.length-3):"")+" ")])]):a("div",{staticClass:"remarkContent",on:{click:t.scheduleClick}},[a("li",[t._v(" 暂未维护 ")])])])])]):a("div",{staticClass:"changeSchedule allSchedule clearfix",on:{click:t.scheduleClick}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.userId,expression:"!userId"}],staticClass:"text left clearfix"},[a("div",{staticClass:"textWarp clearfix"},[a("van-icon",{staticClass:"left",attrs:{name:"plus"}}),a("span",{staticClass:"left"},[t._v("选择日程")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.userId,expression:"!userId"}],staticClass:"scheduleList left clearfix"},[t._m(0),t._m(1),t._m(2),t._m(3)]),a("van-empty",{directives:[{name:"show",rawName:"v-show",value:t.userId,expression:"userId"}],attrs:{description:"暂未维护日程"}})],1),a("van-dialog",{attrs:{"show-cancel-button":"",beforeClose:t.confirmDialog},on:{open:t.openDialog,close:t.closeDialog},model:{value:t.dialogShow,callback:function(e){t.dialogShow=e},expression:"dialogShow"}},[a("van-field",{attrs:{name:"radio",label:"上午"},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.morSchedule,callback:function(e){t.morSchedule=e},expression:"morSchedule"}},[a("van-radio",{attrs:{name:"0"}},[t._v("在岗办公")]),a("van-radio",{attrs:{name:"1"}},[t._v("本地出差")]),a("van-radio",{attrs:{name:"2"}},[t._v("外地出差")]),a("van-radio",{attrs:{name:"3"}},[t._v("请假/调休")]),t.morSchedule?a("van-radio",{attrs:{name:"-1"}},[t._v("取消日程")]):t._e()],1)]},proxy:!0}])}),a("van-field",{attrs:{rows:"2",autosize:"",label:"备注",type:"textarea",placeholder:"请输入上午的备注","show-word-limit":""},model:{value:t.nowDetailList.morRemark,callback:function(e){t.$set(t.nowDetailList,"morRemark",e)},expression:"nowDetailList.morRemark"}}),a("div",{staticClass:"tbSuccess clearfix"},[a("van-button",{staticClass:"right",attrs:{icon:"description",size:"mini",round:"",type:"primary"},on:{click:t.tbSubmit}},[t._v("同步下午并提交")])],1),a("van-field",{attrs:{name:"radio",label:"下午"},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.aftSchedule,callback:function(e){t.aftSchedule=e},expression:"aftSchedule"}},[a("van-radio",{attrs:{name:"0"}},[t._v("在岗办公")]),a("van-radio",{attrs:{name:"1"}},[t._v("本地出差")]),a("van-radio",{attrs:{name:"2"}},[t._v("外地出差")]),a("van-radio",{attrs:{name:"3"}},[t._v("请假/调休")]),t.aftSchedule?a("van-radio",{attrs:{name:"-1"}},[t._v("取消日程")]):t._e()],1)]},proxy:!0}])}),a("van-field",{attrs:{rows:"2",autosize:"",label:"备注",type:"textarea",placeholder:"请输入下午的备注","show-word-limit":""},model:{value:t.nowDetailList.aftRemark,callback:function(e){t.$set(t.nowDetailList,"aftRemark",e)},expression:"nowDetailList.aftRemark"}})],1)],1)},ui=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"left  slh"},[a("span",{staticClass:"circle",staticStyle:{background:"#57c393"}}),t._v(" 在岗办公 ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"left  slh"},[a("li",{staticClass:"circle",staticStyle:{background:"#2f9dff"}}),t._v(" 本地出差 ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"left slh"},[a("li",{staticClass:"circle",staticStyle:{background:"#ffae5a"}}),t._v(" 外地出差 ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"left slh"},[a("li",{staticClass:"circle",staticStyle:{background:"#ff7e84"}}),t._v(" 请假/调休 ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"remarkHeader"},[a("li",{staticClass:"title"},[t._v("我的备注")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"remarkHeader"},[a("li",{staticClass:"title"},[t._v("我的备注")])])}],di=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"typeWarp"},[a("span",{staticClass:"circle",style:0===t.nowDetailListType.scheduleType?"background: #57c393":1===t.nowDetailListType.scheduleType?"background: #2f9dff":2===t.nowDetailListType.scheduleType?"background: #ffae5a":3===t.nowDetailListType.scheduleType?"background: #ff7e84":""}),a("span",{style:0===t.nowDetailListType.scheduleType?"color: #57c393":1===t.nowDetailListType.scheduleType?"color: #2f9dff":2===t.nowDetailListType.scheduleType?"color: #ffae5a":3===t.nowDetailListType.scheduleType?"color: #ff7e84":""},[t._v(" "+t._s(0===t.nowDetailListType.scheduleType?"在岗办公":1===t.nowDetailListType.scheduleType?"本地出差":2===t.nowDetailListType.scheduleType?"外地出差":3===t.nowDetailListType.scheduleType?"请假/调休":"暂未维护")+" ")])])},hi=[],pi=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return a}(d["c"]);Object(u["a"])([Object(d["b"])()],pi.prototype,"nowDetailListType",void 0),pi=Object(u["a"])([Object(d["a"])({})],pi);var mi=pi,vi=mi,fi=(a("20f7"),Object(V["a"])(vi,di,hi,!1,null,"3c3d780c",null)),gi=fi.exports,bi=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.dialogShow=!1,t.morSchedule="",t.aftSchedule="",t.date1="",t.date2="",t}return Object(o["a"])(a,[{key:"scheduleClick",value:function(){this.userId||0===this.userId||Number(this.date1)<Number(this.date2)||(this.dialogShow=!0)}},{key:"tbSubmit",value:function(){this.aftSchedule=this.morSchedule,this.nowDetailList.aftRemark=this.nowDetailList.morRemark,this.confirmDialog("confirm","")}},{key:"confirmDialog",value:function(t,e){if(console.log(t),"confirm"===t){if(!this.morSchedule&&!this.aftSchedule)return this.$toast.fail("日程未录入"),void e();var a=[];a.push({cusId:this.nowDetailList.mor.cusId,timeSlot:1,scheduleDate:this.nowDetailList.chooseDate,scheduleType:!this.morSchedule&&0!==this.morSchedule||-1===this.morSchedule?"":this.morSchedule,remark:this.nowDetailList.morRemark}),a.push({cusId:this.nowDetailList.aft.cusId,timeSlot:2,scheduleDate:this.nowDetailList.chooseDate,scheduleType:!this.aftSchedule&&0!==this.aftSchedule||-1===this.aftSchedule?"":this.aftSchedule,remark:this.nowDetailList.aftRemark}),this._insertSchedule(a,e)}else e()}},{key:"closeDialog",value:function(){this.morSchedule=this.nowDetailList.mor&&(this.nowDetailList.mor.scheduleType||0===this.nowDetailList.mor.scheduleType)?String(this.nowDetailList.mor.scheduleType):"",this.aftSchedule=this.nowDetailList.aft&&(this.nowDetailList.aft.scheduleType||0===this.nowDetailList.aft.scheduleType)?String(this.nowDetailList.aft.aftSchedule):"",this.nowDetailList.aftRemark=this.nowDetailList.aft&&"null"!==this.nowDetailList.aft?this.nowDetailList.aft.remark:"",this.nowDetailList.morRemark=this.nowDetailList.mor&&"null"!==this.nowDetailList.mor?this.nowDetailList.mor.remark:""}},{key:"openDialog",value:function(){this.morSchedule=this.nowDetailList.mor&&(this.nowDetailList.mor.scheduleType||0===this.nowDetailList.mor.scheduleType)?String(this.nowDetailList.mor.scheduleType):"",this.aftSchedule=this.nowDetailList.aft&&(this.nowDetailList.aft.scheduleType||0===this.nowDetailList.aft.scheduleType)?String(this.nowDetailList.aft.scheduleType):"",console.log(this.nowDetailList)}},{key:"_insertSchedule",value:function(t,e){var a=this;ci(t).then((function(t){"200"===t.code?(a.$toast.success(t.msg),a.$emit("insertScheduleSuccess"),""===e&&(a.dialogShow=!1),e()):a.$toast.fail(t.msg)}))}},{key:"onAddressValueChanged",value:function(t){this.date1=Gs(new Date(t)).split("-").join(""),this.date2=Gs(new Date).split("-").join("")}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],bi.prototype,"nowDetailList",void 0),Object(u["a"])([Object(d["b"])()],bi.prototype,"userId",void 0),Object(u["a"])([Object(d["b"])()],bi.prototype,"nowClickDay",void 0),Object(u["a"])([Object(d["d"])("nowClickDay")],bi.prototype,"onAddressValueChanged",null),bi=Object(u["a"])([Object(d["a"])({components:{scheduleType:gi}})],bi);var yi=bi,_i=yi,ki=(a("1db7"),Object(V["a"])(_i,li,ui,!1,null,"7099ccca",null)),Ci=ki.exports,wi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"depPerson"},[a("van-popup",{style:{width:"100%",height:"98%"},attrs:{round:"",position:"bottom",closeable:""},on:{close:t.closeDepPerson},model:{value:t.depPersonIsShow,callback:function(e){t.depPersonIsShow=e},expression:"depPersonIsShow"}},[a("div",{staticClass:"title"},[a("span",{staticClass:"title-value"},[t._v("选择人员信息")])]),a("div",{staticClass:"search"},[a("van-search",{attrs:{placeholder:"请输入搜索人员名称","input-align":"center"},on:{input:t.searchPersonInput},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}})],1),t.searchVal?a("div",{staticClass:"searchPerson",class:t.isMultiple?"changeHeight":""},[t.isMultiple?a("van-checkbox-group",{model:{value:t.personCheckList,callback:function(e){t.personCheckList=e},expression:"personCheckList"}},t._l(t.personList,(function(e,s){return a("ul",{key:s,staticClass:"searchWarp clearfix",on:{click:function(a){return t.checkedClick(e)}}},[a("van-checkbox",{staticClass:"left",attrs:{disabled:!!t.disabled&&t.userIdList.some((function(t){return t===e.userId})),name:e.userId,"checked-color":"#554d62"}},[a("div",{staticClass:"searchContent left"},[a("li",{staticClass:"searchOne"},[a("span",{staticClass:"searchtitle"},[t._v("姓名：")]),a("span",{staticClass:"searchvalue"},[t._v(" "+t._s(e.userName)+" "),a("i",[t._v("("+t._s(e.userId)+")")])])]),a("li",[a("span",{staticClass:"searchtitle"},[t._v("电话：")]),a("span",{staticClass:"searchvalue"},[t._v(t._s(e.phoneNum))])])])])],1)})),0):a("van-radio-group",{model:{value:t.personRadio,callback:function(e){t.personRadio=e},expression:"personRadio"}},t._l(t.personList,(function(e,s){return a("ul",{key:s,staticClass:"searchWarp clearfix",on:{click:function(a){return t.radioClick(e)}}},[a("van-radio",{staticClass:"left",attrs:{size:"mini",disabled:!!t.disabled&&t.userIdList.some((function(t){return t===e.userId})),name:e.userId,"icon-size":"16px","checked-color":"#554d62"}},[a("div",{staticClass:"searchContent left"},[a("li",{staticClass:"searchOne"},[a("span",{staticClass:"searchtitle"},[t._v("姓名：")]),a("span",{staticClass:"searchvalue"},[t._v(" "+t._s(e.userName)+" "),a("i",[t._v("("+t._s(e.userId)+")")])])]),a("li",[a("span",{staticClass:"searchtitle"},[t._v("电话：")]),a("span",{staticClass:"searchvalue"},[t._v(t._s(e.phoneNum))])])])])],1)})),0),0!==t.personList.length||t.personloading?t._e():a("van-empty",{attrs:{description:t.description+"暂无成员信息"}}),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.personloading,expression:"personloading"}],staticClass:"paddingChange",attrs:{color:"#0094ff"}},[t._v("加载中...")]),t.isMultiple?a("div",{staticClass:"footer"},[t.personCheckList.length>0?a("ul",{staticClass:"findChanged left",on:{click:t.findChangedClick}},[a("li",{staticClass:"left"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.personCheckList.length>0,expression:"personCheckList.length > 0"}]},[t._v("已选"+t._s(t.personCheckList.length)+"人")])]),a("van-icon",{staticClass:"left",attrs:{name:"arrow-up"}})],1):t._e(),a("van-button",{staticClass:"right",attrs:{size:"small",plain:"",type:"info"},on:{click:t.checkSureClick}},[t._v("确定")])],1):t._e()],1):a("div",{staticClass:"noSearch"},[t.breadcrumbObj.length>0?a("div",{staticClass:"breadcrumb"},[a("ul",t._l(t.breadcrumbObj,(function(e,s){return a("li",{key:s,class:e.hasChild?"active":"",on:{click:function(a){return t.breadcrumbClick(e,s)}}},[a("span",{staticClass:"value left"},[t._v(t._s(e.value))]),a("van-icon",{staticClass:"left",attrs:{name:"arrow"}})],1)})),0)]):t._e(),a("div",{staticClass:"content clearfix",class:t.isMultiple?"heightChange":""},[t.depTreeList.length>1&&!t.hasdepMainChange?a("div",{staticClass:"moreMainDep"},t._l(t.depTreeList,(function(e,s){return a("van-cell",{key:s,attrs:{title:e.depName,"is-link":""},on:{click:function(a){return t.depMainChange(e)}}})})),1):a("van-collapse",{staticClass:"clearfix",attrs:{accordion:""},on:{change:t.changeCollapse},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[t.isMultiple?a("div",{staticClass:"left depWarp"},[t._l(t.userDepTreeList,(function(e,s){return a("van-collapse-item",{key:s,attrs:{name:s},scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{staticClass:"warp slh",staticStyle:{"padding-left":"10px"}},[t._v(" "+t._s(e.depName)+" ")])]},proxy:!0}],null,!0)},t._l(e.childList,(function(e,s){return a("van-cell",{key:e.depId+s,attrs:{clickable:""},scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{staticClass:"warp slh",staticStyle:{"padding-left":"10px"},on:{click:function(a){return t.depCellClick(e)}}},[t._v(" "+t._s(e.depName)+" ")])]},proxy:!0},{key:"right-icon",fn:function(){return[a("van-icon",{attrs:{name:"arrow"}})]},proxy:!0}],null,!0)})})),1)})),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.treeLoading,expression:"treeLoading"}],staticClass:"paddingChange",attrs:{color:"#0094ff"}},[t._v("加载中...")])],2):a("div",{staticClass:"left depWarp"},[t._l(t.userDepTreeList,(function(e,s){return a("van-collapse-item",{key:s,attrs:{title:e.depName,name:s}},t._l(e.childList,(function(e,s){return a("van-cell",{key:e.depId+s,attrs:{clickable:""},nativeOn:{click:function(a){return t.depCellClick(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(" "+t._s(e.depName)+" ")]},proxy:!0},{key:"right-icon",fn:function(){return[a("van-icon",{attrs:{name:"arrow"}})]},proxy:!0}],null,!0)})})),1)})),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.treeLoading,expression:"treeLoading"}],staticClass:"paddingChange",attrs:{color:"#0094ff"}},[t._v("加载中...")])],2),a("div",{staticClass:"personList left"},[a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.personloading,expression:"personloading"}],staticClass:"paddingChange",attrs:{color:"#0094ff"}},[t._v("加载中...")]),t.isMultiple?a("span",{staticClass:"title-btn",on:{click:t.checkAllOrToggle}},[t._v(t._s(t.checkMag))]):t._e(),0!==t.personList.length&&t.isMultiple?a("van-checkbox-group",{ref:"checkboxperson",on:{change:t.personChange},model:{value:t.personCheckList,callback:function(e){t.personCheckList=e},expression:"personCheckList"}},t._l(t.personList,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:""},nativeOn:{click:function(a){return a.stopPropagation(),function(a){return t.checkedClick(e)}()}},scopedSlots:t._u([{key:"title",fn:function(){return[a("van-checkbox",{ref:"checkboxes",refInFor:!0,attrs:{"checked-color":"#554d62",disabled:!!t.disabled&&t.userIdList.some((function(t){return t===e.userId})),name:e.userId}},[a("span",[t._v(t._s(e.userId)+"/"+t._s(e.userName))])])]},proxy:!0}],null,!0)})})),1):t._e(),0===t.personList.length||t.isMultiple?t._e():a("van-radio-group",{model:{value:t.personRadio,callback:function(e){t.personRadio=e},expression:"personRadio"}},t._l(t.personList,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:""},nativeOn:{click:function(a){return a.stopPropagation(),function(a){return t.radioClick(e)}()}},scopedSlots:t._u([{key:"title",fn:function(){return[a("van-radio",{ref:"checkboxes",refInFor:!0,attrs:{"checked-color":"#554d62",disabled:!!t.disabled&&t.userIdList.some((function(t){return t===e.userId})),name:e.userId}},[t._v(" "+t._s(e.userId)+"/"+t._s(e.userName)+" ")])]},proxy:!0}],null,!0)})})),1),0!==t.personList.length||t.personloading?t._e():a("van-empty",{attrs:{description:t.description+"暂无成员信息"}})],1)])],1),t.isMultiple?a("div",{staticClass:"footer"},[t.personCheckList.length>0?a("ul",{staticClass:"findChanged left",on:{click:t.findChangedClick}},[a("li",{staticClass:"left"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.personCheckList.length>0,expression:"personCheckList.length > 0"}]},[t._v("已选"+t._s(t.personCheckList.length)+"人")])]),a("van-icon",{staticClass:"left",attrs:{name:"arrow-up"}})],1):t._e(),a("van-button",{staticClass:"right",attrs:{size:"small",plain:"",type:"info"},on:{click:t.checkSureClick}},[t._v("确定")])],1):t._e()]),a("van-popup",{style:{height:"60%"},attrs:{position:"bottom",round:""},model:{value:t.changedShow,callback:function(e){t.changedShow=e},expression:"changedShow"}},[a("ul",{staticClass:"showDetail"},t._l(t.getpersonDetailList,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:""},scopedSlots:t._u([{key:"title",fn:function(){return[a("span",[t._v(t._s(e.userId)+"/"+t._s(e.userName))])]},proxy:!0},{key:"right-icon",fn:function(){return[a("van-icon",{attrs:{name:"cross",size:"20px"},nativeOn:{click:function(a){return a.stopPropagation(),t.deletePerson(e)}}})]},proxy:!0}],null,!0)})})),1)])],1)],1)},Li=[],xi=(a("a4d3"),a("e01a"),function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=j+"/api/Dep/getDepTree?treeType="+e.treeType+"&authorizedFlag="+e.authorizedFlag,s=null,t.prev=2,t.next=5,iv.get(a);case 5:if(s=t.sent,200!==s.status){t.next=8;break}return t.abrupt("return",Promise.resolve(s.data));case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),console.log(t.t0);case 13:return t.abrupt("return",s);case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}()),Ii=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=j+"/api/WebAppUser/getUserByParams",s=null,t.prev=2,t.next=5,iv.post(a,e);case 5:if(s=t.sent,200!==s.status){t.next=8;break}return t.abrupt("return",Promise.resolve(s.data));case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),console.log(t.t0);case 13:return t.abrupt("return",s);case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),Si=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=j+"/api/dictionary/getDictionaries",s=null,t.prev=2,t.next=5,iv.post(a,e);case 5:if(s=t.sent,200!==s.status){t.next=8;break}return t.abrupt("return",Promise.resolve(s.data));case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),console.log(t.t0);case 13:return t.abrupt("return",s);case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),Di=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=j+"/api/WebAppUser/queryCrmUser?phoneNum="+e.phoneNum,s=null,t.prev=2,t.next=5,iv.get(a);case 5:if(s=t.sent,200!==s.status){t.next=8;break}return t.abrupt("return",Promise.resolve(s.data));case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),console.log(t.t0);case 13:return t.abrupt("return",s);case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}();function Oi(t){return ji.apply(this,arguments)}function ji(){return ji=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=new FormData,Object.keys(e).forEach((function(t){a.append(t,e[t])})),t.next=4,iv({url:D+"/comm/file/upload",method:"post",data:a});case 4:return s=t.sent,s.data.success||Object(Dt["a"])({type:"warning",message:s.data.msg}),t.abrupt("return",s.data);case 7:case"end":return t.stop()}}),t)}))),ji.apply(this,arguments)}var Ti=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=j+"/api/report/queryWx",s=new FormData,Object.keys(e).forEach((function(t){s.append(t,e[t])})),i=null,t.prev=4,t.next=7,iv.post(a,s);case 7:if(i=t.sent,200!==i.status){t.next=10;break}return t.abrupt("return",Promise.resolve(i.data));case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](4),console.log(t.t0);case 15:return t.abrupt("return",i);case 16:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}(),Ri=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.activeNames=0,t.treeLoading=!1,t.userDepTreeList=[],t.personList=[],t.getpersonDetailList=[],t.personloading=!1,t.depPersonIsShow=!1,t.checkMag="全选",t.searchVal="",t.personCheckList=[],t.personRadio="",t.breadcrumbObj=[],t.description="",t.changedShow=!1,t.hasdepMainChange=!1,t}return Object(o["a"])(a,[{key:"isHas",value:function(t,e,a){var s=!1;return t.some((function(t){(e?t[e]:t)===a&&(s=!0)})),s}},{key:"depMainChange",value:function(t){this.userDepTreeList=[t],this.hasdepMainChange=!0}},{key:"changeCollapse",value:function(t){console.log(t)}},{key:"mapTreeList",value:function(t,e){for(var a=0;a<t.length;a++){var s=t[a];!s.operationFlag&&this.authorizedFlag||e.push(s.depId),s.childList&&s.childList.length>0&&this.mapTreeList(s.childList,e)}return e}},{key:"filterDelete",value:function(t,e,a){var s=t.filter((function(t){return!e.some((function(e){return(a?e[a]:e)===t}))}));return s}},{key:"filterPush",value:function(t,e,a){for(var s=0;s<e.length;s++){var i=e[s];-1===t.indexOf(a?i[a]:i)&&(t.push(a?i[a]:i),this.getpersonDetailList.push(i))}return t}},{key:"isContained",value:function(t,e){if(!(t instanceof Array)||!(e instanceof Array))return!1;if(t.length<e.length)return!1;for(var a=t.toString(),s=0,i=e.length;s<i;s++)if(-1===a.indexOf(e[s]))return!1;return!0}},{key:"yz",value:function(){for(var t=[],e=0;e<this.personList.length;e++){var a=this.personList[e];t.push(a.userId)}t.length>0?this.isContained(this.personCheckList,t)?this.checkMag="取消全选":this.checkMag="全选":this.checkMag=""}},{key:"checkAllOrToggle",value:function(){var t=this;if("全选"===this.checkMag)this.personCheckList=this.filterPush(this.personCheckList,this.personList,"userId"),this.checkMag="取消全选";else{this.personCheckList=this.filterDelete(this.personCheckList,this.personList,"userId");for(var e=0;e<this.getpersonDetailList.length;e++){var a=this.getpersonDetailList[e];-1===this.personCheckList.indexOf(a.userId)&&(this.getpersonDetailList.splice(e,1),e--)}for(var s=function(e){var a=t.userIdDetailList[e];t.isMultiple&&t.disabled&&t.userIdList.some((function(t){return+t===+a.userId}))&&!t.personCheckList.some((function(t){return+t===+a.userId}))&&(t.personCheckList.push(a.userId),t.getpersonDetailList.push(a))},i=0;i<this.userIdDetailList.length;i++)s(i);this.checkMag="全选"}}},{key:"breadcrumbClick",value:function(t,e){var a=this;t.obj[0].hasChild&&(this._getUserByParams({depIdList:this.mapTreeList(t.obj,[]),leaderFlag:this.leaderFlag,authorizedFlag:!0}).then((function(){a.yz()})),this.description=t.obj[0].depName,this.userDepTreeList=t.obj,this.breadcrumbObj.splice(e+1,this.breadcrumbObj.length-(e+1)))}},{key:"closeDepPerson",value:function(){this.$emit("closeDepPerson")}},{key:"depCellClick",value:function(t){var e=this;console.log(t),this._getUserByParams({depIdList:this.mapTreeList([t],[]),leaderFlag:this.leaderFlag,authorizedFlag:!0}).then((function(){e.yz()})),console.log(t),this.description=t.depName,this.breadcrumbObj.push({value:t.depName,hasChild:t.hasChild,obj:[t]}),this.userDepTreeList=[t]}},{key:"_getUserByParams",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a||(this.personList=[],this.personloading=!0),new Promise((function(s){Ii(t).then((function(t){"200"===t.code&&(a||(e.personList=t.data),s(t)),e.personloading=!1}))}))}},{key:"checkedClick",value:function(t){if(-1===this.personCheckList.indexOf(t.userId))if(0===this.getpersonDetailList.length)this.getpersonDetailList.push(t);else for(var e=0;e<this.getpersonDetailList.length;e++){var a=this.getpersonDetailList[e];if(t.userId!==a.userId)return void this.getpersonDetailList.push(t)}else for(var s=0;s<this.getpersonDetailList.length;s++){var i=this.getpersonDetailList[s];if(t.userId===i.userId)return void this.getpersonDetailList.splice(s,1)}}},{key:"personChange",value:function(t){0!==t.length&&this.yz()}},{key:"checkSureClick",value:function(){this.depPersonIsShow=!1,this.$emit("checkSureClick",{personCheckList:this.personCheckList,getpersonDetailList:this.getpersonDetailList})}},{key:"radioClick",value:function(t){this.depPersonIsShow=!1,this.$emit("radioClick",t)}},{key:"findChangedClick",value:function(){console.log(this.getpersonDetailList),this.changedShow=!0}},{key:"deletePerson",value:function(t){if(this.disabled&&this.userIdList.some((function(e){return+e===+t.userId})))this.$toast.fail("已@人员不能删除");else{for(var e=0;e<this.getpersonDetailList.length;e++){var a=this.getpersonDetailList[e];t.userId===a.userId&&this.getpersonDetailList.splice(e,1)}for(var s=0;s<this.personCheckList.length;s++){var i=this.personCheckList[s];t.userId===i&&this.personCheckList.splice(s,1)}}}},{key:"searchPersonInput",value:function(t){this.$cancelAxios(["getUserByParams"]),this._getUserByParams({keyword:t,leaderFlag:this.leaderFlag,authorizedFlag:!0})}},{key:"mounted",value:function(){var t=this;this.depPersonIsShow=this.depPersonShow,this.isMultiple?(this.personCheckList=this.userIdList?Object(y["a"])(this.userIdList):[],this.getpersonDetailList=this.userIdDetailList?Object(y["a"])(this.userIdDetailList):[]):this.personRadio=this.userIdList?Object(y["a"])(this.userIdList):[],0===this.depTreeList.length?xi({treeType:1,authorizedFlag:this.authorizedFlag}).then((function(e){"200"===e.code?(t.userDepTreeList=Object(y["a"])(e.data),t.breadcrumbObj=[{value:t.userDepTreeList[0].depName,hasChild:t.userDepTreeList[0].hasChild,obj:[t.userDepTreeList[0]]}],t._getUserByParams({depIdList:t.mapTreeList(t.userDepTreeList,[]),leaderFlag:t.leaderFlag,authorizedFlag:!0}),t.treeLoading=!1):t.$toast.fail(e.msg)})):1===this.depTreeList.length&&(this.userDepTreeList=Object(y["a"])(this.depTreeList),this.breadcrumbObj=[{value:this.depTreeList[0].depName,hasChild:this.depTreeList[0].hasChild,obj:[this.depTreeList[0]]}],this._getUserByParams({depIdList:this.mapTreeList(this.userDepTreeList,[]),leaderFlag:this.leaderFlag,authorizedFlag:!0}))}}]),a}(d["c"]);Object(u["a"])([h["a"]],Ri.prototype,"depTreeList",void 0),Object(u["a"])([Object(d["b"])()],Ri.prototype,"depPersonShow",void 0),Object(u["a"])([Object(d["b"])()],Ri.prototype,"isMultiple",void 0),Object(u["a"])([Object(d["b"])({type:Array,default:[]})],Ri.prototype,"userIdList",void 0),Object(u["a"])([Object(d["b"])()],Ri.prototype,"userIdDetailList",void 0),Object(u["a"])([Object(d["b"])({default:!1})],Ri.prototype,"leaderFlag",void 0),Object(u["a"])([Object(d["b"])({default:!0})],Ri.prototype,"authorizedFlag",void 0),Object(u["a"])([Object(d["b"])({default:!1})],Ri.prototype,"disabled",void 0),Ri=Object(u["a"])([Object(d["a"])({})],Ri);var Ni=Ri,Ai=Ni,Pi=(a("763e"),Object(V["a"])(Ai,wi,Li,!1,null,"47becbdd",null)),Ei=Pi.exports,Mi=Object(h["b"])("commonStore"),$i=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.nowOrClickYear=-1,t.nowOrClickMonth=-1,t.nowClickDay=new Date,t.dateRange=[],t.nowdataList=[],t.nowDetailList={},t.chooseDate=[],t.depPersonShow=!1,t.calendarShow=!1,t.loading=!1,t.userId="",t.userName="我的日程",t.customInforShow=!1,t.getUserVisitLoading=!1,t.tableDataList=[],t.dialogShow=!1,t.morSchedule="",t.morRemark="",t.aftSchedule="",t.aftRemark="",t}return Object(o["a"])(a,[{key:"changeDate",value:function(){this.initDay(new Date(this.nowClickDay)),this.calendarShow=!0}},{key:"calendarConfirm",value:function(t){this.calendarShow=!1,this.initDay(t)}},{key:"back",value:function(){this.$router.back()}},{key:"depPersonClick",value:function(){this.depTreeList&&0!==this.depTreeList.length&&(this.depPersonShow=!0)}},{key:"backToday",value:function(){this.initDay(new Date)}},{key:"backMine",value:function(){this.userId="",this.userName="我的日程",this._getScheduleOfDateList()}},{key:"initDay",value:function(t){this.nowClickDay=t,this.nowOrClickYear=new Date(t).getFullYear(),this.nowOrClickMonth=new Date(t).getMonth()+1,this.nowdataList=Qs(Hs(t),Ys(t)),this.dateRange=[new Date(Hs(t)),new Date(Ys(t))],this.chooseDate=[Gs(t)],this._getScheduleOfDateList()}},{key:"selectCalendar",value:function(t){this.calendarConfirm(t[0])}},{key:"clickChange",value:function(t){this.initDay(new Date(t))}},{key:"preWeek",value:function(){var t=new Date(this.nowClickDay);this.nowClickDay=new Date(this.nowClickDay.setTime(t.getTime()-6048e5)),this.nowdataList=Qs(Hs(this.nowClickDay),Ys(this.nowClickDay)),this.initDay(this.nowClickDay)}},{key:"nextWeek",value:function(){var t=new Date(this.nowClickDay);this.nowClickDay=new Date(this.nowClickDay.setTime(t.getTime()+6048e5)),this.nowdataList=Qs(Hs(this.nowClickDay),Ys(this.nowClickDay)),this.initDay(this.nowClickDay)}},{key:"closeDepPerson",value:function(){this.depPersonShow=!1}},{key:"radioClick",value:function(t){console.log(t),this.userId=t.userId,this.userName=t.userName,this._getScheduleOfDateList()}},{key:"insertScheduleSuccess",value:function(){this._getScheduleOfDateList()}},{key:"_getScheduleOfDateList",value:function(){var t=this;this.loading=!0;var e={userId:this.userId,scheduleDateList:this.chooseDate};oi(e).then((function(e){if("200"===e.code){var a;console.log(new Date(t.chooseDate[0]).toLocaleDateString());var s=Gs(new Date(t.chooseDate[0])).split("-").join(""),i=Gs(new Date).split("-").join("");a=Number(s)<Number(i)?{chooseDate:t.chooseDate[0],mor:{cusId:"",operationTime:"",remark:"",scheduleDate:"",scheduleType:"",starNum:"",timeSlot:1,userId:"",usestatus:"",visitNum:""},morRemark:"",aft:{cusId:"",operationTime:"",remark:"",scheduleDate:"",scheduleType:"",starNum:"",timeSlot:2,userId:"",usestatus:"",visitNum:""},aftRemark:""}:{chooseDate:t.chooseDate[0],mor:"",morRemark:"",aft:"",aftRemark:""};for(var n=0;n<e.data.length;n++){var r=e.data[n];1===r.timeSlot?(a.mor=r,a.morRemark=r.remark&&"null"!==r.remark?r.remark:""):2===r.timeSlot&&(a.aft=r,a.aftRemark=r.remark&&"null"!==r.remark?r.remark:"")}t.nowDetailList=a}t.loading=!1}))}},{key:"queryCustomer",value:function(){this._getUserVisit(),this.customInforShow=!0}},{key:"_getUserVisit",value:function(){var t=this;this.getUserVisitLoading=!0,this.$cancelAxios(["getUserVisit"]),console.log(this.nowClickDay);var e={startTime:Gs(this.nowClickDay)+" 00:00:00",endTime:Gs(this.nowClickDay)+" 23:59:59",pageNum:1,pageSize:200,userIdList:[]};vt(e).then((function(e){"200"===e.code&&(t.tableDataList=e.data.list),t.getUserVisitLoading=!1}))}},{key:"autoClick",value:function(){this.dialogShow=!0}},{key:"openDialog",value:function(){this.morSchedule="",this.aftSchedule="",console.log(this.nowDetailList)}},{key:"tbSubmit",value:function(){this.aftSchedule=this.morSchedule,this.aftRemark=this.morRemark&&"null"!==this.morRemark?this.morRemark:"",this.confirmDialog("confirm","")}},{key:"confirmDialog",value:function(t,e){var a=this;if(console.log(t),"confirm"===t){var s={userId:this.userId,scheduleDateList:this.nowdataList};oi(s).then((function(t){if("200"===t.code){for(var s=[],i=0;i<a.nowdataList.slice(0,5).length;i++){var n=a.nowdataList[i],r={cusId:"",operationTime:"",remark:a.morRemark&&"null"!==a.morRemark?a.morRemark:"",scheduleDate:n,scheduleType:a.morSchedule,starNum:"",timeSlot:1,userId:"",usestatus:"",visitNum:""},o={cusId:"",operationTime:"",remark:a.aftRemark&&"null"!==a.aftRemark?a.aftRemark:"",scheduleDate:n,scheduleType:a.aftSchedule,starNum:"",timeSlot:2,userId:"",usestatus:"",visitNum:""};if(t.data.length>0)for(var c=0;c<t.data.length;c++){var l=t.data[c];n===l.scheduleDate.substring(0,10)&&1===l.timeSlot&&(r.remark=l.remark&&"null"!==l.remark?l.remark:a.morRemark,r.scheduleType=!l.scheduleType&&0!==l.scheduleType||-1===l.scheduleType?a.morSchedule:l.scheduleType,r.cusId=l.cusId,r.scheduleDate=l.scheduleDate),n===l.scheduleDate.substring(0,10)&&2===l.timeSlot&&(o.remark=l.remark&&"null"!==l.remark?l.remark:a.aftRemark,o.scheduleType=!l.scheduleType&&0!==l.scheduleType||-1===l.scheduleType?a.aftSchedule:l.scheduleType,o.cusId=l.cusId,o.scheduleDate=l.scheduleDate)}var u=Gs(new Date).split("-").join("");r.scheduleDate.split("-").join("")>u&&s.push(r),o.scheduleDate.split("-").join("")>u&&s.push(o)}console.log(s),a.$refs.scheduleList._insertSchedule(s,e),a.dialogShow=!1}}))}else e()}},{key:"mounted",value:function(){this.nowOrClickYear=(new Date).getFullYear(),this.nowOrClickMonth=(new Date).getMonth()+1,this.nowdataList=Qs(Hs(new Date),Ys(new Date)),this.chooseDate=[Gs(new Date)],this.tableDataList=[],this._getScheduleOfDateList(),this.depTreeList||this.actionGetDepTree({treeType:1,authorizedFlag:!0})}}]),a}(d["c"]);Object(u["a"])([Mi.Action],$i.prototype,"actionGetDepTree",void 0),Object(u["a"])([h["a"]],$i.prototype,"depTreeList",void 0),$i=Object(u["a"])([Object(d["a"])({components:{depPerson:Ei,scheduleList:Ci}})],$i);var qi=$i,Vi=qi,Ui=(a("d09c"),Object(V["a"])(Vi,si,ii,!1,null,null,null)),Fi=Ui.exports,zi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"weekly"},[a("div",{staticClass:"header"},[0===t.depTreeList.length?a("div",{staticClass:"person left"},[a("span",{staticClass:"left"},[t._v(t._s(t.personMsg))])]):a("van-dropdown-menu",{staticClass:"left",attrs:{"active-color":"#1989fa"}},[a("van-dropdown-item",{ref:"dropObj",attrs:{options:t.weekTypeoptions},nativeOn:{click:function(e){return t.weekTypeChange(e)}},model:{value:t.weekType,callback:function(e){t.weekType=e},expression:"weekType"}}),a("van-button",{staticClass:"dropButton",attrs:{size:"mini",type:"default",round:!0},on:{click:t.dropClick}},[t._v("点击切换")])],1),a("div",{staticClass:"btnWarp right"},[a("i",{staticClass:"iconfont ytcrm-center left",on:{click:t.back}})])],1),a("div",{staticClass:"weekChange clearfix"},[a("div",{staticClass:"timeMsg left",on:{click:t.changeTimeClick}},[a("span",{staticClass:"left"},[t._v(t._s(t.changeTimeMsg))]),a("i",{staticClass:"iconfont ytcrm-qiehuan left"}),t.weekYearNowNumber!==t.weekYearNumber?a("van-button",{staticClass:"left",attrs:{size:"mini",type:"default",round:!0},on:{click:function(e){return e.stopPropagation(),t.backWeek(e)}}},[t._v("回本周")]):t._e()],1),a("div",{staticClass:"warp right"},[a("van-icon",{attrs:{name:"arrow-left"},on:{click:t.preWeek}}),a("van-icon",{attrs:{name:"arrow"},on:{click:t.nextWeek}})],1)]),a("div",{staticClass:"mainWarp"},[a("div",{directives:[{name:"show",rawName:"v-show",value:""===t.weeklyReportStatus,expression:"weeklyReportStatus === ''"}],staticClass:"weekContentWarp"},[t.weeklyReportLoading?a("van-loading",{staticClass:"paddingChange",attrs:{color:"#0094ff"}},[t._v("加载中...")]):a("div",{staticClass:"content"},[a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.weeklyReportObj.commitFlag,expression:"weeklyReportObj.commitFlag === 0"}],staticClass:"contentButton clearfix"},[(t.depTreeList.length>0&&1===t.weekType||0===t.depTreeList.length&&0===t.weekType)&&t.leaderList.length>1?a("van-dropdown-menu",{staticClass:"left",staticStyle:{"padding-left":"10px"}},[a("van-dropdown-item",{ref:"submitLeader",attrs:{title:t.submitLeaderName},model:{value:t.submitLeaderId,callback:function(e){t.submitLeaderId=e},expression:"submitLeaderId"}},t._l(t.leaderList,(function(e,s){return a("van-cell",{key:s,attrs:{center:"",title:e.leaderName},on:{click:function(a){return t.submitLeaderChange(e)}},scopedSlots:t._u([{key:"right-icon",fn:function(){return[a("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.submitLeaderId===e.leaderId,expression:"submitLeaderId === item.leaderId"}],attrs:{name:"success",color:"#ee0a24"}})]},proxy:!0}],null,!0)})})),1)],1):1===t.leaderList.length?a("span",{staticClass:"fontWeight",staticStyle:{color:"#f56c6c","padding-left":"10px","font-size":"14px","line-height":"20px"}},[t._v("暂未维护汇报领导!")]):t._e(),a("van-button",{directives:[{name:"show",rawName:"v-show",value:t.depTreeList.length>0&&1===t.weekType||0===t.depTreeList.length&&0===t.weekType,expression:"(depTreeList.length > 0 && weekType === 1) || (depTreeList.length === 0 && weekType === 0)"}],staticClass:"right",attrs:{size:"mini",round:"",type:"primary"},on:{click:t.submitReportClick}},[t._v(" 提交 ")]),a("van-button",{staticClass:"right",attrs:{size:"mini",round:"",type:"info"},on:{click:t.saveClick}},[t._v("暂存")]),a("span",{staticClass:"reload right",on:{click:function(e){return t.generateClick("reload")}}},[t._v("重新生成")])],1),a("div",{staticClass:"contentHeader"},[a("span",{staticClass:"year fontWeight"},[t._v(" "+t._s(t.nowYear)+" ")]),a("span",{staticClass:"week"},[t._v("第"+t._s(t.weekNumber)+"周周报")]),t.leaderList.length>2&&0===t.weeklyReportObj.commitFlag?a("van-button",{staticClass:"changeAll",attrs:{size:"mini",round:"",type:"info",plain:""},on:{click:t.changeAllClick}},[t._v(" "+t._s(t.checkAllMsg)+" ")]):t._e(),a("span",{directives:[{name:"show",rawName:"v-show",value:2!==t.weekType,expression:"weekType !== 2"}],staticClass:"person right"},[t._v("填报人："+t._s(t.weeklyReportObj.userName))])],1),a("van-notice-bar",{directives:[{name:"show",rawName:"v-show",value:0===t.weeklyReportObj.commitFlag&&(t.depTreeList.length>0&&1===t.weekType||0===t.depTreeList.length&&0===t.weekType),expression:"weeklyReportObj.commitFlag === 0 && ((depTreeList.length > 0 && weekType === 1) || (depTreeList.length === 0 && weekType === 0))"}],attrs:{scrollable:"","left-icon":"volume-o",text:"如有修改，请先点击暂存，再点击提交！"}}),a("div",{staticClass:"contentWarp",class:0===t.weeklyReportObj.commitFlag?"":"contentWarpHeight"},[a("weekly-content",{ref:"weeklyContent",attrs:{leaderList:t.leaderList,weekType:t.weekType,weeklyObj:t.weeklyReportObj,userIdDetailList:t.userIdDetailList},on:{checkedResultChange:t.checkedResultChange}})],1)],1),a("ul",{staticClass:"quickFix"},t._l(t.weeklyReportObj.resultList,(function(e,s){return a("ul",{key:s,staticClass:"item",attrs:{effect:"dark",content:e.majorClassLabelName,placement:"left-start"}},[a("li",{directives:[{name:"show",rawName:"v-show",value:e.childList&&e.childList.length>0,expression:"item.childList && item.childList.length > 0"}],on:{click:function(e){return t.quickFixClick(s)}}},[t._v(t._s(e.majorClassLabelName.substring(0,2)))])])})),0)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"weeklyReportErr400"===t.weeklyReportStatus,expression:"weeklyReportStatus === 'weeklyReportErr400'"}],staticClass:"noweekContentWarp"},[a("van-empty",{attrs:{description:t.weeklyReportMsg}},[a("van-button",{directives:[{name:"show",rawName:"v-show",value:0===t.userIdList.length,expression:"userIdList.length === 0"}],attrs:{size:"small",round:"",type:"warning"},on:{click:t.generateClick}},[t._v("点击生成")])],1)],1)]),a("van-calendar",{attrs:{type:"range","default-date":t.dateRange,"min-date":new Date(2020,0,1),"first-day-of-week":"6",color:"#1989fa","show-confirm":!1},on:{select:t.changeTimeSelect},model:{value:t.changeTimeshow,callback:function(e){t.changeTimeshow=e},expression:"changeTimeshow"}}),t.depPersonShow?a("dep-person",{attrs:{userIdList:t.userIdList,userIdDetailList:t.userIdDetailList,isMultiple:!0,leaderFlag:!t.needQueryAll,depPersonShow:t.depPersonShow},on:{checkSureClick:t.checkSureClick,closeDepPerson:t.closeDepPerson}}):t._e()],1)},Wi=[],Bi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"weeklyContent",attrs:{id:"weekLabelcontentWarp"}},[t._l(t.weeklyObj.resultList,(function(e,s){return a("ul",{key:s,attrs:{id:"weekLabeltitle"+s}},[a("li",{staticClass:"header fontWeight"},[t._v(t._s(0===s?"一、":1===s?"二、":2===s?"三、":3===s?"四、":4===s?"五、":"")+t._s(e.majorClassLabelName))]),t._l(e.childList,(function(s,i){return a("li",{key:i,staticClass:"content"},[a("div",{staticClass:"contentHeader fontWeight"},[t._v(" "+t._s(i+1)+"、"+t._s(s.subClassLabelName)+" "),a("van-icon",{directives:[{name:"show",rawName:"v-show",value:0===t.weeklyObj.commitFlag,expression:"weeklyObj.commitFlag === 0"}],staticClass:"right",attrs:{name:"add"},on:{click:function(a){return t.addClick(e.majorClassLabelId,s.subClassLabelId,s.subClassLabelName,s.reportDtoList,s.tableType)}}})],1),s.reportDtoList.length>0&&0===t.weeklyObj.commitFlag?a("div",{staticClass:"formWarp"},t._l(s.reportDtoList,(function(e,i){return a("p",{key:i},[t.leaderList.length>2?a("van-checkbox",{on:{change:function(a){return t.checkedResultChange(a,e)}},model:{value:e.checked,callback:function(a){t.$set(e,"checked",a)},expression:"reportDtoItem.checked"}}):t._e(),a("i",{staticClass:"iconfont ytcrm-shanchu",on:{click:function(a){return t.deleteList(s.reportDtoList,e,i)}}}),4===s.tableType||e.cwrdtlId?t._e():a("van-cell",{attrs:{title:"单位类型",name:"picker",value:1===e.objType?"供应商":2===e.objType?"下游客户":3===e.objType?"政府单位":"点击选择单位类型","is-link":""},on:{click:function(a){return t.objTypeClick(e)}}}),4!==s.tableType&&e.cwrdtlId?a("van-cell",{attrs:{title:"单位类型",value:1===e.objType?"供应商":2===e.objType?"下游客户":3===e.objType?"政府单位":"点击选择单位类型"}}):t._e(),4===s.tableType?a("van-cell",{attrs:{title:"类型",name:"picker",value:10052===e.objId?"客户拜访":10051===e.objId?"品种进院":10050===e.objId?"厂家协同":10049===e.objId?"货款催收":10048===e.objId?"其他事务":"点击选择","is-link":""},on:{click:function(a){return t.planClick(e)}}}):t._e(),4===s.tableType||e.cwrdtlId?t._e():a("van-cell",{attrs:{title:"单位信息","is-link":"",value:e.objName?e.objName:"点击选择单位信息"},on:{click:function(a){return t.objChangeClick(e)}}}),4!==s.tableType&&e.cwrdtlId?a("van-cell",{attrs:{title:"单位信息",value:e.objName?e.objName:"点击选择单位信息"}}):t._e(),2===s.tableType?a("van-field",{attrs:{name:"预期时间",label:"预期时间",placeholder:"请输入预期时间",rules:[{required:!0,message:"请填写预期时间"}]},on:{input:function(a){return t.inputChange(e)}},model:{value:e.exceptTimeStr,callback:function(a){t.$set(e,"exceptTimeStr",a)},expression:"reportDtoItem.exceptTimeStr"}}):t._e(),4===s.tableType?a("van-field",{attrs:{rows:"1",autosize:"",label:"项目",type:"textarea",placeholder:"请输入项目名称"},on:{input:function(a){return t.inputChange(e)}},model:{value:e.objName,callback:function(a){t.$set(e,"objName",a)},expression:"reportDtoItem.objName"}}):t._e(),4!==s.tableType?a("van-field",{attrs:{rows:"2",autosize:"",label:"详情",type:"textarea",placeholder:"请输入详情","show-word-limit":""},on:{input:function(a){return t.inputChange(e)}},model:{value:e.labelRemark,callback:function(a){t.$set(e,"labelRemark",a)},expression:"reportDtoItem.labelRemark"}}):t._e(),4===s.tableType?a("van-field",{attrs:{rows:"2",autosize:"",label:"计划",type:"textarea",placeholder:"请输入详情","show-word-limit":""},on:{input:function(a){return t.inputChange(e)}},model:{value:e.labelRemark,callback:function(a){t.$set(e,"labelRemark",a)},expression:"reportDtoItem.labelRemark"}}):t._e(),0!==t.weekType&&e.userId?a("van-cell",{attrs:{title:"填报人",value:e.userId+"/"+e.userName}}):t._e(),0===t.weekType?a("van-cell",{attrs:{title:"提交对象",value:e.submitUserName}}):t._e()],1)})),0):t._e(),s.reportDtoList.length>0&&1===t.weeklyObj.commitFlag||t.userIdDetailList&&t.userIdDetailList.length>0?a("div",{staticClass:"contentWarp"},t._l(s.reportDtoList,(function(e,i){return a("p",{key:i},[4!==s.tableType?a("van-cell",{attrs:{title:"单位类型",value:1===e.objType?"供应商":2===e.objType?"下游客户":3===e.objType?"政府单位":"点击选择单位类型"}}):t._e(),4===s.tableType?a("van-cell",{attrs:{title:"类型",value:10052===e.objId?"客户拜访":10051===e.objId?"品种进院":10050===e.objId?"厂家协同":10049===e.objId?"货款催收":10048===e.objId?"其他事务":"点击选择"}}):t._e(),4!==s.tableType?a("van-cell",{attrs:{title:"单位信息",value:e.objName?e.objName:"点击选择单位信息"}}):t._e(),2===s.tableType?a("van-cell",{attrs:{title:"预期时间",value:e.exceptTimeStr}}):t._e(),4!==s.tableType?a("van-cell",{attrs:{title:"详情",value:e.labelRemark}}):t._e(),4===s.tableType?a("van-cell",{attrs:{title:"计划",value:e.labelRemark}}):t._e(),0!==t.weekType?a("van-cell",{attrs:{title:"填报人",value:e.userId+"/"+e.userName}}):t._e(),0===t.weekType?a("van-cell",{attrs:{title:"提交对象",value:e.submitUserName}}):t._e()],1)})),0):t._e(),0===s.reportDtoList.length?a("div",{staticClass:"noList"},[t._v(" 暂无信息 ")]):t._e()])}))],2)})),a("van-popup",{attrs:{position:"bottom"},model:{value:t.objTypeShowPicker,callback:function(e){t.objTypeShowPicker=e},expression:"objTypeShowPicker"}},[t.objTypeShowPicker?a("van-picker",{attrs:{"show-toolbar":"",columns:t.objTypeColumns},on:{confirm:t.objTypeOnConfirm,cancel:function(e){t.objTypeShowPicker=!1}}}):t._e()],1),a("van-popup",{attrs:{position:"bottom"},model:{value:t.planShowPicker,callback:function(e){t.planShowPicker=e},expression:"planShowPicker"}},[t.planShowPicker?a("van-picker",{attrs:{"show-toolbar":"",columns:t.planColumns},on:{confirm:t.planOnConfirm,cancel:function(e){t.planShowPicker=!1}}}):t._e()],1),a("van-popup",{style:{height:"95%"},attrs:{closeable:"",round:"",position:"bottom"},model:{value:t.objShowPicker,callback:function(e){t.objShowPicker=e},expression:"objShowPicker"}},[t.objShowPicker?a("div",{staticClass:"objWarp"},[a("van-search",{attrs:{placeholder:"请输入搜索关键词"},on:{input:t.searchValueInput},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}}),a("div",{staticClass:"content"},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[2===t.reportDtoChooseObj.objType?a("div",{staticClass:"warp"},t._l(t.custlistOptions,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:"",title:e.custId+"/"+e.custName},on:{click:function(a){return t.changeCust(e)}}})})),1):t._e(),1===t.reportDtoChooseObj.objType?a("div",{staticClass:"warp"},t._l(t.providerInforOptions,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:"",title:e.cpiId+"/"+e.providerName},on:{click:function(a){return t.changeProvider(e)}}})})),1):t._e(),3===t.reportDtoChooseObj.objType?a("div",{staticClass:"warp"},t._l(t.goverListOptions,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:"",title:e.govAttributeId+"/"+e.govAttributeName+"("+e.orgnizationName+") --- "+e.ssqCodeName},on:{click:function(a){return t.changeGover(e)}}})})),1):t._e()])],1)],1)],1):t._e()])],2)},Gi=[];function Hi(t,e,a){return Yi.apply(this,arguments)}function Yi(){return Yi=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:e+a,method:"post",data:s});case 2:return i=t.sent,t.abrupt("return",i.data);case 4:case"end":return t.stop()}}),t)}))),Yi.apply(this,arguments)}var Qi=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Hi(j,"/api/WeeklyReport/getReportDtl",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ki=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Hi(j,"/api/WeeklyReport/generateReport",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ji=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Hi(j,"/api/WeeklyReport/insOrUpdReport",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Xi=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Hi(j,"/api/WeeklyReport/submitReport",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Zi=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Hi(j,"/api/WeeklyReport/dltReport",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),tn=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Hi(j,"/api/UserDep/getLeader",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),en=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.checkedResult={},t.custlistOptions=[],t.goverListOptions=[],t.providerInforOptions=[],t.checkAllMsg=[],t.objTypeColumns=[{text:"下游客户",typeNum:1,id:2},{text:"政府单位",typeNum:34,id:3},{text:"供应商",typeNum:11,id:1}],t.planColumns=[{text:"客户拜访",value:10052},{text:"品种进院",value:10051},{text:"厂家协同",value:10050},{text:"货款催收",value:10049},{text:"其他事务",value:10048}],t.objTypeShowPicker=!1,t.planShowPicker=!1,t.objShowPicker=!1,t.reportDtoChooseObj={},t.searchValue="",t.loading=!1,t.finished=!1,t.refreshing=!1,t.page=1,t}return Object(o["a"])(a,[{key:"searchValueInput",value:function(t){this.page=1,this.providerInforOptions=[],this.custlistOptions=[],this.goverListOptions=[],t?(this.$cancelAxios(["queryGovernmentForVisit","queryProviderForVisit","queryCustListByUserId"]),this.onLoad()):this.onRefresh()}},{key:"objTypeOnConfirm",value:function(t){var e=this;this.reportDtoChooseObj.objId!==t.id?this.reportDtoChooseObj.objName?this.$dialog.confirm({title:"提示",message:"切换单位类型将清空已有单位信息，确定要切换吗？",beforeClose:function(a,s){"confirm"===a?(e.$set(e.reportDtoChooseObj,"objType",t.id),e.$set(e.reportDtoChooseObj,"objId",""),e.$set(e.reportDtoChooseObj,"objName",""),e.reportDtoChooseObj.cwrdocId||e.$set(e.reportDtoChooseObj,"cwrdocId",e.weeklyObj.cwrdocId),e.objTypeShowPicker=!1,s()):s()}}):(this.$set(this.reportDtoChooseObj,"objType",t.id),this.reportDtoChooseObj.cwrdocId||this.$set(this.reportDtoChooseObj,"cwrdocId",this.weeklyObj.cwrdocId),this.objTypeShowPicker=!1):this.objTypeShowPicker=!1}},{key:"planOnConfirm",value:function(t){console.log(this.reportDtoChooseObj),console.log(t),this.reportDtoChooseObj.cwrdocId||this.$set(this.reportDtoChooseObj,"cwrdocId",this.weeklyObj.cwrdocId),this.$set(this.reportDtoChooseObj,"objId",t.value),this.planShowPicker=!1}},{key:"objTypeClick",value:function(t){t.cwrdocId||this.$set(t,"cwrdocId",this.weeklyObj.cwrdocId),this.reportDtoChooseObj=t,this.objTypeShowPicker=!0}},{key:"planClick",value:function(t){t.cwrdocId||this.$set(t,"cwrdocId",this.weeklyObj.cwrdocId),this.reportDtoChooseObj=t,this.planShowPicker=!0}},{key:"objChangeClick",value:function(t){t.cwrdocId||this.$set(t,"cwrdocId",this.weeklyObj.cwrdocId),this.reportDtoChooseObj=t,t.objType?(this.loading=!1,this.finished=!1,this.refreshing=!1,this.objShowPicker=!0):this.$toast.fail("请先选择单位类型")}},{key:"inputChange",value:function(t){t.cwrdocId||this.$set(t,"cwrdocId",this.weeklyObj.cwrdocId)}},{key:"deleteList",value:function(t,e,a){e.cwrdtlId?this._dltReport([e.cwrdtlId],t,a):t.splice(a,1)}},{key:"_dltReport",value:function(t,e,a){var s=this;Zi(t).then((function(t){"200"===t.code?(s.$toast.success(t.msg),e.splice(a,1)):s.$toast.fail(t.msg)}))}},{key:"addClick",value:function(t,e,a,s,i){var n={};switch(i){case 1:n={cwrdocId:this.weeklyObj.cwrdocId,firstClassType:t,secondClassType:e,secondClassTypeName:a,tableType:i,objId:"",objName:"",labelRemark:"",editing:!0,isSaveClick:!1};break;case 2:n={cwrdocId:this.weeklyObj.cwrdocId,firstClassType:t,secondClassType:e,secondClassTypeName:a,tableType:i,objType:"",objId:"",objName:"",exceptTimeStr:"",labelRemark:"",editing:!0,isSaveClick:!1};break;case 3:n={cwrdocId:this.weeklyObj.cwrdocId,firstClassType:t,secondClassType:e,secondClassTypeName:a,tableType:i,objType:"",objId:"",objName:"",labelRemark:"",editing:!0,isSaveClick:!1};break;case 4:n={cwrdocId:this.weeklyObj.cwrdocId,firstClassType:t,secondClassType:e,secondClassTypeName:a,tableType:i,objType:5,objId:"",objName:"",labelRemark:"",editing:!0,isSaveClick:!1};break;default:break}s.unshift(n)}},{key:"_getGoverList",value:function(){var t=this,e={orgnizationKeyword:this.searchValue};It(e).then((function(e){"200"===e.code&&(t.goverListOptions=e.data),t.finished=!0}))}},{key:"_queryCustListByUserId",value:function(){var t=this;1===this.page&&(this.providerInforOptions=[]);var e={pageNum:this.page,pageSize:10,cust:this.searchValue,type:0===this.weekType?1:2};return new Promise((function(a){_t(e).then((function(e){"200"===e.code&&(t.custlistOptions=t.custlistOptions.length>0?t.custlistOptions.concat(e.data.list):e.data.list,a(e.data))}))}))}},{key:"_queryProviderBaseMsg",value:function(){var t=this;1===this.page&&(this.providerInforOptions=[]);var e={providerNameOrId:this.searchValue,useridList:[localStorage.getItem("userId")],pageSize:10,pageNum:this.page};return new Promise((function(a){xt(e).then((function(e){"200"===e.code&&(t.providerInforOptions=t.providerInforOptions.length>0?t.providerInforOptions.concat(e.data.list):e.data.list,a(e.data))}))}))}},{key:"onLoad",value:function(){var t=this;this.refreshing&&(this.page=1,this.providerInforOptions=[],this.refreshing=!1),1===this.reportDtoChooseObj.objType?(this.loading=!0,this._queryProviderBaseMsg().then((function(e){e.hasNextPage?(t.loading=!1,t.page++):t.finished=!0}))):2===this.reportDtoChooseObj.objType?(this.loading=!0,this._queryCustListByUserId().then((function(e){e.hasNextPage?(t.loading=!1,t.page++):t.finished=!0}))):3===this.reportDtoChooseObj.objType&&(this.loading=!0,this._getGoverList())}},{key:"onRefresh",value:function(){this.finished=!1,this.searchValue="",this.loading=!0,this.onLoad()}},{key:"changeCust",value:function(t){t.cwrdocId||this.$set(t,"cwrdocId",this.weeklyObj.cwrdocId),this.$set(this.reportDtoChooseObj,"objId",t.custId),this.$set(this.reportDtoChooseObj,"objName",t.custName),this.objShowPicker=!1}},{key:"changeProvider",value:function(t){t.cwrdocId||this.$set(t,"cwrdocId",this.weeklyObj.cwrdocId),this.$set(this.reportDtoChooseObj,"objId",t.cpiId),this.$set(this.reportDtoChooseObj,"objName",t.providerName),this.objShowPicker=!1}},{key:"changeGover",value:function(t){t.cwrdocId||this.$set(t,"cwrdocId",this.weeklyObj.cwrdocId),this.$set(this.reportDtoChooseObj,"objId",t.cgId),this.$set(this.reportDtoChooseObj,"objName",t.govAttributeId+"/"+t.govAttributeName+"("+t.orgnizationName+")"),this.objShowPicker=!1}},{key:"checkedResultChange",value:function(t,e){e.cwrdtlId?this.$emit("checkedResultChange"):(this.$toast.fail("请先保存新增数据，再选择提交"),this.$set(e,"checked",!1))}},{key:"changeAllClick",value:function(t,e){for(var a=0;a<t.reportDtoList.length;a++){var s=t.reportDtoList[a];this.$set(s,"checked",!s.checked),s.checked?this.checkAllMsg[e]="取消全选":this.checkAllMsg[e]="全选"}}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],en.prototype,"weeklyObj",void 0),Object(u["a"])([Object(d["b"])()],en.prototype,"userIdDetailList",void 0),Object(u["a"])([Object(d["b"])()],en.prototype,"weekType",void 0),Object(u["a"])([Object(d["b"])()],en.prototype,"leaderList",void 0),en=Object(u["a"])([Object(d["a"])({})],en);var an=en,sn=an,nn=(a("bdde"),Object(V["a"])(sn,Bi,Gi,!1,null,null,null)),rn=nn.exports,on=a("1157"),cn=a.n(on),ln=Object(h["b"])("commonStore"),un=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.changeTimeshow=!1,t.changeTimeMsg="选择周",t.nowChangeTime=new Date,t.nowYear=0,t.weekNumber=0,t.weekYearNumber="",t.weekYearNowNumber="",t.dateRange=[],t.startTime="",t.endTime="",t.personMsg="我的周报",t.weekType=0,t.weekTypeoptions=[{text:"我的周报",value:0}],t.depPersonShow=!1,t.weeklyReportStatus="",t.weeklyReportMsg="",t.weeklyReportObj={},t.labelTypeList=[],t.weeklyReportLoading=!1,t.gatherFlag="0",t.userIdList=[],t.userIdDetailList=[],t.leaderList=[],t.submitLeaderName="",t.submitLeaderId="",t.checkAllMsg="全选",t.needQueryAll=!1,t}return Object(o["a"])(a,[{key:"submitLeaderChange",value:function(t){this.$refs.submitLeader.toggle(),this.submitLeaderId=t.leaderId,this.submitLeaderName=t.leaderName}},{key:"weekTypeChange",value:function(){this.weeklyReportStatus="",this.userIdList=[],this.userIdDetailList=[],this.gatherFlag=this.weekType.toString(),"2"!==this.gatherFlag?this._getReportDtl():this.depPersonShow=!0}},{key:"dropClick",value:function(){var t=this.$refs.dropObj;t.toggle()}},{key:"depPersonClick",value:function(){this.depTreeList&&0!==this.depTreeList.length&&2===this.weekType&&(this.depPersonShow=!0)}},{key:"back",value:function(){this.$router.back()}},{key:"changeTimeClick",value:function(){this.changeTimeshow=!0}},{key:"changeTimeSelect",value:function(t){var e=this;this.weekYearNowNumber="",this.nowChangeTime=t[0]?t[0]:t;var a=new Date(t[0]?t[0]:t),s=6===a.getDay()?Gs(a.getTime()):a.getTime()-24*(1+a.getDay())*60*60*1e3,i=6===(new Date).getDay()?Gs((new Date).getTime()):Gs((new Date).getTime()-24*(1+(new Date).getDay())*60*60*1e3),n=new Date(s).getFullYear();this.nowYear=n,this.startTime=Gs(new Date(s)),this.endTime=Ks(new Date(s),6),this.dateRange=[new Date(this.startTime),new Date(this.endTime)],Js(n).result6.filter((function(t,a){t===e.startTime&&(e.weekYearNumber=n+""+a+1,e.weekNumber=a+1,e.changeTimeMsg="".concat(n,"第").concat(a+1,"周")),t===Gs(i)&&(e.weekYearNowNumber=n+""+a+1)})),this._getReportDtl(),this.changeTimeshow=!1}},{key:"checkSureClick",value:function(t){console.log(t),this.userIdDetailList=t.getpersonDetailList,this.userIdList=t.personCheckList,this._getReportDtl(),this.depPersonShow=!1}},{key:"closeDepPerson",value:function(){this.depPersonShow=!1}},{key:"preWeek",value:function(){var t=new Date(this.nowChangeTime);this.nowChangeTime.setTime(t.getTime()-6048e5),this.changeTimeSelect(new Date(this.nowChangeTime))}},{key:"nextWeek",value:function(){var t=new Date(this.nowChangeTime);this.nowChangeTime.setTime(t.getTime()+6048e5),this.changeTimeSelect(new Date(this.nowChangeTime))}},{key:"backWeek",value:function(){this.nowChangeTime=new Date,this.changeTimeSelect(new Date(this.nowChangeTime))}},{key:"_getReportDtl",value:function(){var t=this;this.weeklyReportLoading=!0;var e={gatherFlag:this.gatherFlag,userIdList:this.userIdList,weekOfYear:this.weekNumber,startDate:this.startTime,endDate:this.endTime};Qi(e).then((function(e){if("weeklyReportErr400"===e.code)t.weeklyReportStatus="weeklyReportErr400",t.weeklyReportMsg=e.msg,t.$toast.fail(e.msg);else if("200"===e.code){if(t.weeklyReportStatus="",t.weeklyReportObj=e.data,0===t.weeklyReportObj.commitFlag){for(var a=0;a<t.weeklyReportObj.resultList.length;a++)for(var s=t.weeklyReportObj.resultList[a],i=0;i<s.childList.length;i++)for(var n=s.childList[i],r=0;r<n.reportDtoList.length;r++){var o=n.reportDtoList[r];t.$set(o,"editing",!0),2===t.leaderList.length?t.$set(o,"checked",!0):t.$set(o,"checked",!1)}console.log(t.weeklyReportObj)}for(var c=0;c<t.weeklyReportObj.resultList.length;c++)t.labelTypeList.push("")}t.weeklyReportLoading=!1}))}},{key:"Yz",value:function(t){if(0===t.length)return this.$toast.fail("没有要新增或编辑的信息"),!0;for(var e=0;e<t.length;e++){var a=t[e];switch(a.tableType){case 1:if(!a.objId)return this.$toast.fail("政府单位不能为空"),!0;if(!a.labelRemark)return this.$toast.fail("详情不能为空"),!0;break;case 2:if(!a.objType)return this.$toast.fail("类型不能为空"),!0;if(!a.objId)return this.$toast.fail("客户信息不能为空"),!0;break;case 3:if(!a.objType)return this.$toast.fail("类型不能为空"),!0;if(!a.objId)return this.$toast.fail("客户信息不能为空"),!0;if(!a.labelRemark)return this.$toast.fail("详情不能为空"),!0;break;case 4:if(!a.objId)return this.$toast.fail("事项类型不能为空"),!0;if(!a.labelRemark)return this.$toast.fail("计划不能为空"),!0;break;default:break}}}},{key:"generateClick",value:function(t){var e=this;if("reload"===t)this.$dialog.confirm({title:"提示",message:"新增或编辑数据是否已经暂存？点击确定将继续生成！",beforeClose:function(t,a){if("confirm"===t){var s=e.$toast.loading({duration:0,message:"生成中..."});Ki({startTime:Gs(e.dateRange[0]),endTime:Gs(e.dateRange[1])}).then((function(t){"200"===t.code&&(s.clear(),e._getReportDtl())})),a()}else a()}});else{var a=this.$toast.loading({duration:0,message:"生成中..."});Ki({startTime:Gs(this.dateRange[0]),endTime:Gs(this.dateRange[1])}).then((function(t){"200"===t.code&&(a.clear(),e._getReportDtl())}))}}},{key:"submitReportClick",value:function(){var t=this,e=[];if(this.leaderList.length>1)for(var a=0;a<this.weeklyReportObj.resultList.length;a++)for(var s=this.weeklyReportObj.resultList[a],i=0;i<s.childList.length;i++)for(var n=s.childList[i],r=0;r<n.reportDtoList.length;r++){var o=n.reportDtoList[r];o.checked&&e.push(o.cwrdtlId)}else for(var c=0;c<this.weeklyReportObj.resultList.length;c++)for(var l=this.weeklyReportObj.resultList[c],u=0;u<l.childList.length;u++)for(var d=l.childList[u],h=0;h<d.reportDtoList.length;h++){var p=d.reportDtoList[h];e.push(p.cwrdtlId)}if(console.log(e),this.submitLeaderId)if(e.length){var m={cwrdocId:this.weeklyReportObj.cwrdocId,leaderId:this.submitLeaderId,cwrdtlIdList:e};this.leaderList.length>2?this.$dialog.confirm({title:"提示",message:"单个汇报领导只能提交一次，请确定选择提交信息无遗漏！",beforeClose:function(e,a){"confirm"===e?(t._submitReport(m),a()):a()}}):this._submitReport(m)}else this.$toast.fail("请选择要提交的信息");else this.$toast.fail("请选择汇报领导")}},{key:"_submitReport",value:function(t){var e=this,a=this.$toast.loading({duration:0,message:"提交中..."});Xi(t).then((function(t){a.clear(),"200"===t.code?e._getReportDtl():e.$toast.fail(t.msg)}))}},{key:"saveClick",value:function(){for(var t=this.$refs.weeklyContent.weeklyObj,e=[],a=0;a<t.resultList.length;a++)for(var s=t.resultList[a],i=0;i<s.childList.length;i++)for(var n=s.childList[i],r=0;r<n.reportDtoList.length;r++){var o=n.reportDtoList[r];o.cwrdocId&&(this.$set(o,"isSaveClick",!0),e.push(o))}var c=this.Yz(e);c||this._insOrUpdReport(e)}},{key:"_insOrUpdReport",value:function(t){var e=this;Ji(t).then((function(t){"200"===t.code?(e.$toast.success(t.msg),e._getReportDtl()):e.$toast.fail(t.msg)}))}},{key:"_getLeader",value:function(){var t=this,e={userId:localStorage.getItem("userId")||254};tn(e).then((function(e){t.changeTimeSelect(t.nowChangeTime),t.leaderList=[{leaderId:"",leaderName:"请选择汇报对象"}],t.submitLeaderId="",t.submitLeaderName="请选择汇报对象";for(var a=0;a<e.data.length;a++){var s=e.data[a];s.leaderId&&t.leaderList.push(s)}2===t.leaderList.length&&(t.submitLeaderId=t.leaderList[1].leaderId,t.submitLeaderName=t.leaderList[1].leaderName)}))}},{key:"quickFixClick",value:function(t){cn()("#weekLabelcontentWarp").stop().animate({scrollTop:cn()("#weekLabeltitle"+t)[0].offsetTop-cn()("#weekLabeltitle0")[0].offsetTop},500)}},{key:"changeAllClick",value:function(){for(var t=this.$refs.weeklyContent.weeklyObj,e=0;e<t.resultList.length;e++)for(var a=t.resultList[e],s=0;s<a.childList.length;s++){var i=a.childList[s];if(i.reportDtoList.length>0&&!i.reportDtoList.every((function(t){return t.cwrdtlId})))return void this.$toast.fail("请先暂存新增数据，再选择提交");for(var n=0;n<i.reportDtoList.length;n++){var r=i.reportDtoList[n];"全选"===this.checkAllMsg?this.$set(r,"checked",!0):this.$set(r,"checked",!1)}}"全选"===this.checkAllMsg?this.checkAllMsg="取消全选":this.checkAllMsg="全选"}},{key:"checkedResultChange",value:function(){for(var t=[],e=this.$refs.weeklyContent.weeklyObj,a=0;a<e.resultList.length;a++)for(var s=e.resultList[a],i=0;i<s.childList.length;i++){var n=s.childList[i];n.reportDtoList.length>0&&n.reportDtoList.every((function(t){return t.checked}))?t.push(!0):n.reportDtoList.length>0&&t.push(!1)}t.every((function(t){return t}))?this.checkAllMsg="取消全选":this.checkAllMsg="全选"}},{key:"mounted",value:function(){var t=this;this.depTreeList?this.weekTypeoptions=[{text:"我的周报",value:0},{text:"汇总周报",value:1},{text:"部门管理",value:2}]:this.actionGetDepTree({treeType:1,authorizedFlag:!0}).then((function(){t.weekTypeoptions=[{text:"我的周报",value:0},{text:"汇总周报",value:1},{text:"部门管理",value:2}]})),this._getLeader();var e=localStorage.getItem("menuTree"),a=JSON.parse(e),s=at(a,"周报",[],1);this.needQueryAll=s.some((function(t){return"周报查询所有权限"===t.pmsName})),console.log(a),console.log(s),console.log(this.needQueryAll)}}]),a}(d["c"]);Object(u["a"])([ln.Action],un.prototype,"actionGetDepTree",void 0),Object(u["a"])([h["a"]],un.prototype,"depTreeList",void 0),un=Object(u["a"])([Object(d["a"])({components:{depPerson:Ei,weeklyContent:rn}})],un);var dn=un,hn=dn,pn=(a("7e39"),Object(V["a"])(hn,zi,Wi,!1,null,"3acdb7c7",null)),mn=pn.exports,vn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task"},t._l(t.taskMenu,(function(e,s){return a("div",{key:s,staticClass:"task-catalog"},[a("div",{staticClass:"task-catalog__title"},[t._v(t._s(e.pmsName))]),a("div",{staticClass:"task-catalog__list"},t._l(e.children,(function(e,s){return a("div",{key:s,staticClass:"task-item",style:"border-top: 3px solid "+e.children[0].icon,on:{click:function(a){return t.toList(e.path)}}},[a("div",{staticClass:"task-item__top"},[a("div",{staticClass:"task-item__title"},[t._v(t._s(e.pmsName))]),a("div",{staticClass:"task-item__desc gray"},[t._v(" 点击方块进入 ")])]),a("div",{staticClass:"task-block"},[a("div",{staticClass:"task-block__item",style:"color: "+e.children[0].icon},[a("div",{staticClass:"task-block__item__value"},[t._v(t._s(e.ing))]),a("div",{staticClass:"task-block__item__desc"},[t._v(t._s(e.children[0].pmsName))])]),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"task-loading",attrs:{type:"spinner",color:"#1989fa"}})],1)])})),0)])})),0)},fn=[],gn=(a("3ca3"),a("ddb0"),a("3835"));function bn(t,e,a){return yn.apply(this,arguments)}function yn(){return yn=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,n,r,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=o.length>3&&void 0!==o[3]&&o[3],n=o.length>4&&void 0!==o[4]?o[4]:"",t.next=4,iv({url:e+a,method:"post",data:s,headers:{needOperateLoading:i,msg:encodeURIComponent(n)||encodeURIComponent("请求中，请稍等......")}});case 4:return r=t.sent,t.abrupt("return",r.data);case 6:case"end":return t.stop()}}),t)}))),yn.apply(this,arguments)}var _n=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=O+"/api/task/specific",t.next=3,iv({method:"get",url:e});case 3:return a=t.sent,t.abrupt("return",a.data);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),kn=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,bn(O,"/api/task/getConfirmationRequestList",e,e.needLoading);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Cn=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=O+"/api/task/updateConfirmationRequestStatue",t.next=3,iv({method:"get",url:a,params:e,headers:{needOperateLoading:!0,msg:encodeURIComponent("取函中......")}});case 3:return s=t.sent,t.abrupt("return",s.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),wn=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:O+"/api/task/uploadConfirmationRequestPictures",method:"post",data:e});case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ln=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,bn(O,"/api/task/downloadConfirmationRequestPictures",e,!0,"图片请求中......");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),xn=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,bn(O,"/api/task/expireReason",e,!0,"原因提交中......");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),In=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=O+"/api/task/exceedTimeLimitTask",t.next=3,iv({method:"get",url:a,params:e});case 3:return s=t.sent,t.abrupt("return",s.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Sn=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:O+"/api/task/activeInitiateConfirmationRequest",method:"post",data:e,headers:{needOperateLoading:!0,msg:encodeURIComponent("发起中.......")}});case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Dn=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=O+"/api/task/initiatedConfirmationRequest",t.next=3,iv({method:"get",url:a,params:e,headers:{needOperateLoading:e.ccrId,msg:encodeURIComponent("查询中.......")}});case 3:return s=t.sent,t.abrupt("return",s.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),On=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=O+"/api/task/handleConfirmationRequest/".concat(e),t.next=3,iv({method:"put",url:s,params:a,headers:{needOperateLoading:!0,msg:encodeURIComponent("提交中.......")}});case 3:return i=t.sent,t.abrupt("return",i.data);case 5:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),jn=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.taskMenu=[],t.value=0,t.option=[{text:"全部",value:0},{text:"已读",value:1},{text:"未读",value:2}],t.sendInfo={},t.receiveInfo={},t.loading=!1,t}return Object(o["a"])(a,[{key:"getTotalData",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,Promise.all([Ut({}),qt({}),_n()]);case 3:e=t.sent,a=Object(gn["a"])(e,3),s=a[0],i=a[1],n=a[2],this.loading=!1,this.sendInfo=s.data,this.receiveInfo=i.data,this.taskMenu.forEach((function(t){"通用任务"===t.pmsName&&t.children?t.children.forEach((function(t){"我发出的"===t.pmsName?t.ing=s.data.ing:"我收到的"===t.pmsName&&(t.ing=i.data.unRead)})):"专用任务"===t.pmsName&&t.children&&t.children.forEach((function(t){"询证函助手"===t.pmsName&&(t.ing=n.data.confirmationAssistNum),"询证函异常处理"===t.pmsName&&(t.ing=n.data.abnormalNum)}))}));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"toList",value:function(t){this.$router.push({path:t})}},{key:"activated",value:function(){var t=this,e=localStorage.getItem("menuTree"),a=JSON.parse(e);this.taskMenu=[],a.forEach((function(e){"任务/审批"===e.pmsName&&e.children&&(t.taskMenu=e.children)})),this.getTotalData()}}]),a}(d["c"]);jn=Object(u["a"])([Object(d["a"])({})],jn);var Tn=jn,Rn=Tn,Nn=(a("156f"),Object(V["a"])(Rn,vn,fn,!1,null,"6c61d45b",null)),An=Nn.exports,Pn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sendlist"},[s("van-sticky",[s("van-search",{attrs:{"show-action":"",placeholder:"请输入标题|内容|发送人"},on:{search:t.onRefresh},scopedSlots:t._u([{key:"action",fn:function(){return[s("div",{on:{click:t.onRefresh}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}})],1),s("div",{staticClass:"change"},[s("div",{staticClass:"change-desc"},[t._v(" 当前进行中"),s("span",{staticClass:"change-desc__value"},[t._v(t._s(t.taskNum))]),t._v("项 ")]),s("div",{staticClass:"change-btn",on:{click:t.changeStatus}},[t._v(t._s(1===t.taskStatus?"点击显示已完成的任务":"取消"))])]),s("van-pull-refresh",{staticClass:"msg-list",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("div",{key:e.cmsId,staticClass:"msg-item van-clearfix",on:{click:function(a){return t.toDetail(e)}}},[s("van-swipe-cell",{scopedSlots:t._u([1===+e.useStatus?{key:"right",fn:function(){return[s("van-button",{staticClass:"msg-btn",attrs:{square:"",type:"warning",text:"作废"},on:{click:function(a){return t.cancelTask(e)}}})]},proxy:!0}:null],null,!0)},[s("div",{staticClass:"msg-main"},[s("div",{class:["msg-inner",e.isReturn?"":"w-100"]},[s("div",{staticClass:"msg-item__line"},[1===e.emergencyLevel?s("van-tag",{staticClass:"msg-item__type",attrs:{type:"success"}},[t._v("普通")]):2===e.emergencyLevel?s("van-tag",{staticClass:"msg-item__type",attrs:{type:"warning"}},[t._v("重要")]):3===e.emergencyLevel?s("van-tag",{staticClass:"msg-item__type",attrs:{type:"danger"}},[t._v("紧急")]):t._e(),s("div",{staticClass:"msg-item__time"},[t._v(t._s(e.creTime?e.creTime.slice(0,e.creTime.length-3):""))])],1),s("div",{staticClass:"msg-item__content",style:1===+e.useStatus?"":"color: #999"},[s("div",{staticClass:"msg-item__type"},[t._v(t._s("【"+e.smallTag+"】")),e.eventAgeingEnd?s("i",{staticClass:"iconfont ytcrm-shijian"}):t._e(),s("span",{staticClass:"msg-item__type__time"},[t._v(t._s(e.eventAgeingEnd))])]),s("div",{staticClass:"msg-item__title"},[t._v(t._s(e.orderTitle))])])]),1===+e.useStatus&&e.isReturn?s("div",{staticClass:"msg-progress"},[s("div",{staticClass:"msg-progress__title"},[t._v("当前进度：")]),s("div",{staticClass:"msg-progress__value"},[t._v(t._s(Math.ceil(e.hasReply/e.sendList.length*100))+"%")])]):t._e()]),s("div",{staticClass:"msg-item__finished"},[0===+e.useStatus?s("div",{staticClass:"iscancel"},[t._v("已作废")]):t._e(),2===+e.useStatus?s("img",{attrs:{src:a("9e79"),alt:""}}):t._e()])])],1)})),0)],1),s("div",{staticClass:"fab-circle-two",on:{click:t.toCancelList}},[s("van-icon",{attrs:{name:"delete-o"}})],1),s("div",{staticClass:"fab-circle",on:{click:t.toPublish}},[s("div",{staticClass:"fab-circle-v"}),s("div",{staticClass:"fab-circle-h"})]),1===t.actionType?s("van-calendar",{attrs:{color:"#1989fa",type:"range",title:"选择时间范围","min-date":t.minDate},on:{confirm:t.onDateChange},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),2===t.actionType?s("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}},[s("van-tree-select",{attrs:{"active-color":"#363636",items:t.labelTreeList,"active-id":t.activeId,"main-active-index":t.activeIndex},on:{"update:activeId":function(e){t.activeId=e},"update:active-id":function(e){t.activeId=e},"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e},"click-item":t.onLabelChange}})],1):t._e(),3===t.actionType?s("van-action-sheet",{attrs:{actions:t.urgencyList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectUrgency},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e()],1)},En=[],Mn=Object(h["b"])("commonStore"),$n=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.taskNum="",t.taskStatus=1,t.value=-1,t.option=[{text:"全部",value:-1},{text:"已完成",value:2},{text:"正常",value:1},{text:"作废",value:0}],t.labelTreeList=[],t.activeId=-1,t.activeIndex=0,t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.actionShow=!1,t.actionType=0,t.minDate=new Date(2010,0,1),t.dateRange=[],t.labelValue={},t.urgency={},t.sendTo="",t.urgencyList=[{value:0,name:"全部"},{value:1,name:"普通"},{value:2,name:"重要"},{value:3,name:"紧急"}],t.keywords="",t}return Object(o["a"])(a,[{key:"_getLabelTree",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={type:"1"},t.next=3,Ct(e);case 3:a=t.sent,this.labelTreeList=a.data.map((function(t){var e=[];return t.CHILD_LIST.length&&(e=t.CHILD_LIST.map((function(t){return{id:t.LABEL_ID,text:t.LABEL_NAME}}))),{id:t.LABEL_ID,text:t.LABEL_NAME,children:e}}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"changeStatus",value:function(){this.taskStatus=1===this.taskStatus?2:1,this.onRefresh()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={pageNum:this.page,pageSize:this.pageSize,status:this.taskStatus,search:this.keywords},t.next=3,Ht(e);case 3:a=t.sent,this.loading=!1,this.refreshing=!1,a.success?(a.data.list.forEach((function(t){var e=0;t.sendList.map((function(t){t.content&&e++})),t.hasReply=e})),this.list=[].concat(Object(y["a"])(this.list),Object(y["a"])(a.data.list)),this.page++,this.finished=!a.data.hasNextPage,1===this.taskStatus&&(this.taskNum=a.data.total)):this.error=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"chooseFilter",value:function(t){this.actionShow=!0,this.actionType=t}},{key:"onDateChange",value:function(t){this.actionShow=!1,this.dateRange=[Gs(t[0]),Gs(t[1])]}},{key:"onLabelChange",value:function(t){this.actionShow=!1,this.labelValue=t}},{key:"onSelectUrgency",value:function(t){this.urgency=t}},{key:"reset",value:function(){this.activeId=-1,this.activeIndex=0,this.dateRange=[],this.labelValue={},this.urgency={},this.sendTo=""}},{key:"onConfirm",value:function(){var t=this.$refs.filter;t.toggle(),this.refreshData()}},{key:"refreshData",value:function(){this.list=[],this.page=1,this.finished=!1,this.loading=!0,this.getDataList()}},{key:"cancelTask",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Pt({csoId:e.csoId});case 2:a=t.sent,a.success?(this.$toast.success(a.msg||"作废成功"),e.useStatus=0):this.$toast.fail(a.msg||"作废失败");case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"toDetail",value:function(t){this.SET_TASKDETAILINFO({type:1,csoId:t.csoId}),localStorage.setItem("taskDetailInfo",JSON.stringify({type:1,csoId:t.csoId})),this.SET_HADDONEONDETAIL(!1),this.$router.push({path:"/task/detail"})}},{key:"toPublish",value:function(){this.SET_HADDONEONDETAIL(!1),this.$router.push({name:"TaskPublish"})}},{key:"toCancelList",value:function(){this.$router.push({name:"TaskCancellist"})}},{key:"created",value:function(){this.list=[],this._getLabelTree()}},{key:"activated",value:function(){this.hadDoneOnDetail&&(this.reset(),this._getLabelTree(),this.refreshData())}}]),a}(d["c"]);Object(u["a"])([Mn.Mutation],$n.prototype,"SET_HADDONEONDETAIL",void 0),Object(u["a"])([Mn.Mutation],$n.prototype,"SET_TASKDETAILINFO",void 0),Object(u["a"])([h["a"]],$n.prototype,"hadDoneOnDetail",void 0),$n=Object(u["a"])([Object(d["a"])({})],$n);var qn=$n,Vn=qn,Un=(a("3096"),Object(V["a"])(Vn,Pn,En,!1,null,"97e5a992",null)),Fn=Un.exports,zn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sendlist"},[a("van-sticky",[a("van-search",{attrs:{"show-action":"",placeholder:"请输入标题|内容|发送人"},on:{search:t.onRefresh},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:t.onRefresh}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}})],1),a("van-pull-refresh",{staticClass:"msg-list",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return a("div",{key:e.cmsId,staticClass:"msg-item van-clearfix",on:{click:function(a){return t.toDetail(e)}}},[a("van-swipe-cell",{scopedSlots:t._u([0===+e.useStatus?{key:"right",fn:function(){return[a("van-button",{staticClass:"msg-btn",attrs:{square:"",type:"info",text:"再次发起"},on:{click:function(a){return t.resendTask(e)}}})]},proxy:!0}:null],null,!0)},[a("div",{staticClass:"msg-main"},[a("div",{class:["msg-inner",e.isReturn?"":"w-100"]},[a("div",{staticClass:"msg-item__line"},[1===e.emergencyLevel?a("van-tag",{staticClass:"msg-item__type",attrs:{type:"success"}},[t._v("普通")]):2===e.emergencyLevel?a("van-tag",{staticClass:"msg-item__type",attrs:{type:"warning"}},[t._v("重要")]):3===e.emergencyLevel?a("van-tag",{staticClass:"msg-item__type",attrs:{type:"danger"}},[t._v("紧急")]):t._e(),a("div",{staticClass:"msg-item__time"},[t._v(t._s(e.creTime?e.creTime.slice(0,e.creTime.length-3):""))])],1),a("div",{staticClass:"msg-item__content",style:1===+e.useStatus?"":"color: #999"},[a("div",{staticClass:"msg-item__type"},[t._v(t._s("【"+e.smallTag+"】")),e.eventAgeingEnd?a("i",{staticClass:"iconfont ytcrm-shijian"}):t._e(),a("span",{staticClass:"msg-item__type__time"},[t._v(t._s(e.eventAgeingEnd))])]),a("div",{staticClass:"msg-item__title"},[t._v(t._s(e.orderTitle))])])])]),a("div",{staticClass:"msg-item__finished"},[0===+e.useStatus?a("div",{staticClass:"iscancel"},[t._v("已作废")]):t._e()])])],1)})),0)],1)],1)},Wn=[],Bn=Object(h["b"])("commonStore"),Gn=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.flag=!1,t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.keywords="",t}return Object(o["a"])(a,[{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={pageNum:this.page,pageSize:this.pageSize,status:0,search:this.keywords},t.next=3,Ht(e);case 3:a=t.sent,this.loading=!1,this.refreshing=!1,a.success?(a.data.list.forEach((function(t){var e=0;t.sendList.map((function(t){t.content&&e++})),t.hasReply=e})),this.list=[].concat(Object(y["a"])(this.list),Object(y["a"])(a.data.list)),this.page++,this.finished=!a.data.hasNextPage):this.error=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"refreshData",value:function(){this.keywords="",this.list=[],this.page=1,this.finished=!1,this.loading=!0,this.getDataList()}},{key:"resendTask",value:function(t){this.$router.push({name:"TaskPublish",params:{detail:t}})}},{key:"toDetail",value:function(t){this.SET_TASKDETAILINFO({type:1,csoId:t.csoId}),localStorage.setItem("taskDetailInfo",JSON.stringify({type:1,csoId:t.csoId})),this.$router.push({path:"/task/detail"})}},{key:"activated",value:function(){this.flag&&this.refreshData()}},{key:"beforeRouteLeave",value:function(t,e,a){console.log("---",t.name),"TaskPublish"===t.name||"TaskDetail"===t.name?this.flag=!1:this.flag=!0,a()}}]),a}(d["c"]);Object(u["a"])([Bn.Mutation],Gn.prototype,"SET_TASKDETAILINFO",void 0),Gn=Object(u["a"])([Object(d["a"])({})],Gn);var Hn=Gn,Yn=Hn,Qn=(a("865a"),Object(V["a"])(Yn,zn,Wn,!1,null,"1d19d0fa",null)),Kn=Qn.exports,Jn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"receivelist"},[a("van-sticky",[a("van-search",{attrs:{"show-action":"",placeholder:"请输入标题|内容|发送人"},on:{search:t.onRefresh},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:t.onRefresh}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}})],1),a("div",{staticClass:"change"},[a("div",{staticClass:"change-desc"},[t._v(" 当前进行中"),a("span",{staticClass:"change-desc__value"},[t._v(t._s(t.taskNum))]),t._v("项 ")]),a("div",{staticClass:"change-btn",on:{click:t.changeStatus}},[t._v(t._s(1===t.taskStatus?"点击显示全部任务":"取消"))])]),a("van-pull-refresh",{staticClass:"msg-list",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return a("div",{key:e.cmsId,staticClass:"msg-item van-clearfix",on:{click:function(a){return t.toDetail(e)}}},[a("van-swipe-cell",[a("div",{staticClass:"msg-main"},[a("div",{class:["msg-inner",e.isReturn?"":"w-100"]},[a("div",{staticClass:"msg-item__line"},[a("div",{staticClass:"msg-item__line__left"},[1===e.emergencyLevel?a("van-tag",{staticClass:"msg-item__type",attrs:{type:"success"}},[t._v("普通")]):2===e.emergencyLevel?a("van-tag",{staticClass:"msg-item__type",attrs:{type:"warning"}},[t._v("重要")]):3===e.emergencyLevel?a("van-tag",{staticClass:"msg-item__type",attrs:{type:"danger"}},[t._v("紧急")]):t._e(),a("div",{staticClass:"msg-item__text"},[t._v(t._s(e.creTime?e.creTime.slice(0,e.creTime.length-3):""))])],1),a("div",{staticClass:"msg-item__text"},[t._v("发起人："+t._s(e.sendName))])]),a("div",{staticClass:"msg-item__content",style:1===+e.useStatus?"":"color: #999"},[a("div",{staticClass:"msg-item__type"},[t._v(t._s("【"+e.smallTag+"】")),e.eventAgeingEnd?a("i",{staticClass:"iconfont ytcrm-shijian"}):t._e(),a("span",{staticClass:"msg-item__type__time"},[t._v(t._s(e.eventAgeingEnd))])]),a("div",{staticClass:"msg-item__title"},[t._v(t._s(e.orderTitle))])])]),e.isReturn?a("div",{staticClass:"msg-progress"},[a("div",{staticClass:"msg-progress__title"},[t._v("需回执")])]):t._e()]),a("div",{staticClass:"msg-item__finished"},[0===+e.useStatus?a("div",{staticClass:"iscancel"},[t._v("已作废")]):e.content?a("div",{staticClass:"iscancel"},[t._v("已回执")]):t._e()])])],1)})),0)],1),1===t.actionType?a("van-calendar",{attrs:{color:"#1989fa",type:"range",title:"选择时间范围","min-date":t.minDate},on:{confirm:t.onDateChange},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),2===t.actionType?a("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}},[a("van-tree-select",{attrs:{"active-color":"#363636",items:t.labelTreeList,"active-id":t.activeId,"main-active-index":t.activeIndex},on:{"update:activeId":function(e){t.activeId=e},"update:active-id":function(e){t.activeId=e},"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e},"click-item":t.onLabelChange}})],1):t._e(),3===t.actionType?a("van-action-sheet",{attrs:{actions:t.urgencyList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectUrgency},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e()],1)},Xn=[],Zn=Object(h["b"])("commonStore"),tr=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.taskNum="",t.taskStatus=1,t.value=-1,t.option=[{text:"全部",value:-1},{text:"已读",value:2},{text:"未读",value:1},{text:"作废",value:0}],t.labelTreeList=[],t.activeId=-1,t.activeIndex=0,t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.actionShow=!1,t.actionType=0,t.minDate=new Date(2010,0,1),t.dateRange=[],t.labelValue={},t.urgency={},t.sendTo="",t.keywords="",t.urgencyList=[{value:0,name:"全部"},{value:1,name:"普通"},{value:2,name:"重要"},{value:3,name:"紧急"}],t}return Object(o["a"])(a,[{key:"_getLabelTree",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={type:"1"},t.next=3,Ct(e);case 3:a=t.sent,this.labelTreeList=a.data.map((function(t){var e=[];return t.CHILD_LIST.length&&(e=t.CHILD_LIST.map((function(t){return{id:t.LABEL_ID,text:t.LABEL_NAME}}))),{id:t.LABEL_ID,text:t.LABEL_NAME,children:e}}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"changeStatus",value:function(){this.$cancelAxios(["queryReceive"]),this.taskStatus=1===this.taskStatus?2:1,this.onRefresh()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={},e=2===this.taskStatus?{pageNum:this.page,pageSize:this.pageSize,search:this.keywords}:{pageNum:this.page,pageSize:this.pageSize,isReply:0,search:this.keywords},t.next=4,Bt(e);case 4:a=t.sent,this.loading=!1,this.refreshing=!1,a.success?(this.list=[].concat(Object(y["a"])(this.list),Object(y["a"])(a.data.list)),this.page++,this.finished=!a.data.hasNextPage,1===this.taskStatus&&(this.taskNum=a.data.total)):(this.error=!0,this.taskNum=0);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"chooseFilter",value:function(t){this.actionShow=!0,this.actionType=t}},{key:"onDateChange",value:function(t){this.actionShow=!1,this.dateRange=[Gs(t[0]),Gs(t[1])]}},{key:"onLabelChange",value:function(t){this.actionShow=!1,this.labelValue=t}},{key:"onSelectUrgency",value:function(t){this.urgency=t}},{key:"reset",value:function(){this.activeId=-1,this.activeIndex=0,this.dateRange=[],this.labelValue={},this.urgency={},this.sendTo=""}},{key:"onConfirm",value:function(){var t=this.$refs.filter;t.toggle(),this.refreshData()}},{key:"refreshData",value:function(){this.list=[],this.page=1,this.finished=!1,this.loading=!0,this.getDataList()}},{key:"toDetail",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!==e.useStatus){t.next=5;break}return t.next=3,ee({csodId:e.csodId});case 3:a=t.sent,a.success&&(e.useStatus=2);case 5:this.SET_HADDONEONDETAIL(!1),this.SET_TASKDETAILINFO({type:2,csoId:e.csoId}),localStorage.setItem("taskDetailInfo",JSON.stringify({type:2,csoId:e.csoId})),this.$router.push({path:"/task/detail"});case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.list=[],this._getLabelTree()}},{key:"activated",value:function(){this.hadDoneOnDetail&&(this.reset(),this._getLabelTree(),this.refreshData())}}]),a}(d["c"]);Object(u["a"])([Zn.Mutation],tr.prototype,"SET_HADDONEONDETAIL",void 0),Object(u["a"])([Zn.Mutation],tr.prototype,"SET_TASKDETAILINFO",void 0),Object(u["a"])([h["a"]],tr.prototype,"hadDoneOnDetail",void 0),tr=Object(u["a"])([Object(d["a"])({})],tr);var er=tr,ar=er,sr=(a("5ac7"),Object(V["a"])(ar,Jn,Xn,!1,null,"21f14292",null)),ir=sr.exports,nr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-detail"},[a("div",{staticClass:"task-detail-main"},[a("div",{staticClass:"task-detail-header"},[a("div",{staticClass:"task-detail-header__left"},[1===t.detail.emergencyLevel?a("van-tag",{staticClass:"task-detail-header__type",attrs:{type:"success"}},[t._v("普通")]):2===t.detail.emergencyLevel?a("van-tag",{staticClass:"task-detail-header__type",attrs:{type:"warning"}},[t._v("重要")]):3===t.detail.emergencyLevel?a("van-tag",{staticClass:"task-detail-header__type",attrs:{type:"danger"}},[t._v("紧急")]):t._e(),a("div",{staticClass:"task-detail-header__time"},[t._v(t._s(t.detail.creTime?t.detail.creTime.slice(0,t.detail.creTime.length-3):""))])],1),2===+t.taskDetailInfo.type?a("div",{staticClass:"task-detail-header__value"},[t._v("发起人："+t._s(t.detail.sendId+"/"+t.detail.sendName))]):t._e()]),a("div",{staticClass:"detail-item detail-three center"},[a("div",{class:["detail-three-item flex-col",t.detail.eventAgeingStart||t.detail.eventAgeingEnd?"":"w-50"]},[a("div",{staticClass:"detail-three-item__title"},[t._v("事件分类")]),a("div",{staticClass:"detail-three-item__content"},[t._v(t._s(t.detail.smallTag))])]),t.detail.eventAgeingStart||t.detail.eventAgeingEnd?a("div",{staticClass:"border-left"}):t._e(),t.detail.eventAgeingStart||t.detail.eventAgeingEnd?a("div",{staticClass:"detail-three-item flex-col"},[a("div",{staticClass:"detail-three-item__content"},[a("i",{staticClass:"iconfont ytcrm-shijian"}),t._v(t._s(t.detail.eventAgeingStart+" ~ "+t.detail.eventAgeingEnd))])]):t._e(),a("div",{staticClass:"border-left"}),1===+t.taskDetailInfo.type?a("div",{class:["detail-three-item flex-col",t.detail.eventAgeingStart||t.detail.eventAgeingEnd?"":"w-50"]},[a("div",{staticClass:"detail-three-item__title"},[t._v("当前进度")]),a("div",{staticClass:"detail-three-item__percent"},[t._v(t._s(t.replyList.length&&t.detail.sendList.length?Math.ceil(t.replyList.length/t.detail.sendList.length*100)+"%":"0%"))])]):a("div",{class:["detail-three-item flex-col",t.detail.eventAgeingStart||t.detail.eventAgeingEnd?"":"w-50"]},[a("div",{staticClass:"detail-three-item__title"},[t._v("状态")]),a("div",{staticClass:"detail-three-item__content"},[t._v(t._s(1===t.detail.useStatus?"未读":2===t.detail.useStatus?"已读":0===t.detail.useStatus?"作废":""))])])]),a("div",{staticClass:"line"}),a("div",{staticClass:"detail-item detail-three"},[a("div",{staticClass:"detail-three-item"},[t._v(" 事件编号"),a("span",{staticClass:"detail-three-item__value"},[t._v(t._s(t.detail.csoId||""))])]),a("div",{staticClass:"detail-three-item"},[t._v(" 需要回执"),a("span",{staticClass:"detail-three-item__value"},[t._v(t._s(1===t.detail.isReturn?"是":"否"))])]),a("div",{staticClass:"detail-three-item"},[t._v(" 附件 "),t.detail.files&&t.detail.files.length?a("i",{staticClass:"iconfont ytcrm-attachment detail-three-item__value",on:{click:function(e){t.fileShow=!0}}}):a("span",{staticClass:"detail-three-item__value"},[t._v("无")])])]),a("div",{staticClass:"line"}),a("div",{staticClass:"detail-item"},[a("div",{staticClass:"detail-item__title"},[t._v("标题")]),a("div",{staticClass:"detail-item__content"},[t._v(t._s(t.detail.orderTitle))])]),a("div",{staticClass:"line"}),a("div",{staticClass:"detail-item"},[a("div",{staticClass:"detail-item__title"},[t._v("内容")]),a("div",{staticClass:"detail-item__content"},[t._v(t._s(t.detail.orderContent))])])]),0!==+t.detail.useStatus&&t.detail.isReturn&&t.noReplyList&&t.noReplyList.length?a("div",{staticClass:"detail__card"},[a("div",{staticClass:"detail-header"},[a("div",{staticClass:"detail-header__title"},[t._v("未回执")]),a("div",{staticClass:"detail-header__desc red",on:{click:function(e){return t.onUrgeReply(t.detail.csoId)}}},[a("i",{staticClass:"iconfont ytcrm-tixing"}),t._v(" 点击催办以下"),a("span",{staticClass:"detail-header__value"},[t._v(t._s(t.noReplyList.length))]),t._v("名同事 ")])]),a("div",{staticClass:"detail__card__content"},[a("div",{ref:"noreply",class:t.showAll?"detail-main__full":"detail-main"},[t._v(" "+t._s(t.noReplyList.map((function(t){return t.sendUserName})).join("、"))+" ")]),t.showMore?a("van-icon",{staticClass:"detail-more",attrs:{name:t.showAll?"arrow-up":"arrow-down"},on:{click:function(e){t.showAll=!t.showAll}}}):t._e()],1)]):t._e(),0===+t.detail.useStatus?a("div",{staticClass:"iscancel"},[t._v("已作废")]):t.detail.content?a("div",{staticClass:"detail__card"},[a("div",{staticClass:"detail__card__title"},[t._v("回执内容")]),a("div",{staticClass:"detail__card__content"},[t._v(t._s(t.detail.content))])]):2===+t.taskDetailInfo.type&&t.detail.isReturn&&!t.detail.content?a("div",{staticClass:"detail__card"},[a("div",{staticClass:"detail__card__title",staticStyle:{"padding-bottom":"0"}},[t._v("回执内容")]),a("van-field",{attrs:{rows:"4",autosize:"",type:"textarea",maxlength:"200",placeholder:"请输入回执内容","show-word-limit":""},model:{value:t.replyContent,callback:function(e){t.replyContent=e},expression:"replyContent"}})],1):1===+t.taskDetailInfo.type&&t.detail.isReturn?a("div",{staticClass:"detail__card"},[a("div",{staticClass:"detail-header"},[a("div",{staticClass:"detail-header__title"},[t._v("已回执")]),a("div",{staticClass:"detail-header__desc"},[a("span",{staticClass:"detail-header__value"},[t._v(t._s(t.replyList.length))]),t._v("人")])]),t._l(t.replyList,(function(e,s){return a("div",{key:s,staticClass:"reply-block"},[a("div",{staticClass:"replay-item"},[t._v(" "+t._s(e.sendUserId+"/"+e.sendUserName)+" "),a("span",{staticClass:"replay-item__time"},[t._v("（"+t._s(e.callBackTime)+"）")])]),a("div",{staticClass:"replay-item"},[a("div",{staticClass:"replay-item__title"},[t._v("回执人信息")]),a("div",{staticClass:"replay-item__content"},[t._v(t._s(e.sendTypeList.map((function(e){return e.distributeId+"/"+e.distribute+"（"+t.orderTypeList[e.orderType]+"）"})).join("、")))])]),a("div",{staticClass:"replay-item"},[a("div",{staticClass:"replay-item__title"},[t._v("回执内容")]),a("div",{staticClass:"replay-item__content"},[t._v(t._s(e.content))])])])})),t.replyList&&t.replyList.length?t._e():a("van-empty",{staticClass:"custom-image h-200",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无回执"}})],2):t._e(),2===+t.taskDetailInfo.type&&0!==t.detail.useStatus&&t.detail.isReturn&&!t.detail.content?a("div",{staticClass:"footer"},[a("van-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"info",loading:t.submitLoading,size:"small",round:"",block:""},on:{click:t.submit}},[t._v("提交")]),a("van-button",{attrs:{type:"warning",loading:t.knownLoading,size:"small",round:"",block:"",plain:""},on:{click:t.known}},[t._v("已知悉")])],1):0===t.detail.useStatus?a("div",{staticClass:"footer"},[a("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit",size:"small"},on:{click:t.resend}},[t._v("再次发起")])],1):t._e(),a("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.showSendDetail,callback:function(e){t.showSendDetail=e},expression:"showSendDetail"}},[a("van-tabs",{attrs:{color:"#1989fa"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("van-tab",{attrs:{title:"部门/人员"}},[t.depTreeList.length?a("vs-tree",{ref:"depTree",staticClass:"tree-div",attrs:{data:t.depTreeList,virtual:{itemHeight:40},checkedKeys:t.checkedTree.checkedDep,expandKeys:t.checkedTree.expandDep,disabledKeys:t.checkedTree.expandDep,showCheckbox:"",checkOnClickNode:""}}):a("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无部门/人员"}})],1),a("van-tab",{attrs:{title:"标签"}},[t.tagDataList.length?a("vs-tree",{ref:"tagTree",staticClass:"tree-div",attrs:{data:t.tagDataList,checkedKeys:t.checkedTree.checkedTag,disabledKeys:t.checkedTree.expandTag,showCheckbox:"",checkOnClickNode:""}}):a("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无标签"}})],1),a("van-tab",{attrs:{title:"小组"}},[t.groupTreeList.length?a("vs-tree",{ref:"groupTree",staticClass:"tree-div",attrs:{data:t.groupTreeList,checkedKeys:t.checkedTree.checkedGroup,expandKeys:t.checkedTree.expandGroup,disabledKeys:t.checkedTree.expandGroup,showCheckbox:"",checkOnClickNode:""}}):a("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无小组"}})],1)],1)],1),a("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.fileShow,callback:function(e){t.fileShow=e},expression:"fileShow"}},[a("div",{staticClass:"file__title"},[t._v("附件")]),a("div",{staticClass:"file__list"},t._l(t.detail.files,(function(e,s){return a("div",{key:s,staticClass:"file__item",on:{click:function(a){return t._downloadFile(e)}}},[t._v(t._s(e.fileName+"."+e.fileType))])})),0),a("div",{staticClass:"cancel-btn",on:{click:function(e){t.fileShow=!1}}},[t._v("取消")])])],1)},rr=[],or=Object(h["b"])("commonStore"),cr=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.isMsg=t.$route.query.isMsg,t.userId=t.$route.query.userId,t.detail={},t.loading=!1,t.replyContent="",t.submitLoading=!1,t.knownLoading=!1,t.orderTypeList=["","部门","标签","小组"],t.showSendDetail=!1,t.active=0,t.depTreeList=[],t.groupTreeList=[],t.tagDataList=[],t.checkedTree={},t.showMore=!1,t.showAll=!1,t.replyList=[],t.noReplyList=[],t.fileShow=!1,t}return Object(o["a"])(a,[{key:"_getDepTree",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,Jt({type:1});case 3:e=t.sent,this.loading=!1,e.success&&(this.checkedTree.expandDep=[],this.depTreeList=this.formatTreeData(e.data));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"_geGroupTree",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,Jt({type:2});case 3:e=t.sent,this.loading=!1,e.success&&(this.checkedTree.expandGroup=[],this.groupTreeList=this.formatTreeDataWithoutUser(e.data));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"formatTreeData",value:function(t){var e=this,a=t.map((function(t){var a=t.depId,s=t.depName,i=t.childDeps,n=t.depUsers,r=e.formatTreeData(i),o=n.map((function(t){var i=t.userId,n=t.userName;return e.checkedTree.expandDep.push(i),{id:i,name:n,isUser:1,depId:a,depName:s}}));return e.checkedTree.expandDep.push(a),{id:a,name:s,children:[].concat(Object(y["a"])(r),Object(y["a"])(o)),depUsers:n}}));return a}},{key:"formatTreeDataWithoutUser",value:function(t){var e=this,a=t.map((function(t){var a=t.depId,s=t.depName,i=t.childDeps,n=t.depUsers,r=e.formatTreeDataWithoutUser(i),o=n.map((function(t){return{distributeId:a,distribute:s,orderType:3,sendUserId:t.userId,sendUser:t.userName}}));return e.checkedTree.expandGroup.push(a),{id:a,name:s,children:Object(y["a"])(r),users:o}}));return a}},{key:"_getTags",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,this.tagDataList=[],t.next=4,Zt({});case 4:e=t.sent,this.loading=!1,e.success&&(this.checkedTree.expandTag=[],this.tagDataList=e.data.map((function(t){var e=t.tagId,s=t.tagName,i=t.users,n=i.map((function(t){return{distributeId:e,distribute:s,orderType:2,sendUserId:t.userId,sendUser:t.userName}}));return a.checkedTree.expandTag.push(e),{id:e,name:s,targetUsers:n}})));case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"known",value:function(){this.knownLoading=!0,this.commit(1)}},{key:"submit",value:function(){this.replyContent?(this.submitLoading=!0,this.commit(2)):this.$toast.fail("请填写内容")}},{key:"commit",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={csoId:this.detail.csoId,csodId:this.detail.csodId,content:1===e?"已知悉":this.replyContent},t.next=3,Qt(a);case 3:s=t.sent,s.success&&(this.submitLoading=!1,this.knownLoading=!1,this.$toast.success(s.msg||"回执成功"),this.isMsg?this.detail.content=this.replyContent:(this.SET_HADDONEONDETAIL(!0),setTimeout((function(){i.$router.back()}),1e3)));case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"_downloadFile",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e.fileName,s=e.fileType,i=e.fileUrl,"jpg"===s||"jpeg"===s||"png"===s?window.location.href="https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/".concat(i):this.$router.push({path:"/task/download",query:{fileName:a,fileType:s,fileUrl:i}});case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDetail",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={},1!==+this.taskDetailInfo.type){t.next=7;break}return t.next=4,se({csoId:this.taskDetailInfo.csoId});case 4:e=t.sent,t.next=11;break;case 7:if(2!==+this.taskDetailInfo.type){t.next=11;break}return t.next=10,ne({csoId:this.taskDetailInfo.csoId,userId:this.userId||localStorage.getItem("userId")||""});case 10:e=t.sent;case 11:this.detail=e.data,this.replyList=[],this.noReplyList=[],this.detail.sendList.map((function(t){t.content?a.replyList.push(t):a.noReplyList.push(t)})),0!==+this.detail.useStatus&&this.detail.isReturn&&this.noReplyList.length&&this.$nextTick((function(){var t=a.$refs.noreply;a.showMore=t.scrollHeight>40}));case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onUrgeReply",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e),t.next=3,oe({csoId:e});case 3:a=t.sent,a.success&&this.$toast.success(a.msg||"催办成功");case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"resend",value:function(){this.$router.push({name:"TaskPublish",params:{detail:this.detail}})}},{key:"created",value:function(){var t=this;console.log(this.taskDetailInfo),this.getDetail(),window.addEventListener("pageshow",(function(){t.SET_TASKDETAILINFO(JSON.parse(localStorage.getItem("taskDetailInfo")||"")),t.getDetail()}))}},{key:"beforeDestroy",value:function(){window.removeEventListener("pageshow",(function(){alert("destroy pageshow")}))}}]),a}(d["c"]);Object(u["a"])([or.Mutation],cr.prototype,"SET_HADDONEONDETAIL",void 0),Object(u["a"])([or.Mutation],cr.prototype,"SET_TASKDETAILINFO",void 0),Object(u["a"])([h["a"]],cr.prototype,"taskDetailInfo",void 0),cr=Object(u["a"])([Object(d["a"])({})],cr);var lr=cr,ur=lr,dr=(a("f1ed"),Object(V["a"])(ur,nr,rr,!1,null,"33ce9f5d",null)),hr=dr.exports,pr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-file-download"},[t.isAndroid&&t.isWechatBro?s("img",{staticClass:"file-bg",attrs:{src:a("47f7")}}):t._e(),t.isAndroid&&!t.isWechatBro?s("div",{staticClass:"file-title"},[t._v(t._s(t.fileObj.fileName+"."+t.fileObj.fileType))]):t._e(),t.isAndroid&&!t.isWechatBro?s("van-button",{attrs:{type:"info",size:"small",round:"",block:"",loading:t.loading},on:{click:t._downloadFile}},[t._v("点击下载")]):t._e(),t.isIOS?s("div",{staticClass:"file-title blue copy-content",attrs:{"data-clipboard-text":t.fileUrl},on:{click:t.copy}},[t._v(t._s(t.fileUrl))]):t._e(),t.isIOS?s("div",{staticClass:"file-desc"},[t._v("点击上方复制链接，到浏览器打开")]):t._e()],1)},mr=[],vr=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.isAndroid=!1,t.isIOS=!1,t.isWechatBro=!1,t.showBox=!1,t.fileObj=t.$route.query,t.fileUrl="",t.loading=!1,t}return Object(o["a"])(a,[{key:"mounted",value:function(){var t=navigator.userAgent;console.log(t),this.isAndroid=t.indexOf("Android")>-1||t.indexOf("Linux")>-1,this.isIOS=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),this.isAndroid?this.showBox=!1:this.isIOS&&(this.showBox=!0),this.isWechatBro=this.isWechat(),this.fileUrl="https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/".concat(this.$route.query.fileUrl)}},{key:"isWechat",value:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("micromessenger")}},{key:"copy",value:function(){var t=this,e=new this.$Clipboard(".copy-content");e.on("success",(function(a){console.log(a),t.$toast.success("复制成功"),e.destroy()})),e.on("error",(function(a){console.log(a),t.$toast.fail("该浏览器不支持自动复制"),e.destroy()}))}},{key:"_downloadFile",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this.fileObj.fileType,console.log(e),"jpg"===e||"jpeg"===e||"png"===e?(console.log("图片"),window.location.href="https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/".concat(this.$route.query.fileUrl)):(a=document.createElement("iframe"),a.style.display="none",a.src=this.fileUrl,document.getElementsByTagName("body")[0].appendChild(a));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"downloadIamge",value:function(t,e){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){var t=document.createElement("canvas");t.width=a.width,t.height=a.height;var s=t.getContext("2d");s.drawImage(a,0,0,a.width,a.height);var i=t.toDataURL("image/png"),n=document.createElement("a"),r=new MouseEvent("click");n.download=e||"photo",n.href=i,n.dispatchEvent(r)},a.src=t}}]),a}(d["c"]);vr=Object(u["a"])([Object(d["a"])({})],vr);var fr=vr,gr=fr,br=(a("9ee2"),Object(V["a"])(gr,pr,mr,!1,null,"2e5e1918",null)),yr=br.exports,_r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-publish"},[a("div",{staticClass:"detail__card"},[a("van-form",{attrs:{"validate-first":""},on:{failed:t.onFailed}},[a("van-field",{attrs:{readonly:"",clickable:"",value:t.labelValue.text?t.bigLabelValue.text+" / "+t.labelValue.text:"",required:"",label:"事件分类",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择事件分类"}]},on:{click:function(e){return t.chooseFilter(2)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.dateRange[0]?t.dateRange[0]+" 至 "+t.dateRange[1]:"",label:"事件时效",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(1)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.urgency.name,required:"",label:"紧急程度",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择紧急程度"}]},on:{click:function(e){return t.chooseFilter(3)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.isReturn.name,required:"",label:"需要回执",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择是否需要回执"}]},on:{click:function(e){return t.chooseFilter(4)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.sendPersonsText,required:"",label:"发送至",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择发送人员"}]},on:{click:function(e){return t.chooseFilter(5)}}}),a("van-field",{attrs:{clearable:"",required:"",label:"标题",placeholder:"请输入任务标题",rules:[{validator:t.validator,message:"请输入任务标题"}]},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),a("van-field",{attrs:{clearable:"",required:"",rows:"4",autosize:"",type:"textarea",label:"内容",placeholder:"请输入任务内容"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)],1),a("div",{staticClass:"detail__card"},[a("div",{staticClass:"file__title"},[t._v("附件")]),a("van-uploader",{staticClass:"file__upload",attrs:{"after-read":t.afterRead,"upload-icon":"plus"},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1),a("div",{staticClass:"footer"},[a("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit",size:"small",loading:t.publishLoading},on:{click:t.submit}},[t._v("提交")])],1),1===t.actionType?a("van-calendar",{attrs:{color:"#1989fa",type:"range",title:"选择时间范围","min-date":t.minDate},on:{confirm:t.onDateChange},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),2===t.actionType?a("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}},[a("van-tree-select",{attrs:{"active-color":"#363636",items:t.labelTreeList,"active-id":t.activeId,"main-active-index":t.activeIndex},on:{"update:activeId":function(e){t.activeId=e},"update:active-id":function(e){t.activeId=e},"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e},"click-item":t.onLabelChange}})],1):t._e(),3===t.actionType?a("van-action-sheet",{attrs:{actions:t.urgencyList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectUrgency},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),4===t.actionType?a("van-action-sheet",{attrs:{actions:t.isReturnList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectIsReturn},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),5===t.actionType?a("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}},[a("van-tabs",{attrs:{color:"#1989fa"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("van-search",{attrs:{placeholder:"请输入搜索关键词"},on:{input:t.searchTreeInput},model:{value:t.searchTreeValue,callback:function(e){t.searchTreeValue=e},expression:"searchTreeValue"}}),a("van-tab",{attrs:{title:"部门/人员"}},[t.depTreeList.length?a("vs-tree",{ref:"depTree",staticClass:"tree-div",attrs:{data:t.depTreeList,showLine:"",expandLevel:-1,checkedKeys:t.checkedTree.checkedDep,showCheckbox:""}}):a("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无部门/人员"}})],1),a("van-tab",{attrs:{title:"标签"}},[t.tagDataList.length?a("vs-tree",{ref:"tagTree",staticClass:"tree-div",attrs:{data:t.tagDataList,checkedKeys:t.checkedTree.checkedTag,showCheckbox:"",checkOnClickNode:""}}):a("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无标签"}})],1),a("van-tab",{attrs:{title:"小组"}},[t.groupTreeList.length?a("vs-tree",{ref:"groupTree",staticClass:"tree-div",attrs:{data:t.groupTreeList,checkedKeys:t.checkedTree.checkedGroup,showCheckbox:"",checkOnClickNode:""}}):a("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无小组"}})],1)],1),a("div",{staticClass:"send-btn"},[a("van-button",{attrs:{round:"",block:"",type:"info",size:"small"},on:{click:t.onSendChange}},[t._v("确定")])],1)],1):t._e()],1)},kr=[],Cr=Object(h["b"])("commonStore"),wr=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.activeId=-1,t.activeIndex=0,t.labelTreeList=[],t.loading=!1,t.publishLoading=!1,t.actionShow=!1,t.actionType=0,t.minDate=new Date(2010,0,1),t.urgencyList=[{value:1,name:"普通"},{value:2,name:"重要"},{value:3,name:"紧急"}],t.isReturnList=[{value:1,name:"是"},{value:0,name:"否"}],t.dateRange=[],t.bigLabelValue={},t.labelValue={},t.urgency={},t.isReturn={},t.title="",t.content="",t.depTreeList=[],t.groupTreeList=[],t.tagDataList=[],t.active=0,t.sendPersons=[],t.fileList=[],t.searchTreeValue="",t.checkedTree={},t}return Object(o["a"])(a,[{key:"_getLabelTree",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={type:"1"},t.next=3,Ct(e);case 3:a=t.sent,this.labelTreeList=a.data.map((function(t){var e=[];return t.CHILD_LIST.length&&(e=t.CHILD_LIST.map((function(t){return{id:t.LABEL_ID,text:t.LABEL_NAME}}))),t.LABEL_ID===s.bigLabelValue.id&&(s.bigLabelValue.text=t.LABEL_NAME),{id:t.LABEL_ID,text:t.LABEL_NAME,children:e}})),this.$forceUpdate();case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"_getDepTree",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,Jt({type:1});case 3:e=t.sent,this.loading=!1,e.success&&(this.depTreeList=this.formatTreeData(e.data));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"_geGroupTree",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,Jt({type:2});case 3:e=t.sent,this.loading=!1,e.success&&(this.groupTreeList=this.formatTreeDataWithoutUser(e.data));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"formatTreeData",value:function(t){var e=this,a=t.map((function(t){var a=t.depId,s=t.depName,i=t.childDeps,n=t.depUsers,r=e.formatTreeData(i),o=n.map((function(t){var e=t.userId,i=t.userName;return{id:e,name:i,isUser:1,depId:a,depName:s}}));return{id:a,name:s,children:[].concat(Object(y["a"])(r),Object(y["a"])(o)),depUsers:n}}));return a}},{key:"formatTreeDataWithoutUser",value:function(t){var e=this,a=t.map((function(t){var a=t.depId,s=t.depName,i=t.childDeps,n=t.depUsers,r=e.formatTreeDataWithoutUser(i),o=n.map((function(t){return{distributeId:a,distribute:s,orderType:3,sendUserId:t.userId,sendUser:t.userName}}));return{id:a,name:s,children:Object(y["a"])(r),users:o}}));return a}},{key:"_getTags",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,this.tagDataList=[],t.next=4,Zt({});case 4:e=t.sent,this.loading=!1,e.success&&(this.tagDataList=e.data.map((function(t){var e=t.tagId,a=t.tagName,s=t.users,i=s.map((function(t){return{distributeId:e,distribute:a,orderType:2,sendUserId:t.userId,sendUser:t.userName}}));return{id:e,name:a,targetUsers:i}})));case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"chooseFilter",value:function(t){this.actionShow=!0,this.actionType=t}},{key:"onDateChange",value:function(t){this.actionShow=!1,this.dateRange=[Gs(t[0]),Gs(t[1])]}},{key:"onLabelChange",value:function(t){this.actionShow=!1,this.labelValue=t,this.bigLabelValue=this.labelTreeList[this.activeIndex]}},{key:"onSelectUrgency",value:function(t){this.urgency=t}},{key:"onSelectIsReturn",value:function(t){this.isReturn=t}},{key:"onSendChange",value:function(){var t=this;this.sendPersons=[];var e=this.$refs.depTree;e&&e.getCheckedNodes().forEach((function(e){e.isUser&&t.sendPersons.push({distributeId:e.depId,distribute:e.depName,orderType:1,sendUserId:e.id,sendUser:e.name})}));var a=this.$refs.tagTree;a&&a.getCheckedNodes().forEach((function(e){e.targetUsers&&(t.sendPersons=[].concat(Object(y["a"])(t.sendPersons),Object(y["a"])(e.targetUsers)))}));var s=this.$refs.groupTree;s&&s.getCheckedNodes().forEach((function(e){e.users&&(t.sendPersons=[].concat(Object(y["a"])(t.sendPersons),Object(y["a"])(e.users)))})),this.actionShow=!1}},{key:"validator",value:function(t){console.log(t)}},{key:"onFailed",value:function(t){console.log("failed",t)}},{key:"afterRead",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e),e.status="uploading",e.message="上传中...",t.next=5,Oi({file:e.file});case 5:a=t.sent,a.success?(e.status="success",e.message="上传成功",e.result=a.data):(e.status="failed",e.message="上传失败");case 7:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"submit",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.fileList.map((function(t){var e=t.result,a=e.fileName,s=e.suffix,i=e.fullPath;return{fileName:a,fileType:s,fileUrl:i}})),a={bigTagId:this.bigLabelValue.id,smallTagId:this.labelValue.id,eventAgeingStart:this.dateRange[0]||"",eventAgeingEnd:this.dateRange[1]||"",emergencyLevel:this.urgency.value,isReturn:this.isReturn.value,orderTitle:this.title,orderContent:this.content,files:e,sendPersons:this.sendPersons},a.smallTagId){t.next=5;break}return this.$toast("事件分类不能为空"),t.abrupt("return");case 5:if(a.emergencyLevel){t.next=8;break}return this.$toast("紧急程度不能为空"),t.abrupt("return");case 8:if(0===+a.isReturn||1===+a.isReturn){t.next=11;break}return this.$toast("是否需要回执不能为空"),t.abrupt("return");case 11:if(a.sendPersons.length){t.next=14;break}return this.$toast("发送至不能为空"),t.abrupt("return");case 14:if(a.orderTitle){t.next=17;break}return this.$toast("标题不能为空"),t.abrupt("return");case 17:if(a.orderContent){t.next=20;break}return this.$toast("内容不能为空"),t.abrupt("return");case 20:return this.publishLoading=!0,t.next=23,Nt(a);case 23:s=t.sent,s.success&&(this.SET_HADDONEONDETAIL(!0),this.$toast.success(s.msg||"发送成功"),setTimeout((function(){i.publishLoading=!1,i.$router.back()}),1e3));case 25:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"searchTreeInput",value:function(t){switch(this.active){case 0:this.$refs.depTree.filter(t);break;case 1:this.$refs.tagTree.filter(t);break;case 2:this.$refs.groupTree.filter(t);break;default:break}}},{key:"created",value:function(){var t=this,e=this.$route.params.detail;if(e){this.urgency={value:e.emergencyLevel,name:this.urgencyList.filter((function(t){return t.value===e.emergencyLevel}))[0].name},this.isReturn={value:e.isReturn,name:this.isReturnList.filter((function(t){return t.value===e.isReturn}))[0].name},this.dateRange=[e.eventAgeingStart,e.eventAgeingEnd],this.bigLabelValue={id:e.bigTagId},this.labelValue={id:e.smallTagId,text:e.smallTag},this.title=e.orderTitle,this.content=e.orderContent;var a=this.$root;this.fileList=e.files.map((function(t){return{text:t.fileName,url:a.domainUrl+t.fileUrl,result:{fileName:t.fileName,suffix:t.fileType,fullPath:t.fileUrl}}})),this.sendPersons=[],this.checkedTree={checkedDep:[],checkedTag:[],checkedGroup:[]},e.sendList.map((function(e){var a=0;e.sendTypeList.forEach((function(s){t.sendPersons.push({distributeId:s.distributeId,distribute:s.distribute,orderType:e.orderType,sendUserId:e.sendUserId,sendUser:e.sendUserName}),1===s.orderType?a=1:2===s.orderType?t.checkedTree.checkedTag.push(s.distributeId):3===s.orderType&&t.checkedTree.checkedGroup.push(s.distributeId)})),a&&t.checkedTree.checkedDep.push(e.sendUserId)}))}this._getLabelTree(),this._getDepTree(),this._geGroupTree(),this._getTags()}},{key:"sendPersonsText",get:function(){return this.sendPersons.map((function(t){return t.sendUser})).join("、")}}]),a}(d["c"]);Object(u["a"])([Cr.Mutation],wr.prototype,"SET_HADDONEONDETAIL",void 0),wr=Object(u["a"])([Object(d["a"])({})],wr);var Lr=wr,xr=Lr,Ir=(a("ed20"),Object(V["a"])(xr,_r,kr,!1,null,"809bffc6",null)),Sr=Ir.exports,Dr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customer-unit"},[a("van-sticky",[a("van-dropdown-menu",{attrs:{"active-color":"#1989fa","close-on-click-outside":!1}},[a("van-dropdown-item",{attrs:{options:t.option},on:{change:t.refreshData},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),a("van-dropdown-item",{ref:"filter",attrs:{title:"筛选"}},[a("van-cell-group",{staticStyle:{padding:"10px 0"}},[a("van-field",{attrs:{clearable:"",label:"客户名称",placeholder:"请输入客户名称|客户ID"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),a("van-field",{directives:[{name:"show",rawName:"v-show",value:2===t.value,expression:"value === 2"}],attrs:{readonly:"",clickable:"",value:t.deptsText,label:"部门",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(11)}}}),a("van-field",{directives:[{name:"show",rawName:"v-show",value:2===t.value,expression:"value === 2"}],attrs:{readonly:"",clickable:"",value:t.deptUsersText,label:"人员",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(12)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.hosType.name,label:"医院等级",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(1)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.saleType.name,label:"销售规模",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(2)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.learnType.name,label:"学术专线",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(3)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.isProfit.name,label:"经营性质",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(4)}}})],1),a("div",{staticClass:"dropdown-opts"},[a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:t.reset}},[t._v("重置")]),a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",plain:"",block:"",round:""},on:{click:t.onConfirm}},[t._v("确认")])],1)],1)],1)],1),a("van-pull-refresh",{staticClass:"msg-list",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,s){return a("div",{key:s,staticClass:"customer-item van-clearfix",on:{click:function(a){return t.toDetail(e,1)}}},[a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("客户信息")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.custId?e.custId+"/"+e.custName:""))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("医院等级")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.hospitalLevel||""))])]),e.isShare?t._e():a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("已维护人数")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.personNum))])]),e.isShare?t._e():a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("一般客情热力值")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.warmthPersonNum))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("维护人")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.cceId&&e.creName?e.creName:""))])]),a("div",{staticClass:"line"}),e.hasNoOpts||1!==t.value?2===t.value?a("div",{staticClass:"customer-item__opts"},[a("van-button",{staticClass:"customer-item__btn",attrs:{type:"default",size:"small",round:"",plain:""},on:{click:function(a){return a.stopPropagation(),t.toPerson(e,2)}}},[t._v("查看人员")])],1):t._e():a("div",{staticClass:"customer-item__opts"},[a("van-button",{staticClass:"customer-item__btn",attrs:{type:"info",size:"small",round:"",plain:""},on:{click:function(a){return a.stopPropagation(),t.toDetail(e,2)}}},[t._v("编辑")]),e.cceId&&!e.isShare?a("van-button",{staticClass:"customer-item__btn",attrs:{type:"default",size:"small",round:""},on:{click:function(a){return a.stopPropagation(),t.toShare(e)}}},[t._v("分享至")]):t._e(),a("van-button",{staticClass:"customer-item__btn",attrs:{type:"default",size:"small",round:"",plain:""},on:{click:function(a){return a.stopPropagation(),t.toPerson(e,1)}}},[t._v("人员维护")])],1)])})),0)],1),1===t.actionType?a("van-action-sheet",{attrs:{actions:t.hosTypeList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectHosType},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),2===t.actionType?a("van-action-sheet",{attrs:{actions:t.saleTypeList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectSaleType},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),3===t.actionType?a("van-action-sheet",{attrs:{actions:t.learnTypeList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectLearnType},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),4===t.actionType?a("van-action-sheet",{attrs:{actions:t.isProfitList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectProfit},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),11===t.actionType&&t.actionShow?a("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}},[t.formatDepTree.length?a("vs-tree",{ref:"depTree",staticClass:"tree-div",attrs:{data:t.formatDepTree,checkedKeys:t.defaultCheckedDepKeys,expandKeys:t.expandKeys,showCheckbox:"",checkOnClickNode:""}}):a("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无部门"}}),a("div",{staticClass:"sure-btn"},[a("van-button",{attrs:{round:"",block:"",type:"info",size:"small"},on:{click:t.onDeptChange}},[t._v("确定")])],1)],1):t._e(),12===t.actionType&&t.actionShow?a("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}},[a("van-checkbox",{staticStyle:{padding:"10px 10px 0 28px"},attrs:{shape:"square","icon-size":"14px"},on:{click:t.onAllCheckClick},model:{value:t.allUserChecked,callback:function(e){t.allUserChecked=e},expression:"allUserChecked"}},[t._v("全部")]),t.userDataList.length?a("vs-tree",{key:t.componentKey,ref:"userTree",staticClass:"tree-div",attrs:{data:t.userDataList,checkedKeys:t.defaultCheckedUserKeys,showCheckbox:"",checkOnClickNode:""},on:{change:t.onUserNodeChange}}):a("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无人员"}}),a("div",{staticClass:"sure-btn"},[a("van-button",{attrs:{round:"",block:"",type:"info",size:"small"},on:{click:t.onUserChange}},[t._v("确定")])],1)],1):t._e()],1)},Or=[],jr=(a("7db0"),Object(h["b"])("commonStore")),Tr=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.formatDepTree=[],t.defaultCheckedDepKeys=[],t.expandKeys=[],t.checkedDepts=[],t.getUserListLoading=!1,t.userDataList=[],t.defaultCheckedUserKeys=[],t.checkedUsers=[],t.value=1,t.option=[{text:"本人",value:1},{text:"本部门",value:2}],t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.actionShow=!1,t.actionType=0,t.minDate=new Date(2010,0,1),t.hosType={},t.saleType={},t.learnType={},t.isProfit={},t.keywords="",t.hosTypeList=[],t.saleTypeList=[],t.learnTypeList=[],t.isProfitList=[{value:1,label:"政府办"},{value:2,label:"非政府办营利"},{value:3,label:"非政府办非营利"}],t.roleTypeList=[],t.componentKey=0,t.allUserChecked=!0,t}return Object(o["a"])(a,[{key:"onAllCheckClick",value:function(){var t=this;if(this.defaultCheckedUserKeys=[],this.allUserChecked){var e=this.userDataList;e.forEach((function(e){t.defaultCheckedUserKeys.push(e.id)}))}this.componentKey+=1}},{key:"onUserNodeChange",value:function(t){console.log(t);var e=this.$refs.userTree,a=e.getCheckedNodes()||[];this.defaultCheckedUserKeys=a.map((function(t){return t.id})),this.allUserChecked=a.length===this.userDataList.length}},{key:"getSearchList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.hosTypeList=[],this.saleTypeList=[],this.learnTypeList=[],this.roleTypeList=[],t.next=6,Promise.all([this.getTypeList(12),this.getTypeList(13),this.getTypeList(1),this.getTypeList(2,1)]);case 6:e=t.sent,a=Object(gn["a"])(e,4),s=a[0],i=a[1],n=a[2],r=a[3],this.hosTypeList=s,this.saleTypeList=i,this.learnTypeList=n,this.roleTypeList=r;case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getTypeList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){var s,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={},s=a?{pageNum:1,pageSize:1e5,typeId:e,usestatus:1,typeSecondId:a}:{pageNum:1,pageSize:1e5,usestatus:1,typeId:e},t.next=4,Si(s);case 4:return i=t.sent,n=i.data.list.map((function(t){var e=t.DIC_SELECT_ID,a=t.DIC_SELECT_NAME;return{value:e,name:a}})),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$cancelAxios(["queryCustomInfoList"]),e={type:this.value,custom:this.keywords,hospitalLevel:this.hosType.value||"",yearSalesVolume:this.saleType.value||"",scienceLine:this.learnType.value||"",isProfit:this.isProfit.value||"",pageNum:this.page,pageSize:this.pageSize},2===this.value&&(e.userList=this.checkedUsers.map((function(t){return t.id}))),t.next=5,Se(e);case 5:a=t.sent,this.loading=!1,this.refreshing=!1,a.success?(s=[],a.data.list.forEach((function(t){if(t.custExbandInfoVOList.length){var e=t.custExbandInfoVOList.find((function(t){return!t.isShare}));if(e){var a=Object.assign({},t,e);s.push(a)}else s.push(t);t.custExbandInfoVOList.forEach((function(a){if(!e||a.cceId!==e.cceId){var i=Object.assign({},t,{hasNoOpts:!0},a);s.push(i)}}))}else{var i=Object.assign({personNum:0,warmthPersonNum:0},t);s.push(i)}})),this.list=[].concat(Object(y["a"])(this.list),s),this.page++,this.finished=!a.data.hasNextPage):this.error=!0;case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"chooseFilter",value:function(t){this.actionShow=!0,this.actionType=t}},{key:"onSelectHosType",value:function(t){this.hosType=t}},{key:"onSelectSaleType",value:function(t){this.saleType=t}},{key:"onSelectLearnType",value:function(t){this.learnType=t}},{key:"onSelectProfit",value:function(t){this.isProfit=t}},{key:"reset",value:function(){this.hosType={},this.saleType={},this.learnType={},this.isProfit={},this.keywords=""}},{key:"onConfirm",value:function(){var t=this.$refs.filter;t.toggle(),this.refreshData()}},{key:"refreshData",value:function(){this.list=[],this.page=1,this.finished=!1,this.loading=!0,this.getDataList()}},{key:"toDetail",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.SET_HADDONEONDETAIL(!1),this.$router.push({name:"CustomerUnitDetail",params:{item:e,type:String(a)}});case 2:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"toShare",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.SET_CUSTOMERINFO(e),this.$router.push({name:"CustomerShare"});case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"toPerson",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.orgRoleId){t.next=3;break}return Object(Dt["a"])({type:"warning",message:"请先维护科室角色，再新增人员信息"}),t.abrupt("return");case 3:e.onlyRead=2===a,this.SET_CUSTOMERINFO(e),this.$router.push({name:"CustomerUnitPerson"});case 6:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"_getDepTree",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{treeType:1,authorizedFlag:!0};this.actionGetDepTree(e).then((function(e){0===e.data.length?(t.formatDepTree=[],t.option=[{text:"本人",value:1}]):(t.formatDepTree=t.formatTree(t.depTreeList),t._getUserByParams({depIdList:t.mapTreeList(t.depTreeList,[]),leaderFlag:!1,authorizedFlag:!0}),t.option=[{text:"本人",value:1},{text:"本部门",value:2}])}))}},{key:"mapTreeList",value:function(t,e){for(var a=0;a<t.length;a++){var s=t[a];s.operationFlag&&e.push(s.depId),s.childList&&s.childList.length>0&&this.mapTreeList(s.childList,e)}return e}},{key:"formatTree",value:function(t){var e=this,a=t.map((function(t){var a=t.depId,s=t.depName,i=t.childList,n=t.operationFlag,r=i?e.formatTree(i):[];return e.defaultCheckedDepKeys.push(a),e.expandKeys.push(a),e.checkedDepts.push({id:a,name:s,operationFlag:n}),{id:a,name:s,operationFlag:n,children:r}}));return a}},{key:"_getUserByParams",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.getUserListLoading=!0,t.next=3,Ii(e);case 3:a=t.sent,"200"===a.code&&(this.getUserListLoading=!1,this.userDataList=a.data.map((function(t){var e=t.userId,a=t.userName;return s.defaultCheckedUserKeys.push(e),{id:e,name:a}})),this.checkedUsers=this.userDataList);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onDeptChange",value:function(){var t=this.$refs.depTree;this.checkedDepts=t.getCheckedNodes()||[];var e=this.checkedDepts.map((function(t){return t.id}));this.defaultCheckedDepKeys=e,console.log(this.checkedDepts);var a=this.checkedDepts.map((function(t){return{depId:t.id,operationFlag:t.operationFlag}}));this._getUserByParams({depIdList:this.mapTreeList(a,[]),leaderFlag:!1,authorizedFlag:!0}),this.actionShow=!1}},{key:"onUserChange",value:function(){var t=this.$refs.userTree;this.checkedUsers=t.getCheckedNodes()||[],this.defaultCheckedUserKeys=this.checkedUsers.map((function(t){return t.id})),this.actionShow=!1}},{key:"created",value:function(){this.list=[],this.getSearchList()}},{key:"activated",value:function(){this.depTreeList?0===this.depTreeList.length?(this.option=[{text:"本人",value:1}],this.formatDepTree=[]):(this.formatDepTree=this.formatTree(this.depTreeList),this._getUserByParams({depIdList:this.mapTreeList(this.depTreeList,[]),leaderFlag:!1,authorizedFlag:!0}),this.option=[{text:"本人",value:1},{text:"本部门",value:2}]):this._getDepTree(),this.hadDoneOnDetail&&this.refreshData()}},{key:"deptsText",get:function(){return this.checkedDepts.map((function(t){return t.name})).join("、")}},{key:"deptUsersText",get:function(){return this.checkedUsers.map((function(t){return t.name})).join("、")}}]),a}(d["c"]);Object(u["a"])([jr.Mutation],Tr.prototype,"SET_CUSTOMERINFO",void 0),Object(u["a"])([jr.Action],Tr.prototype,"actionGetDepTree",void 0),Object(u["a"])([jr.Mutation],Tr.prototype,"SET_HADDONEONDETAIL",void 0),Object(u["a"])([h["a"]],Tr.prototype,"depTreeList",void 0),Object(u["a"])([h["a"]],Tr.prototype,"hadDoneOnDetail",void 0),Tr=Object(u["a"])([Object(d["a"])({})],Tr);var Rr=Tr,Nr=Rr,Ar=(a("47a2"),Object(V["a"])(Nr,Dr,Or,!1,null,"5d03a0df",null)),Pr=Ar.exports,Er=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customer-person"},[a("div",{staticClass:"share-header"},[a("div",{staticClass:"share-header__title"},[t._v("分享至")]),a("div",{staticClass:"share0header__add",on:{click:t.toAdd}},[a("van-icon",{attrs:{name:"add",size:"2.2em",color:"#1989fa"}})],1)]),a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return a("div",{key:e.cueId,staticClass:"share-item van-clearfix",on:{click:function(a){return t.toEdit(e)}}},[a("van-swipe-cell",{scopedSlots:t._u([{key:"right",fn:function(){return[a("van-button",{staticClass:"del-btn",attrs:{square:"",type:"danger",text:"删除"},on:{click:function(a){return a.stopPropagation(),t.deleteDonor(e.cesId)}}})]},proxy:!0}],null,!0)},[a("div",{staticClass:"share-list"},[a("div",{staticClass:"share-item__line"},[a("div",{staticClass:"share-item__title"},[t._v("人员")]),a("div",{staticClass:"share-item__content"},[t._v(t._s(e.shareToUserId)+"/"+t._s(e.shareToUserName))])]),a("div",{staticClass:"share-item__line"},[a("div",{staticClass:"share-item__title"},[t._v("是否更新")]),a("div",{staticClass:"share-item__content"},[t._v(t._s(1===e.isUpdate?"是":0===e.isUpdate?"否":""))])]),a("div",{staticClass:"share-item__line"},[a("div",{staticClass:"share-item__title"},[t._v("过期时间")]),a("div",{staticClass:"share-item__content"},[t._v(t._s(e.validDate))])])])])],1)})),0)],1),1===t.actionType?a("van-action-sheet",{attrs:{actions:t.shareCustList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectUser},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),2===t.actionType?a("van-action-sheet",{attrs:{actions:t.selectOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectUpdate},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),3===t.actionType?a("van-calendar",{attrs:{color:"#1989fa","show-confirm":!1},on:{confirm:t.onDateConfirm},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),a("van-popup",{staticClass:"transfer",attrs:{"close-on-click-overlay":!1,round:""},model:{value:t.shareShow,callback:function(e){t.shareShow=e},expression:"shareShow"}},[a("van-form",{staticClass:"transfer-div",attrs:{"validate-first":""},on:{failed:t.onFailed}},[a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.user.name,required:"","label-width":"4em",label:"人员",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择人员"}]},on:{click:function(e){return t.chooseFilter(1)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.isUpdate.name,required:"","label-width":"4em",label:"是否更新",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择是否更新"}]},on:{click:function(e){return t.chooseFilter(2)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.date,"label-width":"4em",label:"过期时间",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(3)}}}),a("div",{staticClass:"transfer-opts"},[a("div",{staticClass:"transfer-btn",on:{click:function(e){t.shareShow=!1}}},[t._v("取消")]),a("div",{staticClass:"transfer-btn transfer-btn--blue",on:{click:t.share}},[t._v("确定")])])],1)],1)],1)},Mr=[],$r=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.shareShow=!1,t.shareCustList=[],t.selectOptions=[{value:0,name:"否"},{value:1,name:"是"}],t.actionShow=!1,t.actionType=0,t.formData={user:{},isUpdate:{},date:""},t}return Object(o["a"])(a,[{key:"validator",value:function(t){return/\S/.test(t)}},{key:"onFailed",value:function(t){console.log("failed",t)}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Te({cceId:this.customerInfo.cceId});case 2:e=t.sent,this.loading=!1,this.refreshing=!1,e.success?(this.list=e.data,this.finished=!0):this.error=!0;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getRoleList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.shareCustList=[],t.next=3,Ne({custId:this.customerInfo.custId,igonreUserId:this.customerInfo.creId,exbandId:this.customerInfo.cceId});case 3:e=t.sent,this.shareCustList=e.data.map((function(t){var e=t.userId,a=t.userName,s=t.isAlreadyShare;return{value:e,name:e+"/"+a,disabled:s}})),this.loading=!0;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"refreshData",value:function(){this.list=[],this.finished=!1,this.loading=!0,this.getDataList()}},{key:"deleteDonor",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$dialog.confirm({title:"提示",message:"确定移除？"}).then(Object(_["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,qe({cesId:e});case 2:s=t.sent,s.success?(a.$toast.success(s.msg||"移除成功"),a.refreshData()):a.$toast.fail(s.msg||"移除失败");case 4:case"end":return t.stop()}}),t)})))).catch((function(){console.log("cancel")}));case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"chooseFilter",value:function(t){this.actionShow=!0,this.actionType=t}},{key:"onSelectUser",value:function(t){this.actionShow=!1,this.formData.user=t}},{key:"onSelectUpdate",value:function(t){this.actionShow=!1,this.formData.isUpdate=t}},{key:"onDateConfirm",value:function(t){console.log(t),this.actionShow=!1,this.formData.date=Gs(t)}},{key:"toAdd",value:function(){this.shareShow=!0,this.formData={cesId:"",user:{},isUpdate:{},date:""}}},{key:"toEdit",value:function(t){console.log(t),this.shareShow=!0,this.formData={cesId:t.cesId,user:{value:t.shareToUserId,name:t.shareToUserName},isUpdate:{value:t.isUpdate,name:1===+t.isUpdate?"是":0===+t.isUpdate?"否":""},date:t.validDate}}},{key:"share",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.formData.user.name){t.next=3;break}return this.$toast("请选择人员"),t.abrupt("return");case 3:if(this.formData.isUpdate.name){t.next=6;break}return this.$toast("请选择是否更新"),t.abrupt("return");case 6:if(console.log(this.formData),!this.formData.cesId){t.next=13;break}return t.next=10,Me({isUpdate:this.formData.isUpdate.value,validDate:this.formData.date,cesId:this.formData.cesId});case 10:t.t0=t.sent,t.next=16;break;case 13:return t.next=15,Pe({cceId:this.customerInfo.cceId,shareToUserId:this.formData.user.value,shareToUserName:this.formData.user.name.split("/")[1],isUpdate:this.formData.isUpdate.value,validDate:this.formData.date});case 15:t.t0=t.sent;case 16:e=t.t0,e.success&&(this.$toast.success(e.msg),this.shareShow=!1,this.refreshData(),this.getRoleList());case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.list=[],console.log(this.customerInfo),this.getRoleList()}}]),a}(d["c"]);Object(u["a"])([h["a"]],$r.prototype,"customerInfo",void 0),$r=Object(u["a"])([Object(d["a"])({})],$r);var qr=$r,Vr=qr,Ur=(a("d5c9"),Object(V["a"])(Vr,Er,Mr,!1,null,"3070d633",null)),Fr=Ur.exports,zr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customer-person"},[a("div",{staticClass:"customer-info"},[a("div",{staticClass:"customer__line"},[a("div",{staticClass:"customer__title"},[t._v("客户信息")]),a("div",{staticClass:"customer__content"},[t._v(t._s(t.customerInfo.custId?t.customerInfo.custId+"/"+t.customerInfo.custName:""))])]),a("div",{staticClass:"customer__linetwo"},[a("div",{staticClass:"customer__line"},[a("div",{staticClass:"customer__title"},[t._v("医院等级")]),a("div",{staticClass:"customer__content"},[t._v(t._s(t.customerInfo.hospitalLevel||""))])]),a("div",{staticClass:"customer__line"},[a("div",{staticClass:"customer__title"},[t._v("维护人")]),a("div",{staticClass:"customer__content"},[t._v(t._s(t.customerInfo.cceId&&t.customerInfo.creName?t.customerInfo.creName:""))])])])]),a("van-pull-refresh",{staticClass:"msg-list",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return a("div",{key:e.cueId,staticClass:"customer-item van-clearfix",on:{click:function(a){return t.toEditUser(3,e)}}},[a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("手机号")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.phoneNum))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("人员信息")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.userId?e.userId+"/"+e.userName:""))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("微信号")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.wxCode))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("角色信息")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.orgnizationRoleId)+"/"+t._s(e.orgnizationRoleName))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("部门信息")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.departmentId)+"/"+t._s(e.departmentName))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("职位信息")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.positionId)+"/"+t._s(e.positionName))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("维护人")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.operationId)+"/"+t._s(e.operationName))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("状态")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(0===e.status?"正式":2===e.status?"退休/离职":3===e.status?"转职":4===e.status?"由转职来":""))])]),a("div",{staticClass:"line"}),t.onlyRead?t._e():a("div",{staticClass:"customer-item__opts"},[a("van-button",{staticClass:"customer-item__btn",attrs:{type:"default",size:"small",round:"",plain:""},on:{click:function(a){return a.stopPropagation(),t.transferTo(e)}}},[t._v("转职至")]),a("van-button",{staticClass:"customer-item__btn",attrs:{type:"info",size:"small",round:"",plain:""},on:{click:function(a){return a.stopPropagation(),t.shareTo(e)}}},[t._v("分享至")]),a("van-button",{staticClass:"customer-item__btn",attrs:{type:"default",size:"small",round:"",plain:""},on:{click:function(a){return a.stopPropagation(),t.toEditUser(2,e)}}},[t._v("编辑")]),a("van-button",{staticClass:"customer-item__btn",attrs:{type:"danger",size:"small",round:"",plain:""},on:{click:function(a){return a.stopPropagation(),t.deleteUser(e)}}},[t._v("删除")])],1)])})),0)],1),t.onlyRead?t._e():a("div",{staticClass:"fab-circle",on:{click:function(e){return t.toEditUser(1)}}},[a("div",{staticClass:"fab-circle-v"}),a("div",{staticClass:"fab-circle-h"})]),a("van-popup",{staticClass:"transfer",attrs:{"close-on-click-overlay":!1,round:""},model:{value:t.transferShow,callback:function(e){t.transferShow=e},expression:"transferShow"}},[a("div",{staticClass:"transfer-div"},[a("van-field",{attrs:{readonly:"",clickable:"",value:t.customer.custId?t.customer.custId+"/"+t.customer.custName:"",required:"","label-width":"4em",label:"客户信息",placeholder:"请输入关键词",rules:[{validator:t.validator,message:"请选择客户信息"}]},on:{click:function(e){return t.chooseFilter(4)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.role.name,required:"","label-width":"4em",label:"科室角色",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择科室角色"}]},on:{click:function(e){return t.chooseFilter(1)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.dept.name,required:"","label-width":"4em",label:"部门信息",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择部门信息"}]},on:{click:function(e){return t.chooseFilter(2)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.position.name,required:"","label-width":"4em",label:"职位信息",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择职位信息"}]},on:{click:function(e){return t.chooseFilter(3)}}}),a("div",{staticClass:"transfer-opts"},[a("div",{staticClass:"transfer-btn",on:{click:function(e){t.transferShow=!1}}},[t._v("取消")]),a("div",{staticClass:"transfer-btn transfer-btn--blue",on:{click:t.transfer}},[t._v("确定")])])],1)]),1===t.actionType?a("van-action-sheet",{attrs:{actions:t.roleList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectRole},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),2===t.actionType?a("van-action-sheet",{attrs:{actions:t.deptList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectDept},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),3===t.actionType?a("van-action-sheet",{attrs:{actions:t.positionList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectPosition},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),a("full-pop",{directives:[{name:"show",rawName:"v-show",value:t.fullPopShow,expression:"fullPopShow"}],attrs:{loading:t.custLoading,list:t.custList},on:{cancel:function(e){t.fullPopShow=!1},input:t.getCustList,select:t.onSelectCustomer}})],1)},Wr=[],Br=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.onlyRead=!1,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.currentUser={},t.transferShow=!1,t.actionShow=!1,t.actionType=0,t.fullPopShow=!1,t.custLoading=!1,t.custList=[],t.roleList=[],t.deptList=[],t.positionList=[],t.customer={},t.role={},t.dept={},t.position={},t}return Object(o["a"])(a,[{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ze({creId:this.customerInfo.creId,custId:this.customerInfo.custId});case 2:e=t.sent,this.loading=!1,this.refreshing=!1,e.success?(this.list=e.data,this.finished=!0):this.error=!0;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onConfirm",value:function(){var t=this.$refs.filter;t.toggle(),this.refreshData()}},{key:"refreshData",value:function(){this.list=[],this.finished=!1,this.loading=!0,this.getDataList()}},{key:"transferTo",value:function(t){this.transferShow=!0,this.currentUser=t}},{key:"deleteUser",value:function(t){var e=this;this.$dialog.confirm({title:"提示",message:"确定删除？",confirmButtonColor:"#1989fa"}).then(Object(_["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Je({cupId:t.cupId});case 2:s=a.sent,s.success?(e.$toast.success(s.msg||"删除成功"),e.refreshData()):e.$toast.fail(s.msg||"删除失败");case 4:case"end":return a.stop()}}),a)})))).catch((function(){console.log("cancel")}))}},{key:"shareTo",value:function(t){this.$router.push({name:"CustomerPersonShare",params:t})}},{key:"toEditUser",value:function(t,e){this.$router.push({name:"CustomerPersonAdd",params:{type:String(t),customerInfo:this.customerInfo,cupId:e?e.cupId:""}})}},{key:"chooseFilter",value:function(t){4===t?this.fullPopShow=!0:(this.actionShow=!0,this.actionType=t)}},{key:"validator",value:function(t){console.log(t)}},{key:"getCustList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$cancelAxios(["queryPM4CustList"]),this.custList=[],""===e){t.next=8;break}return this.custLoading=!0,t.next=6,ea({custom:e,igonreCustId:this.customerInfo.custId});case 6:a=t.sent,a.success&&(this.custLoading=!1,this.custList=a.data);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRoleList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,sa({custId:e});case 2:a=t.sent,a.success&&(this.roleList=a.data.map((function(t){return{value:t.creId+"-"+t.orgRoleId,name:"".concat(t.orgRoleName,"（").concat(t.creName,"）")}})));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDeptList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={dicUpperSelectId:e,keyword:"",pageNum:1,pageSize:1e4,typeId:3,upperTypeId:2,usestatus:1,typeSecondId:1},t.next=3,Si(a);case 3:s=t.sent,s.success&&(this.deptList=s.data.list.map((function(t){var e=t.DIC_SELECT_ID,a=t.DIC_SELECT_NAME;return{value:e,name:a}})));case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getPostionFun",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={dicUpperSelectId:e,keyword:"",pageNum:1,pageSize:1e4,typeId:4,upperTypeId:3,usestatus:1,typeSecondId:1},t.next=3,Si(a);case 3:s=t.sent,s.success&&(this.positionList=s.data.list.map((function(t){var e=t.DIC_SELECT_ID,a=t.DIC_SELECT_NAME;return{value:e,name:a}})));case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onSelectCustomer",value:function(t){this.customer=t,this.role={},this.dept={},this.position={},this.getRoleList(t.custId),this.fullPopShow=!1}},{key:"onSelectRole",value:function(t){this.role=t,this.dept={},this.position={},this.getDeptList(t.value.split("-")[1])}},{key:"onSelectDept",value:function(t){this.dept=t,this.position={},this.getPostionFun(t.value)}},{key:"onSelectPosition",value:function(t){this.position=t}},{key:"transfer",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ze({custId:this.customer.custId,orgRoleId:this.role.value.split("-")[1],deptId:this.dept.value,positionId:this.position.value,oldCupId:this.currentUser.cupId,userId:this.role.value.split("-")[0]});case 2:e=t.sent,e.success&&(this.$toast.success(e.msg),this.transferShow=!1);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){this.list=[],console.log(this.customerInfo),this.onlyRead=this.customerInfo.onlyRead}}]),a}(d["c"]);Object(u["a"])([h["a"]],Br.prototype,"customerInfo",void 0),Br=Object(u["a"])([Object(d["a"])({components:{fullPop:Ce}})],Br);var Gr=Br,Hr=Gr,Yr=(a("2e64"),Object(V["a"])(Hr,zr,Wr,!1,null,"6d09ff86",null)),Qr=Yr.exports,Kr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"person-add"},[1===+t.type||2===+t.type?a("div",{staticClass:"detail__card"},[a("van-form",{attrs:{"validate-first":""},on:{failed:t.onFailed}},[a("van-field",{attrs:{clearable:"",disabled:!!t.formData.creId&&String(t.formData.creId)!==t.nowUser,required:"",name:"validator",label:"人员姓名",placeholder:"请输入人员姓名",rules:[{validator:t.validator,message:"请输入人员姓名"}]},model:{value:t.formData.userName,callback:function(e){t.$set(t.formData,"userName",e)},expression:"formData.userName"}}),a("van-field",{attrs:{clearable:"",disabled:!!t.formData.creId&&String(t.formData.creId)!==t.nowUser,required:"",name:"validator",label:"手机号",placeholder:"请输入手机号",rules:[{validator:t.validator,message:"请输入手机号"}]},on:{input:t._queryCrmUser},model:{value:t.formData.phoneNum,callback:function(e){t.$set(t.formData,"phoneNum",e)},expression:"formData.phoneNum"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.phoneLoading||t.userList.length,expression:"phoneLoading || userList.length"}],staticClass:"user-list"},[t.phoneLoading?a("van-loading",{attrs:{type:"spinner",color:"#1989fa"}}):t.userList.length?a("div",{staticClass:"user-info",on:{click:function(e){return t.chooseUser(t.userList[0])}}},[a("div",{staticClass:"user-info__name"},[t._v(" "+t._s(t.userList[0].userId+"/"+t.userList[0].userName)+" ")]),a("div",{staticClass:"user-info__code"},[t._v("手机号："+t._s(t.userList[0].phoneNum))]),a("div",{staticClass:"user-info__code"},[t._v("微信号："+t._s(t.userList[0].wxCode))])]):t._e()],1),a("van-field",{attrs:{clearable:"",disabled:!!t.formData.creId&&String(t.formData.creId)!==t.nowUser,required:"",name:"validator",label:"微信号",placeholder:"请输入人员微信号",rules:[{validator:t.validator,message:"请输入人员微信号"}]},model:{value:t.formData.wxCode,callback:function(e){t.$set(t.formData,"wxCode",e)},expression:"formData.wxCode"}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.depart?t.formData.depart.name:"",required:"",label:"部门信息",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择部门信息"}]},on:{click:function(e){return t.chooseFilter(5)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.position?t.formData.position.name:"",required:"",label:"职位信息",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择职位信息"}]},on:{click:function(e){return t.chooseFilter(6)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.statusObj?t.formData.statusObj.name:"",required:"",label:"状态",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择人员状态"}]},on:{click:function(e){return t.chooseFilter(7)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.warmth?t.formData.warmth.name:"",required:"",label:"热力值",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(8)}}}),a("van-field",{attrs:{clearable:"",label:"身份证号",placeholder:"请输入人员身份证号"},model:{value:t.formData.idCard,callback:function(e){t.$set(t.formData,"idCard",e)},expression:"formData.idCard"}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.birthday,label:"生日",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(9)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.politicsBirthday,label:"政治生日",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(10)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.education?t.formData.education.name:"",label:"学历",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(2)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.marital?t.formData.marital.name:"",label:"婚姻状况",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(1)}}}),a("van-field",{attrs:{clearable:"",rows:"2",autosize:"",type:"textarea",label:"家庭情况",placeholder:"请输入人员家庭情况"},model:{value:t.formData.familyStatus,callback:function(e){t.$set(t.formData,"familyStatus",e)},expression:"formData.familyStatus"}}),a("van-field",{attrs:{clearable:"",rows:"2",autosize:"",type:"textarea",label:"地址",placeholder:"请输入地址"},model:{value:t.formData.address,callback:function(e){t.$set(t.formData,"address",e)},expression:"formData.address"}}),a("van-field",{attrs:{clearable:"",rows:"2",autosize:"",type:"textarea",label:"备注",placeholder:"请输入人员备注"},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark",e)},expression:"formData.remark"}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.political?t.formData.political.name:"",label:"政治面貌",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(3)}}}),a("van-field",{attrs:{clearable:"",label:"收入",placeholder:"请输入人员收入"},model:{value:t.formData.salary,callback:function(e){t.$set(t.formData,"salary",e)},expression:"formData.salary"}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.hobbyDetail,label:"爱好",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(4)}}})],1)],1):a("van-cell-group",{staticClass:"detail__card"},[a("van-cell",{attrs:{title:"人员姓名",value:t.formData.userName}}),a("van-cell",{attrs:{title:"手机号",value:t.formData.phoneNum}}),a("van-cell",{attrs:{title:"微信号",value:t.formData.wxCode}}),a("van-cell",{attrs:{title:"部门信息",value:t.formData.depart?t.formData.depart.name:""}}),a("van-cell",{attrs:{title:"职位信息",value:t.formData.position?t.formData.position.name:""}}),a("van-cell",{attrs:{title:"状态",value:t.formData.statusObj?t.formData.statusObj.name:""}}),a("van-cell",{attrs:{title:"热力值",value:t.formData.warmth?t.formData.warmth.name:""}}),a("van-cell",{attrs:{title:"身份证号",value:t.formData.idCard}}),a("van-cell",{attrs:{title:"生日",value:t.formData.birthday}}),a("van-cell",{attrs:{title:"政治生日",value:t.formData.politicsBirthday}}),a("van-cell",{attrs:{title:"学历",value:t.formData.education?t.formData.education.name:""}}),a("van-cell",{attrs:{title:"婚姻状况",value:t.formData.marital?t.formData.marital.name:""}}),a("van-cell",{attrs:{title:"家庭情况",value:t.formData.familyStatus}}),a("van-cell",{attrs:{title:"地址",value:t.formData.address}}),a("van-cell",{attrs:{title:"备注",value:t.formData.remark}}),a("van-cell",{attrs:{title:"政治面貌",value:t.formData.political?t.formData.political.name:""}}),a("van-cell",{attrs:{title:"收入",value:t.formData.salary}}),a("van-cell",{attrs:{title:"爱好",value:t.hobbyDetail}})],1),1===+t.type||2===+t.type?a("div",{staticClass:"footer"},[a("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit",size:"small",loading:t.publishLoading},on:{click:t.submit}},[t._v("提交")])],1):t._e(),1===t.actionType?a("van-action-sheet",{attrs:{actions:t.maritalOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectMarital},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),2===t.actionType?a("van-action-sheet",{attrs:{actions:t.educationOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectEducation},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),3===t.actionType?a("van-action-sheet",{attrs:{actions:t.politicalOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectPolitical},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),4===t.actionType?a("van-popup",{staticClass:"transfer",attrs:{"close-on-click-overlay":!1,round:""},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}},[a("div",{staticClass:"transfer-div"},[a("van-checkbox-group",{model:{value:t.hobbyResult,callback:function(e){t.hobbyResult=e},expression:"hobbyResult"}},t._l(t.hobbyOptions,(function(e,s){return a("van-cell",{key:e.value,attrs:{clickable:"",title:""+e.name},on:{click:function(e){return t.toggle(s)}},scopedSlots:t._u([{key:"right-icon",fn:function(){return[a("van-checkbox",{ref:"checkboxes",refInFor:!0,attrs:{name:e}})]},proxy:!0}],null,!0)})})),1),a("div",{staticClass:"transfer-opts"},[a("div",{staticClass:"transfer-btn",on:{click:function(e){t.actionShow=!1}}},[t._v("取消")]),a("div",{staticClass:"transfer-btn transfer-btn--blue",on:{click:t.onSelectHobby}},[t._v("确定")])])],1)]):t._e(),5===t.actionType?a("van-action-sheet",{attrs:{actions:t.departOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectDepart},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),6===t.actionType?a("van-action-sheet",{attrs:{actions:t.positionOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectPosition},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),7===t.actionType?a("van-action-sheet",{attrs:{actions:t.statusOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectStatus},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),8===t.actionType?a("van-action-sheet",{attrs:{actions:t.warmthNumOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectWarmth},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),9===t.actionType?a("van-popup",{staticClass:"transfer",attrs:{"close-on-click-overlay":!1,round:""},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}},[a("div",{staticClass:"transfer-div"},[a("van-datetime-picker",{attrs:{"show-toolbar":!1,type:"date",title:"选择年月日"},model:{value:t.birthday,callback:function(e){t.birthday=e},expression:"birthday"}}),a("div",{staticClass:"transfer-opts"},[a("div",{staticClass:"transfer-btn",on:{click:function(e){t.actionShow=!1}}},[t._v("取消")]),a("div",{staticClass:"transfer-btn transfer-btn--blue",on:{click:t.onSelectBirthday}},[t._v("确定")])])],1)]):t._e(),10===t.actionType?a("van-popup",{staticClass:"transfer",attrs:{"close-on-click-overlay":!1,round:""},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}},[a("div",{staticClass:"transfer-div"},[a("van-datetime-picker",{attrs:{"show-toolbar":!1,type:"date",title:"选择年月日"},model:{value:t.politicsBirthday,callback:function(e){t.politicsBirthday=e},expression:"politicsBirthday"}}),a("div",{staticClass:"transfer-opts"},[a("div",{staticClass:"transfer-btn",on:{click:function(e){t.actionShow=!1}}},[t._v("取消")]),a("div",{staticClass:"transfer-btn transfer-btn--blue",on:{click:t.onSelectPoliticsBirthday}},[t._v("确定")])])],1)]):t._e()],1)},Jr=[],Xr=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.type=t.$route.params.type,t.customerInfo=t.$route.params.customerInfo,t.cupId=t.$route.params.cupId,t.nowUser="",t.userList=[],t.phoneLoading=!1,t.publishLoading=!1,t.birthday=new Date,t.politicsBirthday=new Date,t.actionShow=!1,t.actionType=0,t.maritalOptions=[{value:0,name:"未婚"},{value:1,name:"已婚"}],t.educationOptions=[{value:1,name:"本科"},{value:2,name:"专科"},{value:3,name:"中专"},{value:4,name:"博士"},{value:5,name:"硕士"},{value:6,name:"高中及以下"}],t.politicalOptions=[{value:0,name:"群众"},{value:1,name:"党员"},{value:2,name:"团员"},{value:3,name:"少数党"}],t.statusOptions=[{value:0,name:"正式"},{value:2,name:"退休/离职"}],t.statusFullOptions=[{value:0,name:"正式"},{value:2,name:"退休/离职"},{value:3,name:"转职"},{value:4,name:"由转职来"}],t.warmthNumOptions=[{value:1,name:"一般客情"},{value:2,name:"需要进阶的客情"},{value:3,name:"从未接触的客情"}],t.hobbyOptions=[],t.hobbyResult=[],t.departOptions=[],t.positionOptions=[],t.formData={cueId:"",marital:{},education:{},political:{},statusObj:{},position:{},depart:{},warmth:{},userName:"",birthday:"",politicsBirthday:"",phoneNum:"",wxCode:"",idCard:"",familyStatus:"",address:"",remark:"",salary:""},t.timeout=null,t}return Object(o["a"])(a,[{key:"getHobbyFun",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={keyword:"",pageNum:1,pageSize:1e4,usestatus:1,typeId:11},t.next=3,Si(e);case 3:a=t.sent,a.success&&(this.hobbyOptions=a.data.list.map((function(t){var e=t.DIC_SELECT_ID,a=t.DIC_SELECT_NAME;return{value:e,name:a}})));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"_queryDept",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={dicUpperSelectId:this.customerInfo.orgRoleId,keyword:"",pageNum:1,pageSize:1e4,typeId:3,upperTypeId:2,usestatus:1,typeSecondId:1},t.next=3,Si(e);case 3:a=t.sent,a.success&&(this.departOptions=a.data.list.map((function(t){var e=t.DIC_SELECT_ID,a=t.DIC_SELECT_NAME;return{value:e,name:a}})),this.formData.depart=this.formData.departmentId?{value:this.formData.departmentId,name:this.departOptions.find((function(t){return t.value===+s.formData.departmentId})).name}:{});case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getPostionFun",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={dicUpperSelectId:e,keyword:"",pageNum:1,pageSize:1e4,typeId:4,upperTypeId:3,usestatus:1,typeSecondId:1},t.next=3,Si(a);case 3:s=t.sent,s.success&&(this.positionOptions=s.data.list.map((function(t){var e=t.DIC_SELECT_ID,a=t.DIC_SELECT_NAME;return{value:e,name:a}})),this.formData.positionId&&(this.formData.position={value:this.formData.positionId,name:this.positionOptions.find((function(t){return t.value===+i.formData.positionId})).name},this.$forceUpdate()));case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"_queryCrmUser",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=e.replace(/[^0-9-]+/,""),this.formData.phoneNum=e,this.$cancelAxios(["queryCrmUser"]),clearTimeout(this.timeout),this.timeout=setTimeout(Object(_["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a.phoneLoading=!0,t.next=3,Di({phoneNum:e});case 3:s=t.sent,a.phoneLoading=!1,a.userList=s.data;case 6:case"end":return t.stop()}}),t)}))),800);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"chooseUser",value:function(t){var e=this;this.phoneLoading=!1,this.userList=[],this.formData.wxCode=t.wxCode,this.formData.userName=t.userName,this.formData.userId=t.userId,this.formData.creId=t.creId,t.userExpandDOS.length>0&&(this.formData.cueId=t.userExpandDOS[0].cueId,this.formData.idCard=t.userExpandDOS[0].idCard,this.formData.familyStatus=t.userExpandDOS[0].familyStatus,this.formData.salary=t.userExpandDOS[0].salary,this.formData.address=t.userExpandDOS[0].address,this.formData.marital=null!==t.userExpandDOS[0].maritalStatus?{value:t.userExpandDOS[0].maritalStatus,name:this.maritalOptions.find((function(t){return t.value===+t.userExpandDOS[0].maritalStatus})).name}:{},this.formData.education=t.userExpandDOS[0].education?{value:t.userExpandDOS[0].education,name:this.educationOptions.find((function(t){return t.value===+t.userExpandDOS[0].education})).name}:{},this.formData.warmth=t.userExpandDOS[0].warmthNum?{value:t.userExpandDOS[0].warmthNum,name:this.warmthNumOptions.find((function(t){return t.value===+t.userExpandDOS[0].warmthNum})).name}:{},this.hobbyResult=t.userExpandDOS[0].hobby?t.userExpandDOS[0].hobby.split(",").map((function(t){return e.hobbyOptions.find((function(e){return e.value===+t}))})):[])}},{key:"chooseFilter",value:function(t){this.actionShow=!0,this.actionType=t}},{key:"onSelectMarital",value:function(t){this.actionShow=!1,this.formData.marital=t}},{key:"onSelectEducation",value:function(t){this.actionShow=!1,this.formData.education=t}},{key:"onSelectPolitical",value:function(t){this.actionShow=!1,this.formData.political=t}},{key:"toggle",value:function(t){var e=this.$refs.checkboxes;e[t].toggle()}},{key:"onSelectHobby",value:function(){this.actionShow=!1}},{key:"onSelectDepart",value:function(t){this.actionShow=!1,this.formData.depart=t,this.formData.position={},this.positionOptions=[],this.getPostionFun(t.value)}},{key:"onSelectPosition",value:function(t){this.actionShow=!1,this.formData.position=t}},{key:"onSelectStatus",value:function(t){this.actionShow=!1,this.formData.statusObj=t}},{key:"onSelectWarmth",value:function(t){this.actionShow=!1,this.formData.warmth=t}},{key:"onSelectBirthday",value:function(){this.actionShow=!1,this.formData.birthday=Gs(this.birthday)}},{key:"onSelectPoliticsBirthday",value:function(){this.actionShow=!1,this.formData.politicsBirthday=Gs(this.politicsBirthday)}},{key:"validator",value:function(t){return console.log(t),/\S/.test(t)}},{key:"onFailed",value:function(t){console.log("failed",t)}},{key:"submit",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=Object(b["a"])({},this.formData),e.userName){t.next=4;break}return this.$toast("人员姓名不能为空"),t.abrupt("return");case 4:if(e.phoneNum){t.next=7;break}return this.$toast("手机号不能为空"),t.abrupt("return");case 7:if(e.wxCode){t.next=10;break}return this.$toast("微信号不能为空"),t.abrupt("return");case 10:if(e.depart.name){t.next=13;break}return this.$toast("部门不能为空"),t.abrupt("return");case 13:if(e.position.name){t.next=16;break}return this.$toast("职位不能为空"),t.abrupt("return");case 16:if(e.statusObj.name){t.next=19;break}return this.$toast("状态不能为空"),t.abrupt("return");case 19:if(e.warmth.name){t.next=22;break}return this.$toast("热力值不能为空"),t.abrupt("return");case 22:if(e.custId=this.customerInfo.custId,e.maritalStatus=e.marital.value,e.education=e.education.value,e.politicalStatus=e.political.value,e.departmentId=e.depart.value,e.positionId=e.position.value,e.status=e.statusObj.value,e.warmthNum=e.warmth.value,delete e.marital,delete e.political,delete e.depart,delete e.position,delete e.statusObj,delete e.warmth,e.orgnizationRoleId=this.customerInfo.orgRoleId,e.hobby=this.hobbyResult.length?this.hobbyResult.map((function(t){return t.value})).join(","):"",e.phoneNum=e.phoneNum.replace(/\s+/g,""),2!==+this.type){t.next=46;break}return t.next=42,Qe(e);case 42:a=t.sent,a.success&&(this.$toast.success(a.msg||"修改成功"),setTimeout((function(){i.$router.back()}),2e3)),t.next=51;break;case 46:if(1!==+this.type){t.next=51;break}return t.next=49,He(e);case 49:s=t.sent,s.success&&(this.$toast.success(s.msg||"新增成功"),setTimeout((function(){i.$router.back()}),2e3));case 51:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getDetail",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Be({cupId:this.cupId});case 2:e=t.sent,e.success&&(this.formData=e.data,this.formData.creId=e.data.userCreId,this.formData.marital=null!==this.formData.maritalStatus?{value:this.formData.maritalStatus,name:this.maritalOptions.find((function(t){return t.value===+a.formData.maritalStatus})).name}:{},this.formData.education=this.formData.education?{value:this.formData.education,name:this.educationOptions.find((function(t){return t.value===+a.formData.education})).name}:{},this.formData.political=this.formData.politicalStatus?{value:this.formData.politicalStatus,name:this.politicalOptions.find((function(t){return t.value===+a.formData.politicalStatus})).name}:{},this.hobbyResult=this.formData.hobby?this.formData.hobby.split(",").map((function(t){return a.hobbyOptions.find((function(e){return e.value===+t}))})):[],4===+this.formData.status?this.statusOptions=[{value:0,name:"正式"},{value:2,name:"退休/离职"},{value:4,name:"由转职来"}]:this.statusOptions=[{value:0,name:"正式"},{value:2,name:"退休/离职"}],this.formData.statusObj={value:this.formData.status,name:this.statusFullOptions.find((function(t){return t.value===+a.formData.status})).name},this.formData.departmentId&&(this._queryDept(),this.getPostionFun(this.formData.departmentId)),this.formData.warmth=this.formData.warmthNum?{value:this.formData.warmthNum,name:this.warmthNumOptions.find((function(t){return t.value===+a.formData.warmthNum})).name}:{},console.log(this.formData),console.log(this.hobbyResult),this.birthday=this.formData.birthday?new Date(this.formData.birthday):new Date,this.politicsBirthday=this.formData.politicsBirthday?new Date(this.formData.politicsBirthday):new Date);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.nowUser=localStorage.getItem("userId"),t.next=3,this.getHobbyFun();case 3:1!==+this.type?this.getDetail():this._queryDept();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"hobbyDetail",get:function(){return this.hobbyResult.length?this.hobbyResult.map((function(t){return t.name})).join(","):""}}]),a}(d["c"]);Xr=Object(u["a"])([Object(d["a"])({})],Xr);var Zr=Xr,to=Zr,eo=(a("4f2e"),Object(V["a"])(to,Kr,Jr,!1,null,"45462a00",null)),ao=eo.exports,so=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customer-person"},[a("div",{staticClass:"share-header"},[a("div",{staticClass:"share-header__title"},[t._v("分享至")]),a("div",{staticClass:"share0header__add",on:{click:t.toAdd}},[a("van-icon",{attrs:{name:"add",size:"2.2em",color:"#1989fa"}})],1)]),a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return a("div",{key:e.cueId,staticClass:"share-item van-clearfix",on:{click:function(a){return t.toEdit(e)}}},[a("van-swipe-cell",{scopedSlots:t._u([{key:"right",fn:function(){return[a("van-button",{staticClass:"del-btn",attrs:{square:"",type:"danger",text:"删除"},on:{click:function(a){return a.stopPropagation(),t.deleteDonor(e.cesId)}}})]},proxy:!0}],null,!0)},[a("div",{staticClass:"share-list"},[a("div",{staticClass:"share-item__line"},[a("div",{staticClass:"share-item__title"},[t._v("人员")]),a("div",{staticClass:"share-item__content"},[t._v(t._s(e.shareToUserId)+"/"+t._s(e.shareToUserName))])]),a("div",{staticClass:"share-item__line"},[a("div",{staticClass:"share-item__title"},[t._v("是否更新")]),a("div",{staticClass:"share-item__content"},[t._v(t._s(1===e.isUpdate?"是":0===e.isUpdate?"否":""))])]),a("div",{staticClass:"share-item__line"},[a("div",{staticClass:"share-item__title"},[t._v("过期时间")]),a("div",{staticClass:"share-item__content"},[t._v(t._s(e.validDate))])])])])],1)})),0)],1),1===t.actionType?a("van-action-sheet",{attrs:{actions:t.shareCustList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectUser},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),2===t.actionType?a("van-action-sheet",{attrs:{actions:t.selectOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectUpdate},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),3===t.actionType?a("van-calendar",{attrs:{color:"#1989fa","show-confirm":!1},on:{confirm:t.onDateConfirm},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),a("van-popup",{staticClass:"transfer",attrs:{"close-on-click-overlay":!1,round:""},model:{value:t.shareShow,callback:function(e){t.shareShow=e},expression:"shareShow"}},[a("van-form",{staticClass:"transfer-div",attrs:{"validate-first":""},on:{failed:t.onFailed}},[a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.user.name,required:"","label-width":"4em",label:"人员",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择人员"}]},on:{click:function(e){return t.chooseFilter(1)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.isUpdate.name,required:"","label-width":"4em",label:"是否更新",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择是否更新"}]},on:{click:function(e){return t.chooseFilter(2)}}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.date,"label-width":"4em",label:"过期时间",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(3)}}}),a("div",{staticClass:"transfer-opts"},[a("div",{staticClass:"transfer-btn",on:{click:function(e){t.shareShow=!1}}},[t._v("取消")]),a("div",{staticClass:"transfer-btn transfer-btn--blue",on:{click:t.share}},[t._v("确定")])])],1)],1)],1)},io=[],no=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.personDetail=t.$route.params,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.shareShow=!1,t.shareCustList=[],t.selectOptions=[{value:0,name:"否"},{value:1,name:"是"}],t.actionShow=!1,t.actionType=0,t.formData={user:{},isUpdate:{},date:""},t}return Object(o["a"])(a,[{key:"validator",value:function(t){return/\S/.test(t)}},{key:"onFailed",value:function(t){console.log("failed",t)}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,na({cueId:this.personDetail.cueId});case 2:e=t.sent,this.loading=!1,this.refreshing=!1,e.success?(this.list=e.data,this.finished=!0):this.error=!0;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getRoleList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.shareCustList=[],t.next=3,oa({custId:this.customerInfo.custId,igonreUserId:this.personDetail.operationId,exbandId:this.personDetail.cueId,orgRoleId:this.personDetail.orgnizationRoleId,userId:this.personDetail.userId});case 3:e=t.sent,this.shareCustList=e.data.map((function(t){var e=t.userId,a=t.userName,s=t.isAlreadyShare;return{value:e,name:e+"/"+a,disabled:s}})),this.loading=!0;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"refreshData",value:function(){this.list=[],this.finished=!1,this.loading=!0,this.getDataList()}},{key:"deleteDonor",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$dialog.confirm({title:"提示",message:"确定移除？"}).then(Object(_["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pa({cesId:e});case 2:s=t.sent,s.success?(a.$toast.success(s.msg||"移除成功"),a.refreshData()):a.$toast.fail(s.msg||"移除失败");case 4:case"end":return t.stop()}}),t)})))).catch((function(){console.log("cancel")}));case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"chooseFilter",value:function(t){this.actionShow=!0,this.actionType=t}},{key:"onSelectUser",value:function(t){this.actionShow=!1,this.formData.user=t}},{key:"onSelectUpdate",value:function(t){this.actionShow=!1,this.formData.isUpdate=t}},{key:"onDateConfirm",value:function(t){console.log(t),this.actionShow=!1,this.formData.date=Gs(t)}},{key:"toAdd",value:function(){this.shareShow=!0,this.formData={cesId:"",user:{},isUpdate:{},date:""}}},{key:"toEdit",value:function(t){console.log(t),this.shareShow=!0,this.formData={cesId:t.cesId,user:{value:t.shareToUserId,name:t.shareToUserName},isUpdate:{value:t.isUpdate,name:1===+t.isUpdate?"是":0===+t.isUpdate?"否":""},date:t.validDate}}},{key:"share",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.formData.user.name){t.next=3;break}return this.$toast("请选择人员"),t.abrupt("return");case 3:if(this.formData.isUpdate.name){t.next=6;break}return this.$toast("请选择是否更新"),t.abrupt("return");case 6:if(console.log(this.formData),!this.formData.cesId){t.next=13;break}return t.next=10,da({isModify:0,isUpdate:this.formData.isUpdate.value,validDate:this.formData.date,cesId:this.formData.cesId});case 10:t.t0=t.sent,t.next=16;break;case 13:return t.next=15,la({cueId:this.personDetail.cueId,shareToUserId:this.formData.user.value,shareToUserName:this.formData.user.name.split("/")[1],isModify:0,isUpdate:this.formData.isUpdate.value,validDate:this.formData.date});case 15:t.t0=t.sent;case 16:e=t.t0,e.success&&(this.$toast.success(e.msg),this.shareShow=!1,this.refreshData(),this.getRoleList());case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.list=[],console.log(this.customerInfo),console.log("----",this.personDetail),this.getRoleList()}}]),a}(d["c"]);Object(u["a"])([h["a"]],no.prototype,"customerInfo",void 0),no=Object(u["a"])([Object(d["a"])({})],no);var ro=no,oo=ro,co=(a("0ea9"),Object(V["a"])(oo,so,io,!1,null,"3f195727",null)),lo=co.exports,uo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"person-add"},[2===+t.type?a("div",{staticClass:"detail__card"},[a("van-form",{attrs:{"validate-first":""},on:{failed:t.onFailed}},[a("van-field",{attrs:{value:t.formData.custId?t.formData.custId+"/"+t.formData.custName:"",disabled:"",label:"客户信息"}}),a("van-field",{attrs:{value:t.formData.hospitalLevel,disabled:"",label:"医院等级"}}),a("van-field",{attrs:{value:t.formData.personNum,disabled:"",label:"已维护人数"}}),a("van-field",{attrs:{value:t.formData.warmthPersonNum,disabled:"",label:"一般客情热力值"}}),a("van-field",{attrs:{value:t.formData.cceId&&t.formData.creName?t.formData.creName:"",disabled:"",label:"维护人"}}),t.orgRoleEdit?a("van-field",{attrs:{readonly:"",clickable:"",required:"",value:t.formData.orgRole?t.formData.orgRole.name:"",label:"科室角色维护",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择科室角色"}]},on:{click:function(e){return t.chooseFilter(1)}}}):a("van-field",{attrs:{readonly:"",value:t.formData.orgRole?t.formData.orgRole.name:"",disabled:!t.orgRoleEdit,label:"科室角色维护"}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.yearSalesVolume?t.formData.yearSalesVolume.name:"",label:"年药品总采购额",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(2)}}}),a("van-field",{attrs:{clearable:"",type:"number",label:"英特占比",placeholder:"请输入英特占比(数字)"},model:{value:t.formData.intPercent,callback:function(e){t.$set(t.formData,"intPercent",e)},expression:"formData.intPercent"}}),a("van-field",{attrs:{readonly:"",clickable:"",required:"",value:t.formData.scienceLine?t.formData.scienceLine.name:"",label:"学术专线",placeholder:"点击选择",rules:[{validator:t.validator,message:"请选择学术专线"}]},on:{click:function(e){return t.chooseFilter(3)}}}),a("van-field",{attrs:{clearable:"",label:"股东成分",placeholder:"请输入股东成分"},model:{value:t.formData.shareholderCompose,callback:function(e){t.$set(t.formData,"shareholderCompose",e)},expression:"formData.shareholderCompose"}}),a("van-field",{attrs:{readonly:"",clickable:"",value:t.formData.isProfit?t.formData.isProfit.name:"",label:"经营性质",placeholder:"点击选择"},on:{click:function(e){return t.chooseFilter(4)}}}),a("van-field",{attrs:{clearable:"",label:"营利性质",placeholder:"请输入营利性质"},model:{value:t.formData.profitProperty,callback:function(e){t.$set(t.formData,"profitProperty",e)},expression:"formData.profitProperty"}})],1)],1):a("van-cell-group",{staticClass:"detail__card"},[a("van-cell",{attrs:{title:"客户信息",value:t.formData.custId?t.formData.custId+"/"+t.formData.custName:""}}),a("van-cell",{attrs:{title:"医院等级",value:t.formData.hospitalLevel}}),t.formData.isShare?t._e():a("van-cell",{attrs:{title:"已维护人数",value:t.formData.personNum}}),t.formData.isShare?t._e():a("van-cell",{attrs:{title:"一般客情热力值",value:t.formData.warmthPersonNum}}),a("van-cell",{attrs:{title:"维护人",value:t.formData.cceId&&t.formData.creName?t.formData.creName:""}}),a("van-cell",{attrs:{title:"科室角色维护",value:t.formData.orgRole?t.formData.orgRole.name:""}}),a("van-cell",{attrs:{title:"年药品总采购额",value:t.formData.yearSalesVolume?t.formData.yearSalesVolume.name:""}}),a("van-cell",{attrs:{title:"英特占比",value:t.formData.intPercent}}),a("van-cell",{attrs:{title:"学术专线",value:t.formData.scienceLine?t.formData.scienceLine.name:""}}),a("van-cell",{attrs:{title:"股东成分",value:t.formData.shareholderCompose}}),a("van-cell",{attrs:{title:"经营性质",value:t.formData.isProfit?1===t.formData.isProfit.value?"政府办":2===t.formData.isProfit.value?"非政府办营利":3===t.formData.isProfit.value?"非政府办非营利":"":""}}),a("van-cell",{attrs:{title:"营利性质",value:t.formData.profitProperty}})],1),2===+t.type?a("div",{staticClass:"footer"},[a("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit",size:"small",loading:t.publishLoading},on:{click:t.submit}},[t._v("保存")])],1):t._e(),1===t.actionType?a("van-action-sheet",{attrs:{actions:t.roleTypeList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectRoleType},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),2===t.actionType?a("van-action-sheet",{attrs:{actions:t.saleTypeList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectSaleType},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),3===t.actionType?a("van-action-sheet",{attrs:{actions:t.learnTypeList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectLearnType},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e(),4===t.actionType?a("van-action-sheet",{attrs:{actions:t.isProfitList,"cancel-text":"取消","close-on-click-action":""},on:{select:t.onSelectProfit},model:{value:t.actionShow,callback:function(e){t.actionShow=e},expression:"actionShow"}}):t._e()],1)},ho=[],po=Object(h["b"])("commonStore"),mo=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.type=t.$route.params.type,t.customerInfo=t.$route.params.item,t.activeId=-1,t.activeIndex=0,t.labelTreeList=[],t.loading=!1,t.publishLoading=!1,t.actionShow=!1,t.actionType=0,t.hosTypeList=[],t.saleTypeList=[],t.learnTypeList=[],t.isProfitList=[],t.roleTypeList=[],t.orgRoleEdit=!0,t.formData={orgRole:{},yearSalesVolume:{},intPercent:"",scienceLine:{},shareholderCompose:"",isProfit:{},profitProperty:""},t}return Object(o["a"])(a,[{key:"getSearchList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,n,r,o=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.hosTypeList=[],this.saleTypeList=[],this.learnTypeList=[],this.isProfitList=[{value:1,name:"政府办"},{value:2,name:"非政府办营利"},{value:3,name:"非政府办非营利"}],this.roleTypeList=[],t.next=7,Promise.all([this.getTypeList(12),this.getTypeList(13),this.getTypeList(1),this.getTypeList(2,1)]);case 7:e=t.sent,a=Object(gn["a"])(e,4),s=a[0],i=a[1],n=a[2],r=a[3],this.hosTypeList=s,this.saleTypeList=i,this.learnTypeList=n,this.roleTypeList=r,this.formData=Object(b["a"])({},this.customerInfo),this.formData.orgRole=this.formData.orgRoleId?{value:this.formData.orgRoleId,name:this.roleTypeList.find((function(t){return t.value===+o.formData.orgRoleId})).name}:{},this.formData.yearSalesVolume=this.formData.yearSalesVolume?{value:this.formData.yearSalesVolume,name:this.saleTypeList.find((function(t){return t.value===+o.formData.yearSalesVolume})).name}:{},this.formData.scienceLine=this.formData.scienceLine?{value:this.formData.scienceLine,name:this.learnTypeList.find((function(t){return t.value===+o.formData.scienceLine})).name}:{},this.formData.isProfit={value:this.formData.isProfit,name:1===this.formData.isProfit?"政府办":2===this.formData.isProfit?"非政府办营利":3===this.formData.isProfit?"非政府办非营利":""};case 22:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getTypeList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){var s,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={},s=a?{pageNum:1,pageSize:1e5,typeId:e,usestatus:1,typeSecondId:a}:{pageNum:1,pageSize:1e5,usestatus:1,typeId:e},t.next=4,Si(s);case 4:return i=t.sent,n=i.data.list.map((function(t){var e=t.DIC_SELECT_ID,a=t.DIC_SELECT_NAME;return{value:e,name:a}})),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"chooseFilter",value:function(t){this.actionShow=!0,this.actionType=t}},{key:"onSelectRoleType",value:function(t){this.actionShow=!1,this.formData.orgRole=t}},{key:"onSelectSaleType",value:function(t){this.actionShow=!1,this.formData.yearSalesVolume=t}},{key:"onSelectLearnType",value:function(t){this.actionShow=!1,this.formData.scienceLine=t}},{key:"onSelectProfit",value:function(t){this.actionShow=!1,this.formData.isProfit=t}},{key:"validator",value:function(t){console.log(t)}},{key:"onFailed",value:function(t){console.log("failed",t)}},{key:"submit",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,n,r,o,c,l,u,d,h,p=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.formData,a=e.cceId,s=e.custId,i=e.custName,n=e.intPercent,r=e.profitProperty,o=e.shareholderCompose,c=e.orgRole,l=e.scienceLine,u=e.yearSalesVolume,d=e.isProfit,c.value){t.next=4;break}return this.$toast("请选择科室角色"),t.abrupt("return");case 4:if(l.value){t.next=7;break}return this.$toast("请选择学术专线"),t.abrupt("return");case 7:return this.publishLoading=!0,t.next=10,Oe({cceId:a,customId:s,customName:i,intPercent:n,isProfit:d.value||"",orgRoleId:c.value,profitProperty:r,scienceLine:l.value,shareholderCompose:o,yearSalesVolume:u.value||""});case 10:h=t.sent,h.success&&(this.SET_HADDONEONDETAIL(!0),this.$toast.success(h.msg||"保存成功"),setTimeout((function(){p.publishLoading=!1,p.$router.back()}),2e3));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"isAllow",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ue({custId:e});case 2:a=t.sent,a.success?this.orgRoleEdit=!0:this.orgRoleEdit=!1;case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.getSearchList(),2===+this.type&&this.customerInfo.cceId&&this.isAllow(this.customerInfo.custId)}}]),a}(d["c"]);Object(u["a"])([po.Mutation],mo.prototype,"SET_HADDONEONDETAIL",void 0),mo=Object(u["a"])([Object(d["a"])({})],mo);var vo=mo,fo=vo,go=(a("31f6"),Object(V["a"])(fo,uo,ho,!1,null,"44cb7127",null)),bo=go.exports,yo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customer-unit"},[a("van-sticky",[a("div",{staticClass:"header"},[a("van-dropdown-menu",{staticClass:"header-dropdown",attrs:{"active-color":"#1989fa","close-on-click-outside":!1}},[a("van-dropdown-item",{ref:"filter",attrs:{title:"筛选"}},[a("van-tree-select",{attrs:{"active-color":"#363636",items:t.labelTreeList,"active-id":t.activeId,"main-active-index":t.activeIndex},on:{"update:activeId":function(e){t.activeId=e},"update:active-id":function(e){t.activeId=e},"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e}}}),a("div",{staticClass:"dropdown-opts"},[a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:t.reset}},[t._v("重置")]),a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",plain:"",block:"",round:""},on:{click:t.onConfirm}},[t._v("确认")])],1)],1)],1)],1)]),a("van-pull-refresh",{staticClass:"msg-list",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"immediate-check":!1,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,s){return a("div",{key:s,staticClass:"customer-item van-clearfix"},[a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__cust"},[t._v(t._s(e.labelName))]),a("div",{staticClass:"customer-item__time"},[t._v(t._s(e.visitTime?e.visitTime.slice(0,e.visitTime.length-3):""))])]),a("div",{staticClass:"line"}),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("医院")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.companyName))])]),e.expectTimeStr?a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("预期时间")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.expectTimeStr))])]):t._e(),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("业务员")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.userName))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("备注")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.remark))])])])})),0)],1),a("div",{staticClass:"fab-circle",on:{click:t.toUnionList}},[a("van-icon",{attrs:{name:"exchange"}})],1)],1)},_o=[];d["a"].registerHooks(["beforeRouteLeave"]);var ko=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.flag=!0,t.custId=t.$route.params.custId,t.curMan=t.$route.params.curMan,t.isCabin=t.$route.params.isCabin,t.activeId=-1,t.activeIndex=0,t.labelTreeList=[],t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t}return Object(o["a"])(a,[{key:"_getLabelTree",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={type:"1"},t.next=3,Ct(e);case 3:a=t.sent,this.labelTreeList=a.data.map((function(t,e){var a=[];return t.CHILD_LIST.length&&(a=t.CHILD_LIST.map((function(t){return{id:t.LABEL_ID,text:t.LABEL_NAME}}))),{id:t.LABEL_ID,text:t.LABEL_NAME,children:[{id:-e-2,text:"全部"}].concat(Object(y["a"])(a))}})),this.labelTreeList.unshift({id:-1,text:"全部"});case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"reset",value:function(){this.activeId=-1,this.activeIndex=0}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={},e=this.curMan?{custId:this.custId,pageNum:this.page,pageSize:this.pageSize,flag:0,type:this.typeResult,userId:this.curMan.salerId,visitUserId:this.curMan.userId}:{custId:this.custId,pageNum:this.page,pageSize:this.pageSize,flag:0,type:this.typeResult},"true"!==this.isCabin){t.next=8;break}return t.next=5,xs(e);case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,ka(e);case 10:t.t0=t.sent;case 11:a=t.t0,this.loading=!1,this.refreshing=!1,a.success?(this.list=[].concat(Object(y["a"])(this.list),Object(y["a"])(a.data.list)),this.page++,this.finished=!a.data.hasNextPage):this.error=!0;case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onConfirm",value:function(){var t=this.$refs.filter;t.toggle(),this.onRefresh()}},{key:"toUnionList",value:function(){var t={};t=this.curMan?{custId:this.custId,type:this.typeResult,userId:this.curMan.salerId,visitUserId:this.curMan.userId,isCabin:String(this.isCabin)}:{custId:this.custId,type:this.typeResult,isCabin:String(this.isCabin)},this.$router.push({name:"CustomerAnalysisUnionList",params:t})}},{key:"activated",value:function(){this.custId=this.$route.params.custId,this.curMan=this.$route.params.curMan,this.isCabin=this.$route.params.isCabin,this.flag&&(this._getLabelTree(),this.onRefresh())}},{key:"beforeRouteLeave",value:function(t,e,a){"CustomerAnalysisUnionList"===t.name?this.flag=!1:this.flag=!0,a()}},{key:"typeResult",get:function(){if(0===this.activeIndex)return null;if(-1===this.activeId){var t=this.labelTreeList[this.activeIndex].children.map((function(t){return+t.id}));return t.shift(),t}return[+this.activeId]}}]),a}(d["c"]);ko=Object(u["a"])([Object(d["a"])({})],ko);var Co=ko,wo=Co,Lo=(a("ea62"),Object(V["a"])(wo,yo,_o,!1,null,"5886f648",null)),xo=Lo.exports,Io=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customerAnalysis"},[a("div",{},[a("van-cell-group",{staticClass:"detail__card"},[a("van-cell",{attrs:{title:"人员信息",value:t.curMan.userName}}),a("van-cell",{attrs:{title:"职务",value:t.curMan.position}}),a("van-cell",{attrs:{title:"生日",value:t.curMan.birthday}}),a("van-cell",{attrs:{title:"是否党员",value:1===t.curMan.politicalStatus?"是":"否"}}),a("van-cell",{attrs:{title:"是否关键",value:"--"}}),a("van-cell",{attrs:{title:"热力值",value:t.warmthNumOptions[t.curMan.warmthNum]}}),a("van-cell",{attrs:{title:"活跃度",value:"--"}}),a("van-cell",{attrs:{title:"资料贡献",value:t.curMan.saleName}}),a("van-cell",{attrs:{title:"电话",value:t.curMan.phoneNum}}),a("van-cell",{attrs:{title:"兴趣",value:t.curMan.hobby}})],1),a("div",{staticClass:"task-item",on:{click:t.toList}},[a("div",{staticClass:"task-item__top"},[a("div",{staticClass:"task-item__title"},[t._v("近100天")]),a("div",{staticClass:"task-item__desc"},[t._v(" 全部 "),a("van-icon",{attrs:{name:"arrow",size:"18px"}})],1)]),a("div",{staticClass:"task-block"},[a("div",{staticClass:"task-block__item"},[a("div",{staticClass:"task-block__item__desc"},[t._v("累计客勤事件/次")]),a("div",{staticClass:"task-block__item__value"},[t._v(t._s(t.eventCount.custEventCount))])]),a("div",{staticClass:"task-block__item"},[a("div",{staticClass:"task-block__item__desc"},[t._v("累计外勤拜访/次")]),a("div",{staticClass:"task-block__item__value"},[t._v(t._s(t.eventCount.legWorkCount))])]),a("div",{staticClass:"task-block__item"},[a("div",{staticClass:"task-block__item__desc"},[t._v("累计客户随访/次")]),a("div",{staticClass:"task-block__item__value"},[t._v(t._s(t.eventCount.followCount))])]),a("div",{staticClass:"task-block__item"},[a("div",{staticClass:"task-block__item__desc"},[t._v("累计客户协防/次")]),a("div",{staticClass:"task-block__item__value"},[t._v(t._s(t.eventCount.assistCount))])])])])],1)])},So=[];d["a"].registerHooks(["beforeRouteLeave"]);var Do=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.flag=!0,t.curMan=t.$route.params.item,t.custId=t.$route.params.custId,t.isCabin=t.$route.params.isCabin,t.eventCount={},t.personLoading=!1,t.personList=[],t.warmthNumOptions=["","一般客情","需要进阶的客情","从未接触的客情"],t}return Object(o["a"])(a,[{key:"getPersonInfo",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xa({custId:this.custId,cueId:this.curMan.cueId});case 2:e=t.sent,this.curMan=Object.assign(this.curMan,e.data);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getEventCount",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={custId:this.custId,userId:this.curMan.salerId,personId:this.curMan.userId},"true"!==this.isCabin){t.next=7;break}return t.next=4,ks(e);case 4:t.t0=t.sent,t.next=10;break;case 7:return t.next=9,ga(e);case 9:t.t0=t.sent;case 10:a=t.t0,this.eventCount=a.data;case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"toList",value:function(){this.$router.push({name:"CustomerAnalysisList",params:{curMan:this.curMan,custId:this.custId}})}},{key:"activated",value:function(){this.flag&&(this.getPersonInfo(),this.getEventCount())}},{key:"beforeRouteLeave",value:function(t,e,a){"CustomerAnalysisList"===t.name?this.flag=!1:this.flag=!0,a()}}]),a}(d["c"]);Do=Object(u["a"])([Object(d["a"])({})],Do);var Oo=Do,jo=Oo,To=(a("9673"),Object(V["a"])(jo,Io,So,!1,null,"de3a4c52",null)),Ro=To.exports,No=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customer-unit"},[a("van-pull-refresh",{staticClass:"msg-list",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,s){return a("div",{key:s,staticClass:"customer-item van-clearfix"},[a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__cust"},[a("van-tag",{staticStyle:{"margin-right":"5px"},attrs:{type:1===e.taskType?"primary":"warning "}},[t._v(t._s(1===e.taskType?"随访人":"协访人"))]),t._v(t._s(e.togetherUserName))],1),a("div",{staticClass:"customer-item__time"},[t._v(t._s(e.visitTime?e.visitTime.slice(0,e.visitTime.length-3):""))])]),a("div",{staticClass:"line"}),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("事件分类")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.labelName))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("医院")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.companyName))])]),e.expectTimeStr?a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("预期时间")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.expectTimeStr))])]):t._e(),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("业务员")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.userName))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("备注")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.remark))])])])})),0)],1)],1)},Ao=[],Po=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.custId=t.$route.params.custId,t.userId=t.$route.params.userId,t.visitUserId=t.$route.params.visitUserId,t.type=t.$route.params.type,t.isCabin=t.$route.params.isCabin,t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t}return Object(o["a"])(a,[{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={custId:this.custId,pageNum:this.page,pageSize:this.pageSize,flag:1,type:this.type,userId:this.userId,visitUserId:this.visitUserId},"true"!==this.isCabin){t.next=7;break}return t.next=4,xs(e);case 4:t.t0=t.sent,t.next=10;break;case 7:return t.next=9,ka(e);case 9:t.t0=t.sent;case 10:a=t.t0,this.loading=!1,this.refreshing=!1,a.success?(this.list=[].concat(Object(y["a"])(this.list),Object(y["a"])(a.data.list)),this.page++,this.finished=!a.data.hasNextPage):this.error=!0;case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"refreshData",value:function(){this.list=[],this.page=1,this.finished=!1,this.loading=!0,this.getDataList()}},{key:"created",value:function(){this.page=1,this.list=[]}}]),a}(d["c"]);Po=Object(u["a"])([Object(d["a"])({})],Po);var Eo=Po,Mo=Eo,$o=(a("b120"),Object(V["a"])(Mo,No,Ao,!1,null,"5b6e2de3",null)),qo=$o.exports,Vo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customerFollow"},[a("div",{staticClass:"header"},[a("div",{staticClass:"person left",on:{click:t.depPersonClick}},[0===t.userIdList.length?a("span",{staticClass:"left"},[t._v(t._s(t.personMsg))]):a("span",{staticClass:"left userDetail slh"},t._l(t.userIdDetailList,(function(e,s){return a("i",{key:s},[t._v(" "+t._s(e.userName)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:s<t.userIdDetailList.length-1,expression:"index < userIdDetailList.length - 1"}]},[t._v(",")])])})),0),a("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.depTreeList.length>0,expression:"depTreeList.length > 0"}],staticClass:"left",attrs:{name:"arrow-down"}}),a("van-button",{directives:[{name:"show",rawName:"v-show",value:t.userIdList.length>0,expression:"userIdList.length > 0"}],staticClass:"left",attrs:{size:"mini",type:"default",round:!0},nativeOn:{click:function(e){return e.stopPropagation(),t.backMine(e)}}},[t._v("回我的客情")])],1),a("div",{staticClass:"btnWarp right"},[a("i",{staticClass:"iconfont ytcrm-center left",on:{click:t.back}})])]),a("div",{staticClass:"customerFollow-header clearfix"},[(new Date).toLocaleDateString()!==new Date(t.nowClickDay).toLocaleDateString()?a("span",{staticClass:"date left",on:{click:t.changeDate}},[t._v(" "+t._s(t.nowOrClickMonth)+"月"+t._s(new Date(t.nowClickDay).getDate())+"日 "),a("i",{staticClass:"year"},[t._v(t._s(t.nowOrClickYear))])]):a("span",{staticClass:"date left",on:{click:t.changeDate}},[t._v(" 今日 "),a("i",{staticClass:"iconfont ytcrm-qiehuan"})]),(new Date).toLocaleDateString()!==new Date(t.nowClickDay).toLocaleDateString()?a("van-button",{staticClass:"left",attrs:{size:"mini",type:"default",round:!0},on:{click:t.backToday}},[t._v("回今日")]):t._e(),a("div",{staticClass:"weekChange right"},[a("van-icon",{attrs:{name:"arrow-left"},on:{click:t.preWeek}}),a("van-icon",{attrs:{name:"arrow"},on:{click:t.nextWeek}})],1)],1),t._m(0),a("div",{staticClass:"customerFollowContent"},[a("ul",{staticClass:"weekWarp"},t._l(t.nowdataList,(function(e){return a("li",{key:e,on:{click:function(a){return t.clickChange(e)}}},[a("span",{class:new Date(e).toLocaleDateString()===(new Date).toLocaleDateString()?"dayClickBgColor":new Date(e).getTime()<=(new Date).getTime()?"passBg":""},[a("i",{class:+e.substring(e.length-2,e.length)===+new Date(t.nowClickDay).getDate()?"nowChoose":""},[t._v(" "+t._s(e.substring(e.length-2,e.length))+" ")])]),a("div",{class:+e.substring(e.length-2,e.length)===+new Date(t.nowClickDay).getDate()?"circle":""})])})),0)]),a("div",{staticClass:"warp"},[a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.userIdList.length,expression:"userIdList.length === 0"}],staticClass:"addWarp",on:{click:t.addFllowClick}},[a("div",{staticClass:"addClick"},[a("van-icon",{staticClass:"left",attrs:{name:"plus"}}),a("span",{staticClass:"left"},[t._v("点击添加客情")])],1)]),a("div",{staticClass:"coustomerInfor",class:0===t.userIdList.length?"":"coustomerInforHeight"},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":""},on:{load:t.onLoad},model:{value:t.getUserVisitLoading,callback:function(e){t.getUserVisitLoading=e},expression:"getUserVisitLoading"}},t._l(t.tableDataList,(function(e,s){return a("ul",{key:s},[a("li",{staticClass:"taskType clearfix"},[e.isRaisedStarFlag?t._e():a("van-icon",{staticClass:"left",attrs:{name:"star-o"},on:{click:function(a){return t.addStarClick(e.cuvId)}}}),t._l(e.starFlag,(function(t){return a("van-icon",{key:t,staticClass:"left",attrs:{name:"star"}})})),0===e.whetherLegwork?a("i",{staticClass:"left always iconfont ytcrm-zaigangguanli"}):t._e(),1===e.whetherLegwork?a("i",{staticClass:"left need iconfont ytcrm-waiqin"}):t._e(),a("span",{staticClass:"right time"},[t._v(" "+t._s(e.visitTime.substring(0,e.visitTime.length-3))+" ")])],2),a("li",{staticClass:"header"},[t._v(" "+t._s(e.companyName)+" "),a("span",{staticClass:"type fontWeight"},[t._v("("+t._s(1===e.companyType?"供应商":2===e.companyType?"下游客户":3===e.companyType?"政府单位":"")+")")])]),a("li",{staticClass:"person clearfix"},[a("span",{staticClass:"value left"},[t._v(" "+t._s(e.visitUserName)+" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.visitUserPosition,expression:"item.visitUserPosition"}]},[t._v("（"+t._s(e.visitUserPosition)+"）")])]),1===e.warmthNum?a("van-icon",{staticClass:"always left",attrs:{name:"smile"}}):t._e(),2===e.warmthNum?a("van-icon",{staticClass:"need left",attrs:{name:"clock"}}):t._e(),3===e.warmthNum?a("van-icon",{staticClass:"never left",attrs:{name:"warning"}}):t._e()],1),a("li",{directives:[{name:"show",rawName:"v-show",value:e.crmLabelRemarkDtoList.length>=0,expression:"item.crmLabelRemarkDtoList.length >= 0"}],staticClass:"crmLabelRemarkDtoList"},[0===t.userIdList.length?a("p",{staticClass:"clearfix"},[a("van-button",{staticClass:"right",attrs:{plain:"",type:"info",size:"mini",round:""},on:{click:function(a){return t.editRemark(e)}}},[t._v("编辑客情事件")])],1):t._e(),t._l(e.crmLabelRemarkDtoList,(function(e,s){return a("p",{key:s},[a("span",{staticClass:"title"},[t._v(" "+t._s(e.labelName)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.expectTimeStr,expression:"crmLabelRemarkitem.expectTimeStr"}],staticClass:"time"},[t._v("("+t._s(e.expectTimeStr)+")")]),t._v(" : ")]),a("span",{staticClass:"value"},[t._v(t._s(e.remark))])])}))],2),e.crmVisitCommentDtoList&&e.crmVisitCommentDtoList.length>0?a("li",{staticClass:"crmVisitCommentDtoList"},[a("p",{staticClass:"visCommentHeader "},[a("span",{staticClass:"fontWeight"},[t._v("批注信息")]),a("van-button",{directives:[{name:"show",rawName:"v-show",value:t.userIdList.length>0,expression:"userIdList.length > 0"}],staticClass:"right",attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return t.addVisitComment(e)}}},[t._v("点击新增")])],1),t._l(e.crmVisitCommentDtoList,(function(e,s){return a("p",{key:s,staticClass:"crmVisitItem"},[a("span",{staticClass:"value"},[a("span",{staticClass:"title"},[t._v("内容:")]),t._v(" "+t._s(e.commentRemark)+" ")]),a("span",{staticClass:"personValue"},[a("span",{staticClass:"title"},[t._v("批注人:")]),t._v(" "+t._s(e.creId)+"/"+t._s(e.creName)+" "),a("i",{staticClass:"time right"},[t._v(t._s(e.credate.substring(0,e.credate.length-3)))])])])}))],2):a("li",{staticClass:"crmVisitCommentDtoList"},[a("span",{staticClass:"value"},[a("span",{staticClass:"title"},[t._v("批注:")]),t._v(" 暂无 "),a("van-button",{directives:[{name:"show",rawName:"v-show",value:t.userIdList.length>0,expression:"userIdList.length > 0"}],staticClass:"right",attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return t.addVisitComment(e)}}},[t._v("点击添加")])],1)]),a("li",{staticClass:"taskWarp clearfix"},[a("span",{staticClass:"value left"},[a("span",{staticClass:"title"},[t._v(t._s(1===e.taskType?"个人:":2===e.taskType?"协访人：":(e.taskType,"")))]),e.togetherUserId&&2===e.taskType?a("span",[t._v(t._s(e.togetherUserId)+"/"+t._s(e.togetherUserName))]):1===e.taskType?a("span",[t._v("自己拜访")]):3===e.taskType?a("span",{staticClass:"fontWeight",staticStyle:{color:"#faab0c"}},[t._v("接待")]):t._e()]),t.userIdList.length>0?a("span",{staticClass:"userValue right"},[a("span",{staticClass:"title"},[t._v("录入人:")]),t._v(" "+t._s(e.creId)+"/"+t._s(e.creName)+" ")]):t._e()]),a("li",{staticClass:"addressWarp"},[a("p",{staticClass:"adressHeader fontWeight"},[t._v(" 定位信息： "),0===t.userIdList.length?a("van-button",{staticClass:"right",attrs:{size:"mini",color:"#7232dd",plain:"",round:""},on:{click:function(a){return t.handleRelateClockIn(e)}}},[t._v("关联打卡记录")]):t._e()],1),e.cciId?a("p",[t._v(t._s(e.cciId)+"/"+t._s(e.address))]):a("p",[t._v("暂无定位信息")]),a("van-popup",{attrs:{position:"bottom"},model:{value:t.showAdressPicker,callback:function(e){t.showAdressPicker=e},expression:"showAdressPicker"}},[a("van-picker",{attrs:{"item-height":"60","default-index":t.nowChangeClickIndex,"show-toolbar":"",columns:t.clickInList},on:{confirm:t.onConfirm,cancel:function(e){t.showAdressPicker=!1}},scopedSlots:t._u([{key:"option",fn:function(e){return[a("li",{staticStyle:{padding:"0px 20px","text-index":"20px","font-size":"14px"}},[t._v(" "+t._s(e.cciId)+"/"+t._s(e.address)+" "),a("span",{staticStyle:{color:"#777","font-size":"12px"}},[t._v("("+t._s(e.credate)+")")])])]}}],null,!0)})],1)],1)])})),0)],1),a("van-empty",{directives:[{name:"show",rawName:"v-show",value:0===t.tableDataList.length&&!t.getUserVisitLoading,expression:"tableDataList.length === 0 && !getUserVisitLoading"}],attrs:{description:"暂无客情"}})],1)]),a("van-calendar",{attrs:{type:"range","default-date":t.dateRange,"min-date":new Date(2020,0,1),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{select:t.selectCalendar},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}}),t.depPersonShow?a("dep-person",{attrs:{userIdList:t.userIdList,userIdDetailList:t.userIdDetailList,isMultiple:!0,depPersonShow:t.depPersonShow},on:{checkSureClick:t.checkSureClick,closeDepPerson:t.closeDepPerson}}):t._e(),a("van-dialog",{attrs:{"show-cancel-button":"",beforeClose:t.confirmDialog},model:{value:t.crmVisitCommentShow,callback:function(e){t.crmVisitCommentShow=e},expression:"crmVisitCommentShow"}},[a("ul",{staticClass:"addCommentWarp coustomerInfor"},[t.bowClickFllObj?a("ul",{staticClass:"detail"},[a("li",{staticClass:"taskType clearfix"},[t.bowClickFllObj.starFlag?a("van-icon",{staticClass:"left",attrs:{name:"star"}}):t._e(),0===t.bowClickFllObj.whetherLegwork?a("i",{staticClass:"left always iconfont ytcrm-zaigangguanli"}):t._e(),1===t.bowClickFllObj.whetherLegwork?a("i",{staticClass:"left need iconfont ytcrm-waiqin"}):t._e(),a("span",{staticClass:"right time"},[t._v(" "+t._s(t.bowClickFllObj.visitTime.substring(0,t.bowClickFllObj.visitTime.length-3))+" ")])],1),a("li",{staticClass:"header"},[t._v(" "+t._s(t.bowClickFllObj.companyName)+" "),a("span",{staticClass:"type fontWeight"},[t._v(" ("+t._s(1===t.bowClickFllObj.companyType?"供应商":2===t.bowClickFllObj.companyType?"下游客户":3===t.bowClickFllObj.companyType?"政府单位":"")+") ")])]),a("li",{staticClass:"person clearfix"},[a("span",{staticClass:"value left"},[t._v(" "+t._s(t.bowClickFllObj.visitUserName)+" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.bowClickFllObj.visitUserPosition,expression:"bowClickFllObj.visitUserPosition"}]},[t._v("（"+t._s(t.bowClickFllObj.visitUserPosition)+"）")])]),1===t.bowClickFllObj.warmthNum?a("van-icon",{staticClass:"always left",attrs:{name:"smile"}}):t._e(),2===t.bowClickFllObj.warmthNum?a("van-icon",{staticClass:"need left",attrs:{name:"clock"}}):t._e(),3===t.bowClickFllObj.warmthNum?a("van-icon",{staticClass:"never left",attrs:{name:"warning"}}):t._e()],1),a("li",{directives:[{name:"show",rawName:"v-show",value:t.bowClickFllObj.crmLabelRemarkDtoList.length>0,expression:"bowClickFllObj.crmLabelRemarkDtoList.length > 0"}],staticClass:"crmLabelRemarkDtoList"},t._l(t.bowClickFllObj.crmLabelRemarkDtoList,(function(e,s){return a("p",{key:s},[a("span",{staticClass:"title"},[t._v(" "+t._s(e.labelName)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.expectTimeStr,expression:"crmLabelRemarkitem.expectTimeStr"}],staticClass:"time"},[t._v("("+t._s(e.expectTimeStr)+")")]),t._v(" : ")]),a("span",{staticClass:"value"},[t._v(t._s(e.remark))])])})),0),t.bowClickFllObj.crmVisitCommentDtoList&&t.bowClickFllObj.crmVisitCommentDtoList.length>0?a("li",{staticClass:"crmVisitCommentDtoList"},[a("p",{staticClass:"visCommentHeader "},[a("span",{staticClass:"fontWeight"},[t._v("批注信息")])]),t._l(t.bowClickFllObj.crmVisitCommentDtoList,(function(e,s){return a("p",{key:s,staticClass:"crmVisitItem"},[a("span",{staticClass:"value"},[a("span",{staticClass:"title"},[t._v("内容:")]),t._v(" "+t._s(e.commentRemark)+" ")]),a("span",{staticClass:"personValue"},[a("span",{staticClass:"title"},[t._v("批注人:")]),t._v(" "+t._s(e.creId)+"/"+t._s(e.creName)+" "),a("i",{staticClass:"time right"},[t._v(t._s(e.credate.substring(0,e.credate.length-3)))])])])}))],2):a("li",{staticClass:"crmVisitCommentDtoList"},[a("span",{staticClass:"value"},[a("span",{staticClass:"title"},[t._v("批注:")]),t._v(" 暂无 ")])]),a("li",{staticClass:"taskWarp clearfix"},[a("span",{staticClass:"value left"},[a("span",{staticClass:"title"},[t._v(t._s(1===t.bowClickFllObj.taskType?"个人:":2===t.bowClickFllObj.taskType?"协访人：":""))]),t.bowClickFllObj.togetherUserId&&2===t.bowClickFllObj.taskType?a("span",[t._v(t._s(t.bowClickFllObj.togetherUserId)+"/"+t._s(t.bowClickFllObj.togetherUserName))]):a("span",[t._v("自己拜访")])]),t.userIdList.length>0?a("span",{staticClass:"userValue right"},[a("span",{staticClass:"title"},[t._v("录入人:")]),t._v(" "+t._s(t.bowClickFllObj.creId)+"/"+t._s(t.bowClickFllObj.creName)+" ")]):t._e()])]):t._e(),a("li",{staticClass:"commentHeader"},[t._v("批注：")]),a("li",[a("van-field",{attrs:{rows:"5",autosize:"",type:"textarea",placeholder:"请输入批注","show-word-limit":""},model:{value:t.visitCommentMsg,callback:function(e){t.visitCommentMsg=e},expression:"visitCommentMsg"}})],1)])]),a("addfllow-detail",{ref:"addFlloeDetail",attrs:{maplabelTreeList:t.maplabelTreeList},on:{confirmDialog:t.addConfirmDialog}}),a("van-popup",{style:{height:"75%"},attrs:{round:"",position:"bottom",closeable:""},model:{value:t.customerLabelShow,callback:function(e){t.customerLabelShow=e},expression:"customerLabelShow"}},[a("div",{staticClass:"customerLabelWarp"},[a("ul",{staticClass:"borderTop"},t._l(t.labelValueObj,(function(e,s){return a("li",{key:s,staticClass:"listWarp"},[a("van-field",{attrs:{readonly:"",clickable:"",label:"事件分类",value:e.labelName,placeholder:"点击维护事件分类"},on:{click:function(e){t.labelShow=!0,t.changeLabelIndex=s}}}),"药事会信息"===e.labelName?a("van-field",{staticClass:"customerLabelChange",attrs:{label:"时间",type:"text",placeholder:"请输入时间"},model:{value:e.expectTimeStr,callback:function(a){t.$set(e,"expectTimeStr",a)},expression:"item.expectTimeStr"}}):t._e(),a("van-field",{staticClass:"customerLabelChange",attrs:{rows:"1",autosize:"",label:"客情事件",type:"textarea",placeholder:"请输入客情事件"},model:{value:e.remark,callback:function(a){t.$set(e,"remark",a)},expression:"item.remark"}}),a("van-icon",{directives:[{name:"show",rawName:"v-show",value:!e.cuvId,expression:"!item.cuvId"}],attrs:{name:"cross",size:"22px"},nativeOn:{click:function(e){return e.stopPropagation(),t.deleteItemClick(s)}}})],1)})),0),a("li",{staticClass:"buttonWarp clearfix"},[a("van-button",{staticClass:"left",attrs:{size:"small",plain:"",type:"info",round:""},on:{click:t.addCustomList}},[t._v("新增客情事件")]),a("van-button",{staticClass:"right",attrs:{size:"small",plain:"",type:"primary",round:""},on:{click:t.addCustomSure}},[t._v("确定")])],1)])]),a("van-popup",{style:{height:"65%"},attrs:{round:"",position:"bottom"},model:{value:t.labelShow,callback:function(e){t.labelShow=e},expression:"labelShow"}},[a("van-tree-select",{attrs:{height:"100%",items:t.maplabelTreeList,"main-active-index":t.activeIndex},on:{"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e}},scopedSlots:t._u([{key:"content",fn:function(){return[t.maplabelTreeList.length>0&&t.maplabelTreeList[t.activeIndex].children?a("ul",{staticClass:"labelTreeWarp"},t._l(t.maplabelTreeList[t.activeIndex].children,(function(e,s){return a("li",{key:s,class:t.labelValueObj[t.changeLabelIndex]&&t.labelValueObj[t.changeLabelIndex].labelId===e.LABEL_ID?"active":"",on:{click:function(a){return t.labelTreeItemClick(e)}}},[t._v(" "+t._s(e.LABEL_NAME)+" "),t.labelValueObj[t.changeLabelIndex]&&t.labelValueObj[t.changeLabelIndex].labelId===e.LABEL_ID?a("van-icon",{staticClass:"right",attrs:{name:"success"}}):t._e()],1)})),0):t._e(),t.maplabelTreeList.length>0&&0===t.maplabelTreeList[t.activeIndex].children.length?a("van-empty",{attrs:{description:"暂无信息"}}):t._e()]},proxy:!0}])})],1)],1)},Uo=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"middleHeader"},[a("ul",{staticClass:"weekWarp"},[a("li",[t._v("一")]),a("li",[t._v("二")]),a("li",[t._v("三")]),a("li",[t._v("四")]),a("li",[t._v("五")]),a("li",[t._v("六")]),a("li",[t._v("日")])])])}],Fo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addFllowDetail"},[a("van-dialog",{attrs:{"show-cancel-button":"",beforeClose:t.confirmDialog},model:{value:t.addFllowShow,callback:function(e){t.addFllowShow=e},expression:"addFllowShow"}},[a("ul",{staticClass:"addFllowWarp"},[a("li",[a("van-field",{attrs:{readonly:"",clickable:"",name:"datetimePicker",value:t.changeTime,label:"时间选择",placeholder:"点击选择时间"},on:{click:function(e){t.timeShowPicker=!0}}})],1),a("li",[a("van-field",{attrs:{name:"radio",label:"拜访类型"},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.visitType,callback:function(e){t.visitType=e},expression:"visitType"}},[a("van-radio",{attrs:{name:"1","icon-size":"14px"}},[t._v("个人")]),a("van-radio",{attrs:{name:"2","icon-size":"14px"}},[t._v("协访")]),a("van-radio",{attrs:{name:"3","icon-size":"14px"}},[t._v("接待")])],1)]},proxy:!0}])})],1),a("li",["2"===t.visitType?a("van-field",{attrs:{readonly:"",clickable:"",placeholder:"点击选择协访人员",label:"协访人",value:t.visitUserName},on:{click:t.visitUserChange}}):t._e()],1),a("li",{staticClass:"visited"},[a("van-field",{attrs:{readonly:"",clickable:"",label:"单位类型",placeholder:"点击选择单位类型",value:1===t.objTypeValue?"供应商":2===t.objTypeValue?"下游客户":3===t.objTypeValue?"政府单位":""},on:{click:function(e){t.objTypeShowPicker=!0}}})],1),a("li",[a("van-field",{attrs:{readonly:"",clickable:"",label:"单位信息",placeholder:"点击选择单位信息",value:t.objName},on:{click:t.objChangeClick}})],1),a("li",[a("van-field",{attrs:{name:"radio",label:"关联定位"},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-radio-group",{attrs:{direction:"horizontal"},on:{change:t.addressTypeChange},model:{value:t.addressType,callback:function(e){t.addressType=e},expression:"addressType"}},[a("van-radio",{attrs:{name:"1","icon-size":"14px"}},[t._v("关联已有")]),a("van-radio",{attrs:{name:"2","icon-size":"14px"}},[t._v("直接打卡")])],1)]},proxy:!0}])})],1),a("li",[1===+t.addressType?a("van-field",{attrs:{readonly:"",clickable:"",label:"打卡信息",placeholder:"点击选择打卡信息",value:t.addressDeatilValue},on:{click:t.adressChangeClick}}):t._e(),2===+t.addressType?a("van-field",{attrs:{name:"radio",label:"直接打卡"},scopedSlots:t._u([2===+t.addressType?{key:"input",fn:function(){return[a("span",{staticClass:"clockIn",on:{click:t.clockInClick}},[t._v("立即打卡")])]},proxy:!0}:null],null,!0)}):t._e()],1),a("li",[2===+t.addressType&&t.addressDeatilValue?a("van-field",{attrs:{readonly:"",clickable:"",label:"打卡信息",value:t.addressDeatilValue}}):t._e()],1),a("li",[a("van-field",{attrs:{readonly:"",clickable:"",label:"职员信息",placeholder:"点击选择职员信息",value:t.staffMemberName},on:{click:t.staffMemberChangeClick}})],1),t.staffMemberInforObj.length>0?a("van-tabs",{attrs:{type:"card",color:"#1989fa"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.staffMemberInforObj,(function(e,s){return a("van-tab",{key:s,attrs:{title:e.userName}},[e.phoneNumber?a("li",{staticClass:"timeChange"},[a("van-field",{attrs:{readonly:"",clickable:"",label:"电话",value:e.phoneNumber}}),a("van-checkbox",{staticClass:"left",attrs:{"icon-size":"18px"},model:{value:e.outsideCheck,callback:function(a){t.$set(e,"outsideCheck",a)},expression:"item.outsideCheck"}},[t._v("外勤")])],1):t._e(),e.hotValue?a("li",{staticClass:"objTypeValue"},[a("van-field",{attrs:{readonly:"",clickable:"",label:"热力值"},scopedSlots:t._u([{key:"input",fn:function(){return[a("span",{class:1===e.hotid?"always":2===e.hotid?"up":3===e.hotid?"never":""},[t._v(t._s(e.hotValue))])]},proxy:!0}],null,!0)}),a("span",{staticClass:"star",on:{click:function(t){e.starCheck=!e.starCheck}}},[e.starCheck?a("van-icon",{staticClass:"left",attrs:{name:"star",size:"20px"}}):a("van-icon",{staticClass:"left",attrs:{name:"star-o",size:"20px"}}),a("i",{staticClass:"value left"},[t._v("星标")])],1)],1):t._e(),a("li",[a("van-field",{attrs:{readonly:"",clickable:"",label:"客情事件",value:0===e.needLabelValueObj.length?"":"已维护"+e.needLabelValueObj.length+"客情事件",placeholder:"点击维护客情事件"},on:{click:function(e){t.customerLabelShow=!0}}})],1)])})),1):t._e()],1)]),a("van-popup",{attrs:{position:"bottom"},model:{value:t.objTypeShowPicker,callback:function(e){t.objTypeShowPicker=e},expression:"objTypeShowPicker"}},[t.objTypeShowPicker?a("van-picker",{attrs:{"show-toolbar":"",columns:t.objTypeColumns},on:{confirm:t.objTypeOnConfirm,cancel:function(e){t.objTypeShowPicker=!1}}}):t._e()],1),a("van-popup",{attrs:{position:"bottom"},model:{value:t.timeShowPicker,callback:function(e){t.timeShowPicker=e},expression:"timeShowPicker"}},[a("van-datetime-picker",{attrs:{formatter:t.formatter,type:"datetime",filter:t.filter,title:"选择完整时间","min-date":t.minDate,"max-date":t.maxDate},on:{cancel:function(e){t.timeShowPicker=!1},confirm:t.confirmTime},model:{value:t.timeValue,callback:function(e){t.timeValue=e},expression:"timeValue"}})],1),a("van-popup",{style:{height:"75%"},attrs:{closeable:"",round:"",position:"bottom"},model:{value:t.objShowPicker,callback:function(e){t.objShowPicker=e},expression:"objShowPicker"}},[t.objShowPicker?a("div",{staticClass:"objWarp"},[a("van-search",{attrs:{placeholder:"请输入搜索关键词"},on:{input:t.searchValueInput},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}}),a("div",{staticClass:"content"},[a("van-pull-refresh",{attrs:{offset:"40"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[2===t.objTypeValue?a("div",{staticClass:"warp"},t._l(t.custlistOptions,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:"",title:e.custId+"/"+e.custName},on:{click:function(a){return t.changeCust(e)}}})})),1):t._e(),1===t.objTypeValue?a("div",{staticClass:"warp"},t._l(t.providerInforOptions,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:"",title:e.cpiId+"/"+e.providerName},on:{click:function(a){return t.changeProvider(e)}}})})),1):t._e(),3===t.objTypeValue?a("div",{staticClass:"warp"},t._l(t.goverListOptions,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:"",title:e.govAttributeId+"/"+e.govAttributeName+"("+e.orgnizationName+") --- "+e.ssqCodeName},on:{click:function(a){return t.changeGover(e)}}})})),1):t._e()])],1)],1)],1):t._e()]),a("van-popup",{style:{height:"75%"},attrs:{closeable:"",round:"",position:"bottom"},model:{value:t.staffMemberShow,callback:function(e){t.staffMemberShow=e},expression:"staffMemberShow"}},[a("van-checkbox-group",{staticStyle:{height:"100%"},on:{change:t.personCheckChange},model:{value:t.staffMemberInforList,callback:function(e){t.staffMemberInforList=e},expression:"staffMemberInforList"}},[a("div",{staticClass:"staffMemberChange"},[t._l(t.personList,(function(e,s){return a("ul",{key:s,staticClass:"searchWarp clearfix",on:{click:function(a){return t.personCheckClick(e)}}},[a("van-checkbox",{staticClass:"left",attrs:{size:"mini",name:e.userId||e.USER_ID,"icon-size":"16px","checked-color":"#554d62"}},[1===t.objTypeValue?a("div",{staticClass:"searchContent left"},[a("li",{staticClass:"searchOne"},[a("span",{staticClass:"searchtitle"},[t._v("姓名：")]),a("span",{staticClass:"searchvalue"},[t._v(" "+t._s(e.userName)+" "),a("i",[t._v("("+t._s(e.userId)+")")])])]),a("li",[a("span",{staticClass:"searchtitle"},[t._v("电话：")]),a("span",{staticClass:"searchvalue"},[t._v(t._s(e.phoneNum))])])]):t._e(),2===t.objTypeValue?a("div",{staticClass:"searchContent left"},[a("li",{staticClass:"searchOne"},[a("span",{staticClass:"searchtitle"},[t._v("姓名：")]),a("span",{staticClass:"searchvalue"},[t._v(" "+t._s(e.userName)+" "),a("i",[t._v("("+t._s(e.userId)+")")])])]),a("li",[a("span",{staticClass:"searchtitle"},[t._v("电话：")]),a("span",{staticClass:"searchvalue"},[t._v(t._s(e.phoneNum))])])]):t._e(),3===t.objTypeValue?a("div",{staticClass:"searchContent left"},[a("li",{staticClass:"searchOne"},[a("span",{staticClass:"searchtitle"},[t._v("姓名：")]),a("span",{staticClass:"searchvalue"},[t._v(" "+t._s(e.CU_USER_NAME)+" "),a("i",[t._v("("+t._s(e.USER_ID)+")")])])]),a("li",[a("span",{staticClass:"searchtitle"},[t._v("电话：")]),a("span",{staticClass:"searchvalue"},[t._v(t._s(e.CU_PHONE_NUM))])])]):t._e()])],1)})),a("div",{staticClass:"buttonWarp clearfix"},[a("van-button",{staticClass:"left",attrs:{size:"small",plain:"",type:"info",round:""},on:{click:function(e){t.staffMemberShow=!1}}},[t._v("取消")]),a("van-button",{staticClass:"right",attrs:{size:"small",plain:"",type:"primary",round:""},on:{click:t.addSurePerson}},[t._v("确定")])],1)],2)]),0===t.personList.length?a("van-empty",{attrs:{description:"暂无成员信息"}}):t._e()],1),a("van-popup",{style:{height:"75%"},attrs:{closeable:"",round:"",position:"bottom"},model:{value:t.visitUserShow,callback:function(e){t.visitUserShow=e},expression:"visitUserShow"}},[a("div",{staticClass:"visitUserWarp"},[a("div",{staticClass:"search"},[a("van-search",{attrs:{placeholder:"请输入搜索人员名称","input-align":"center"},on:{input:t.searchPersonInput},model:{value:t.visitsearchVal,callback:function(e){t.visitsearchVal=e},expression:"visitsearchVal"}})],1),a("van-radio-group",{directives:[{name:"show",rawName:"v-show",value:!t.visitUserLoading&&t.userOptions.length>0,expression:"!visitUserLoading && userOptions.length > 0"}],model:{value:t.visitUserId,callback:function(e){t.visitUserId=e},expression:"visitUserId"}},t._l(t.userOptions,(function(e,s){return a("ul",{key:s,staticClass:"searchWarp clearfix",on:{click:function(a){return t.changeVisitUser(e)}}},[a("van-radio",{staticClass:"left",attrs:{size:"mini",name:e.userId,"icon-size":"16px","checked-color":"#554d62"}},[a("div",{staticClass:"searchContent left"},[a("li",{staticClass:"searchOne"},[a("span",{staticClass:"searchtitle"},[t._v("姓名：")]),a("span",{staticClass:"searchvalue"},[t._v(" "+t._s(e.userName)+" "),a("i",[t._v("("+t._s(e.userId)+")")])])]),a("li",[a("span",{staticClass:"searchtitle"},[t._v("电话：")]),a("span",{staticClass:"searchvalue"},[t._v(t._s(e.phoneNum))])])])])],1)})),0),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.visitUserLoading,expression:"visitUserLoading"}],staticClass:"paddingChange",attrs:{color:"#0094ff"}},[t._v("加载中...")]),0!==t.userOptions.length||t.visitUserLoading?t._e():a("van-empty",{attrs:{description:"暂无成员信息"}})],1)]),a("van-popup",{style:{height:"75%"},attrs:{round:"",position:"bottom",closeable:""},model:{value:t.customerLabelShow,callback:function(e){t.customerLabelShow=e},expression:"customerLabelShow"}},[a("div",{staticClass:"customerLabelWarp"},[a("ul",t._l(t.staffMemberInforObj.length>0&&t.staffMemberInforObj[t.activeName].remarkValueList,(function(e,s){return a("li",{key:s,staticClass:"listWarp"},[a("van-field",{attrs:{readonly:"",clickable:"",label:"事件分类",value:e.labelValue,placeholder:"点击维护事件分类"},on:{click:function(e){t.labelShow=!0,t.changeLabelIndex=s}}}),"药事会信息"===e.labelValue?a("van-field",{staticClass:"customerLabelChange",attrs:{label:"时间",type:"text",placeholder:"请输入时间"},model:{value:e.expectTimeStr,callback:function(a){t.$set(e,"expectTimeStr",a)},expression:"item.expectTimeStr"}}):t._e(),a("van-field",{staticClass:"customerLabelChange",attrs:{rows:"1",autosize:"",label:"客情事件",type:"textarea",placeholder:"请输入客情事件"},model:{value:e.labelRemark,callback:function(a){t.$set(e,"labelRemark",a)},expression:"item.labelRemark"}}),a("van-icon",{directives:[{name:"show",rawName:"v-show",value:!e.cuvId,expression:"!item.cuvId"}],attrs:{name:"cross",size:"22px"},nativeOn:{click:function(e){return e.stopPropagation(),t.deleteItemClick(s)}}})],1)})),0),a("li",{staticClass:"buttonWarp clearfix"},[a("van-button",{staticClass:"left",attrs:{size:"small",plain:"",type:"info",round:""},on:{click:t.addCustomList}},[t._v("新增客情事件")]),a("van-button",{staticClass:"right",attrs:{size:"small",plain:"",type:"primary",round:""},on:{click:t.addCustomSure}},[t._v("确定")])],1)])]),a("van-popup",{style:{height:"65%"},attrs:{round:"",position:"bottom"},model:{value:t.labelShow,callback:function(e){t.labelShow=e},expression:"labelShow"}},[a("van-tree-select",{attrs:{height:"100%",items:t.maplabelTreeList,"main-active-index":t.activeIndex},on:{"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e}},scopedSlots:t._u([{key:"content",fn:function(){return[t.maplabelTreeList.length>0&&t.maplabelTreeList[t.activeIndex].children?a("ul",{staticClass:"labelTreeWarp"},t._l(t.maplabelTreeList[t.activeIndex].children,(function(e,s){return a("li",{key:s,class:t.staffMemberInforObj.length>0&&t.staffMemberInforObj[t.activeName].remarkValueList[t.changeLabelIndex]&&t.staffMemberInforObj.length>0&&t.staffMemberInforObj[t.activeName].remarkValueList[t.changeLabelIndex].labelId===e.LABEL_ID?"active":"",on:{click:function(a){return t.labelTreeItemClick(e)}}},[t._v(" "+t._s(e.LABEL_NAME)+" "),t.staffMemberInforObj.length>0&&t.staffMemberInforObj[t.activeName].remarkValueList[t.changeLabelIndex]&&t.staffMemberInforObj.length>0&&t.staffMemberInforObj[t.activeName].remarkValueList[t.changeLabelIndex].labelId===e.LABEL_ID?a("van-icon",{staticClass:"right",attrs:{name:"success"}}):t._e()],1)})),0):t._e(),t.maplabelTreeList.length>0&&0===t.maplabelTreeList[t.activeIndex].children.length?a("van-empty",{attrs:{description:"暂无信息"}}):t._e()]},proxy:!0}])})],1),a("van-popup",{style:{height:"65%"},attrs:{position:"bottom"},model:{value:t.showAdressPicker,callback:function(e){t.showAdressPicker=e},expression:"showAdressPicker"}},[a("div",{staticClass:"clearfix"},[a("van-search",{staticClass:"left",staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请输入搜索关键词"},on:{input:t.addressSearchValueInput},model:{value:t.addressSearchValue,callback:function(e){t.addressSearchValue=e},expression:"addressSearchValue"}}),a("van-field",{staticClass:"left",staticStyle:{margin:"10px",padding:"5px",background:"#f7f8fa",width:"30%"},attrs:{readonly:"",clickable:"",name:"datePicker",value:t.addresschangeTime,label:"",placeholder:"点击选择时间"},on:{click:function(e){t.addresstimeShowPicker=!0}}})],1),a("van-popup",{attrs:{position:"bottom"},model:{value:t.addresstimeShowPicker,callback:function(e){t.addresstimeShowPicker=e},expression:"addresstimeShowPicker"}},[a("van-datetime-picker",{attrs:{type:"date",title:"选择完整时间","min-date":t.minDate,"max-date":t.maxDate},on:{cancel:t.addressCancel,confirm:t.addressconfirmTime},model:{value:t.timeValue,callback:function(e){t.timeValue=e},expression:"timeValue"}})],1),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.getCrmClockInLoading,expression:"getCrmClockInLoading"}],staticClass:"paddingChange",attrs:{color:"#0094ff"}},[t._v("加载中...")]),t.clickInList.length>0&&!t.getCrmClockInLoading?a("div",{staticClass:"content",staticStyle:{height:"calc(100% - 100px)",overflow:"auto"}},t._l(t.clickInList,(function(e,s){return a("van-cell",{key:s,attrs:{clickable:""},on:{click:function(a){return t.adressOnConfirm(e)}}},[t._v(" "+t._s(e.cciId)+"/"+t._s(e.address)+" "),a("span",{staticStyle:{color:"#777","font-size":"12px"}},[t._v("("+t._s(e.credate)+")")])])})),1):a("van-empty",{attrs:{description:"暂无打卡信息"}}),a("van-button",{staticStyle:{"margin-left":"10%","margin-top":"10px",width:"40%"},attrs:{plain:"",type:"info",size:"small",round:""},on:{click:function(e){return t.adressOnConfirm("")}}},[t._v("清除已选打卡信息")]),a("van-button",{staticStyle:{"margin-left":"10%","margin-top":"10px",width:"30%"},attrs:{plain:"",type:"default",size:"small",round:""},on:{click:function(e){return t.adressOnConfirm("")}}},[t._v("取消")])],1)],1)},zo=[],Wo=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.clickInList=[],t.getCrmClockInLoading=!1,t.addFllowShow=!1,t.showAdressPicker=!1,t.minDate=new Date(2019,0,1),t.maxDate=new Date,t.changeTime="",t.timeValue=new Date,t.timeShowPicker=!1,t.outsideCheck=!1,t.starCheck=!1,t.objTypeValue=2,t.objTypeShowPicker=!1,t.objTypeColumns=[{text:"下游客户",typeNum:1,id:2},{text:"政府单位",typeNum:34,id:3},{text:"供应商",typeNum:11,id:1}],t.custlistOptions=[],t.goverListOptions=[],t.goverListMiddleOptions=[],t.providerInforOptions=[],t.objId="",t.objName="",t.objShowPicker=!1,t.searchValue="",t.loading=!1,t.finished=!1,t.refreshing=!1,t.page=1,t.staffMemberShow=!1,t.staffMemberInforList=[],t.staffMemberInforObj=[],t.staffMemberId="",t.staffMemberName="",t.personList=[],t.phoneNumber="",t.hotValue="",t.visitUserLoading=!1,t.visitUserShow=!1,t.visitsearchVal="",t.visitType="1",t.visitUserId="",t.visitUserName="",t.userOptions=[],t.labelTreeList=[],t.activeIndex=0,t.needLabelValueObj=[],t.labelValueObj=[{labelId:"",labelValue:"",labelRemark:"",expectTimeStr:""}],t.customerLabelShow=!1,t.labelShow=!1,t.changeLabelIndex=0,t.activeName=0,t.addressType="1",t.addressValue="",t.addressDeatilValue="",t.addressSearchValue="",t.addresschangeTime="",t.addresstimeShowPicker=!1,t}return Object(o["a"])(a,[{key:"addressCancel",value:function(){this.addresstimeShowPicker=!1,this.addresschangeTime="",this._getCrmClockIn()}},{key:"addressconfirmTime",value:function(t){console.log(Gs(t)),this.addresschangeTime=Gs(t),this._getCrmClockIn(),this.addresstimeShowPicker=!1}},{key:"filter",value:function(t,e){return"minute"===t?(console.log(e),e.filter((function(t){return t%15===0}))):e}},{key:"confirmDialog",value:function(t,e){var a=this;console.log(this.staffMemberInforList),console.log(this.staffMemberInforObj);for(var s=[],i=0;i<this.staffMemberInforObj.length;i++){for(var n=this.staffMemberInforObj[i],r=[],o=0;o<n.remarkValueList.length;o++){var c=n.remarkValueList[o];c.labelId&&r.push({labelName:c.labelValue,labelId:c.labelId,remark:c.labelRemark,expectTimeStr:c.expectTimeStr,isSign:!1,userIdList:[],tagIdList:[]})}s.push({companyType:this.objTypeValue,companyId:this.objId,dataType:1,cciId:this.addressValue,leaderIsItVisible:1,starFlag:n.starCheck?1:0,taskType:this.visitType,togetherUserId:this.visitUserId,userId:localStorage.getItem("userId"),visitTime:this.changeTime,visitUserId:n.userId,whetherLegwork:n.outsideCheck?1:0,crmLabelRemarkVoList:r})}if("confirm"===t){if(!this.staffMemberInforObj.length)return e(),void this.$nextTick((function(){a.addFllowShow=!0,setTimeout((function(){a.$toast.fail("请选择职员信息")}))}));if(""===this.changeTime)return e(),void this.$nextTick((function(){a.addFllowShow=!0,setTimeout((function(){a.$toast.fail("请选择拜访时间")}))}));if(-1===this.objTypeValue)return e(),void this.$nextTick((function(){a.addFllowShow=!0,setTimeout((function(){a.$toast.fail("请选择单位类型")}))}));if(""===this.objId)return e(),void this.$nextTick((function(){a.addFllowShow=!0,setTimeout((function(){a.$toast.fail("请选择单位信息")}))}))}this.$emit("confirmDialog",{action:t,done:e,params:s})}},{key:"confirmTime",value:function(t){this.changeTime=Gs(this.timeValue)+" "+new Date(t).toTimeString().substring(0,5),this.timeShowPicker=!1}},{key:"formatter",value:function(t,e){return"year"===t?e+"年":"month"===t?e+"月":"day"===t?e+"日":e}},{key:"objTypeOnConfirm",value:function(t){var e=this;this.objTypeValue!==t.id?this.objName?this.$dialog.confirm({title:"提示",message:"切换单位类型将清空已有单位信息，确定要切换吗？",beforeClose:function(a,s){"confirm"===a?(e.objId="",e.objName="",e.staffMemberId="",e.staffMemberName="",e.hotValue="",e.phoneNumber="",e.objTypeValue=t.id,e.objTypeShowPicker=!1,s()):s()}}):(this.objId="",this.objName="",this.objTypeValue=t.id,this.objTypeShowPicker=!1):this.objTypeShowPicker=!1}},{key:"objChangeClick",value:function(){this.custlistOptions=[],this.goverListOptions=[],this.providerInforOptions=[],this.page=1,this.searchValue="",-1!==this.objTypeValue?(this.loading=!1,this.finished=!1,this.refreshing=!1,this.objShowPicker=!0):this.$toast.fail("请先选择单位类型")}},{key:"searchValueInput",value:function(t){this.page=1,this.providerInforOptions=[],this.custlistOptions=[],t?(this.$cancelAxios(["queryGovernmentForVisit","queryProviderForVisit","queryCustListByUserId"]),this.onLoad()):this.onRefresh()}},{key:"_getGoverList",value:function(){var t=this,e={orgnizationKeyword:this.searchValue};It(e).then((function(e){"200"===e.code&&(t.goverListOptions=e.data,t.goverListMiddleOptions=Object(y["a"])(e.data)),t.finished=!0}))}},{key:"_queryGovernmentUserMsg",value:function(t){var e=this;St(t).then((function(t){if("200"===t.code){for(var a=[],s=0;s<t.data.list[0].govermentList[0].detail.length;s++){var i=t.data.list[0].govermentList[0].detail[s];i.USER_ID&&3!==i.IS_DEL&&a.push(i)}if(a.length>0){for(var n=[a[0]],r=0;r<a.length;r++){for(var o=!1,c=0;c<n.length;c++)if(a[r].USER_ID===n[c].USER_ID){o=!0;break}o||n.push(a[r])}e.personList=n}}else e.$toast.fail(t.msg),e.personList=[]}))}},{key:"_queryCustListByUserId",value:function(){var t=this;1===this.page&&(this.providerInforOptions=[]);var e={pageNum:this.page,pageSize:10,cust:this.searchValue,type:this.visitType};return new Promise((function(a){_t(e).then((function(e){"200"===e.code&&(t.custlistOptions=t.custlistOptions.length>0?t.custlistOptions.concat(e.data.list):e.data.list,a(e.data))}))}))}},{key:"_queryProviderForVisit",value:function(){var t=this;1===this.page&&(this.providerInforOptions=[]);var e={providerNameOrId:this.searchValue,useridList:[],pageSize:10,pageNum:this.page};return new Promise((function(a){xt(e).then((function(e){"200"===e.code&&(t.providerInforOptions=t.providerInforOptions.length>0?t.providerInforOptions.concat(e.data.list):e.data.list,a(e.data))}))}))}},{key:"onRefresh",value:function(){this.finished=!1,this.searchValue="",this.loading=!0,this.onLoad()}},{key:"onLoad",value:function(){var t=this;this.refreshing&&(this.page=1,this.providerInforOptions=[],this.custlistOptions=[],this.goverListOptions=[],this.refreshing=!1),1===this.objTypeValue?(this.loading=!0,this._queryProviderForVisit().then((function(e){e.hasNextPage?(t.loading=!1,t.page++):t.finished=!0}))):2===this.objTypeValue?(this.loading=!0,this._queryCustListByUserId().then((function(e){e.hasNextPage?(t.loading=!1,t.page++):t.finished=!0}))):3===this.objTypeValue&&(this.loading=!0,this._getGoverList())}},{key:"_queryPersonByCustId",value:function(t){var e=this;kt(t).then((function(t){"200"===t.code&&(e.personList=t.data)}))}},{key:"changeCust",value:function(t){this.staffMemberId="",this.staffMemberName="";var e={creId:localStorage.getItem("userId"),custId:t.custId,type:this.visitType};this._queryPersonByCustId(e),this.objId=t.custId,this.objName=t.custName,this.objShowPicker=!1}},{key:"changeProvider",value:function(t){this.staffMemberId="",this.staffMemberName="",this.personList=t.userList;for(var e=[],a=0;a<t.userList.length;a++){var s=t.userList[a];s.userId&&3!==s.isDel&&!s.oldOperationId&&e.push(s)}this.personList=[].concat(e),this.objId=t.cpiId,this.objName=t.providerName,this.objShowPicker=!1}},{key:"changeGover",value:function(t){this.staffMemberId="",this.staffMemberName="";var e={cgId:t.cgId,govAttributeid:"",orgnizationKeyword:"",pageNum:1,pageSize:1,ssqCode:"",useridList:[]};this._queryGovernmentUserMsg(e),this.objId=t.cgId,this.objName=t.govAttributeId+"/"+t.govAttributeName+"("+t.orgnizationName+")",this.objShowPicker=!1}},{key:"staffMemberChangeClick",value:function(){this.objId&&this.objName?this.staffMemberShow=!0:this.$toast.fail("请先选择单位信息")}},{key:"addSurePerson",value:function(){this.staffMemberShow=!1,this.staffMemberName="",this.staffMemberInforObj=[];for(var t=0;t<this.personList.length;t++)for(var e=this.personList[t],a=0;a<this.staffMemberInforList.length;a++){var s=this.staffMemberInforList[a];(e.USER_ID||e.userId)===s&&(this.staffMemberName+=e.CU_USER_NAME||e.userName,this.staffMemberName+=",",this.staffMemberInforObj.push({userId:e.USER_ID||e.userId,userName:e.CU_USER_NAME||e.userName,phoneNumber:e.CU_PHONE_NUM||e.phoneNum,hotid:+e.WARMTH_NUM||+e.warmthNum,starCheck:0,outsideCheck:this.addressValue?1:0,hotValue:1===+e.WARMTH_NUM||1===+e.warmthNum?"业务员一般客情":2===+e.WARMTH_NUM||3===+e.warmthNum?"需要进阶的客情":3===+e.WARMTH_NUM||3===+e.warmthNum?"从未接触的客情":"请选择热力值信息",remarkValueList:[{labelId:"",labelValue:"",labelRemark:"",expectTimeStr:""}],needLabelValueObj:[]}))}console.log(this.staffMemberInforObj)}},{key:"personCheckChange",value:function(){console.log(this.staffMemberInforList)}},{key:"personCheckClick",value:function(t){console.log(this.staffMemberInforList),console.log(t)}},{key:"visitUserChange",value:function(){this.visitUserShow=!0,this._getUserByParams({leaderFlag:!1})}},{key:"_getUserByParams",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.visitUserLoading=!0,Ii(e).then((function(t){"200"===t.code?a.userOptions=t.data:a.$toast.fail(t.msg),a.visitUserLoading=!1}));case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"searchPersonInput",value:function(t){this.$cancelAxios(["getUserByParams"]),this._getUserByParams({keyword:t})}},{key:"changeVisitUser",value:function(t){this.visitUserId=t.userId,this.visitUserName=t.userName,this.visitUserShow=!1}},{key:"labelTreeItemClick",value:function(t){this.labelShow=!1,this.staffMemberInforObj[this.activeName].remarkValueList[this.changeLabelIndex].labelId!==t.LABEL_ID&&(this.staffMemberInforObj[this.activeName].remarkValueList[this.changeLabelIndex].labelId=t.LABEL_ID,this.staffMemberInforObj[this.activeName].remarkValueList[this.changeLabelIndex].labelValue=t.LABEL_NAME,this.staffMemberInforObj[this.activeName].remarkValueList[this.changeLabelIndex].expectTimeStr="")}},{key:"deleteItemClick",value:function(t){1===this.staffMemberInforObj[this.activeName].remarkValueList.length?(this.changeLabelIndex=0,this.staffMemberInforObj[this.activeName].remarkValueList=[{labelId:"",labelValue:"",labelRemark:"",expectTimeStr:""}]):(this.changeLabelIndex=t,this.staffMemberInforObj[this.activeName].remarkValueList.splice(t,1))}},{key:"addCustomList",value:function(){this.staffMemberInforObj[this.activeName].remarkValueList.push({labelId:"",labelValue:"",labelRemark:"",expectTimeStr:""})}},{key:"addCustomSure",value:function(){for(var t=0;t<this.staffMemberInforObj[this.activeName].remarkValueList.length;t++){var e=this.staffMemberInforObj[this.activeName].remarkValueList[t];if(!e.labelId)return this.customerLabelShow=!0,void this.$toast.fail({message:"事件分类未全部维护",position:"top"})}this.staffMemberInforObj[this.activeName].needLabelValueObj=Object(y["a"])(this.staffMemberInforObj[this.activeName].remarkValueList),this.customerLabelShow=!1}},{key:"adressOnConfirm",value:function(t){if(!t)return this.addressValue="",this.addressDeatilValue="",void(this.showAdressPicker=!1);this.addressValue=t.cciId,this.addressDeatilValue=t.cciId+"/"+t.address,this.showAdressPicker=!1}},{key:"adressChangeClick",value:function(){this.showAdressPicker=!0}},{key:"clockInClick",value:function(){this.init("click")}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$cancelAxios(["getSign"]),this.wxRegister(t)}},{key:"wxRegister",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=location.href.split("#")[0],s={url:a};K(s).then((function(a){var s=a.data;B["a"].config({debug:!1,appId:"ww2170b959e5dac682",timestamp:s.timestamp,nonceStr:s.nonceStr,signature:s.signature,jsApiList:["getLocation"]}),B["a"].error((function(t){console.log(t)})),B["a"].ready((function(){B["a"].getLocation({type:"gcj02",success:function(a){console.log(a),t.getPositionByLonLats(a.longitude,a.latitude,e)},cancel:function(t){console.log(t),console.log("用户拒绝授权获取地理位置"),alert("用户拒绝授权获取地理位置")}})}))})).catch((function(t){console.log(t)}))}},{key:"getPositionByLonLats",value:function(t,e){var a=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=window.AMap,n=[t,e];i.service("AMap.Geocoder",(function(){var r=new i.Geocoder({});r.getAddress(n,(function(i,n){if("complete"===i&&"OK"===n.info){var r=n.regeocode.formattedAddress;if("click"===s){var o={address:r,latitude:e,longitude:t,city:n.regeocode.addressComponent.city,province:n.regeocode.addressComponent.province};a._insCrmClockIn(o,r)}}}))}))}},{key:"_insCrmClockIn",value:function(t,e){var a=this,s=this.$toast.loading({message:"打卡中...",duration:0,forbidClick:!0});J(t).then((function(t){"200"===t.code&&(a.addressValue=t.data,a.addressDeatilValue=t.data+"/"+e,a.$toast.success("打卡成功")),s.clear()}))}},{key:"addressTypeChange",value:function(){var t=this;this.addressValue||this.addressDeatilValue?this.$dialog.confirm({title:"提示",message:"切换关联定位类型将清空已选或者已打卡位置信息，确定要切换吗？",beforeClose:function(e,a){"confirm"===e?(t.addressValue="",t.addressDeatilValue="",a()):a()}}):(this.addressValue="",this.addressDeatilValue="")}},{key:"addressSearchValueInput",value:function(){this._getCrmClockIn()}},{key:"_getCrmClockIn",value:function(){var t=this;this.getCrmClockInLoading=!0;var e={detailFlag:!1,startTime:this.addresschangeTime,keyword:this.addressSearchValue};wt(e).then((function(e){"200"===e.code&&(t.clickInList=e.data),t.getCrmClockInLoading=!1}))}},{key:"mounted",value:function(){this._getCrmClockIn()}},{key:"onAddressValueChanged",value:function(t){var e=this;t&&this.staffMemberInforObj.length>0&&this.staffMemberInforObj.map((function(t){e.$set(t,"outsideCheck",1)}))}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Wo.prototype,"maplabelTreeList",void 0),Object(u["a"])([Object(d["d"])("addressValue")],Wo.prototype,"onAddressValueChanged",null),Wo=Object(u["a"])([Object(d["a"])({})],Wo);var Bo=Wo,Go=Bo,Ho=(a("dea5"),Object(V["a"])(Go,Fo,zo,!1,null,"581300d8",null)),Yo=Ho.exports,Qo=Object(h["b"])("commonStore"),Ko=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.depPersonShow=!1,t.personMsg="我的客情",t.nowOrClickYear=-1,t.nowOrClickMonth=-1,t.nowClickDay=new Date,t.calendarShow=!1,t.nowdataList=[],t.dateRange=[],t.chooseDate=[],t.getUserVisitLoading=!1,t.tableDataList=[],t.userIdList=[],t.userIdDetailList=[],t.bowClickFllObj="",t.crmVisitCommentShow=!1,t.visitCommentMsg="",t.finished=!1,t.refreshing=!1,t.page=1,t.customerLabelShow=!1,t.maplabelTreeList=[],t.labelTreeList=[],t.labelValueObj=[{labelId:"",labelName:"",remark:"",expectTimeStr:""}],t.activeIndex=0,t.labelShow=!1,t.changeLabelIndex=0,t.showAdressPicker=!1,t.clickInList=[],t.nowClickObj={},t.nowChangeClickIndex="",t}return Object(o["a"])(a,[{key:"changeDate",value:function(){this.calendarShow=!0}},{key:"initDay",value:function(t){this.nowClickDay=t,this.nowOrClickYear=new Date(t).getFullYear(),this.nowOrClickMonth=new Date(t).getMonth()+1,this.nowdataList=Qs(Hs(t),Ys(t)),this.dateRange=[new Date(Hs(t)),new Date(Ys(t))],this.chooseDate=[Gs(t)],this.getUserVisitLoading=!1,this.finished=!1,this.refreshing=!1,this.page=1,this.tableDataList=[],this._getUserVisit()}},{key:"clickChange",value:function(t){this.initDay(new Date(t))}},{key:"preWeek",value:function(){var t=new Date(this.nowClickDay);this.nowClickDay.setTime(t.getTime()-6048e5),this.nowdataList=Qs(Hs(this.nowClickDay),Ys(this.nowClickDay)),this.initDay(this.nowClickDay)}},{key:"nextWeek",value:function(){var t=new Date(this.nowClickDay);this.nowClickDay.setTime(t.getTime()+6048e5),this.nowdataList=Qs(Hs(this.nowClickDay),Ys(this.nowClickDay)),this.initDay(this.nowClickDay)}},{key:"back",value:function(){this.$router.back()}},{key:"calendarConfirm",value:function(t){this.calendarShow=!1,this.initDay(t)}},{key:"selectCalendar",value:function(t){this.calendarConfirm(t[0])}},{key:"backToday",value:function(){this.initDay(new Date)}},{key:"backMine",value:function(){this.userIdList=[],this.userIdDetailList=[],this.refreshing=!0,this.onRefresh()}},{key:"checkSureClick",value:function(t){this.userIdDetailList=t.getpersonDetailList,this.userIdList=t.personCheckList,this.refreshing=!0,this.onRefresh(),this.depPersonShow=!1}},{key:"closeDepPerson",value:function(){this.depPersonShow=!1}},{key:"depPersonClick",value:function(){this.depTreeList&&0!==this.depTreeList.length&&(this.depPersonShow=!0)}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.tableDataList=[],this.refreshing=!1),this._getUserVisit()}},{key:"onRefresh",value:function(){this.finished=!1,this.getUserVisitLoading=!0,this.onLoad()}},{key:"_getUserVisit",value:function(){var t=this;1===this.page&&(this.tableDataList=[]),this.getUserVisitLoading=!0,this.$cancelAxios(["getUserVisit"]),console.log(this.nowClickDay);var e={startTime:Gs(this.nowClickDay)+" 00:00:00",endTime:Gs(this.nowClickDay)+" 23:59:59",pageNum:this.page,pageSize:2,userIdList:0===this.userIdList.length?[localStorage.getItem("userId")]:this.userIdList};vt(e).then((function(e){"200"===e.code?(t.tableDataList=e.data.list.length>0?t.tableDataList.concat(e.data.list):t.tableDataList,e.data.hasNextPage?t.page++:t.finished=!0):(t.finished=!0,t.$toast.fail(e.msg)),t.getUserVisitLoading=!1}))}},{key:"addVisitComment",value:function(t){this.bowClickFllObj=t,this.crmVisitCommentShow=!0}},{key:"addFllowClick",value:function(){var t=this.$refs.addFlloeDetail;t.addFllowShow=!0}},{key:"confirmDialog",value:function(t,e){if(console.log(t),"confirm"===t){if(!this.visitCommentMsg)return void this.$toast.fail("请输入批注");var a=[{commentRemark:this.visitCommentMsg,cuvId:this.bowClickFllObj.cuvId,cvcId:this.bowClickFllObj.cvcId}];this._insOrUpdComment(a,e)}else e()}},{key:"_insOrUpdComment",value:function(t,e){var a=this;bt(t).then((function(t){"200"===t.code?(a.$toast.success(t.msg),a.crmVisitCommentShow=!1,a._getUserVisit(),a.visitCommentMsg="",e()):a.$toast.fail(t.msg)}))}},{key:"addConfirmDialog",value:function(t){var e=this;"confirm"===t.action?ft(t.params).then((function(a){if("200"===a.code){e.$toast.success(a.msg);var s=e.$refs.addFlloeDetail;s.addFllowShow=!1,e.initDay(s.changeTime.replace(/-/g,"/")),s.objTypeValue=-1,s.objId="",s.objName="",s.staffMemberId="",s.staffMemberName="",s.visitType="1",s.visitUserId="",s.visitUserName="",s.activeIndex=0,s.starCheck=!1,s.outsideCheck=!1,s.changeTime="",s.phoneNum="",s.hotValue="",s.staffMemberInforObj=[],s.labelValueObj=[{labelId:"",labelValue:"",labelRemark:"",expectTimeStr:""}],t.done()}else e.$toast.fail(a.msg),t.done()})):t.done()}},{key:"editRemark",value:function(t){this.bowClickFllObj=t,this.labelValueObj=t.crmLabelRemarkDtoList,this.customerLabelShow=!0}},{key:"deleteItemClick",value:function(t){1===this.labelValueObj.length?(this.changeLabelIndex=0,this.labelValueObj=[{labelId:"",labelName:"",remark:"",expectTimeStr:""}]):(this.changeLabelIndex=t,this.labelValueObj.splice(t,1))}},{key:"addCustomList",value:function(){this.labelValueObj.push({labelId:"",labelName:"",remark:"",expectTimeStr:""})}},{key:"addCustomSure",value:function(){for(var t=this,e=0;e<this.labelValueObj.length;e++){var a=this.labelValueObj[e];if(!a.labelId)return this.customerLabelShow=!0,void this.$toast.fail({message:"事件分类未全部维护",position:"top"})}this.customerLabelShow=!1;for(var s=0;s<this.labelValueObj.length;s++){var i=this.labelValueObj[s];i.cuvId||Object.assign(i,{cuvId:this.bowClickFllObj.cuvId}),Object.assign(i,{isSign:!1,userIdList:[],isSyncToTopic:!0})}gt(this.labelValueObj).then((function(e){"200"===e.code?(t.$toast.success(e.msg),t.onRefresh()):t.$toast.fail(e.msg)})),console.log(this.labelValueObj)}},{key:"mapLabelTree",value:function(){for(var t=0;t<this.labelTreeList.length;t++){var e=this.labelTreeList[t];e.CHILD_LIST?this.maplabelTreeList.push({text:e.LABEL_NAME,index:t,id:e.LABEL_ID,children:e.CHILD_LIST}):this.maplabelTreeList.push({text:e.LABEL_NAME,id:e.LABEL_ID})}}},{key:"_getLabelTree",value:function(){var t=this,e={type:"1"};Ct(e).then((function(e){t.labelTreeList=e.data,t.mapLabelTree()}))}},{key:"labelTreeItemClick",value:function(t){this.labelShow=!1,this.labelValueObj[this.changeLabelIndex].labelId!==t.LABEL_ID&&(this.labelValueObj[this.changeLabelIndex].labelId=t.LABEL_ID,this.labelValueObj[this.changeLabelIndex].labelName=t.LABEL_NAME,this.labelValueObj[this.changeLabelIndex].expectTimeStr="")}},{key:"handleRelateClockIn",value:function(t){this.showAdressPicker=!0,this.nowClickObj=t;for(var e=0;e<this.clickInList.length;e++){var a=this.clickInList[e];t.cciId===a.cciId&&(this.nowChangeClickIndex=e)}}},{key:"_getCrmClockIn",value:function(t){var e=this;wt(t).then((function(t){"200"===t.code&&(e.clickInList=t.data)}))}},{key:"onConfirm",value:function(t){console.log(t);var e={cciId:t.cciId,cuvId:this.nowClickObj.cuvId};this._relateClockIn(e,t)}},{key:"_relateClockIn",value:function(t,e){var a=this;Lt(t).then((function(t){"200"===t.code?(a.$toast.success(t.msg),a.showAdressPicker=!1,a.$set(a.nowClickObj,"cciId",e.cciId),a.$set(a.nowClickObj,"address",e.address),a.$set(a.nowClickObj,"latitude",e.latitude),a.$set(a.nowClickObj,"longitude",e.longitude)):a.$toast.fail(t.msg)}))}},{key:"addStarClick",value:function(t){var e=this;this.$dialog.confirm({title:"确认",message:"确定要将当前拜访记录提升为星标事件吗？"}).then((function(){yt({cuvId:t}).then((function(t){"200"===t.code?(e.$toast.success(t.msg),e.onRefresh()):e.$toast.fail(t.msg)}))}))}},{key:"mounted",value:function(){this._getLabelTree(),this.nowOrClickYear=(new Date).getFullYear(),this.nowOrClickMonth=(new Date).getMonth()+1,this.nowdataList=Qs(Hs(new Date),Ys(new Date)),this.dateRange=[new Date(Hs(new Date)),new Date(Ys(new Date))],this.chooseDate=[Gs(new Date)],this.depTreeList||this.actionGetDepTree({treeType:1,authorizedFlag:!0});var t={detailFlag:!1,startTime:"",keyword:""};this._getCrmClockIn(t)}}]),a}(d["c"]);Object(u["a"])([Qo.Action],Ko.prototype,"actionGetDepTree",void 0),Object(u["a"])([h["a"]],Ko.prototype,"depTreeList",void 0),Ko=Object(u["a"])([Object(d["a"])({components:{depPerson:Ei,addfllowDetail:Yo}})],Ko);var Jo=Ko,Xo=Jo,Zo=(a("4186"),Object(V["a"])(Xo,Vo,Uo,!1,null,"1656a138",null)),tc=Zo.exports,ec=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flloMsgDetail"},[a("div",{staticClass:"flloMsgDetailHeader"},[t._v(" 拜访记录详情 "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.cuvId,expression:"cuvId"}],staticClass:"right"},[t._v("id："+t._s(t.cuvId))])]),t.flloMsgDetail?a("ul",{staticClass:"flloMsgDetailContent"},[a("li",{staticClass:"taskType clearfix"},[t.flloMsgDetail.isRaisedStarFlag?t._e():a("van-icon",{staticClass:"left",attrs:{name:"star-o"},on:{click:function(e){return t.addStarClick(t.flloMsgDetail.cuvId)}}}),t._l(t.flloMsgDetail.starFlag,(function(t){return a("van-icon",{key:t,staticClass:"left",attrs:{name:"star"}})})),0===t.flloMsgDetail.whetherLegwork?a("i",{staticClass:"left always iconfont ytcrm-zaigangguanli"}):t._e(),1===t.flloMsgDetail.whetherLegwork?a("i",{staticClass:"left need iconfont ytcrm-waiqin"}):t._e(),a("span",{staticClass:"right time"},[t._v(" "+t._s(t.flloMsgDetail.visitTime&&t.flloMsgDetail.visitTime.substring(0,t.flloMsgDetail.visitTime.length-3))+" ")])],2),a("li",{staticClass:"header"},[t._v(" "+t._s(t.flloMsgDetail.companyName)+" "),a("span",{staticClass:"type fontWeight"},[t._v("("+t._s(1===t.flloMsgDetail.companyType?"供应商":2===t.flloMsgDetail.companyType?"下游客户":3===t.flloMsgDetail.companyType?"政府单位":"")+")")])]),a("li",{staticClass:"person clearfix"},[a("span",{staticClass:"value left"},[t._v(" "+t._s(t.flloMsgDetail.visitUserName)+" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.flloMsgDetail.visitUserPosition,expression:"flloMsgDetail.visitUserPosition"}]},[t._v("（"+t._s(t.flloMsgDetail.visitUserPosition)+"）")])]),1===t.flloMsgDetail.warmthNum?a("van-icon",{staticClass:"always left",attrs:{name:"smile"}}):t._e(),2===t.flloMsgDetail.warmthNum?a("van-icon",{staticClass:"need left",attrs:{name:"clock"}}):t._e(),3===t.flloMsgDetail.warmthNum?a("van-icon",{staticClass:"never left",attrs:{name:"warning"}}):t._e()],1),a("li",{directives:[{name:"show",rawName:"v-show",value:t.flloMsgDetail.crmLabelRemarkDtoList&&t.flloMsgDetail.crmLabelRemarkDtoList.length>=0,expression:"flloMsgDetail.crmLabelRemarkDtoList && flloMsgDetail.crmLabelRemarkDtoList.length >= 0"}],staticClass:"crmLabelRemarkDtoList"},[a("p",{staticClass:"crmLabelRemarkHeader"},[t._v("客情事件：")]),t._l(t.flloMsgDetail.crmLabelRemarkDtoList,(function(e,s){return a("p",{key:s},[a("span",{staticClass:"title"},[t._v(" "+t._s(e.labelName)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.expectTimeStr,expression:"crmLabelRemarkitem.expectTimeStr"}],staticClass:"time"},[t._v("("+t._s(e.expectTimeStr)+")")]),t._v(" : ")]),a("span",{staticClass:"value"},[t._v(t._s(e.remark))])])}))],2),t.flloMsgDetail.crmVisitCommentDtoList&&t.flloMsgDetail.crmVisitCommentDtoList.length>0?a("li",{staticClass:"crmVisitCommentDtoList"},[t._m(0),t._l(t.flloMsgDetail.crmVisitCommentDtoList,(function(e,s){return a("p",{key:s,staticClass:"crmVisitItem"},[a("span",{staticClass:"value"},[a("span",{staticClass:"title"},[t._v("内容:")]),t._v(" "+t._s(e.commentRemark)+" ")]),a("span",{staticClass:"personValue"},[a("span",{staticClass:"title"},[t._v("批注人:")]),t._v(" "+t._s(e.creId)+"/"+t._s(e.creName)+" "),a("i",{staticClass:"time right"},[t._v(t._s(e.credate&&e.credate.substring(0,e.credate.length-3)))])])])}))],2):a("li",{staticClass:"crmVisitCommentDtoList"},[t._m(1)]),a("li",{staticClass:"taskWarp clearfix"},[a("span",{staticClass:"value left"},[a("span",{staticClass:"title"},[t._v(t._s(1===t.flloMsgDetail.taskType?"个人:":2===t.flloMsgDetail.taskType?"协访人：":(t.flloMsgDetail.taskType,"")))]),t.flloMsgDetail.togetherUserId&&2===t.flloMsgDetail.taskType?a("span",[t._v(t._s(t.flloMsgDetail.togetherUserId)+"/"+t._s(t.flloMsgDetail.togetherUserName))]):1===t.flloMsgDetail.taskType?a("span",[t._v("自己拜访")]):3===t.flloMsgDetail.taskType?a("span",{staticClass:"fontWeight",staticStyle:{color:"#faab0c"}},[t._v("接待")]):t._e()])]),a("li",{staticClass:"addressWarp"},[a("p",{staticClass:"adressHeader fontWeight"},[t._v(" 定位信息： ")]),t.flloMsgDetail.cciId?a("p",[t._v(t._s(t.flloMsgDetail.cciId)+"/"+t._s(t.flloMsgDetail.address))]):a("p",[t._v("暂无定位信息")])])]):t._e()])},ac=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"visCommentHeader "},[a("span",{staticClass:"fontWeight"},[t._v("批注信息")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"value"},[a("span",{staticClass:"title"},[t._v("批注:")]),t._v(" 暂无 ")])}],sc=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.cuvId="",t.flloMsgDetail="",t}return Object(o["a"])(a,[{key:"_getUserVisit",value:function(t){var e=this;vt({cuvId:t}).then((function(t){console.log(t),"200"===t.code&&(e.flloMsgDetail=t.data.list[0])}))}},{key:"addStarClick",value:function(t){var e=this;this.$dialog.confirm({title:"确认",message:"确定要将当前拜访记录提升为星标事件吗？"}).then((function(){yt({cuvId:t}).then((function(a){"200"===a.code?(e.$toast.success(a.msg),e._getUserVisit(t)):e.$toast.fail(a.msg)}))}))}},{key:"mounted",value:function(){this.cuvId=this.$route.query.cuvid,console.log(this.$route.query),this._getUserVisit(this.cuvId)}}]),a}(d["c"]);sc=Object(u["a"])([Object(d["a"])({})],sc);var ic=sc,nc=ic,rc=(a("ea45"),Object(V["a"])(nc,ec,ac,!1,null,"aa8f49a4",null)),oc=rc.exports,cc=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task"},[a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"task-loading",attrs:{type:"spinner",color:"#1989fa"}})],1)},lc=[],uc=Object(h["b"])("commonStore"),dc=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.detail=t.$route.params.item,t.detailType=t.$route.params.detailType,t.loading=!1,t.replyContent="",t.orderTypeList=["","部门","标签","小组"],t.showSendDetail=!1,t.active=0,t.depTreeList=[],t.groupTreeList=[],t}return Object(o["a"])(a,[{key:"getDetail",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,ne({csoId:this.$route.query.csoId,userId:this.$route.query.userId});case 3:if(e=t.sent,this.loading=!1,!e.success){t.next=16;break}if(1!==e.data.useStatus){t.next=13;break}return this.loading=!0,t.next=10,ee({csodId:e.data.csodId});case 10:a=t.sent,this.loading=!1,a.success&&(e.data.useStatus=2);case 13:this.SET_TASKDETAILINFO({type:2,csoId:this.$route.query.csoId}),localStorage.setItem("taskDetailInfo",JSON.stringify({type:2,csoId:this.$route.query.csoId})),this.$router.replace({path:"/task/detail",query:{userId:this.$route.query.userId,isMsg:"1"}});case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.getDetail()}}]),a}(d["c"]);Object(u["a"])([uc.Mutation],dc.prototype,"SET_TASKDETAILINFO",void 0),dc=Object(u["a"])([Object(d["a"])({})],dc);var hc=dc,pc=hc,mc=(a("2076"),Object(V["a"])(pc,cc,lc,!1,null,"455207d8",null)),vc=mc.exports,fc=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plaintextLogin"},[a("van-form",{on:{submit:t.onSubmit}},[a("van-field",{attrs:{name:"username",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),a("van-field",{attrs:{type:"password",name:"password",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),a("div",{staticStyle:{margin:"16px"}},[a("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"}},[t._v("提交")])],1)],1)],1)},gc=[],bc=Object(h["b"])("user"),yc=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.username="",t.password="",t}return Object(o["a"])(a,[{key:"onSubmit",value:function(t){var e=this;localStorage.clear(),console.log("submit",t);var a={userCode:t.username,password:t.password};et(a).then((function(t){console.log(t),localStorage.setItem("tokenValue",t.data.token),localStorage.setItem("userId",t.data.userId),localStorage.setItem("userCode",t.data.userCode),localStorage.setItem("userName",t.data.userName),localStorage.setItem("headImgUrl",t.data.headImgUrl);for(var a=[],s=0;s<t.data.resListTree.length;s++){var i=t.data.resListTree[s];2===i.plantformType&&("首页"!==i.pmsName||i.children)&&a.push(i)}localStorage.setItem("menuTree",JSON.stringify(a)),e.SET_INFORMATION(t.data),e.$router.replace({path:a[0].path}),location.reload()}))}}]),a}(d["c"]);Object(u["a"])([bc.Mutation],yc.prototype,"SET_INFORMATION",void 0),yc=Object(u["a"])([Object(d["a"])({})],yc);var _c=yc,kc=_c,Cc=(a("09cd"),Object(V["a"])(kc,fc,gc,!1,null,"4049da04",null)),wc=Cc.exports,Lc=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customerHotSit"},[a("ul",{staticClass:"title"},[a("li",{staticClass:"text fontWeight"},[t._v("CRM客情热力情况")]),a("li",{staticClass:"depTime"},[t._v(" "+t._s(t.wxList.depName)+" "),a("i",{staticClass:"right"},[t._v(t._s(t.wxList.creTime))])])]),a("div",{staticClass:"mainWarp"},[a("ul",{staticClass:"weekPlan borderHas"},[t._m(0),a("li",{staticStyle:{flex:"6"}},[a("span",{staticClass:"left fontWeight"},[t._v("本周部门计划"+t._s(t.wxList.isFinishPlan?"已":"未")+"完毕")]),a("van-icon",{attrs:{name:t.wxList.isFinishPlan?"certificate":"close"}})],1)]),a("ul",{staticClass:"hasActive"},[t._m(1),a("li",{staticClass:"text",staticStyle:{flex:"6"}},[a("span",{staticClass:"left fontWeight"},[t._v(" 累计已激活客户单位 "),a("i",[t._v(t._s(t.wxList.actCust))]),t._v(" 家 ")]),a("span",{staticClass:"left fontWeight"},[t._v(" 累计已激活客户⼈员 "),a("i",[t._v(t._s(t.wxList.actPerson))]),t._v(" 名 ")])])]),a("ul",{staticClass:"postionNum borderHas"},[a("li",[a("p",[t._v(" 院⻓/供应 商⾼层/政 府正处及 以上 "),a("span",[a("i",{staticClass:"number"},[t._v(t._s(t.wxList.aGrade))]),t._v(" 名 ")])])]),a("li",[a("p",[t._v(" 副院⻓、副 书记/⼤区 经理/政府 副处级 "),a("span",[a("i",{staticClass:"number"},[t._v(t._s(t.wxList.bGrade))]),t._v(" 名 ")])])]),a("li",[a("p",[t._v(" 主任/商务、 销售经理/ 政府机构副 科以上 "),a("span",[a("i",{staticClass:"number"},[t._v(t._s(t.wxList.cGrade))]),t._v(" 名 ")])])]),a("li",[a("p",[t._v(" 主任/商务、 销售经理/ 政府机构副 科以上 "),a("span",[a("i",{staticClass:"number"},[t._v(t._s(t.wxList.dGrade))]),t._v(" 名 ")])])])]),a("ul",{staticClass:"cover borderHas"},[a("li",{staticClass:"iconWarp"},[t._m(2),a("p",{staticClass:"fontWeight",staticStyle:{"text-align":"right","padding-right":"10px"}},[a("i",{staticClass:"number"},[t._v(t._s(100*(t.wxList.actCust/t.wxList.allCust).toFixed(4)))]),t._v(" % ")]),a("p",{staticStyle:{"font-size":"12px"}},[t._v("还有"+t._s(t.wxList.allCust-t.wxList.actCust)+"家客户单位未维护。")])]),a("li",{staticClass:"customSys"},[a("p",{staticClass:"fontWeight"},[a("span",[t._v("⼀般客情")]),a("span",{staticClass:"right"},[a("i",[t._v(t._s(t.wxList.normal))]),a("span",[t._v("名")])])]),a("p",{staticClass:"fontWeight"},[a("span",[t._v("需进阶客情")]),a("span",{staticClass:"right"},[a("i",[t._v(t._s(t.wxList.lack))]),a("span",[t._v("名")])])]),a("p",{staticClass:"fontWeight"},[a("span",[t._v("未接触客情")]),a("span",{staticClass:"right"},[a("i",[t._v(t._s(t.wxList.never))]),a("span",[t._v("名")])])])])]),a("ul",{staticClass:"customLogs borderHas"},[t._m(3),a("li",{staticClass:"text",staticStyle:{flex:"6"}},[a("span",{staticClass:"left fontWeight"},[t._v(" 累计已收到客情⽇志 "),a("i",[t._v(t._s(t.wxList.custViewCount))]),t._v(" 条 ")]),a("span",{staticClass:"left fontWeight"},[t._v(" 涉及客户单位 "),a("i",[t._v(t._s(t.wxList.custCount))]),t._v(" 家， "),a("i",[t._v(t._s(t.wxList.personCount))]),t._v(" 人 ")]),a("span",{staticClass:"left fontWeight"},[t._v(" 星标事件 "),a("i",[t._v(t._s(t.wxList.starCount))]),t._v(" 条，请注意查阅。 ")]),a("span",{staticClass:"left fontWeight"},[t._v("上周反映最多话题为：")]),t.wxList&&0===t.wxList.topicRankList.length?a("span",{staticClass:"left twoLine"},[t._v("暂无话题")]):t._e(),t._l(t.showAll?t.wxList.topicRankList:t.wxList.topicRankList.slice(0,4),(function(e,s){return a("span",{key:s,staticClass:"left oneLine fontWeight"},[t._v(" "+t._s(e.smallTagName)+" "+t._s(e.num)+"条 ")])})),t.wxList.topicRankList&&t.wxList.topicRankList.length>4?a("van-icon",{staticClass:"left oneLine",attrs:{name:t.showAll?"arrow-up":"arrow-down"},on:{click:function(e){t.showAll=!t.showAll}}}):t._e()],2)]),a("ul",{staticClass:"workOutside borderHas"},[t._m(4),a("li",{staticClass:"text",staticStyle:{flex:"7"}},[a("span",{staticClass:"left fontWeight",staticStyle:{width:"100%"}},[t._v(" 上周团队成员外勤打卡 "),a("i",[t._v(t._s(t.wxList.legWorkCount))]),t._v(" 次 ")]),t.wxList&&t.wxList.legWorkAddress.length>0?a("span",{staticClass:"left fontWeight",staticStyle:{width:"100%"}},[t._v(" 曾到过 "),a("span",{staticClass:"place"},[t._v(t._s(t.wxList&&t.wxList.legWorkAddress.join(",")))]),t._v(" 等。 ")]):t._e()])]),a("ul",{staticClass:"ranking borderHas"},[t._m(5),a("li",{staticClass:"text",staticStyle:{flex:"7"}},[a("span",{staticClass:"left fontWeight"},[t._v(" 累计部门总分 "),a("i",[t._v(t._s(t.wxList.score))]),t.wxList.rank?a("span",[t._v(" ，排名第 "),a("i",[t._v(t._s(t.wxList.rank))]),t._v(" 名。 ")]):t._e()])])])])])},xc=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",[a("i",{staticClass:"iconfont ytcrm-richeng"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"iconWarp"},[a("i",{staticClass:"iconfont ytcrm-qingkuangfanying"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"fontWeight"},[a("i",{staticClass:"iconfont ytcrm-fugai"}),t._v(" 累计 客户覆盖程度 ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"iconWarp"},[a("i",{staticClass:"iconfont ytcrm-rizhi"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"iconWarp"},[a("i",{staticClass:"iconfont ytcrm-tubiao"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"iconWarp"},[a("i",{staticClass:"iconfont ytcrm-jinpai"})])}],Ic=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.wxList="",t.showAll=!1,t}return Object(o["a"])(a,[{key:"_queryWx",value:function(){var t=this;console.log(this.$route.query);var e=this.$toast.loading({message:"加载中...",forbidClick:!0});Ti({messageId:this.$route.query.messageId||386}).then((function(a){t.wxList=a.data,e.clear()}))}},{key:"mounted",value:function(){this._queryWx()}}]),a}(d["c"]);Ic=Object(u["a"])([Object(d["a"])({})],Ic);var Sc=Ic,Dc=Sc,Oc=(a("ec83"),Object(V["a"])(Dc,Lc,xc,!1,null,"34604137",null)),jc=Oc.exports,Tc=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"twoPinDic"},[a("div",{staticClass:"btnWarp right"},[a("i",{staticClass:"iconfont ytcrm-center left",on:{click:function(e){return t.$router.back()}}})]),t.entryChange?a("div",{staticClass:"entryChange"},[a("div",{staticClass:"entryChange-header fontWeight"},[t._v(" 请选择核算单元进入 ")]),a("ul",{staticClass:"entryValue"},t._l(t.entryList,(function(e){return a("van-cell",{key:e.entryid,attrs:{title:e.entryname,"is-link":""},on:{click:function(a){return t.entryChangeClick(e)}}})})),1)]):a("div",{staticClass:"twoPinDicWarp"},[a("i",{staticClass:"entryNum left"},[t._v(t._s(t.chooseEntry.entryId)+"/"+t._s(t.chooseEntry.entryName))]),a("div",{staticClass:"twoPinDicHeader clearfix"},[a("div",{staticClass:"iconWarp left",on:{click:t.menuChangeClick}},[a("van-icon",{attrs:{name:"wap-nav"}})],1),a("tab-switch",{staticClass:"left",attrs:{menuList:["按客户下单","二销目录","订单查询"],tabActiveIndex:t.tabActiveIndex},on:{tabClick:t.tabClick}}),a("div",{staticClass:"searchWarp left"},[a("van-search",{directives:[{name:"show",rawName:"v-show",value:2!==t.tabActiveIndex,expression:"tabActiveIndex !== 2"}],attrs:{"show-action":"",shape:"round",placeholder:0===t.tabActiveIndex?"请输入客户ID|名称":"请输入货品ID|名称"},on:{search:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}}),a("li",{directives:[{name:"show",rawName:"v-show",value:2===t.tabActiveIndex,expression:"tabActiveIndex === 2"}],staticClass:"clearfix",staticStyle:{padding:"10px"}},[a("van-button",{staticClass:"right",attrs:{"icon-position":"right",icon:"arrow-down",size:"mini",plain:"",hairline:"",type:"info"},on:{click:t.superFliter}},[t._v("高级搜索")]),a("van-button",{staticClass:"right",staticStyle:{"margin-right":"10px"},attrs:{size:"mini",plain:"",hairline:"",type:"warning"},on:{click:t.clearFliter}},[t._v("清除筛选条件")])],1)],1)],1),a("div",{staticClass:"twoPinMainWarp"},[1===t.tabActiveIndex?a("van-tabs",{attrs:{type:"card",color:"rgba(35, 98, 251, 0.6)"},on:{change:t.dirTypeTabClick}},t._l(["全部","近效期","待处理"],(function(t,e){return a("van-tab",{key:t,attrs:{title:t,name:0===e?"":e+1}})})),1):t._e(),a("div",{ref:"goodsCustomWarp",staticClass:"warp",style:0===t.tabActiveIndex||2===t.tabActiveIndex?"height:100%;":""},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.getDataLoading,callback:function(e){t.getDataLoading=e},expression:"getDataLoading"}},[0===t.tabActiveIndex?a("customer-list",{attrs:{customList:t.customList},on:{chooseCustomClick:t.chooseCustomClick}}):t._e(),1===t.tabActiveIndex?a("twopin-goods",{attrs:{isResell:!0,goodsDataList:t.goodsList},on:{goodsClick:t.goodsClick}}):t._e(),2===t.tabActiveIndex?a("orderquery-list",{ref:"orderqueryList",attrs:{orderList:t.orderList}}):t._e()],1)],1)],1)],1)]),a("van-popup",{style:{width:"60%",height:"100%"},attrs:{position:"left"},model:{value:t.menuChangeShow,callback:function(e){t.menuChangeShow=e},expression:"menuChangeShow"}},[a("ul",{staticClass:"menuWarp"},[a("li",{staticClass:"menuWarpHeader"},[a("p",{staticClass:"nowChooseTitle"},[t._v("当前选择：")]),a("p",{staticClass:"nowChooseValue fontWeight"},[t._v(t._s(t.chooseEntry.entryId)+"/"+t._s(t.chooseEntry.entryName))])]),t._l(t.entryList,(function(e,s){return a("li",{key:e.entryid,staticClass:"menuWarpTab clearfix",class:"tabBg"+s%2,on:{click:function(a){return t.entryChangeClick(e)}}},[a("p",{staticClass:"menuWarpTabValue fontWeight"},[t._v(t._s(e.entryname))]),a("p",{staticClass:"menuWarpTabNow left"},[t._v("点击选择")])])}))],2)]),a("van-popup",{style:{width:"100%",height:"auto"},attrs:{position:"top",round:""},model:{value:t.filterShow,callback:function(e){t.filterShow=e},expression:"filterShow"}},[a("ul",{staticClass:"filterWarp"},[a("van-form",[a("van-field",{attrs:{name:"客户ID",label:"客户ID",placeholder:"客户ID"},model:{value:t.filterObj.customId,callback:function(e){t.$set(t.filterObj,"customId",e)},expression:"filterObj.customId"}}),a("van-field",{attrs:{name:"客户名称",label:"客户名称",placeholder:"客户名称"},model:{value:t.filterObj.customName,callback:function(e){t.$set(t.filterObj,"customName",e)},expression:"filterObj.customName"}}),a("van-field",{attrs:{readonly:"",clickable:"",name:"calendar",value:t.filterObj.starttime+" ~ "+t.filterObj.endtime,label:"时间范围",placeholder:"点击选择日期"},on:{click:function(e){t.calendarShow=!0}}}),a("van-calendar",{attrs:{type:"range","min-date":new Date(2020,0,1),"first-day-of-week":"1",color:"#1989fa"},on:{confirm:t.selectCalendar},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}}),a("div",{staticClass:"clearfix",staticStyle:{margin:"16px"}},[a("van-button",{staticClass:"left",staticStyle:{width:"49%"},attrs:{round:"",block:"",type:"default"},on:{click:t.clearFliter}},[t._v("重置")]),a("van-button",{staticClass:"right",staticStyle:{width:"49%"},attrs:{round:"",block:"",type:"info"},on:{click:t.filterSubmit}},[t._v("确定")])],1)],1)],1)])],1)},Rc=[],Nc=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tabSwitch"},t._l(t.menuList,(function(e,s){return a("div",{key:s,staticClass:"left",class:t.tabActiveIndex===s?"active":"",on:{click:function(a){return t.tabClick(s,e)}}},[t._v(" "+t._s(e[t.label]?e[t.label]:e)+" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.tabActiveIndex===s,expression:"tabActiveIndex === index"}],staticClass:"line"})])})),0)},Ac=[],Pc=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"tabClick",value:function(t,e){this.$emit("tabClick",{index:t,item:e})}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Pc.prototype,"tabActiveIndex",void 0),Object(u["a"])([Object(d["b"])()],Pc.prototype,"menuList",void 0),Object(u["a"])([Object(d["b"])({default:"label"})],Pc.prototype,"label",void 0),Pc=Object(u["a"])([Object(d["a"])({})],Pc);var Ec=Pc,Mc=Ec,$c=(a("4f56"),Object(V["a"])(Mc,Nc,Ac,!1,null,"1f471a66",null)),qc=$c.exports,Vc=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customerList"},t._l(t.customList,(function(e,s){return a("div",{key:e.customid+s,staticClass:"warp"},[e.contactList&&0!==e.contactList.length?a("van-collapse",{model:{value:t.twoPinActiveNames,callback:function(e){t.twoPinActiveNames=e},expression:"twoPinActiveNames"}},[a("van-collapse-item",{attrs:{name:e.customid},scopedSlots:t._u([{key:"title",fn:function(){return[a("ul",[a("li",{staticClass:"customerValue"},[t._v(t._s(e.customid)+"/"+t._s(e.customname))]),a("li",{staticClass:"customentryvalue"},[t._v(t._s(e.entryid)+"/"+t._s(e.entryname))])])]},proxy:!0}],null,!0)},t._l(e.contactList,(function(s,i){return a("van-cell",{key:s.CONTACTID+i,class:s.hasClick?"hasClick":"",attrs:{"is-link":""},on:{click:function(a){t.chooseCustomClick(Object.assign({customid:e.customid,customname:e.customname},s),s)}},scopedSlots:t._u([{key:"title",fn:function(){return[a("span",{style:s.dialyPass?"color: #AAA":""},[t._v(" "+t._s(s.CONTACTID+s.CONTACTMAN)+" "),a("br"),s.dialyPass?a("i",{staticClass:"fontSize-12 text-orange"},[t._v("最小效期为:"+t._s(new Date(s.miniTime).toLocaleDateString()))]):t._e()])]},proxy:!0}],null,!0)})})),1)],1):a("van-cell",{class:e.hasClick?"hasClick":"",attrs:{"is-link":""},on:{click:function(a){return t.chooseCustomClick(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[a("ul",[a("li",{staticClass:"customerValue"},[t._v(t._s(e.customid)+"/"+t._s(e.customname))]),a("li",{staticClass:"customentryvalue"},[t._v(t._s(e.entryid)+"/"+t._s(e.entryname))])])]},proxy:!0}],null,!0)})],1)})),0)},Uc=[],Fc=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.twoPinActiveNames=[],t}return Object(o["a"])(a,[{key:"chooseCustomClick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e){if(this.$set(e,"hasClick",!0),e.dialyPass)return void this.$dialog.alert({message:"".concat(e.CONTACTMAN,"有多个不同的有效期且已过期，不允许选择，最小效期为:").concat(new Date(e.miniTime).toLocaleDateString())}).then((function(){}))}else this.$set(t,"hasClick",!0);this.$emit("chooseCustomClick",t)}}]),a}(d["c"]);Object(u["a"])([h["a"]],Fc.prototype,"chooseEntry",void 0),Object(u["a"])([Object(d["b"])()],Fc.prototype,"customList",void 0),Fc=Object(u["a"])([Object(d["a"])({})],Fc);var zc=Fc,Wc=zc,Bc=(a("23eb"),Object(V["a"])(Wc,Vc,Uc,!1,null,"7a215679",null)),Gc=Bc.exports,Hc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"twoPinGoods"},[s("ul",{staticClass:"goodslistWarp"},t._l(t.goodsDataList,(function(e,i){return s("li",{key:i,on:{click:function(a){return t.goodsClick(e)}}},[s("van-card",{directives:[{name:"lazy",rawName:"v-lazy",value:e.smallimglink||a("0981"),expression:"item.smallimglink || require('../../../../assets/images/noImg.png')"}],attrs:{thumb:e.smallimglink||a("0981"),"lazy-load":!0},scopedSlots:t._u([{key:"title",fn:function(){return[s("van-tag",{directives:[{name:"show",rawName:"v-show",value:e.nearlyEffectiveFlag,expression:"item.nearlyEffectiveFlag"}],attrs:{color:"#FC923F"}},[t._v("近效期")]),s("van-tag",{directives:[{name:"show",rawName:"v-show",value:e.waiteProcessFlag,expression:"item.waiteProcessFlag"}],attrs:{color:"rgb(255, 126, 132)"}},[t._v("待处理")]),s("span",{staticClass:"fontWeight"},[t._v(t._s(e.goodsId)+"/"+t._s(e.goodsName))])]},proxy:!0},{key:"desc",fn:function(){return[s("li",{staticClass:"cartLine"},[s("span",{staticClass:"cartTitle"},[t._v("规格：")]),s("span",[t._v(t._s(e.goodstype)+"/"+t._s(e.goodsunit))])]),e.prodarea?s("li",{staticClass:"cartLine"},[s("span",{staticClass:"cartTitle"},[t._v("产地：")]),s("span",[t._v(t._s(e.prodarea))])]):t._e()]},proxy:!0},{key:"tags",fn:function(){return[s("li",{staticClass:"cartLine clearfix"},[e.nearlyEffectiveLotNum?s("span",{staticClass:"left",style:"width: 50%"},[s("i",{staticClass:"cartTitle"},[t._v("近效期批号数：")]),t._v(" "+t._s(e.nearlyEffectiveLotNum)+" ")]):t._e(),e.waiteProcessotNum?s("span",{staticClass:"left",style:"width: 50%"},[s("i",{staticClass:"cartTitle"},[t._v("待处理批号数：")]),t._v(" "+t._s(e.waiteProcessotNum)+" ")]):t._e()]),s("li",{staticClass:"cartLine clearfix"},[e.mintotalgoodsqty?s("span",{staticClass:"left",style:"width: 50%"},[s("i",{staticClass:"cartTitle"},[t._v("可销库存：")]),t._v(" "+t._s(e.mintotalgoodsqty)+" ")]):t._e(),e.price&&e.mintotalgoodsqty?s("span",{staticClass:"left",style:"width: 50%"},[s("i",{staticClass:"cartTitle"},[t._v("总价：")]),t._v(" ￥"+t._s((e.mintotalgoodsqty*e.price).toFixed(2))+" ")]):t._e()])]},proxy:!0},t.isResell||2!==e.limitFlag&&3!==e.limitFlag?!t.isResell&&e.price>0?{key:"price",fn:function(){return[s("li",{staticClass:"clearfix"},[s("span",{staticClass:"left",style:"width: 100%"},[s("i",{staticClass:"cartTitle"},[t._v("单价：")]),t._v(" ￥"+t._s(e.price)+" "),e.lastSellPrice?s("i",{staticStyle:{color:"#aaa","font-size":"12px"}},[t._v("（上次销价￥"+t._s(e.lastSellPrice)+"）")]):t._e()])])]},proxy:!0}:t.isResell?null:{key:"price",fn:function(){return[s("i",{staticStyle:{color:"red"}},[t._v("货品暂无价格，不允许销售。")])]},proxy:!0}:{key:"price",fn:function(){return[2===e.limitFlag?s("i",{staticStyle:{color:"red"}},[t._v("当前货品不可销。")]):s("i",{staticStyle:{color:"red"}},[t._v("当前货品既有禁销也有限销，请联系采购处理。")])]},proxy:!0}],null,!0)}),e.hadsale?s("van-button",{staticClass:"hadsale",attrs:{size:"mini",plain:"",type:"primary"}},[t._v("卖过")]):t._e()],1)})),0)])},Yc=[],Qc=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"goodsClick",value:function(t){(this.isResell||t.price>0)&&2!==t.limitFlag&&3!==t.limitFlag&&this.$emit("goodsClick",t)}},{key:"mounted",value:function(){console.log(this.goodsDataList)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Qc.prototype,"goodsDataList",void 0),Object(u["a"])([Object(d["b"])({default:!1})],Qc.prototype,"isResell",void 0),Qc=Object(u["a"])([Object(d["a"])({})],Qc);var Kc=Qc,Jc=Kc,Xc=(a("29fb"),Object(V["a"])(Jc,Hc,Yc,!1,null,"7ef8b9f8",null)),Zc=Xc.exports,tl=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"orderqueryList"},t._l(t.orderList,(function(e){return a("ul",{key:e.codDocId,staticClass:"listWarp",on:{click:function(a){return t.orderObjClick(e)}}},[a("li",{staticClass:"listLine"},[1!==e.status?a("van-tag",{staticStyle:{"margin-right":"10px"},attrs:{type:2===e.status?"success":3===e.status?"warning":4===e.status?"danger":5===e.status?"warning":6===e.status?"primary":7===e.status||8===e.status?"success":"warning",plain:2===e.status||(3===e.status||4!==e.status&&(5!==e.status&&(6!==e.status&&(7!==e.status&&8!==e.status))))}},[t._v(" "+t._s(2===e.status?"已生成订单":3===e.status?"审核未通过":4===e.status?"传输到ERP报错":5===e.status?"ERP作废":6===e.status?"ERP临时":7===e.status?"ERP正式":8===e.status?"ERP完成":"未知")+" ")]):t._e(),a("span",{staticClass:"fontWeight"},[t._v(t._s(e.createTime))]),a("div",{staticClass:"right"},[t._v(" ￥ "),a("span",{staticClass:"fontWeight",staticStyle:{"font-size":"14px"}},[t._v(t._s(e.totalPrice))]),a("span",{staticClass:"listTitle"},[t._v("（总价格）")])])],1),a("li",{staticClass:"listLine clearfix"},[a("div",{staticClass:"twoLeft left"},[a("span",{staticClass:"listTitle"},[t._v("总单id：")]),a("span",{staticClass:"listValue"},[t._v(t._s(e.codDocId))])]),a("div",{staticClass:"twoRight left"},[a("span",{staticClass:"listTitle"},[t._v("销售合同id：")]),a("span",{staticClass:"listValue"},[t._v(t._s(e.conid||"待生成"))])])]),a("li",{staticClass:"listLine"},[a("span",{staticClass:"listTitle"},[t._v("客户：")]),a("span",{staticClass:"listValue"},[t._v(t._s(e.customId)+"/"+t._s(e.customName))])]),a("li",{staticClass:"listLine"},[a("span",{staticClass:"listTitle"},[t._v("运输地址：")]),a("span",{staticClass:"listValue"},[t._v(t._s(e.addressId)+"/"+t._s(e.addressName))])]),e.docMemo?a("li",{staticClass:"listLine"},[a("span",{staticClass:"listTitle"},[t._v("备注：")]),a("span",{staticClass:"listValue"},[t._v(t._s(e.docMemo))])]):t._e(),a("li",{staticClass:"orderPerson"},[a("span",{staticClass:"listTitle"},[t._v("下单人：")]),a("van-tag",{attrs:{color:"#7232dd"}},[t._v(t._s(e.userId)+"/"+t._s(e.userName))])],1),a("van-popup",{style:{height:"100%",width:"100%"},attrs:{position:"right","get-container":"#app",closeable:""},model:{value:t.dtlShow,callback:function(e){t.dtlShow=e},expression:"dtlShow"}},[t.dtlShow?a("dtl-order-list",{attrs:{orderObj:t.orderObj}}):t._e()],1)],1)})),0)},el=[],al=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dtlOrderList"},[a("div",{staticClass:"header"},[t._v("细单列表")]),a("ul",{staticClass:"goodslistWarp"},t._l(t.goodsList,(function(e,s){return a("li",{key:s,staticClass:"commonLine"},[a("van-card",{scopedSlots:t._u([{key:"title",fn:function(){return[a("li",{staticStyle:{"line-height":"30px"}},[a("van-tag",{directives:[{name:"show",rawName:"v-show",value:3===e.goodsStatusId,expression:"item.goodsStatusId === 3"}],attrs:{color:"#FC923F"}},[t._v(t._s(e.goodsStatus))]),a("van-tag",{directives:[{name:"show",rawName:"v-show",value:3!==e.goodsStatusId,expression:"item.goodsStatusId !== 3"}],attrs:{color:"rgb(255, 126, 132)"}},[t._v(t._s(e.goodsStatus))]),a("span",{staticClass:"fontWeight fontSize-14",class:e.goodsStatusId?"paddingLeft-5":""},[t._v(t._s(t.orderObj.createTime))]),a("van-button",{staticClass:"right",staticStyle:{"margin-top":"3px"},attrs:{round:"",size:"mini",plain:"",type:"info"},on:{click:function(a){return t.logisticsClick(e.codDtlId)}}},[t._v("查看物流信息")])],1)]},proxy:!0},{key:"desc",fn:function(){return[a("li",{staticClass:"cartLine"},[a("span",{staticClass:"fontWeight"},[t._v(t._s(e.goodsId)+"/"+t._s(e.goodsName))])]),a("li",{staticClass:"twoLine"},[a("p",{directives:[{name:"show",rawName:"v-show",value:e.condtlid,expression:"item.condtlid"}],staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("销售订单细单ID：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.condtlid))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("细单ID：")]),a("span",{staticClass:"value"},[t._v(t._s(e.codDtlId))])])]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("保管账：")]),a("span",{staticClass:"value"},[t._v(t._s(e.storageId)+"/"+t._s(e.storageName))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("批号：")]),a("span",{staticClass:"value"},[t._v(t._s(e.lotNo))])])]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("规格：")]),a("span",{staticClass:"value"},[t._v(t._s(e.goodstype))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("厂家：")]),a("span",{staticClass:"value"},[t._v(t._s(e.zxfactoryname))])])]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("数量：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.goodsQty))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("总价：")]),a("span",{staticClass:"value fontWeight"},[t._v("￥"+t._s(e.dtlTotalPrice))])])]),a("li",{staticClass:"oneLine"},[a("span",{staticClass:"title"},[t._v("细单备注：")]),a("span",{staticClass:"value"},[t._v(" "+t._s(e.dtlMemo)+" ")])])]},proxy:!0}],null,!0)})],1)})),0),a("van-dialog",{attrs:{title:"物流信息查看"},model:{value:t.logisticsShow,callback:function(e){t.logisticsShow=e},expression:"logisticsShow"}},[a("van-steps",{attrs:{direction:"vertical",active:0}},t._l(t.logisticsList,(function(e,s){return a("van-step",{key:s},[a("h3",[t._v("【"+t._s(e.billno)+"】"+t._s(e.operastatus))]),a("p",[t._v(t._s(e.operadate)+" -- "+t._s(e.operator))])])})),1)],1)],1)},sl=[],il=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.goodsList=[],t.logisticsList=[],t.logisticsShow=!1,t}return Object(o["a"])(a,[{key:"_getOrderDtl",value:function(){var t=this;Lv({codDocId:this.orderObj.codDocId}).then((function(e){t.goodsList=e}))}},{key:"logisticsClick",value:function(t){var e=this;Ov({condtlid:t}).then((function(t){"200"===t.code?(e.logisticsShow=!0,e.logisticsList=t.data):e.$toast.fail(t.msg)}))}},{key:"mounted",value:function(){this._getOrderDtl()}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],il.prototype,"orderObj",void 0),il=Object(u["a"])([Object(d["a"])({})],il);var nl=il,rl=nl,ol=(a("3f06"),Object(V["a"])(rl,al,sl,!1,null,"da83f59a",null)),cl=ol.exports,ll=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.dtlShow=!1,t.orderObj={},t}return Object(o["a"])(a,[{key:"orderObjClick",value:function(t){console.log(t),this.orderObj=t,this.dtlShow=!0}},{key:"mounted",value:function(){console.log(this.orderList)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],ll.prototype,"orderList",void 0),ll=Object(u["a"])([Object(d["a"])({components:{dtlOrderList:cl}})],ll);var ul=ll,dl=ul,hl=(a("f714"),Object(V["a"])(dl,tl,el,!1,null,"40f02e9f",null)),pl=hl.exports,ml=Object(h["b"])("commonStore"),vl=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.entryList=[],t.customList=[],t.orderList=[],t.goodsList=[],t.entryChange=!0,t.entryObj={entryId:0,entryName:""},t.menuChangeShow=!1,t.tabActiveIndex=0,t.dirType="",t.searchValue="",t.finished=!1,t.refreshing=!1,t.getDataLoading=!1,t.page=1,t.scroll=0,t.calendarShow=!1,t.filterShow=!1,t.filterObj={customId:"",customName:"",entryId:"",starttime:"",endtime:""},t}return Object(o["a"])(a,[{key:"onRefresh",value:function(){this.finished=!1,this.getDataLoading=!1,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.customList=[],this.goodsList=[],this.refreshing=!1),this.getDataLoading=!0,0===+this.tabActiveIndex&&this._getCustom(),1===+this.tabActiveIndex&&this._getGoodsResell(),2===+this.tabActiveIndex&&this._getOrderDoc()}},{key:"tabClick",value:function(t){this.$cancelAxios(["getGoodsResell","getCustom","getOrderDoc"]);var e=t.index;this.tabActiveIndex=e,this.searchValue="",this.page=1,this.finished=!1,this.getDataLoading=!1,this.onRefresh()}},{key:"dirTypeTabClick",value:function(t){this.dirType=t,this.finished=!1,this.getDataLoading=!1,this.onRefresh()}},{key:"entryChangeClick",value:function(t){this.entryChange=!1,this.$set(this.entryObj,"entryId",t.entryid),this.$set(this.entryObj,"entryName",t.entryname),this.SET_ENTRYINFOR(this.entryObj),this.menuChangeShow=!1,this.page=1,this.customList=[],this.onRefresh()}},{key:"menuChangeClick",value:function(){this.menuChangeShow=!0}},{key:"chooseCustomClick",value:function(t){var e=this.$refs.goodsCustomWarp.scrollTop;console.log("wrapperScrollTop",e),this.scroll=e,this.$router.push({name:"custom-detail",query:t})}},{key:"goodsClick",value:function(t){var e=this.$refs.goodsCustomWarp.scrollTop;console.log("wrapperScrollTop",e),this.scroll=e,this.SET_GOODSDETAIL(t),this.$router.push({path:"/twoPinDic/goodsDetail",query:{id:t.goodsId,type:"1",dirType:this.dirType}})}},{key:"_queryEntryid",value:function(){var t=this;this.$cancelAxios(["queryEntryid"]),lv().then((function(e){t.entryList=e,1===e.length&&t.entryChangeClick(e[0])}))}},{key:"_getCustom",value:function(){var t=this;this.$cancelAxios(["getCustom"]),1===this.page&&(this.customList=[]);var e={condition:this.searchValue,entryid:this.chooseEntry.entryId,pageNum:this.page,pageSize:7};uv(e).then((function(e){t.customList=t.customList.concat(e.list);for(var a=0;a<t.customList.length;a++){var s=t.customList[a];s.contactList&&s.contactList.length>0&&s.contactList.forEach((function(t){var e=0;t.dates&&t.dates.length>0&&(t.dates.forEach((function(t){e?e>new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()&&(e=new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()):e=new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()})),e<new Date((new Date).toLocaleDateString()).getTime()&&(t.dialyPass=!0,t.miniTime=e))}))}e.hasNextPage?(t.getDataLoading=!1,t.page++):t.finished=!0}))}},{key:"_getGoodsResell",value:function(){var t=this;this.$cancelAxios(["getGoodsResell"]),1===this.page&&(this.goodsList=[]);var e={goodsId:"",goodsName:"",goodsNameOrId:this.searchValue,entryId:this.chooseEntry.entryId,dirType:this.dirType,pageNum:this.page,pageSize:7};kv(e).then((function(e){t.goodsList=t.goodsList.concat(e.list),e.hasNextPage?(t.getDataLoading=!1,t.page++):t.finished=!0}))}},{key:"onSearch",value:function(){this.onRefresh()}},{key:"_getOrderDoc",value:function(){var t=this;this.$cancelAxios(["getOrderDoc"]),1===this.page&&(this.orderList=[]),wv({orderType:14,customId:this.filterObj.customId,customName:this.filterObj.customName,entryId:this.chooseEntry.entryId,endtime:this.filterObj.endtime?this.filterObj.endtime+" 23:59:59":"",starttime:this.filterObj.starttime?this.filterObj.starttime+" 00:00:00":"",pageNum:this.page,pageSize:7}).then((function(e){t.orderList=t.orderList.concat(e.data.list),console.log(t.orderList),e.data.hasNextPage?(t.getDataLoading=!1,t.page++):t.finished=!0}))}},{key:"superFliter",value:function(){this.filterShow=!0,console.log("高级搜索")}},{key:"clearFliter",value:function(){this.filterObj={customId:"",customName:"",entryId:"",starttime:"",endtime:""},this.onRefresh()}},{key:"filterSubmit",value:function(t){console.log(t),this.filterShow=!1,this.onRefresh()}},{key:"selectCalendar",value:function(t){this.filterObj.starttime=Gs(t[0]),this.filterObj.endtime=Gs(t[1]),this.calendarShow=!1}},{key:"activated",value:function(){"twoPinDic"===this.$route.name&&this.$refs.goodsCustomWarp&&(this.$refs.goodsCustomWarp.scrollTop=this.scroll),this.chooseEntry.entryId?this.entryChange=!1:(this.entryChange=!0,this._queryEntryid())}}]),a}(d["c"]);Object(u["a"])([ml.Mutation],vl.prototype,"SET_ENTRYINFOR",void 0),Object(u["a"])([ml.Mutation],vl.prototype,"SET_GOODSDETAIL",void 0),Object(u["a"])([ml.Mutation],vl.prototype,"SET_SHOPCARTSHOW",void 0),Object(u["a"])([h["a"]],vl.prototype,"shopingCartShow",void 0),Object(u["a"])([h["a"]],vl.prototype,"chooseEntry",void 0),vl=Object(u["a"])([Object(d["a"])({components:{tabSwitch:qc,customerList:Gc,twopinGoods:Zc,orderqueryList:pl},beforeRouteLeave:function(t,e,a){this.$refs.orderqueryList&&this.$refs.orderqueryList.dtlShow?(this.$refs.orderqueryList.dtlShow=!1,a(!1)):this.shopingCartShow?(this.SET_SHOPCARTSHOW(!1),e.meta.keepAlive=!0,a(!1)):("operationHome"===t.name&&(this.entryChange=!1,this.entryList=[],this.customList=[],this.orderList=[],this.goodsList=[],this.entryObj={entryId:0,entryName:""},this.menuChangeShow=!1,this.tabActiveIndex=0,this.dirType="",this.searchValue="",this.finished=!1,this.refreshing=!1,this.getDataLoading=!1,this.page=1,this.scroll=0,this.calendarShow=!1,this.filterShow=!1,this.filterObj={customId:"",customName:"",entryId:"",starttime:"",endtime:""},this.SET_ENTRYINFOR("")),a(!0))}})],vl);var fl=vl,gl=fl,bl=(a("e9e7"),Object(V["a"])(gl,Tc,Rc,!1,null,"6fea7ba0",null)),yl=bl.exports,_l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"operationHome"},[a("div",{staticClass:"searchWarp"},[a("van-search",{attrs:{shape:"round","show-action":"",placeholder:"请输入搜索关键词"},on:{input:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t.searchValue?a("ul",{staticClass:"menu"},t._l(t.needMenu,(function(e,s){return a("li",{key:s,on:{click:function(a){return t.routerClick(e)}}},[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#"+e.icon}})]),a("p",[t._v(t._s(e.pmsName))])])})),0):a("ul",{staticClass:"menu"},t._l(t.opMenu,(function(e,s){return a("li",{key:s,on:{click:function(a){return t.routerClick(e)}}},[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#"+e.icon}})]),a("p",[t._v(t._s(e.pmsName))])])})),0)])},kl=[],Cl=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.opMenu=[],t.needMenu=[],t.searchValue="",t}return Object(o["a"])(a,[{key:"onSearch",value:function(t){var e=this;if(""!==t){this.needMenu=[];var a=this.$toast.loading("查询中...");setTimeout((function(){a.close();for(var s=0;s<e.opMenu.length;s++){var i=e.opMenu[s];-1!==i.pmsName.indexOf(t)&&e.needMenu.push(i)}}),600)}}},{key:"routerClick",value:function(t){this.$router.push({path:t.path})}},{key:"activated",value:function(){var t=this,e=localStorage.getItem("menuTree"),a=JSON.parse(e);this.opMenu=[],a.forEach((function(e){"业务系统"===e.pmsName&&e.children&&e.children.forEach((function(e){3===e.pmsType&&t.opMenu.push(e)}))}))}}]),a}(d["c"]);Cl=Object(u["a"])([Object(d["a"])({})],Cl);var wl=Cl,Ll=wl,xl=(a("ece2"),Object(V["a"])(Ll,_l,kl,!1,null,"579489a4",null)),Il=xl.exports,Sl=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"goodsListWarp"},[a("i",{staticClass:"entryNum left"},[t._v(t._s(t.chooseEntry.entryId)+"/"+t._s(t.chooseEntry.entryName))]),a("div",{staticClass:"btnWarp right"},[a("i",{staticClass:"iconfont ytcrm-center left",on:{click:function(e){return t.$router.back()}}})]),a("li",{staticClass:"clearfix",staticStyle:{"padding-right":"10px"}},[a("van-popover",{staticClass:"right",attrs:{theme:"dark",trigger:"click",actions:t.soldActions},on:{select:t.selectSoldWay},scopedSlots:t._u([{key:"reference",fn:function(){return[a("van-button",{staticStyle:{border:"none"},attrs:{size:"mini",plain:"",icon:t.showSoldPopover?"arrow-up":"arrow-down",type:"info","icon-position":"right"}},[t._v(" "+t._s(0===t.soldFlag?"未销售过":1===t.soldFlag?"已销售过":"点击选择销售情况")+" ")])]},proxy:!0}]),model:{value:t.showSoldPopover,callback:function(e){t.showSoldPopover=e},expression:"showSoldPopover"}}),a("van-popover",{staticClass:"right",attrs:{theme:"dark",trigger:"click",actions:t.orderActions},on:{select:t.selectOrderWay},scopedSlots:t._u([{key:"reference",fn:function(){return[a("van-button",{staticStyle:{border:"none"},attrs:{size:"mini",plain:"",icon:t.showOrderPopover?"arrow-up":"arrow-down",type:"info","icon-position":"right"}},[t._v(" "+t._s(1===t.orderFlag?"按库存排序":2===t.orderFlag?"按金额排序":"点击切换排序方式")+" ")])]},proxy:!0}]),model:{value:t.showOrderPopover,callback:function(e){t.showOrderPopover=e},expression:"showOrderPopover"}})],1),a("div",{staticClass:"paddingWarp"},[a("li",{staticClass:"oneWarp customerWarp clearfix"},[a("span",{staticClass:"nameValue slh left fontSize-14",on:{click:t.chooseCustom}},[a("i",[t._v("客户信息："+t._s((t.customInfor.CONTACTID||t.customInfor.customid)+"/"+(t.customInfor.CONTACTMAN||t.customInfor.customname)))])]),a("van-icon",{attrs:{name:"arrow-down"},on:{click:t.chooseCustom}})],1),a("li",{staticClass:"oneWarp addressWarp clearfix",class:t.contactObj.ADDRESSID?"":"addressborder"},[t.contactList.length>0?a("span",{staticClass:"nameValue left",on:{click:function(e){t.contactShow=!0}}},[t.contactObj.ADDRESSID?a("i",[t._v("运输地址："+t._s(t.contactObj.ADDRESSID)+"/"+t._s(t.contactObj.ADDRESS))]):a("i",[t._v("请选择运输地址")])]):a("span",{staticClass:"nameValue left"},[t._v(t._s(t.contactLoading?"运输地址获取中...":"暂无运输地址信息"))]),t.contactList.length>0?a("van-icon",{attrs:{name:"arrow-down"},on:{click:function(e){t.contactShow=!0}}}):t._e()],1)]),a("li",[a("van-tabs",{staticStyle:{"border-bottom":"1px solid #eee",height:"30px"},attrs:{color:"#363636"},on:{change:t.tabsSwitch}},[a("van-tab",{attrs:{title:"全部",name:""}}),a("van-tab",{attrs:{title:"近效期",name:"2"}}),a("van-tab",{attrs:{title:"待处理",name:"3"}})],1),a("van-search",{attrs:{shape:"round",placeholder:"请输入货品ID|名称","show-action":""},on:{search:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.goodsSerchValue,callback:function(e){t.goodsSerchValue=e},expression:"goodsSerchValue"}})],1),a("li",{ref:"goodsWarp",staticClass:"listWarp"},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.getGoodsLoading,callback:function(e){t.getGoodsLoading=e},expression:"getGoodsLoading"}},[a("twopin-goods",{attrs:{goodsDataList:t.goodsDataList},on:{goodsClick:t.goodsClick}})],1)],1)],1),a("van-action-sheet",{attrs:{"cancel-text":"取消","close-on-click-action":""},scopedSlots:t._u([{key:"default",fn:function(){return t._l(t.contactList,(function(e,s){return a("van-cell",{key:s,attrs:{"is-link":""},on:{click:function(a){return t.chooseClick(e)}}},[t._v(t._s(e.ADDRESSID)+"/ "+t._s(e.ADDRESS))])}))},proxy:!0}]),model:{value:t.contactShow,callback:function(e){t.contactShow=e},expression:"contactShow"}}),a("van-popup",{style:"height: 70%",attrs:{position:"bottom",closeable:"",round:""},model:{value:t.showCustomerPicker,callback:function(e){t.showCustomerPicker=e},expression:"showCustomerPicker"}},[a("div",{staticClass:"header fontSize-14 fontWeight",staticStyle:{padding:"20px"}},[t._v("客户列表选择")]),a("div",{staticClass:"searchWarp"},[a("van-search",{attrs:{"show-action":"",shape:"round",placeholder:"请输入搜索关键词"},on:{clear:t.onCustomerSearch,search:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:t.onCustomerSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.customerSearchValue,callback:function(e){t.customerSearchValue=e},expression:"customerSearchValue"}})],1),a("van-pull-refresh",{staticClass:"customerPullRefresh",on:{refresh:t.onCustomerRefresh},model:{value:t.customerRefreshing,callback:function(e){t.customerRefreshing=e},expression:"customerRefreshing"}},[a("van-list",{attrs:{offset:20,finished:t.customerFinished,"finished-text":"没有更多了"},on:{load:t.onCustomerLoad},model:{value:t.getCustomerLoading,callback:function(e){t.getCustomerLoading=e},expression:"getCustomerLoading"}},[a("customer-list",{attrs:{customList:t.customList},on:{chooseCustomClick:t.chooseCustomClick}})],1)],1)],1)],1)},Dl=[],Ol=Object(h["b"])("commonStore"),jl=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.showOrderPopover=!1,t.showSoldPopover=!1,t.orderActions=[{text:"取消排序"},{text:"按库存排序"},{text:"按金额排序"}],t.soldActions=[{text:"取消选择"},{text:"未销售过"},{text:"销售过"}],t.goodsSerchValue="",t.dirType="",t.goodsDataList=[],t.contactList=[],t.contactObj={},t.contactShow=!1,t.contactLoading=!1,t.scroll=1,t.page=1,t.finished=!1,t.refreshing=!1,t.getGoodsLoading=!1,t.orderFlag="",t.soldFlag="",t.showCustomerPicker=!1,t.customerFinished=!1,t.customerRefreshing=!1,t.getCustomerLoading=!1,t.customerPage=1,t.customList=[],t.customerSearchValue="",t.customInfor={},t}return Object(o["a"])(a,[{key:"onRefresh",value:function(){this.finished=!1,this.getGoodsLoading=!0,this.page=1,this.onLoad()}},{key:"selectSoldWay",value:function(t,e){console.log(t),console.log(e),this.soldFlag=0===e?"":e-1,this.onRefresh()}},{key:"selectOrderWay",value:function(t,e){console.log(t),console.log(e),this.orderFlag=0===e?"":e,this.onRefresh()}},{key:"goodsClick",value:function(t){var e=this.$refs.goodsWarp.scrollTop;console.log("wrapperScrollTop",e),this.scroll=e,this.SET_GOODSDETAIL(Object.assign(Object(b["a"])(Object(b["a"])({},this.customInfor),this.contactObj),t)),this.contactObj.ADDRESSID?this.$router.push({path:"/twoPinDic/goodsDetail",query:{id:t.goodsId,type:"2",dirType:this.dirType}}):this.$toast.fail("请先选择运输地址")}},{key:"_queryContact",value:function(){var t=this;this.contactLoading=!0;var e={entryid:this.chooseEntry.entryId,customid:this.customInfor.customid||"",contactid:this.customInfor.CONTACTID||""};hv(e).then((function(e){t.contactLoading=!1,t.contactList=e,1===t.contactList.length&&(t.contactObj=t.contactList[0])}))}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.goodsDataList=[],this.refreshing=!1),this._getGoods()}},{key:"_getGoods",value:function(){var t=this;this.$cancelAxios(["getGoods"]),1===this.page&&(this.goodsDataList=[]);var e={entryId:this.chooseEntry.entryId,customId:this.customInfor.customid,goodsId:"",goodsName:"",goodsNameOrId:this.goodsSerchValue,dirType:this.dirType,soldFlag:this.soldFlag,pageSize:5,pageNum:this.page,orderFlag:this.orderFlag};dv(e).then((function(e){"200"===e.code?t.orderFlag?(t.goodsDataList=e.data,t.finished=!0):t.goodsDataList=t.goodsDataList.concat(e.data.list):t.$toast.fail(e.msg),e.data.hasNextPage?(t.getGoodsLoading=!1,t.page++):t.finished=!0}))}},{key:"chooseClick",value:function(t){this.contactObj=t,this.contactShow=!1}},{key:"tabsSwitch",value:function(t){this.dirType=t,this.goodsDataList=[],this.onRefresh()}},{key:"onSearch",value:function(){this.onRefresh()}},{key:"chooseCustom",value:function(){this.showCustomerPicker=!0,this.onCustomerLoad()}},{key:"_getCustom",value:function(){var t=this;this.$cancelAxios(["getCustom"]),1===this.customerPage&&(this.customList=[]);var e={condition:this.customerSearchValue,entryid:this.chooseEntry.entryId,pageNum:this.customerPage,pageSize:5};uv(e).then((function(e){t.customList=t.customList.concat(e.list),e.hasNextPage?(t.getCustomerLoading=!1,t.customerPage++):t.customerFinished=!0}))}},{key:"onCustomerSearch",value:function(){this.onCustomerRefresh()}},{key:"onCustomerRefresh",value:function(){this.customerFinished=!1,this.getCustomerLoading=!1,this.customerPage=1,this.onCustomerLoad()}},{key:"onCustomerLoad",value:function(){this.customerRefreshing&&(this.customerPage=1,this.customList=[],this.customerRefreshing=!1),this.getCustomerLoading=!0,this._getCustom()}},{key:"chooseCustomClick",value:function(t){this.customInfor.customid=t.customid,this.customInfor.customname=t.customname,this.customInfor.CONTACTID=t.CONTACTID,this.customInfor.CONTACTMAN=t.CONTACTMAN,this.showCustomerPicker=!1,this.contactObj={},this._queryContact(),this.onRefresh()}},{key:"activated",value:function(){this.$refs.goodsWarp.scrollTop=this.scroll}},{key:"mounted",value:function(){this.customInfor={CONTACTID:this.$route.query.CONTACTID,customid:this.$route.query.customid,CONTACTMAN:this.$route.query.CONTACTMAN,customname:this.$route.query.customname},this.contactObj={},this._queryContact(),console.log(this.$route.query)}}]),a}(d["c"]);Object(u["a"])([h["a"]],jl.prototype,"chooseEntry",void 0),Object(u["a"])([Ol.Mutation],jl.prototype,"SET_GOODSDETAIL",void 0),Object(u["a"])([Ol.Mutation],jl.prototype,"SET_SHOPCARTSHOW",void 0),Object(u["a"])([h["a"]],jl.prototype,"shopingCartShow",void 0),jl=Object(u["a"])([Object(d["a"])({components:{twopinGoods:Zc,customerList:Gc},beforeRouteLeave:function(t,e,a){this.shopingCartShow?(e.meta.keepAlive=!0,this.SET_SHOPCARTSHOW(!1),a(!1)):("twoPinDic"===t.name?e.meta.keepAlive=!1:e.meta.keepAlive=!0,a(!0))}})],jl);var Tl=jl,Rl=Tl,Nl=(a("7ff1"),Object(V["a"])(Rl,Sl,Dl,!1,null,"0304621e",null)),Al=Nl.exports,Pl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"goodsDetail"},[s("div",{staticClass:"btnWarp right"},[s("i",{staticClass:"iconfont ytcrm-center left",on:{click:function(e){return t.$router.back()}}})]),s("div",{staticClass:"img"},[s("img",{attrs:{src:t.goodsDetail.bigimglink||a("0981"),alt:""}})]),s("ul",{staticClass:"commonLine"},[s("li",{staticClass:"oneLine fontWeight"},[s("van-tag",{directives:[{name:"show",rawName:"v-show",value:t.goodsDetail.nearlyEffectiveFlag,expression:"goodsDetail.nearlyEffectiveFlag"}],attrs:{color:"#FC923F"}},[t._v("近效期")]),s("van-tag",{directives:[{name:"show",rawName:"v-show",value:t.goodsDetail.waiteProcessFlag,expression:"goodsDetail.waiteProcessFlag"}],attrs:{color:"rgb(255, 126, 132)"}},[t._v("待处理")]),s("span",{staticClass:"bigfontSize paddingLeft-5"},[t._v(t._s(t.goodsDetail.goodsId)+"/"+t._s(t.goodsDetail.goodsName))])],1),s("li",{staticClass:"twoLine"},[s("p",{staticClass:"twoLeft"},[s("span",{staticClass:"title"},[t._v("规格：")]),s("span",{staticClass:"value"},[t._v(t._s(t.goodsDetail.goodstype)+"/"+t._s(t.goodsDetail.goodsunit))])]),t.logList&&t.logList.length>0&&t.logList[0].packsizeList.length>0?s("p",{staticClass:"twoRight"},[s("span",{staticClass:"title"},[t._v("包装大小：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(t.logList.length>0?t.logList[0].packsizeList[0]:""))])]):t._e()]),s("li",{staticClass:"oneLine"},[s("span",{staticClass:"title"},[t._v("厂家：")]),s("span",{staticClass:"value"},[t._v(" "+t._s(t.goodsDetail.factoryname)+" ")])]),"2"===t.$route.query.type&&t.goodsDetail.customid?s("li",{staticClass:"oneLine"},[s("span",{staticClass:"title"},[t._v("客户：")]),s("span",{staticClass:"value"},[t._v(t._s(t.goodsDetail.customid)+"/"+t._s(t.goodsDetail.customname))])]):t._e(),"2"===t.$route.query.type&&t.goodsDetail.CONTACTID?s("li",{staticClass:"oneLine"},[s("span",{staticClass:"title"},[t._v("分支机构：")]),s("span",{staticClass:"value"},[t._v(t._s(t.goodsDetail.CONTACTID)+"/"+t._s(t.goodsDetail.CONTACTMAN))])]):t._e(),"2"===t.$route.query.type&&t.goodsDetail.ADDRESSID?s("li",{staticClass:"oneLine"},[s("span",{staticClass:"title"},[t._v("运输地址：")]),s("span",{staticClass:"value"},[t._v(t._s(t.goodsDetail.ADDRESSID)+"/"+t._s(t.goodsDetail.ADDRESS))])]):t._e()]),s("van-collapse",{model:{value:t.lotInfor,callback:function(e){t.lotInfor=e},expression:"lotInfor"}},[s("van-collapse-item",{attrs:{name:"1"},scopedSlots:t._u([{key:"title",fn:function(){return[s("span",[t._v("批号信息")]),s("span",{staticClass:"text-red paddingLeft-5"},[t._v(t._s(2===t.goodsDetail.salesqtycontrol?"":"报货数量应该为"+t.goodsDetail.leastsaleqty+"的倍数"))])]},proxy:!0}])},[s("van-checkbox",{staticStyle:{"padding-bottom":"10px"},attrs:{disabled:t.logList.every((function(e){return e.mindtlgoodsqty<(2===t.goodsDetail.salesqtycontrol?1:t.goodsDetail.leastsaleqty)}))},on:{change:t.checkAll},model:{value:t.checkedAllClick,callback:function(e){t.checkedAllClick=e},expression:"checkedAllClick"}},[t._v(" "+t._s(t.checkedAllClick?"取消全选":"全选")+" ")]),s("van-checkbox-group",{ref:"checkboxGroup",on:{change:t.logChange},model:{value:t.logChoose,callback:function(e){t.logChoose=e},expression:"logChoose"}},t._l(t.logList,(function(e,a){return s("van-checkbox",{key:a,attrs:{name:e.lotno,disabled:e.mindtlgoodsqty<(2===t.goodsDetail.salesqtycontrol?1:t.goodsDetail.leastsaleqty)}},[s("ul",{staticClass:"commonLine"},[s("li",{staticClass:"oneLine"},[s("van-tag",{attrs:{color:3===e.goodsStatusId?"#FC923F":"rgb(255, 126, 132)"}},[t._v(t._s(e.goodsStatus))]),s("span",{staticClass:"right",on:{click:t.overlimit}},[s("van-stepper",{attrs:{max:e.twoPinNumber,step:2===t.goodsDetail.salesqtycontrol?1:t.goodsDetail.leastsaleqty},on:{change:t.stepperChange},model:{value:e.twoPinNumber,callback:function(a){t.$set(e,"twoPinNumber",a)},expression:"item.twoPinNumber"}})],1)],1),s("li",{staticClass:"oneLine"},[s("span",{staticClass:"title paddingLeft-5"},[t._v("批号：")]),s("span",{staticClass:"value fontWeight bigfontSize"},[t._v(t._s(e.lotno))])]),s("li",{staticClass:"twoLine"},[s("p",{staticClass:"twoRight",staticStyle:{flex:"1.5"}},[s("span",{staticClass:"title"},[t._v("可销库存：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(e.mindtlgoodsqty))])]),s("p",{staticClass:"twoRight",staticStyle:{flex:"2"}},[s("span",{staticClass:"title"},[t._v("效期：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(e.invalidDate.substring(0,10))+"("+t._s(e.diffDay)+"天)")])])]),s("li",{staticClass:"clearfix"},[s("van-button",{attrs:{size:"mini",round:"",type:"default"},on:{click:function(a){a.stopPropagation(),t.currentPage=1,t.queryImgs(e)}}},[t._v(" 查看仓管员反馈信息 ")]),s("van-button",{attrs:{size:"mini",round:"",plain:"",type:"info"},on:{click:function(a){a.stopPropagation(),t.currentPage=1,t.queryCustomOften(e)}}},[t._v(" 查看常销客户 ")])],1)])])})),1)],1)],1),s("ul",{staticClass:"hasOp"},["1"===t.$route.query.type?s("van-field",{attrs:{readonly:"",clickable:"",name:"picker","is-link":"",value:t.goodsDetail.customname,label:"客户信息",placeholder:"点击选择客户信息"},on:{click:t.chooseCustom}}):t._e(),"1"===t.$route.query.type?s("van-field",{attrs:{readonly:"",clickable:"",name:"picker","is-link":"",value:t.goodsDetail.ADDRESS,label:"运输地址",placeholder:"点击选择运输地址"},on:{click:t.chooseContact}}):t._e(),(0===+t.priceType||1===+t.priceType)&&+t.twoPinPrice>0?s("van-field",{attrs:{type:"number",label:"价格"},model:{value:t.twoPinPrice,callback:function(e){t.twoPinPrice=e},expression:"twoPinPrice"}}):s("van-field",{attrs:{value:t.priceText,label:"价格",error:"",readonly:""}}),t.goodsDetail.lastSellPrice?s("van-field",{attrs:{label:"上次销价",readonly:"","is-link":""},model:{value:t.goodsDetail.lastSellPrice,callback:function(e){t.$set(t.goodsDetail,"lastSellPrice",e)},expression:"goodsDetail.lastSellPrice"}}):t._e(),s("van-field",{attrs:{rows:"1",autosize:"",label:"备注",type:"textarea",placeholder:"请输入备注"},model:{value:t.twoPinMemo,callback:function(e){t.twoPinMemo=e},expression:"twoPinMemo"}}),s("van-popup",{style:"height: 70%",attrs:{position:"bottom",closeable:"",round:""},model:{value:t.showCustomerPicker,callback:function(e){t.showCustomerPicker=e},expression:"showCustomerPicker"}},[s("div",{staticClass:"header fontSize-14 fontWeight",staticStyle:{padding:"20px"}},[t._v("客户列表选择")]),s("div",{staticClass:"searchWarp"},[s("van-search",{attrs:{"show-action":"",shape:"round",placeholder:"请输入搜索关键词"},on:{clear:t.onSearch,search:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[s("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),s("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.getDataLoading,callback:function(e){t.getDataLoading=e},expression:"getDataLoading"}},[s("customer-list",{attrs:{customList:t.customList},on:{chooseCustomClick:t.chooseCustomClick}})],1)],1)],1)],1),s("van-submit-bar",{attrs:{price:+(t.allTwoPinNumber*+t.twoPinPrice*1e4/100).toFixed(2).toString(),"button-text":"加入购物车"},on:{submit:t.addCartClick}},[t.allTwoPinNumber?s("span",[t._v(" 总数： "),s("i",{staticStyle:{color:"rgba(255, 153, 0, 1)"}},[t._v(t._s(t.allTwoPinNumber))])]):t._e()]),s("van-action-sheet",{attrs:{"cancel-text":"取消","close-on-click-action":""},scopedSlots:t._u([{key:"default",fn:function(){return[t._l(t.contactList,(function(e,a){return s("van-cell",{key:a,attrs:{"is-link":""},on:{click:function(a){return t.chooseContactClick(e)}}},[t._v(t._s(e.ADDRESSID)+"/ "+t._s(e.ADDRESS))])})),0===t.contactList.length?s("van-empty",{attrs:{description:"暂无运输地址信息"}}):t._e()]},proxy:!0}]),model:{value:t.getContactShow,callback:function(e){t.getContactShow=e},expression:"getContactShow"}}),s("van-popup",{style:"height: 90%",attrs:{position:"bottom",closeable:"",round:""},model:{value:t.queryInforPicker,callback:function(e){t.queryInforPicker=e},expression:"queryInforPicker"}},[s("div",{staticClass:"queryInforWarp"},[s("div",{staticClass:"queryInforHeader fontSize-16 fontWeight"},[t._v(t._s(1===t.queryClickType?"仓管员上传照片查看":"常销客户查看"))]),s("div",{staticClass:"queryInforCommon"},[s("ul",{staticClass:"commonLine"},[s("li",{staticClass:"oneLine"},[s("van-tag",{attrs:{color:3===t.queryClickInfor.goodsStatusId?"#FC923F":"rgb(255, 126, 132)"}},[t._v(t._s(t.queryClickInfor.goodsStatus))]),s("span",{staticClass:"title paddingLeft-5"},[t._v("批号：")]),s("span",{staticClass:"value fontWeight bigfontSize"},[t._v(t._s(t.queryClickInfor.lotno))])],1),s("li",{staticClass:"oneLine"},[s("span",{staticClass:"title"},[t._v("品种：")]),s("span",{staticClass:"value"},[t._v(t._s(t.queryClickInfor.goodsId)+"/"+t._s(t.queryClickInfor.goodsName))])]),s("li",{staticClass:"twoLine"},[s("p",{staticClass:"twoRight",staticStyle:{flex:"1.5"}},[s("span",{staticClass:"title"},[t._v("规格：")]),s("span",{staticClass:"value"},[t._v(t._s(t.queryClickInfor.goodstype))])]),t.queryClickInfor.prodarea?s("p",{staticClass:"twoRight",staticStyle:{flex:"2"}},[s("span",{staticClass:"title"},[t._v("产地：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(t.queryClickInfor.prodarea))])]):t._e()]),t.queryClickInfor.factoryname?s("li",{staticClass:"oneLine"},[s("span",{staticClass:"title"},[t._v("厂家：")]),s("span",{staticClass:"value"},[t._v(" "+t._s(t.queryClickInfor.factoryname)+" ")])]):t._e(),s("li",{staticClass:"twoLine"},[s("p",{staticClass:"twoRight",staticStyle:{flex:"1.5"}},[s("span",{staticClass:"title"},[t._v("可销库存：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(t.queryClickInfor.mindtlgoodsqty))])]),s("p",{staticClass:"twoRight",staticStyle:{flex:"2"}},[s("span",{staticClass:"title"},[t._v("效期：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(t.queryClickInfor.invalidDate?t.queryClickInfor.invalidDate.substring(0,10):"")+"("+t._s(t.queryClickInfor.diffDay)+"天)")])])])])]),t.imgIforObj&&t.imgIforObj.imgList&&1===t.queryClickType?s("van-swipe",{staticStyle:{height:"280px"},on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[s("div",{staticClass:"custom-indicator"},[t._v(t._s(t.current+1)+"/"+t._s(t.imgIforObj.imgList.length))])]},proxy:!0}],null,!1,1729476862)},t._l(t.imgIforObj.imgList,(function(e,a){return s("van-swipe-item",{key:a},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"image"}],attrs:{src:e},on:{click:function(e){return t.getImg(t.imgIforObj.imgList,a)}}})])})),1):t._e(),0===t.querytotal||1===t.queryClickType&&!t.imgIforObj.imgList?s("van-empty",{attrs:{description:"暂无反馈信息记录"}}):t._e(),2===t.queryClickType&&t.querytotal>0?s("div",{staticClass:"customWarp"},t._l(t.customOftenList,(function(e,a){return s("ul",{key:a,staticClass:"commonLine"},[s("li",{staticClass:"oneLine"},[s("span",{staticClass:"title"},[t._v("常销客户：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(e.openPinCustomId)+"/"+t._s(e.openPinCustomName))])]),s("li",{staticClass:"twoLine"},[s("p",{staticClass:"twoRight",staticStyle:{flex:"1.5"}},[s("span",{staticClass:"title"},[t._v("销售频次：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(e.lotCount))])]),s("p",{staticClass:"twoRight",staticStyle:{flex:"2"}},[s("span",{staticClass:"title"},[t._v("业务员：")]),s("span",{staticClass:"value"},[t._v(t._s(e.openPinSalerId)+t._s(e.openPinSalerName))])])])])})),0):t._e(),t.querytotal>0?s("van-pagination",{attrs:{"force-ellipses":"","total-items":t.querytotal,"items-per-page":1===t.queryClickType?1:5},on:{change:t.pageChange},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e(),1===t.queryClickType?s("van-button",{staticClass:"operatorButton",attrs:{round:"",type:"info",size:"small"},on:{click:function(e){return t.sendToWareClick(0)}}},[t._v("提示仓管员上传照片")]):t._e(),s("van-action-sheet",{attrs:{title:"仓管员选择"},model:{value:t.operatorShow,callback:function(e){t.operatorShow=e},expression:"operatorShow"}},[s("div",{staticClass:"operatorCntent"},[s("van-search",{staticStyle:{padding:"0px 0px 10px"},attrs:{"show-action":"",shape:"round",placeholder:"请输入用户ID|名称"},on:{clear:t._getWarehouseOperator,search:t._getWarehouseOperator},scopedSlots:t._u([{key:"action",fn:function(){return[s("div",{on:{click:t._getWarehouseOperator}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.operatorSearchValue,callback:function(e){t.operatorSearchValue=e},expression:"operatorSearchValue"}}),0===t.operatorList.length?s("van-empty",{attrs:{description:"暂无仓管员授权人员"}}):t._e(),t.operatorList.length>0?s("van-checkbox-group",{model:{value:t.operatorResult,callback:function(e){t.operatorResult=e},expression:"operatorResult"}},t._l(t.operatorList,(function(e,a){return s("van-checkbox",{key:a,attrs:{name:e.userId}},[t._v(t._s(e.userName)+" -- "+t._s(e.depName))])})),1):t._e(),s("li",{staticClass:"buttonWarp"},[s("van-button",{staticClass:"left",attrs:{size:"mini",round:"",type:"default"},on:{click:function(e){e.stopPropagation(),t.operatorShow=!1,t.operatorSearchValue=""}}},[t._v(" 取消 ")]),s("van-button",{staticClass:"right",attrs:{size:"mini",round:"",plain:"",type:"info"},on:{click:function(e){return e.stopPropagation(),t.sendToWareClick(1)}}},[t._v(" 确定 ")])],1)],1)])],1)])],1)},El=[],Ml=a("28a2"),$l=Object(h["b"])("commonStore"),ql=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.current=0,t.goodsDetail={},t.lotInfor=["1"],t.logList=[],t.checkedAllClick=!1,t.logChangeInfor={},t.allTwoPinNumber=0,t.logChoose=[],t.twoPinNumber=1,t.priceType="",t.twoPinPrice="",t.priceText="",t.twoPinMemo="",t.showCustomerPicker=!1,t.finished=!1,t.refreshing=!1,t.getDataLoading=!1,t.page=1,t.customList=[],t.searchValue="",t.getContactShow=!1,t.clickIndex="",t.contactList=[],t.queryInforPicker=!1,t.queryClickInfor={},t.queryClickType="",t.currentPage=1,t.querytotal=1,t.customOftenList=[],t.imgIforObj={},t.operatorShow=!1,t.operatorList=[],t.operatorResult=[],t.operatorSearchValue="",t}return Object(o["a"])(a,[{key:"addCartClick",value:function(){var t=this;if(this.goodsDetail.customid)if(this.goodsDetail.ADDRESSID)if("{}"!==JSON.stringify(this.logChangeInfor))if(this.twoPinPrice){var e=[];for(var a in this.logChangeInfor)if(Object.prototype.hasOwnProperty.call(this.logChangeInfor,a)){var s=this.logChangeInfor[a];if(0===s.twoPinNumber||2!==this.goodsDetail.salesqtycontrol&&s.twoPinNumber%this.goodsDetail.leastsaleqty!==0)return void this.$toast.fail("加入数量不合格");e.push({entryId:this.chooseEntry.entryId,entryName:this.chooseEntry.entryName,customId:this.goodsDetail.customid,customName:this.goodsDetail.customname,goodsId:this.goodsDetail.goodsId,goodsName:this.goodsDetail.goodsName,contactId:this.goodsDetail.CONTACTID,contactName:this.goodsDetail.CONTACTMAN,addressId:this.goodsDetail.ADDRESSID,addressName:this.goodsDetail.ADDRESS,goodsStatusId:s.goodsStatusId,goodsStatus:s.goodsStatus,storageId:s.storageId,storageName:s.storageName,lotId:s.lotid,lotNo:s.lotno,goodsQty:s.twoPinNumber,price:this.twoPinPrice,invoiceWay:1,zxSpecialFlag:0,dtlMemo:this.twoPinMemo})}mv(e).then((function(e){"200"===e.code?t.$toast.success(e.msg):t.$toast.fail(e.msg)}))}else this.$toast.fail("请输入价格");else this.$toast.fail("请先选择批号信息");else this.$toast.fail("请先选择运输地址");else this.$toast.fail("请先选择客户信息")}},{key:"checkAll",value:function(t){t?this.$refs.checkboxGroup.toggleAll(!0):this.$refs.checkboxGroup.toggleAll()}},{key:"logChange",value:function(t){var e=this;console.log(t),this.allTwoPinNumber=0,this.logChangeInfor={};for(var a=function(a){var s=t[a];e.logChangeInfor[s]=e.logList.find((function(t){return console.log(t),s===t.lotno&&(e.allTwoPinNumber+=t.twoPinNumber),s===t.lotno}))},s=0;s<t.length;s++)a(s);this.$forceUpdate()}},{key:"stepperChange",value:function(){for(var t in this.allTwoPinNumber=0,this.logChangeInfor)this.allTwoPinNumber+=this.logChangeInfor[t].twoPinNumber}},{key:"_getGoodsDtl",value:function(){var t=this,e={dirType:this.$route.query.dirType,entryId:this.chooseEntry.entryId,goodsId:this.$route.query.id};pv(e).then((function(e){t.logList=[];for(var a=0;a<e.length;a++){var s=e[a];0!==+s.mindtlgoodsqty&&t.logList.push(s)}for(var i=0;i<t.logList.length;i++){var n=t.logList[i];n.twoPinNumber=n.mindtlgoodsqty}console.log(t.logList)}))}},{key:"_getCustom",value:function(){var t=this;this.$cancelAxios(["getCustom"]),1===this.page&&(this.customList=[]);var e={condition:this.searchValue,entryid:this.chooseEntry.entryId,pageNum:this.page,pageSize:5};uv(e).then((function(e){t.customList=t.customList.concat(e.list),e.hasNextPage?(t.getDataLoading=!1,t.page++):t.finished=!0}))}},{key:"onRefresh",value:function(){this.finished=!1,this.getDataLoading=!1,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.customList=[],this.refreshing=!1),this.getDataLoading=!0,this._getCustom()}},{key:"_getGoodsPrice",value:function(){var t=this;Cv({customId:this.goodsDetail.customid,entryId:this.goodsDetail.entryId,goodsId:this.goodsDetail.goodsId}).then((function(e){console.log(e),t.twoPinPrice=e.price,t.priceType=e.limitFlag,+t.twoPinPrice<0?t.priceText="货品暂无价格，不允许销售。":2===+t.priceType?t.priceText="货品不可销。":3===+t.priceType&&(t.priceText="货品既有禁销也有限销，需要联系采购处理。")}))}},{key:"chooseCustomClick",value:function(t){this.goodsDetail.customid=t.customid,this.goodsDetail.customname=t.customname,this.goodsDetail.CONTACTID=t.CONTACTID,this.goodsDetail.CONTACTMAN=t.CONTACTMAN,this.showCustomerPicker=!1,this.page=1,this.customList=[],this._getGoodsPrice()}},{key:"chooseCustom",value:function(){this.showCustomerPicker=!0,this.onLoad()}},{key:"onSearch",value:function(){this.onRefresh()}},{key:"chooseContact",value:function(){if(this.goodsDetail.customid){var t={entryid:this.goodsDetail.entryId,customid:this.goodsDetail.customid,contactid:this.goodsDetail.CONTACTID};this._queryContact(t)}else this.$toast.fail("请先选择客户信息")}},{key:"_queryContact",value:function(t){var e=this,a=this.$toast.loading({message:"运输地址查询中，请稍等......",duration:0,forbidClick:!0});hv(t).then((function(t){a.close(),e.contactList=t,e.getContactShow=!0}))}},{key:"chooseContactClick",value:function(t){this.goodsDetail.ADDRESSID=t.ADDRESSID,this.goodsDetail.ADDRESS=t.ADDRESS,this.getContactShow=!1,this.$forceUpdate()}},{key:"overlimit",value:function(){event.stopPropagation()}},{key:"queryImgs",value:function(t){var e=this;this.queryClickInfor=t,this.queryClickType=1,console.log(t);var a=0;if(this.queryClickInfor.shareGoodsDtl&&this.queryClickInfor.shareGoodsDtl.length>0)for(var s=0;s<this.queryClickInfor.shareGoodsDtl.length;s++){var i=this.queryClickInfor.shareGoodsDtl[s];a+=i.mindtlgoodsqty}xv({entryId:t.entryId,goodsId:t.goodsId,goodsStatusId:t.goodsStatusId,lotid:t.lotid,pqcsFlag:1,storageId:t.storageId,shareEntryId:a>0?this.queryClickInfor.shareGoodsDtl[0].mindtlgoodsqty:t.entryId,pageNum:this.currentPage,pageSize:1}).then((function(t){console.log(t),e.querytotal=t.total,e.imgIforObj=t.list[0],e.queryInforPicker=!0,e.current=0}))}},{key:"pageChange",value:function(){1===this.queryClickType?this.queryImgs(this.queryClickInfor):2===this.queryClickType&&this.queryCustomOften(this.queryClickInfor)}},{key:"queryCustomOften",value:function(t){var e=this;console.log(t),this.queryClickInfor=t,this.queryClickType=2,Iv({entryId:t.entryId,goodsId:t.goodsId,lotid:t.lotid,pageNum:this.currentPage,pageSize:5}).then((function(t){console.log(t),e.customOftenList=t.list,e.querytotal=t.total,e.queryInforPicker=!0,e.current=0}))}},{key:"getImg",value:function(t,e){Object(Ml["a"])({images:t,showIndex:!0,loop:!1,startPosition:e})}},{key:"sendToWareClick",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0===e)this.operatorShow=!0,this._getWarehouseOperator();else{if(0===this.operatorResult.length)return void this.$toast.fail("请选择要提示的仓管员");var a=0;if(this.queryClickInfor.shareGoodsDtl&&this.queryClickInfor.shareGoodsDtl.length>0)for(var s=0;s<this.queryClickInfor.shareGoodsDtl.length;s++){var i=this.queryClickInfor.shareGoodsDtl[s];a+=i.mindtlgoodsqty}Sv({entryId:this.queryClickInfor.entryId,goodsId:this.queryClickInfor.goodsId,goodsName:this.queryClickInfor.goodsName,goodsStatusId:this.queryClickInfor.goodsStatusId,storageId:this.queryClickInfor.storageId,dirType:3===this.queryClickInfor.goodsStatusId?2:3,shareEntryId:a>0?this.queryClickInfor.shareGoodsDtl[0].mindtlgoodsqty:this.queryClickInfor.entryId,lotid:this.queryClickInfor.lotid,userIdList:this.operatorResult}).then((function(e){"200"===e.code?(t.operatorShow=!1,t.$toast.success(e.msg)):t.$toast.fail(e.msg)}))}}},{key:"_getWarehouseOperator",value:function(){var t=this;this.operatorResult=[],console.log(this.queryClickInfor),Dv({storageId:this.queryClickInfor.storageId,keyword:this.operatorSearchValue}).then((function(e){t.operatorList=e}))}},{key:"onChange",value:function(t){this.current=t}},{key:"mounted",value:function(){this.goodsDetail=JSON.parse(JSON.stringify(this.getgoodsDetail)),this.getgoodsDetail.price>0&&(this.twoPinPrice=this.getgoodsDetail.price),this._getGoodsDtl()}}]),a}(d["c"]);Object(u["a"])([h["a"]],ql.prototype,"chooseEntry",void 0),Object(u["a"])([h["a"]],ql.prototype,"getgoodsDetail",void 0),Object(u["a"])([$l.Mutation],ql.prototype,"SET_SHOPCARTSHOW",void 0),Object(u["a"])([h["a"]],ql.prototype,"shopingCartShow",void 0),ql=Object(u["a"])([Object(d["a"])({components:{customerList:Gc},beforeRouteLeave:function(t,e,a){this.shopingCartShow?(this.SET_SHOPCARTSHOW(!1),a(!1)):a(!0)}})],ql);var Vl=ql,Ul=Vl,Fl=(a("765b"),Object(V["a"])(Ul,Pl,El,!1,null,"378f3c2d",null)),zl=Fl.exports,Wl=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wmsTwoPinDic"},[a("div",{staticClass:"btnWarp right"},[a("i",{staticClass:"iconfont ytcrm-center left",on:{click:function(e){return t.$router.back()}}})]),a("div",{staticClass:"wmsTwoPinDicWarp"},[a("div",{staticClass:"twoPinDicHeader clearfix"},[a("div",{staticClass:"iconWarp left"},[a("van-icon",{attrs:{name:"wap-nav"}})],1),a("tab-switch",{staticClass:"left",attrs:{menuList:["未处理","已处理"],tabActiveIndex:t.tabActiveIndex},on:{tabClick:t.tabClick}}),a("div",{staticClass:"searchWarp left"},[a("li",{staticClass:"clearfix",staticStyle:{padding:"10px","border-bottom":"1px solid #eee"}},[a("van-button",{staticClass:"right",attrs:{"icon-position":"right",icon:"arrow-down",size:"mini",plain:"",hairline:"",type:"info"},on:{click:t.superFliter}},[t._v("高级搜索")]),a("van-button",{staticClass:"right",staticStyle:{"margin-right":"10px"},attrs:{size:"mini",plain:"",hairline:"",type:"warning"},on:{click:t.clearFliter}},[t._v("清除筛选条件")])],1)])],1),a("div",{ref:"goodsCustomWarp",staticClass:"warpList",staticStyle:{height:"calc(100% - 100px)",overflow:"auto"}},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.getDataLoading,callback:function(e){t.getDataLoading=e},expression:"getDataLoading"}},[a("twopin-goods",{attrs:{isResell:!0,goodsDataList:t.dataList},on:{goodsClick:t.goodsClick}})],1)],1)],1)]),a("van-popup",{style:{height:"100%",width:"100%"},attrs:{position:"right",closeable:""},model:{value:t.dtlShow,callback:function(e){t.dtlShow=e},expression:"dtlShow"}},[a("twopin-goods",{attrs:{isResell:!0,goodsDataList:[t.clickObj]}}),a("div",{staticClass:"dtlWarp"},[a("van-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.goodsDtlList,(function(e,s){return a("van-collapse-item",{key:s,attrs:{name:s},scopedSlots:t._u([{key:"title",fn:function(){return[a("ul",{staticClass:"commonLine"},[a("li",{staticClass:"oneLine",staticStyle:{"line-height":"30px"}},[a("van-tag",{attrs:{color:3===e.goodsStatusId?"#FC923F":"rgb(255, 126, 132)"}},[t._v(t._s(e.goodsStatus))]),a("span",{staticClass:"title paddingLeft-5"},[t._v("批号：")]),a("span",{staticClass:"value fontWeight bigfontSize"},[t._v(t._s(e.lotno))]),0===t.tabActiveIndex?a("div",{staticClass:"right",on:{click:function(t){return t.stopPropagation()}}},[a("van-button",{attrs:{size:"mini",plain:"",type:"info"},on:{click:function(a){return t.unloadImgClick(e)}}},[t._v("批量处理")])],1):a("div",{staticClass:"right",on:{click:function(t){return t.stopPropagation()}}},[a("van-button",{staticClass:"right",attrs:{size:"mini",plain:"",type:"info"},on:{click:function(a){return t.unloadImgClick(e)}}},[t._v("查看所有")])],1)],1),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft",staticStyle:{flex:"1.5"}},[a("span",{staticClass:"title"},[t._v("可销库存：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.mindtlgoodsqty))])]),a("p",{staticClass:"twoRight",staticStyle:{flex:"2"}},[a("span",{staticClass:"title"},[t._v("保管账：")]),a("span",{staticClass:"value"},[t._v(t._s(e.storageName))])])]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft",staticStyle:{flex:"1.5"}},[a("span",{staticClass:"title"},[t._v("二销库存：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.dtlsecgoodsqty))])]),a("p",{staticClass:"twoRight",staticStyle:{flex:"2"}},[a("span",{staticClass:"title"},[t._v("效期：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.invalidDate.substring(0,10))+"("+t._s(e.diffDay)+"天)")])])])])]},proxy:!0}],null,!0)},[a("div",{staticClass:"contentWarp"},t._l(e.pqcsImgRecordList,(function(s,i){return a("ul",{key:i,staticClass:"commonLine",staticStyle:{padding:"5px","margin-bottom":"3px","box-shadow":"0px 2px 2px 0px #eee"}},[a("li",{staticClass:"oneLine"},[t._v(" 创建时间："+t._s(s.createTime)+" "),0===t.tabActiveIndex?a("div",{staticClass:"right"},[a("van-button",{attrs:{icon:"plus",plain:"",size:"mini",type:"info"},on:{click:function(a){return t.unloadImgClick(e,s)}}},[t._v("上传照片")])],1):a("van-button",{staticClass:"right",attrs:{size:"mini",plain:"",type:"info"},on:{click:function(a){return t.unloadImgClick(e,s)}}},[t._v("查看照片")])],1),a("li",{staticClass:"oneLine"},[t._v("发起人："+t._s(s.sponsorId)+"/"+t._s(s.sponsorName))])])})),0)])})),1)],1)],1),a("van-popup",{staticClass:"imgsShowWarp",style:{height:"80%",width:"100%"},attrs:{position:"bottom",round:"",closeable:""},model:{value:t.imgsShow,callback:function(e){t.imgsShow=e},expression:"imgsShow"}},[0===t.tabActiveIndex?a("ul",{staticClass:"commonLine",staticStyle:{padding:"40px 10px 10px",positon:"relative",height:"calc(100% - 50px)"}},[a("li",{staticClass:"oneLine fontWeight fontSize-14"},[t._v(t._s(t.clickObj.goodsId)+"/"+t._s(t.clickObj.goodsName))]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("厂家：")]),a("span",{staticClass:"value"},[t._v(t._s(t.clickObj.factoryname))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("规格：")]),a("span",{staticClass:"value"},[t._v(t._s(t.clickObj.goodstype))])])]),t.lineClickObj.createTime?t._e():a("li",{staticClass:"oneLine text-red"},[t._v("批量处理所有发起")]),t.lineClickObj.createTime?a("li",{staticClass:"oneLine"},[t._v("创建时间："+t._s(t.lineClickObj.createTime))]):t._e(),t.lineClickObj.createTime?a("li",{staticClass:"oneLine"},[t._v("发起人："+t._s(t.lineClickObj.sponsorId)+"/"+t._s(t.lineClickObj.sponsorName))]):t._e(),a("van-uploader",{attrs:{multiple:""},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}}),a("li",{staticClass:"button clearfix",staticStyle:{width:"calc(100% - 20px)",position:"absolute",bottom:"10px"}},[a("van-button",{staticClass:"left",staticStyle:{width:"45%"},attrs:{size:"small",type:"info",plain:"",round:""},on:{click:t.afterRead}},[t._v("确定上传")]),a("van-button",{staticClass:"right",staticStyle:{width:"45%"},attrs:{size:"small",type:"default",round:""},on:{click:function(e){t.imgsShow=!1}}},[t._v("取消上传")])],1)],1):a("ul",{staticClass:"commonLine",staticStyle:{padding:"40px 10px 10px",positon:"relative",height:"calc(100% - 50px)"}},[a("li",{staticClass:"oneLine fontWeight fontSize-14"},[t._v(t._s(t.clickObj.goodsId)+"/"+t._s(t.clickObj.goodsName))]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("厂家：")]),a("span",{staticClass:"value"},[t._v(t._s(t.clickObj.factoryname))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("规格：")]),a("span",{staticClass:"value"},[t._v(t._s(t.clickObj.goodstype))])])]),t.lineClickObj.createTime?t._e():a("li",{staticClass:"oneLine text-red"},[t._v("查看所有处理图片")]),t.lineClickObj.createTime?a("li",{staticClass:"oneLine"},[t._v("创建时间："+t._s(t.lineClickObj.createTime))]):t._e(),t.lineClickObj.createTime?a("li",{staticClass:"oneLine"},[t._v("发起人："+t._s(t.lineClickObj.sponsorId)+"/"+t._s(t.lineClickObj.sponsorName))]):t._e(),t.imgIforObj&&t.imgIforObj.imgList?a("van-swipe",{staticStyle:{height:"280px"},on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[a("div",{staticClass:"custom-indicator"},[t._v(t._s(t.current+1)+"/"+t._s(t.imgIforObj.imgList.length))])]},proxy:!0}],null,!1,1729476862)},t._l(t.imgIforObj.imgList,(function(e,s){return a("van-swipe-item",{key:s},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"image"}],attrs:{src:e},on:{click:function(e){return t.getImg(t.imgIforObj.imgList,s)}}})])})),1):t._e(),t.querytotal>0?a("van-pagination",{staticStyle:{width:"calc(100% - 20px)",position:"absolute",bottom:"10px"},attrs:{"total-items":t.querytotal,"items-per-page":1,"force-ellipses":""},on:{change:t.pageChange},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)]),a("van-popup",{style:{width:"100%",height:"auto"},attrs:{position:"top",round:""},model:{value:t.filterShow,callback:function(e){t.filterShow=e},expression:"filterShow"}},[a("ul",{staticClass:"filterWarp"},[a("van-form",[a("van-field",{attrs:{name:"货品ID|名称",label:"货品ID|名称",placeholder:"货品ID|名称"},model:{value:t.filterObj.goodsNameOrId,callback:function(e){t.$set(t.filterObj,"goodsNameOrId",e)},expression:"filterObj.goodsNameOrId"}}),a("van-field",{attrs:{name:"核算单元ID",label:"核算单元ID",placeholder:"核算单元ID"},model:{value:t.filterObj.entryId,callback:function(e){t.$set(t.filterObj,"entryId",e)},expression:"filterObj.entryId"}}),a("van-field",{attrs:{name:"核算单元名称",label:"核算单元名称",placeholder:"核算单元名称"},model:{value:t.filterObj.entryName,callback:function(e){t.$set(t.filterObj,"entryName",e)},expression:"filterObj.entryName"}}),a("div",{staticClass:"clearfix",staticStyle:{margin:"16px"}},[a("van-button",{staticClass:"left",staticStyle:{width:"49%"},attrs:{round:"",block:"",type:"default"},on:{click:t.clearFliter}},[t._v("重置")]),a("van-button",{staticClass:"right",staticStyle:{width:"49%"},attrs:{round:"",block:"",type:"info"},on:{click:t.filterSubmit}},[t._v("确定")])],1)],1)],1)])],1)},Bl=[],Gl=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.current=0,t.tabActiveIndex=0,t.dataList=[],t.page=1,t.finished=!1,t.refreshing=!1,t.getDataLoading=!1,t.dtlShow=!1,t.imgsShow=!1,t.clickObj={},t.dtlClickObj={},t.lineClickObj={},t.goodsDtlList=[],t.activeNames=[0],t.fileList=[],t.imgIforObj={},t.currentPage=1,t.querytotal=1,t.filterShow=!1,t.filterObj={goodsId:"",goodsNameOrId:"",entryId:"",entryName:""},t}return Object(o["a"])(a,[{key:"_getGoodsResellPcqs",value:function(){var t=this;this.$cancelAxios(["getGoodsResellPcqs"]),1===this.page&&(this.dataList=[]),jv({entryId:this.filterObj.entryId,entryName:this.filterObj.entryName,goodsNameOrId:this.filterObj.goodsNameOrId,pqcsFlag:this.tabActiveIndex,pageNum:this.page,pageSize:10}).then((function(e){"4000"===e.code&&(t.finished=!0,t.getDataLoading=!1,t.$toast.fail(e.msg)),t.dataList=t.dataList.concat(e.data.list),t.getDataLoading=!0,e.hasNextPage?(t.getDataLoading=!1,t.page++):t.finished=!0}))}},{key:"tabClick",value:function(t){var e=t.index;this.tabActiveIndex=e,this.clearFliter()}},{key:"onRefresh",value:function(){this.finished=!1,this.getDataLoading=!1,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.dataList=[],this.refreshing=!1),this.getDataLoading=!0,this._getGoodsResellPcqs()}},{key:"goodsClick",value:function(t){var e=this;this.fileList=[],this.clickObj=t,Tv({entryId:t.entryId,goodsId:t.goodsId,storageId:t.storageId,pqcsFlag:this.tabActiveIndex}).then((function(t){e.goodsDtlList=t;for(var a=0;a<e.goodsDtlList.length;a++)e.activeNames.push(a);e.dtlShow=!0,0===e.goodsDtlList.length&&(e.onRefresh(),e.dtlShow=!1)}))}},{key:"unloadImgClick",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.dtlClickObj=t,console.log(t),1===this.tabActiveIndex?(Rv({entryId:t.entryId,goodsId:t.goodsId,goodsStatusId:t.goodsStatusId,lotid:t.lotid,pqcsFlag:1,cpsiId:""!==a?a.cpsiId:"",storageId:t.storageId,pageNum:this.currentPage,pageSize:1}).then((function(t){e.imgIforObj=t.list[0],e.querytotal=t.total,e.imgsShow=!0,e.current=0})),this.lineClickObj=""!==a?a:{}):(this.imgsShow=!0,this.current=0,this.lineClickObj=""!==a?a:{})}},{key:"pageChange",value:function(){this.unloadImgClick(this.dtlClickObj,this.lineClickObj)}},{key:"afterRead",value:function(){var t=this,e=[];if(this.lineClickObj.cpsiId)e.push(this.lineClickObj.cpsiId);else for(var a=0;a<this.dtlClickObj.pqcsImgRecordList.length;a++){var s=this.dtlClickObj.pqcsImgRecordList[a];e.push(s.cpsiId)}var i=new FormData;if(0!==this.fileList.length){for(var n=0;n<this.fileList.length;n++){var r=this.fileList[n];r.status="uploading",r.message="上传中...";var o=r.file.name.split("."),c=new File([r.file],"index"+n+"."+o[o.length-1]);console.log(c),i.append("imgs",c)}i.append("cpsiIds",e),Nv(i).then((function(e){if("200"===e.code){t.imgsShow=!1;for(var a=0;a<t.fileList.length;a++){var s=t.fileList[a];s.status="success",s.message="上传成功"}t.$toast.success("上传成功"),setTimeout((function(){t.goodsClick(t.clickObj)}),800)}else for(var i=0;i<t.fileList.length;i++){var n=t.fileList[i];n.status="failed",n.message="上传失败"}}))}else this.$toast.fail("请选择要上传的图片")}},{key:"getImg",value:function(t,e){Object(Ml["a"])({images:t,showIndex:!0,loop:!1,startPosition:e})}},{key:"superFliter",value:function(){this.filterShow=!0,console.log("高级搜索")}},{key:"clearFliter",value:function(){this.filterObj={goodsNameOrId:"",entryId:"",entryName:""},this.onRefresh()}},{key:"filterSubmit",value:function(t){console.log(t),this.filterShow=!1,this.onRefresh()}},{key:"onChange",value:function(t){this.current=t}}]),a}(d["c"]);Gl=Object(u["a"])([Object(d["a"])({components:{tabSwitch:qc,twopinGoods:Zc},beforeRouteLeave:function(t,e,a){this.dtlShow?(this.dtlShow=!1,this.imgsShow=!1,a(!1)):a(!0)}})],Gl);var Hl=Gl,Yl=Hl,Ql=(a("f7f8"),Object(V["a"])(Yl,Wl,Bl,!1,null,"4ba642d2",null)),Kl=Ql.exports,Jl=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wmsTwoPinDetail"},[a("twopin-goods",{attrs:{isResell:!0,goodsDataList:t.goodsDtlList}}),a("div",{staticClass:"dtlWarp"},[a("van-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.goodsDtlList,(function(e,s){return a("van-collapse-item",{key:s,attrs:{name:s},scopedSlots:t._u([{key:"title",fn:function(){return[a("ul",{staticClass:"commonLine"},[a("li",{staticClass:"oneLine",staticStyle:{"line-height":"30px"}},[a("van-tag",{attrs:{color:3===e.goodsStatusId?"#FC923F":"rgb(255, 126, 132)"}},[t._v(t._s(e.goodsStatus))]),a("span",{staticClass:"title paddingLeft-5"},[t._v("批号：")]),a("span",{staticClass:"value fontWeight bigfontSize"},[t._v(t._s(e.lotno))])],1),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft",staticStyle:{flex:"1.5"}},[a("span",{staticClass:"title"},[t._v("可销库存：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.mindtlgoodsqty))])]),a("p",{staticClass:"twoRight",staticStyle:{flex:"2"}},[a("span",{staticClass:"title"},[t._v("保管账：")]),a("span",{staticClass:"value"},[t._v(t._s(e.storageName))])])]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft",staticStyle:{flex:"1.5"}},[a("span",{staticClass:"title"},[t._v("二销库存：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.dtlsecgoodsqty))])]),a("p",{staticClass:"twoRight",staticStyle:{flex:"2"}},[a("span",{staticClass:"title"},[t._v("效期：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.invalidDate.substring(0,10))+"("+t._s(e.diffDay)+"天)")])])])])]},proxy:!0}],null,!0)},[a("div",{staticClass:"contentWarp"},t._l(e.pqcsImgRecordList,(function(i,n){return a("ul",{key:n,staticClass:"commonLine",staticStyle:{padding:"5px","margin-bottom":"3px","box-shadow":"0px 2px 2px 0px #eee"}},[a("li",{staticClass:"oneLine"},[t._v(" 创建时间："+t._s(i.createTime)+" "),0===t.type?a("div",{staticClass:"right"},[a("van-button",{attrs:{icon:"plus",plain:"",size:"mini",type:"info"},on:{click:function(a){return t.unloadImgClick(e,s)}}},[t._v("上传照片")])],1):a("van-button",{staticClass:"right",attrs:{size:"mini",plain:"",type:"info"},on:{click:function(a){return t.unloadImgClick(e,s)}}},[t._v("查看照片")])],1),a("li",{staticClass:"oneLine"},[t._v("发起人："+t._s(i.sponsorId)+"/"+t._s(i.sponsorName))])])})),0)])})),1)],1),a("van-popup",{staticClass:"imgsShowWarp",style:{height:"80%",width:"100%"},attrs:{position:"bottom",round:"",closeable:""},model:{value:t.imgsShow,callback:function(e){t.imgsShow=e},expression:"imgsShow"}},[0===t.type?a("ul",{staticClass:"commonLine",staticStyle:{padding:"40px 10px 10px",positon:"relative",height:"calc(100% - 50px)"}},[a("li",{staticClass:"oneLine fontWeight fontSize-14"},[t._v(t._s(t.goodsDtlList[0]&&t.goodsDtlList[0].goodsId)+"/"+t._s(t.goodsDtlList[0]&&t.goodsDtlList[0].goodsName))]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("厂家：")]),a("span",{staticClass:"value"},[t._v(t._s(t.goodsDtlList[0]&&t.goodsDtlList[0].factoryname))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("规格：")]),a("span",{staticClass:"value"},[t._v(t._s(t.goodsDtlList[0]&&t.goodsDtlList[0].goodstype))])])]),t.lineClickObj.createTime?a("li",{staticClass:"oneLine"},[t._v("创建时间："+t._s(t.lineClickObj.createTime))]):t._e(),t.lineClickObj.createTime?a("li",{staticClass:"oneLine"},[t._v("发起人："+t._s(t.lineClickObj.sponsorId)+"/"+t._s(t.lineClickObj.sponsorName))]):t._e(),a("van-uploader",{attrs:{multiple:""},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}}),a("li",{staticClass:"button clearfix",staticStyle:{width:"calc(100% - 20px)",position:"absolute",bottom:"10px"}},[a("van-button",{staticClass:"left",staticStyle:{width:"45%"},attrs:{size:"small",type:"info",plain:"",round:""},on:{click:t.afterRead}},[t._v("确定上传")]),a("van-button",{staticClass:"right",staticStyle:{width:"45%"},attrs:{size:"small",type:"default",round:""},on:{click:function(e){t.imgsShow=!1}}},[t._v("取消上传")])],1)],1):a("ul",{staticClass:"commonLine",staticStyle:{padding:"40px 10px 10px",positon:"relative",height:"calc(100% - 50px)"}},[a("li",{staticClass:"oneLine fontWeight fontSize-14"},[t._v(t._s(t.goodsDtlList[0]&&t.goodsDtlList[0].goodsId)+"/"+t._s(t.goodsDtlList[0]&&t.goodsDtlList[0].goodsName))]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("厂家：")]),a("span",{staticClass:"value"},[t._v(t._s(t.goodsDtlList[0]&&t.goodsDtlList[0].factoryname))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("规格：")]),a("span",{staticClass:"value"},[t._v(t._s(t.goodsDtlList[0]&&t.goodsDtlList[0].goodstype))])])]),t.lineClickObj.createTime?t._e():a("li",{staticClass:"oneLine text-red"},[t._v("查看所有处理图片")]),t.lineClickObj.createTime?a("li",{staticClass:"oneLine"},[t._v("创建时间："+t._s(t.lineClickObj.createTime))]):t._e(),t.lineClickObj.createTime?a("li",{staticClass:"oneLine"},[t._v("发起人："+t._s(t.lineClickObj.sponsorId)+"/"+t._s(t.lineClickObj.sponsorName))]):t._e(),t.imgIforObj&&t.imgIforObj.imgList?a("van-swipe",{staticStyle:{height:"280px"}},t._l(t.imgIforObj.imgList,(function(e,s){return a("van-swipe-item",{key:s},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"image"}],attrs:{src:e},on:{click:function(e){return t.getImg(t.imgIforObj.imgList,s)}}})])})),1):t._e(),t.querytotal>0?a("van-pagination",{staticStyle:{width:"calc(100% - 20px)",position:"absolute",bottom:"10px"},attrs:{"total-items":t.querytotal,"items-per-page":1,"force-ellipses":""},on:{change:t.pageChange},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)])],1)},Xl=[],Zl=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.goodsDtlList=[],t.activeNames=[0],t.type=0,t.dtlClickObj={},t.lineClickObj={},t.imgsShow=!1,t.fileList=[],t.imgIforObj={},t.currentPage=1,t.querytotal=1,t}return Object(o["a"])(a,[{key:"_getimgsPqsc",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Rv({shareEntryId:this.$route.query.entryId,goodsId:this.$route.query.goodsId,goodsStatusId:this.$route.query.goodsStatusId,lotid:this.$route.query.lotid,storageId:this.$route.query.storageId,pageNum:1,pageSize:1,cpsiId:this.$route.query.cpsiId}).then((function(a){a.list&&a.list.length>0&&(t.type=a.list[0].pqcsFlag,t.imgIforObj=a.list[0],e&&t._getGoodsDtlPcsq())}))}},{key:"_getGoodsDtlPcsq",value:function(){var t=this;Tv({entryId:this.$route.query.entryId,goodsId:this.$route.query.goodsId,storageId:this.$route.query.storageId,lotid:this.$route.query.lotid,cpsiId:this.$route.query.cpsiId,pqcsFlag:this.type}).then((function(e){t.goodsDtlList=e;for(var a=0;a<t.goodsDtlList.length;a++)t.activeNames.push(a)}))}},{key:"unloadImgClick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.dtlClickObj=t,this.imgsShow=!0,""!==e?(this.lineClickObj=t.pqcsImgRecordList[e],console.log(this.lineClickObj),this.imgIforObj=this.lineClickObj):(this.lineClickObj={},this._getimgsPqsc(!1))}},{key:"afterRead",value:function(){var t=this,e=[];if(this.lineClickObj.cpsiId)e.push(this.lineClickObj.cpsiId);else for(var a=0;a<this.dtlClickObj.pqcsImgRecordList.length;a++){var s=this.dtlClickObj.pqcsImgRecordList[a];e.push(s.cpsiId)}var i=new FormData;if(0!==this.fileList.length){for(var n=0;n<this.fileList.length;n++){var r=this.fileList[n];r.status="uploading",r.message="上传中...";var o=r.file.name.split("."),c=new File([r.file],"index"+n+"."+o[o.length-1]);console.log(c),i.append("imgs",c)}i.append("cpsiIds",e),Nv(i).then((function(e){"200"===e.code?(t.$toast.success("上传成功"),t.imgsShow=!1,t.fileList=[],setTimeout((function(){t.type=1,t._getGoodsDtlPcsq()}),800)):t.$toast.fail(e.msg)}))}else this.$toast.fail("请选择要上传的图片")}},{key:"getImg",value:function(t,e){Object(Ml["a"])({images:t,showIndex:!0,loop:!1,startPosition:e})}},{key:"pageChange",value:function(){this.unloadImgClick(this.dtlClickObj,this.lineClickObj)}},{key:"mounted",value:function(){this._getimgsPqsc(),console.log(this.$route.query)}}]),a}(d["c"]);Zl=Object(u["a"])([Object(d["a"])({components:{twopinGoods:Zc}})],Zl);var tu=Zl,eu=tu,au=(a("a274"),Object(V["a"])(eu,Jl,Xl,!1,null,"2dc6c1c6",null)),su=au.exports,iu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"inventoryQuery"},[t.hasSearch?t._e():s("div",{staticClass:"imgLogo"},[s("img",{attrs:{src:a("29af"),alt:"",srcset:""}})]),s("div",{staticClass:"search"},[s("van-search",{attrs:{"show-action":"",placeholder:"请输入搜索关键词"},on:{search:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[s("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t.searchValue&&t.hasSearch?s("div",{staticClass:"listWarp"},[s("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.dataloading,callback:function(e){t.dataloading=e},expression:"dataloading"}},t._l(t.dataList,(function(e,a){return s("ul",{key:a,staticClass:"sameList",style:e.hasClick?"background:#eee;":"",on:{click:function(s){return t.listClick(e,a,s)}}},[s("li",{staticClass:"online"},[s("p",{staticClass:"one clearfix"},[s("span",{staticClass:"title"},[t._v("品种：")]),s("span",{staticClass:"value"},[t._v(" "+t._s(e.goodsid)+"/"+t._s(e.currencyname?e.goodsname+"("+e.currencyname+")":e.goodsname)+" "),s("div",{staticStyle:{display:"inline-block"},on:{click:function(e){return t.copyContent(a)}}},[s("i",{staticClass:"iconfont ytcrm-fuzhi",attrs:{"data-clipboard-text":e.goodsid+"/"+(null!==e.currencyname?e.goodsname+"("+e.currencyname+")":e.goodsname),id:"copy_custsetinfor"+a}})])])])]),s("li",{staticClass:"online"},[s("p",{staticClass:"one clearfix"},[s("span",{staticClass:"title"},[t._v("核算单元：")]),s("span",{staticClass:"value"},[t._v(t._s(e.entryId)+"/"+t._s(e.entryName))])])]),s("li",{staticClass:"twoline clearfix"},[s("p",{staticClass:"two-left left slh"},[s("span",{staticClass:"title"},[t._v("规格：")]),s("span",{staticClass:"value"},[t._v(t._s(e.goodstype))])]),s("p",{staticClass:"two-right left slh"},[s("span",{staticClass:"title"},[t._v("产地：")]),s("span",{staticClass:"value"},[t._v(t._s(e.prodarea?e.prodarea:e.prodarea2?e.prodarea2:"主档信息暂未维护"))])])]),s("li",{staticClass:"twoline clearfix"},[s("p",{staticClass:"two-left left slh"},[s("span",{staticClass:"title"},[t._v("采购员：")]),s("span",{staticClass:"value"},[t._v(t._s(e.employeeName?e.employeeName:e.supplyerName))])]),s("p",{staticClass:"two-right left slh"},[s("span",{staticClass:"title"},[t._v("可销库存：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(e.goodsqty?e.goodsqty:"0"))])])]),s("div",{staticClass:"tags"},[s("div",{staticClass:"coldflag",class:0===e.coldflag||null===e.coldflag?"nocoldflag":""},[t._v(" "+t._s(0===e.coldflag||null===e.coldflag?"非":(e.coldflag,""))+"冷链 ")])]),s("li",{staticClass:"list-btns"},[s("div",{staticClass:"btn",on:{click:function(a){return a.stopPropagation(),t.searchLimit(e)}}},[t._v(" 查看可销库存下限 ")]),s("div",{staticClass:"btn",on:{click:function(a){return a.stopPropagation(),t.queryPrice(e)}}},[t._v("查看价格")])])])})),0)],1)],1):t._e(),s("van-popup",{style:{height:"100%",width:"100%"},attrs:{position:"right",closeable:""},on:{touchmove:function(t){t.stopPropagation(),t.preventDefault()}},model:{value:t.dtlShow,callback:function(e){t.dtlShow=e},expression:"dtlShow"}},[s("header",{staticClass:"fontSize-14",staticStyle:{"text-align":"center","line-height":"40px"}},[t._v("库存列表")]),s("div",{staticClass:"dtlWarp"},[t._l(t.detailDataList,(function(e,a){return s("ul",{key:a,staticClass:"sameList"},[s("li",{staticClass:"online"},[s("p",{staticClass:"one slh"},[s("span",{staticClass:"title"},[t._v("品种：")]),s("span",{staticClass:"value"},[t._v(t._s(e.goodsId)+"/"+t._s(e.currencyname?e.goodsName+"("+e.currencyname+")":e.goodsName))])])]),s("li",{staticClass:"twoline"},[s("p",{staticClass:"two-left left slh"},[s("span",{staticClass:"title"},[t._v("采购员：")]),s("span",{staticClass:"value"},[t._v(t._s(e.employeename))])]),s("p",{staticClass:"two-right left slh"},[s("span",{staticClass:"title"},[t._v("货品状态：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(e.goodsstatus))])])]),s("li",{staticClass:"twoline"},[s("p",{staticClass:"two-left left slh"},[s("span",{staticClass:"title"},[t._v("货品规格：")]),s("span",{staticClass:"value"},[t._v(t._s(e.goodstype))])]),s("p",{staticClass:"two-right left slh"},[s("span",{staticClass:"title"},[t._v("批号：")]),s("span",{staticClass:"value fontWeight"},[t._v(t._s(e.lotno))])])]),s("li",{staticClass:"twoline"},[s("p",{staticClass:"two-left left slh"},[s("span",{staticClass:"title"},[t._v("保管账名称：")]),s("span",{staticClass:"value"},[t._v(t._s(e.storagename))])]),s("p",{directives:[{name:"show",rawName:"v-show",value:e.invaliddate,expression:"data.invaliddate"}],staticClass:"two-right left slh"},[s("span",{staticClass:"title"},[t._v("效期至：")]),s("span",{staticClass:"value main-color"},[t._v(t._s(e.invaliddate))])])]),s("li",{staticClass:"twoline"},[s("p",{staticClass:"two-left left slh"},[s("span",{staticClass:"title"},[t._v("两票制库存：")]),s("span",{staticClass:"value"},[t._v(t._s(e.goodsNum||0))])]),s("p",{staticClass:"two-right left slh"},[s("span",{staticClass:"title"},[t._v("两票制：")]),s("span",{staticClass:"value fontWeight"},[t._v(" "+t._s(1==e.invoiceFlag?"两票制":2==e.invoiceFlag?"发票未到":3==e.invoiceFlag?"无两票制库存":0==e.invoiceFlag?"非两票制":"")+" ")])])]),s("li",{staticClass:"twoline"},[s("p",{staticClass:"two-left left slh"},[s("span",{staticClass:"title"},[t._v("库存：")]),s("span",{staticClass:"value"},[t._v(t._s(e.goodsqty))])]),s("p",{staticClass:"two-right left slh"},[s("span",{staticClass:"title"},[t._v("产地：")]),s("span",{staticClass:"value fontWeight"},[t._v(" "+t._s(t.getProdarea)+" ")])])]),s("li",{directives:[{name:"show",rawName:"v-show",value:e.packsize&&e.packname&&e.goodsunit,expression:"data.packsize && data.packname && data.goodsunit"}],staticClass:"online"},[s("p",{staticClass:"one slh"},[s("span",{staticClass:"title"},[t._v("包装：")]),s("span",{staticClass:"value"},[t._v(t._s(e.packsize)+t._s(e.goodsunit)+"/"+t._s(e.packname))])])])])})),t.detailDataList&&0!==t.detailDataList.length?t._e():s("van-empty",{attrs:{description:"暂无详情列表"}})],2)])],1)},nu=[],ru=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=j+"/api/inventory/infoList",t.next=3,iv({method:"get",url:a,params:e});case 3:return s=t.sent,t.abrupt("return",s.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ou=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=j+"/api/inventory/lowerLimit",t.next=3,iv({method:"get",url:a,params:e,headers:{needOperateLoading:!0,msg:encodeURIComponent("可销库存下限查询中，请稍等......")}});case 3:return s=t.sent,t.abrupt("return",s.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),cu=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=j+"/api/inventory/price",t.next=3,iv({method:"get",url:a,params:e,headers:{needOperateLoading:!0,msg:encodeURIComponent("价格查询中，请稍等......")}});case 3:return s=t.sent,t.abrupt("return",s.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),lu=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=j+"/api/inventory/detailInfoList",t.next=3,iv({method:"get",url:a,params:e,headers:{needOperateLoading:!0,msg:encodeURIComponent("库存列表查询中，请稍等......")}});case 3:return s=t.sent,t.abrupt("return",s.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),uu=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.searchValue="",t.hasSearch=!1,t.finished=!1,t.refreshing=!1,t.dataloading=!0,t.page=1,t.pageSize=4,t.dataList=[],t.detailDataList=[],t.dtlShow=!1,t.getProdarea="",t}return Object(o["a"])(a,[{key:"onSearch",value:function(){this.page=1,this.dataList=[],this.onLoad()}},{key:"onRefresh",value:function(){this.finished=!1,this.dataloading=!0,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.dataList=[],this.refreshing=!1),this.finished=!1,this.dataloading=!0,this._getInfoList()}},{key:"_getInfoList",value:function(){var t=this;if(this.$cancelAxios(["infoList"]),this.searchValue){this.hasSearch=!0,1===this.page&&(this.dataList=[]);var e={keyWords:this.searchValue,page:this.page,pageSize:this.pageSize};ru(e).then((function(e){"200"===e.code?(t.dataList=t.dataList.concat(e.data.list),e.data.hasNextPage?(t.dataloading=!1,t.page++):t.finished=!0):t.$toast.fail(e.msg)}))}else this.$toast.fail("请输入要查询的货品信息")}},{key:"listClick",value:function(t,e,a){var s=this;a.target.id!=="copy_custsetinfor"+e&&(this.$set(t,"hasClick",!0),t.goodsqty&&(this.getProdarea=t.prodarea?t.prodarea:t.prodarea2?t.prodarea2:"主档信息暂未维护"),lu({entryId:t.entryId,goodsId:t.goodsid}).then((function(t){s.dtlShow=!0,s.detailDataList=t.data})))}},{key:"copyContent",value:function(t){st("#copy_custsetinfor"+t,this)}},{key:"searchLimit",value:function(t){var e=this;ou({entryId:t.entryId,goodsId:t.goodsid}).then((function(t){for(var a="",s=0;s<t.data.length;s++){var i=t.data[s];a+='<div class="lock-info"><span>'.concat(i.ddlName,'：</span><span class="fontWeight">').concat(i.forbidsqty,"</span></div>")}e.$dialog.confirm({message:a||"暂无可销库存下限",allowHtml:!0})}))}},{key:"queryPrice",value:function(t){var e=this;cu({entryId:t.entryId,goodsId:t.goodsid}).then((function(a){var s=a.data||0===a.data?"".concat(t.goodsname,"的跟标医院限价是").concat(a.data,"元"):"未查到".concat(t.goodsname,"价格");e.$dialog.confirm({message:s,allowHtml:!0})}))}}]),a}(d["c"]);uu=Object(u["a"])([Object(d["a"])({beforeRouteLeave:function(t,e,a){this.dtlShow?(this.dtlShow=!1,a(!1)):a(!0)}})],uu);var du=uu,hu=du,pu=(a("3318"),Object(V["a"])(hu,iu,nu,!1,null,"4640ac3e",null)),mu=pu.exports,vu=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inquiryLetterAssistant"},[a("div",{staticClass:"searchWarp clearfix"},[a("van-search",{staticClass:"left",attrs:{shape:"round","show-action":"",placeholder:"输入客户ID或名称可查询"},on:{input:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}}),t.filterObj.startTime||t.filterObj.endTime||t.filterObj.confirmadocid||t.filterObj.customerId||t.filterObj.customName?a("van-badge",{staticStyle:{"margin-top":"15px","margin-right":"5px"},attrs:{dot:""}},[a("van-button",{staticClass:"right",attrs:{"icon-position":"right",icon:"arrow-down",size:"mini",hairline:"",type:"info"},on:{click:t.superFliter}},[t._v("高级搜索")])],1):a("van-button",{staticClass:"right",staticStyle:{"margin-top":"15px","margin-right":"5px"},attrs:{"icon-position":"right",icon:"arrow-down",size:"mini",hairline:"",type:"info"},on:{click:t.superFliter}},[t._v(" 高级搜索 ")])],1),t.validNumber?a("div",{staticClass:"notice",staticStyle:{"margin-top":"5px"},on:{click:function(e){t.validShow=!0}}},[a("van-notice-bar",{attrs:{"left-icon":"info-o",mode:"link"}},[t._v("预警：你有"+t._s(t.validNumber)+"条超期消息未处理")])],1):t._e(),a("van-tabs",{attrs:{type:"card",color:"rgba(35, 98, 251, 0.6)"},on:{click:t.inquiryTypeClick}},[a("van-tab",{attrs:{title:"未处理"}}),a("van-tab",{attrs:{title:"进行中"}}),a("van-tab",{attrs:{title:"已完成"}}),a("van-tab",{attrs:{title:"已审核"}})],1),a("div",{staticClass:"mainWarp"},[a("van-pull-refresh",{attrs:{id:"inquiryList"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.getDataLoading,callback:function(e){t.getDataLoading=e},expression:"getDataLoading"}},[a("inquiry-letter-list",{ref:"inquiryLetterList",attrs:{inquiryType:t.inquiryType,inquiryList:t.inquiryDataList},on:{changeStatus:t.changeStatus,inquiryDetailClick:t.inquiryDetailClick}})],1)],1)],1),a("i",{staticClass:"iconfont ytcrm-dakuanyichang",on:{click:t.addClick}}),a("i",{staticClass:"iconfont ytcrm-rizhiyichang",on:{click:t.queryClick}}),a("van-popup",{style:{width:"100%",height:"auto"},attrs:{position:"top",round:""},model:{value:t.filterShow,callback:function(e){t.filterShow=e},expression:"filterShow"}},[a("ul",{staticClass:"filterWarp"},[a("van-form",[a("van-field",{attrs:{readonly:"",clickable:"",name:"calendar",value:t.filterObj.startTime?t.filterObj.startTime+" ~ "+t.filterObj.endTime:"",label:"时间范围",placeholder:"点击选择日期"},on:{click:function(e){t.calendarShow=!0}}}),t.calendarShow?a("div",{staticClass:"calendar"},[a("van-calendar",{attrs:{type:"range","min-date":new Date(2020,0,1),"first-day-of-week":"1",color:"#1989fa"},on:{confirm:t.selectCalendar},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}})],1):t._e(),a("van-field",{attrs:{name:"总单编号",label:"总单编号",placeholder:"总单编号"},model:{value:t.filterObj.confirmadocid,callback:function(e){t.$set(t.filterObj,"confirmadocid",e)},expression:"filterObj.confirmadocid"}}),a("van-field",{attrs:{name:"客户ID",label:"客户ID",placeholder:"客户ID"},model:{value:t.filterObj.customerId,callback:function(e){t.$set(t.filterObj,"customerId",e)},expression:"filterObj.customerId"}}),a("van-field",{attrs:{name:"客户名称",label:"客户名称",placeholder:"客户名称"},model:{value:t.filterObj.customName,callback:function(e){t.$set(t.filterObj,"customName",e)},expression:"filterObj.customName"}}),a("div",{staticClass:"clearfix",staticStyle:{margin:"16px"}},[a("van-button",{staticClass:"left",staticStyle:{width:"49%"},attrs:{round:"",block:"",type:"default"},on:{click:t.clearFliter}},[t._v("重置")]),a("van-button",{staticClass:"right",staticStyle:{width:"49%"},attrs:{round:"",block:"",type:"info"},on:{click:t.filterSubmit}},[t._v("确定")])],1)],1)],1)]),a("van-popup",{style:{width:"100%",height:"100%"},attrs:{position:"bottom",closeable:""},on:{close:t.validClose},model:{value:t.validShow,callback:function(e){t.validShow=e},expression:"validShow"}},[t.validShow?a("div",{staticClass:"validWarp"},[a("div",{staticClass:"validHeader fontWeight"},[t._v(" 超期消息未处理信息列表 ")]),a("van-pull-refresh",{on:{refresh:t.onValidRefresh},model:{value:t.validrefreshing,callback:function(e){t.validrefreshing=e},expression:"validrefreshing"}},[a("van-list",{attrs:{offset:20,finished:t.validfinished,"finished-text":"没有更多了"},on:{load:t.onValidLoad},model:{value:t.validDataLoading,callback:function(e){t.validDataLoading=e},expression:"validDataLoading"}},[a("inquiry-letter-list",{attrs:{inquiryList:t.validDataList},on:{inquiryDetailClick:t.inquiryDetailClick}})],1)],1)],1):t._e()]),a("van-popup",{style:{width:"100%",height:"100%"},attrs:{position:"bottom",closeable:""},on:{close:t.addClose},model:{value:t.addShow,callback:function(e){t.addShow=e},expression:"addShow"}},[t.addShow?a("div",{staticClass:"addWarp"},[a("div",{staticClass:"header fontSize-16 fontWeight",staticStyle:{padding:"20px 10px"}},[t._v(" 新增客户信息列表 ")]),a("van-field",{attrs:{readonly:"",clickable:"",name:"picker","is-link":"",value:t.chooseEntry.entryname,label:"核算单元",placeholder:"点击选择核算单元"},on:{click:function(e){t.entryChange=!0}}}),a("van-field",{attrs:{readonly:"",clickable:"",name:"picker","is-link":"",value:t.chooseCustomDetail.CONTACTMAN||t.chooseCustomDetail.customname,label:"客户信息",placeholder:"点击选择客户信息"},on:{click:t.chooseCustom}}),a("van-field",{attrs:{rows:"2",autosize:"",label:"询函备注",type:"textarea",placeholder:"请输入询函备注"},model:{value:t.inquiryMessage,callback:function(e){t.inquiryMessage=e},expression:"inquiryMessage"}}),a("van-uploader",{attrs:{multiple:""},model:{value:t.addfileList,callback:function(e){t.addfileList=e},expression:"addfileList"}}),a("li",{staticClass:"button clearfix",staticStyle:{width:"calc(100% - 20px)",position:"absolute",left:"10px",bottom:"10px",display:"flex"}},[a("van-button",{staticClass:"left",staticStyle:{flex:"1"},attrs:{size:"small",type:"info",plain:"",round:""},on:{click:t.afterReadSure}},[t._v("确定")]),a("van-button",{staticClass:"left",staticStyle:{flex:"1","margin-left":"10px"},attrs:{size:"small",type:"default",round:""},on:{click:function(e){t.addShow=!1}}},[t._v("取消")])],1)],1):t._e()]),a("van-action-sheet",{attrs:{title:"核算单元选择","cancel-text":"取消"},model:{value:t.entryChange,callback:function(e){t.entryChange=e},expression:"entryChange"}},[a("div",{staticClass:"operatorCntent"},[0===t.entryList.length?a("van-empty",{attrs:{description:"暂无核算单元信息"}}):t._e(),t._l(t.entryList,(function(e,s){return a("van-cell",{key:s,attrs:{"is-link":"",value:e.entryid+"/"+e.entryname},on:{click:function(a){return a.stopPropagation(),t.entryChangeClick(e)}}})}))],2)]),a("van-popup",{staticClass:"showCustomerWarp",style:"height: 80%",attrs:{position:"bottom",closeable:"",round:""},model:{value:t.showCustomerPicker,callback:function(e){t.showCustomerPicker=e},expression:"showCustomerPicker"}},[a("div",{staticClass:"header fontSize-16 fontWeight",staticStyle:{padding:"10px 20px"}},[t._v("客户列表选择")]),a("div",{staticClass:"searchWarp"},[a("van-search",{attrs:{"show-action":"",shape:"round",placeholder:"请输入搜索关键词"},on:{clear:t.onSearch,search:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.searchValueCustom,callback:function(e){t.searchValueCustom=e},expression:"searchValueCustom"}})],1),a("van-pull-refresh",{on:{refresh:t.onCustomRefresh},model:{value:t.refreshingCustom,callback:function(e){t.refreshingCustom=e},expression:"refreshingCustom"}},[a("van-list",{attrs:{offset:20,finished:t.finishedCustom,"finished-text":"没有更多了"},on:{load:t.onCustomLoad},model:{value:t.getCustomLoading,callback:function(e){t.getCustomLoading=e},expression:"getCustomLoading"}},[a("customer-list",{attrs:{customList:t.customList},on:{chooseCustomClick:t.chooseCustomClick}})],1)],1)],1),a("van-popup",{style:{width:"100%",height:"100%"},attrs:{position:"bottom",closeable:""},model:{value:t.addQueryListShow,callback:function(e){t.addQueryListShow=e},expression:"addQueryListShow"}},[t.addQueryListShow?a("div",{staticClass:"addQueryListWarp"},[a("inquiry-abnormal",{attrs:{typeValue:"noMoudle"}})],1):t._e()]),a("van-popup",{staticClass:"imgsShowWarp",style:{height:"95%",width:"100%"},attrs:{position:"bottom",round:"",closeable:""},model:{value:t.imgsShow,callback:function(e){t.imgsShow=e},expression:"imgsShow"}},[t.imgsShow?a("inquiry-detail",{attrs:{confirmadocid:t.inquiryDetailObj.confirmadocid,detailType:"popup",inquiryDetailObj:t.inquiryDetailObj},on:{uploadSuccess:t.uploadSuccess,cancelUp:function(e){t.imgsShow=!1}}}):t._e()],1)],1)},fu=[],gu=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inquiryLetterList",attrs:{id:"inquiryLetter"}},t._l(t.inquiryList,(function(e,s){return a("ul",{key:s,staticClass:"listWarp",class:e.isClick?"hasClick":"",on:{click:function(a){return t.inquiryDetailClick(e)}}},[a("li",{staticClass:"oneline fontWeight"},[a("span",{staticClass:"orderNum"},[t._v("总单编号 "+t._s(e.confirmadocid))]),a("span",{staticClass:"entryInfor"},[t._v("核算单元 "+t._s(e.entryid))]),a("span",{staticClass:"dateValue"},[t._v(t._s(e.credate&&e.credate.substring(0,10)))])]),a("li",[t._v(" "+t._s(e.customerName.split("/")[0])+" ")]),e.contactMan?a("li",{staticStyle:{color:"#777"}},[t._v(" "+t._s(e.contactMan)+" ")]):t._e(),a("li",{staticClass:"positionR fontWeight"},[a("span",{staticClass:"price"},[t._v("出函金额 "+t._s(e.total)+"元")]),5!==e.usestate&&6!==e.usestate?a("span",{staticClass:"positionA",class:e.validDays<0?"text-red":"",staticStyle:{right:"5px"}},[t._v("剩余 "+t._s(e.validDays)+" 天")]):t._e(),(5===e.usestate||6===e.usestate)&&e.validDays<0?a("span",{staticClass:"positionA",staticStyle:{right:"5px"}},[t._v(" 超期"),a("i",{staticClass:"value",class:e.validDays<0?"text-red":""},[t._v(t._s(e.validDays)+" 天")]),t._v("完成 ")]):t._e()]),0===t.inquiryType||3!==t.inquiryType?a("li",{staticClass:"buttonWarp clearfix"},[0===t.inquiryType?a("van-button",{staticClass:"left",staticStyle:{width:"48%"},attrs:{round:"",type:"info",plain:"",hairline:"",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.changeStatus(0,e.confirmadocid,s)}}},[t._v("启动询证")]):t._e(),3!==t.inquiryType?a("van-button",{staticClass:"right",staticStyle:{width:"48%"},attrs:{round:"",type:"info",plain:"",hairline:"",size:"mini"},on:{click:function(a){return t.changeStatus(1,e.confirmadocid,s)}}},[t._v("上传照片")]):t._e()],1):t._e()])})),0)},bu=[],yu=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"inquiryDetailClick",value:function(t){this.$set(t,"isClick",!0),this.$emit("inquiryDetailClick",t)}},{key:"changeStatus",value:function(t,e,a){var s=this;if(0===this.inquiryType&&0===t){var i="请核对财务下发的纸质材料，确认无误后点击下方“确定”！";this.$dialog.confirm({message:i,allowHtml:!0,getContainer:"#inquiryLetter",confirmButtonText:"确定",beforeClose:function(i,n){if("confirm"===i){var r={index:a,confirmadocid:e,statue:0===t?4:5};s.$emit("changeStatus",r),n()}else n()}})}else this.$emit("changeStatus")}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],yu.prototype,"inquiryType",void 0),Object(u["a"])([Object(d["b"])()],yu.prototype,"inquiryList",void 0),yu=Object(u["a"])([Object(d["a"])({})],yu);var _u=yu,ku=_u,Cu=(a("c3e9"),Object(V["a"])(ku,gu,bu,!1,null,"2234bb39",null)),wu=Cu.exports,Lu=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inquiryAbnormalDeal"},[a("div",{staticClass:"header fontSize-16 fontWeight clearfix",staticStyle:{padding:"10px 20px"}},[a("span",{staticClass:"left"},[t._v("询证函异常列表")]),t.filterObj.startTime||t.filterObj.endTime||t.filterObj.contactId||t.filterObj.contactName||t.filterObj.customerId||t.filterObj.customName||t.filterObj.entryId||t.filterObj.entryName?a("van-badge",{staticClass:"left",staticStyle:{"margin-left":"10px"},attrs:{dot:""}},[a("van-button",{staticClass:"right",attrs:{"icon-position":"right",icon:"arrow-down",size:"mini",hairline:"",type:"info"},on:{click:t.superFliter}},[t._v("高级搜索")])],1):a("van-button",{staticClass:"left",staticStyle:{"margin-left":"10px"},attrs:{"icon-position":"right",icon:"arrow-down",size:"mini",hairline:"",type:"info"},on:{click:t.superFliter}},[t._v(" 高级搜索 ")])],1),a("list",{ref:"list",attrs:{filterObj:t.filterObj},on:{listClick:t.listClick}}),a("van-popup",{style:{width:"100%",height:"auto"},attrs:{position:"top",round:""},model:{value:t.filterShow,callback:function(e){t.filterShow=e},expression:"filterShow"}},[a("ul",{staticClass:"filterWarp"},[a("van-form",[a("van-field",{attrs:{readonly:"",clickable:"",name:"calendar",value:t.filterObj.startTime?t.filterObj.startTime+" ~ "+t.filterObj.endTime:"",label:"时间范围",placeholder:"点击选择日期"},on:{click:function(e){t.calendarShow=!0}}}),t.calendarShow?a("div",{staticClass:"calendar"},[a("van-calendar",{attrs:{type:"range","min-date":new Date(2020,0,1),"first-day-of-week":"1",color:"#1989fa"},on:{confirm:t.selectCalendar},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}})],1):t._e(),a("van-field",{attrs:{name:"客户ID",label:"客户ID",placeholder:"客户ID"},model:{value:t.filterObj.customerId,callback:function(e){t.$set(t.filterObj,"customerId",e)},expression:"filterObj.customerId"}}),a("van-field",{attrs:{name:"客户名称",label:"客户名称",placeholder:"客户名称"},model:{value:t.filterObj.customName,callback:function(e){t.$set(t.filterObj,"customName",e)},expression:"filterObj.customName"}}),a("van-field",{attrs:{name:"核算单元ID",label:"核算单元ID",placeholder:"核算单元ID"},model:{value:t.filterObj.entryId,callback:function(e){t.$set(t.filterObj,"entryId",e)},expression:"filterObj.entryId"}}),a("van-field",{attrs:{name:"核算单元名称",label:"核算单元名称",placeholder:"核算单元名称"},model:{value:t.filterObj.entryName,callback:function(e){t.$set(t.filterObj,"entryName",e)},expression:"filterObj.entryName"}}),a("van-field",{attrs:{name:"分支机构ID",label:"分支机构ID",placeholder:"分支机构ID"},model:{value:t.filterObj.contactId,callback:function(e){t.$set(t.filterObj,"contactId",e)},expression:"filterObj.contactId"}}),a("van-field",{attrs:{name:"分支机构名称",label:"分支机构名称",placeholder:"分支机构名称"},model:{value:t.filterObj.contactName,callback:function(e){t.$set(t.filterObj,"contactName",e)},expression:"filterObj.contactName"}}),a("div",{staticClass:"clearfix",staticStyle:{margin:"16px"}},[a("van-button",{staticClass:"left",staticStyle:{width:"49%"},attrs:{round:"",block:"",type:"default"},on:{click:t.clearFliter}},[t._v("重置")]),a("van-button",{staticClass:"right",staticStyle:{width:"49%"},attrs:{round:"",block:"",type:"info"},on:{click:t.filterSubmit}},[t._v("确定")])],1)],1)],1)]),a("van-popup",{style:{width:"100%",height:"100%"},attrs:{position:"right",closeable:""},model:{value:t.detailShow,callback:function(e){t.detailShow=e},expression:"detailShow"}},[t.detailShow?a("detail",{ref:"detail",attrs:{detailVal:t.detailVal,typeValue:t.typeValue},on:{cancelUp:function(e){t.detailShow=!1}}}):t._e()],1)],1)},xu=[],Iu=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("van-tabs",{attrs:{color:"#1989fa"},on:{click:t.onTabClick},model:{value:t.activeType,callback:function(e){t.activeType=e},expression:"activeType"}},[a("van-tab",{attrs:{name:"0",title:"未处理"}}),a("van-tab",{attrs:{name:"1",title:"已处理"}})],1),a("van-pull-refresh",{on:{refresh:t.onQuerylistRefresh},model:{value:t.refreshingList,callback:function(e){t.refreshingList=e},expression:"refreshingList"}},[a("van-list",{attrs:{offset:20,finished:t.finishedQuerylist,"finished-text":"没有更多了"},on:{load:t.onQuerylistLoad},model:{value:t.getQuerylistLoading,callback:function(e){t.getQuerylistLoading=e},expression:"getQuerylistLoading"}},t._l(t.queryListData,(function(e,s){return a("ul",{key:s,staticClass:"commonLine",class:e.isClick?"hasClick":"",on:{click:function(a){return t.listDetailClick(e)}}},[a("li",{staticClass:"oneLine"},[a("span",{staticClass:"fontSize-14 value fontWeight"},[t._v(" "+t._s(e.customerId)+"/"+t._s(e.customerName)+" ")])]),e.contactId?a("li",{staticClass:"oneLine"},[a("span",{staticClass:"value",staticStyle:{color:"#777"}},[t._v(" "+t._s(e.contactId)+"/"+t._s(e.contactName)+" ")])]):t._e(),e.entryId?a("li",{staticClass:"oneLine"},[a("span",{staticClass:"title"},[t._v("核算单元：")]),a("span",{staticClass:"value"},[t._v(" "+t._s(e.entryId)+"/"+t._s(e.entryName)+" ")])]):t._e(),e.confirmationContent?a("li",{staticClass:"oneLine"},[a("span",{staticClass:"title"},[t._v("询函备注：")]),a("span",{staticClass:"value"},[t._v(" "+t._s(e.confirmationContent)+" ")])]):t._e(),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("发起人：")]),a("span",{staticClass:"value"},[t._v(t._s(e.userName))])]),a("p",{staticClass:"twoRight",staticStyle:{color:"#777"}},[a("span",{staticClass:"value"},[t._v(t._s(e.createTime.substring(0,16)))])])])])})),0)],1)],1)},Su=[],Du=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.refreshingList=!1,t.finishedQuerylist=!1,t.getQuerylistLoading=!1,t.addQueryListShow=!1,t.queryListData=[],t.pageQueryList=1,t.activeType=0,t}return Object(o["a"])(a,[{key:"onTabClick",value:function(){this.onQuerylistRefresh()}},{key:"onQuerylistRefresh",value:function(){this.finishedQuerylist=!1,this.getQuerylistLoading=!1,this.refreshingList=!1,this.pageQueryList=1,this._getQueryList()}},{key:"onQuerylistLoad",value:function(){this.refreshingList&&(this.pageQueryList=1,this.queryListData=[],this.refreshingList=!1),this.getQuerylistLoading=!0,this._getQueryList()}},{key:"_getQueryList",value:function(){var t=this;this.$cancelAxios(["initiatedConfirmationRequest"]),1===this.pageQueryList&&(this.queryListData=[]);var e={type:this.activeType,startTime:this.filterObj.startTime?this.filterObj.startTime:"",endTime:this.filterObj.endTime?this.filterObj.endTime:"",customerId:this.filterObj.customerId,customerName:this.filterObj.customerName,contactId:this.filterObj.contactId,contactName:this.filterObj.contactName,entryId:this.filterObj.entryId,entryName:this.filterObj.entryName,pageNum:this.pageQueryList,pageSize:7};Dn(e).then((function(e){t.queryListData=t.queryListData.concat(e.data.list),e.hasNextPage?(t.getQuerylistLoading=!1,t.pageQueryList++):t.finishedQuerylist=!0}))}},{key:"listDetailClick",value:function(t){this.$set(t,"isClick",!0),this.$emit("listClick",t)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Du.prototype,"filterObj",void 0),Du=Object(u["a"])([Object(d["a"])({})],Du);var Ou=Du,ju=Ou,Tu=(a("b219"),Object(V["a"])(ju,Iu,Su,!1,null,"5eeabb29",null)),Ru=Tu.exports,Nu=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail"},[t._m(0),a("div",{staticClass:"mainWarp"},[a("ul",{staticClass:"commonLine"},[a("li",{staticClass:"oneLine fontWeight fontSize-16"},[t._v(t._s(t.detailVal.customerName))]),t.detailVal.contactName?a("li",{staticClass:"oneLine",staticStyle:{color:"#777"}},[t._v(t._s(t.detailVal.contactName))]):t._e(),t.detailVal.entryId?a("li",{staticClass:"oneLine"},[a("span",{staticClass:"title"},[t._v("核算单元：")]),a("span",{staticClass:"value"},[t._v(t._s(t.detailVal.entryId)+"/ "+t._s(t.detailVal.entryName))])]):t._e(),t.detailVal.confirmationContent?a("li",{staticClass:"oneLine"},[a("span",{staticClass:"title"},[t._v("询函备注：")]),a("span",{staticClass:"value"},[t._v(t._s(t.detailVal.confirmationContent))])]):t._e(),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("发起人：")]),a("span",{staticClass:"value"},[t._v(t._s(t.detailVal.userName))])]),a("p",{staticClass:"twoRight"},[t._v(" "+t._s(t.detailVal.createTime.substring(0,16))+" ")])])]),1===t.detailVal.status||t.hasDeal?a("ul",{staticClass:"dealWarp commonLine fontWeight"},[a("li",[a("span",{staticClass:"title"},[t._v("财务反馈：")]),a("span",{staticClass:"value"},[t._v(t._s(t.hasDeal?t.message:t.detailVal.replyRemark))])]),t.detailVal.replyUserName&&t.detailVal.updateTime?a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("反馈人：")]),a("span",{staticClass:"value"},[t._v(t._s(t.detailVal.replyUserName))])]),a("p",{staticClass:"twoRight"},[t._v(" "+t._s(t.detailVal.updateTime.substring(0,16))+" ")])]):t._e()]):t._e(),a("div",{staticClass:"imgwarp"},[t.detailVal.imageUrlList&&t.detailVal.imageUrlList.length>0?a("van-swipe",{staticStyle:{height:"250px"},on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[a("div",{staticClass:"custom-indicator"},[t._v(t._s(t.current+1)+"//"+t._s(t.detailVal.imageUrlList.length))])]},proxy:!0}],null,!1,1070693186)},t._l(t.detailVal.imageUrlList,(function(e,s){return a("van-swipe-item",{key:s},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"image"}],staticStyle:{weith:"100%",height:"100%",margin:"0 auto",display:"block"},attrs:{src:e},on:{click:function(e){return t.getImg(t.detailVal.imageUrlList,s)}}})])})),1):a("van-empty",{attrs:{description:"暂无图片"}})],1),0!==t.detailVal.status||"module"!==t.typeValue||t.hasDeal?t._e():a("ul",{staticClass:"op"},[a("van-field",{attrs:{rows:"2",autosize:"",label:"反馈",type:"textarea",placeholder:"请输入反馈信息"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),a("li",{staticClass:"button clearfix"},[a("van-button",{staticClass:"left",staticStyle:{flex:"1"},attrs:{size:"small",type:"info",plain:"",round:""},on:{click:t.submitClick}},[t._v("提交")]),"module"===t.typeValue?a("van-button",{staticClass:"left",staticStyle:{flex:"1","margin-left":"10px"},attrs:{size:"small",type:"default",round:""},on:{click:t.cancelUp}},[t._v("取消")]):t._e()],1)],1)])])},Au=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header fontSize-16 fontWeight clearfix",staticStyle:{padding:"10px 20px"}},[a("span",{staticClass:"left"},[t._v("查看详情")])])}],Pu=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.current=0,t.message="",t.hasDeal=!1,t}return Object(o["a"])(a,[{key:"onChange",value:function(t){this.current=t}},{key:"submitClick",value:function(){var t=this;On(this.detailVal.ccrId,{replyRemark:this.message}).then((function(e){"200"===e.code?(t.$toast.success(e.msg),t.hasDeal=!0):t.$toast.fail(e.msg)}))}},{key:"getImg",value:function(t,e){Object(Ml["a"])({images:t,showIndex:!0,loop:!1,startPosition:e})}},{key:"cancelUp",value:function(){this.$emit("cancelUp")}},{key:"mounted",value:function(){this.current=0}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Pu.prototype,"detailVal",void 0),Object(u["a"])([Object(d["b"])()],Pu.prototype,"typeValue",void 0),Pu=Object(u["a"])([Object(d["a"])({})],Pu);var Eu=Pu,Mu=Eu,$u=(a("4060"),Object(V["a"])(Mu,Nu,Au,!1,null,"5b4d08e4",null)),qu=$u.exports,Vu=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.detailVal={},t.detailShow=!1,t.filterShow=!1,t.calendarShow=!1,t.filterObj={startTime:"",endTime:"",confirmadocid:"",entryId:"",entryName:"",contactId:"",contactName:"",customerId:"",customName:""},t}return Object(o["a"])(a,[{key:"superFliter",value:function(){this.filterShow=!0}},{key:"filterSubmit",value:function(){this.filterShow=!1,this.$forceUpdate(),this.$refs.list.onQuerylistRefresh()}},{key:"clearFliter",value:function(){this.filterObj={startTime:"",endTime:"",confirmadocid:"",contactId:"",contactName:"",entryId:"",entryName:"",customerId:"",customName:""},this.filterShow=!1,this.$refs.list.onQuerylistRefresh()}},{key:"listClick",value:function(t){this.detailVal=t,this.detailShow=!0}},{key:"selectCalendar",value:function(t){this.filterObj.startTime=Gs(t[0]),this.filterObj.endTime=Gs(t[1]),this.calendarShow=!1}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])({type:String,default:"module"})],Vu.prototype,"typeValue",void 0),Vu=Object(u["a"])([Object(d["a"])({components:{list:Ru,detail:qu},beforeRouteLeave:function(t,e,a){this.detailShow?(this.detailShow=!1,a(!1)):a(!0)}})],Vu);var Uu=Vu,Fu=Uu,zu=(a("2081"),Object(V["a"])(Fu,Lu,xu,!1,null,"96424314",null)),Wu=zu.exports,Bu=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inquiryLetterDetail"},[a("div",{staticClass:"header"},[t._v("详情查看")]),a("ul",{staticClass:"commonLine",staticStyle:{padding:"40px 10px 50px",positon:"relative",height:"calc(100% - 90px)"}},[a("li",{staticClass:"oneLine fontWeight fontSize-16"},[t._v(t._s(t.inquiryDetailObj.customerName))]),t.inquiryDetailObj.contactMan?a("li",{staticClass:"oneLine fontSize-16",staticStyle:{color:"#777"}},[t._v(t._s(t.inquiryDetailObj.contactMan))]):t._e(),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("总单编号：")]),a("span",{staticClass:"value"},[t._v(t._s(t.inquiryDetailObj.confirmadocid))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("核算单元：")]),a("span",{staticClass:"value"},[t._v(t._s(t.inquiryDetailObj.entryid))])])]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("出函金额：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(t.inquiryDetailObj.total)+"元")])]),5!==t.inquiryDetailObj.usestate&&6!==t.inquiryDetailObj.usestate?a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("剩余：")]),a("span",{staticClass:"value",class:t.inquiryDetailObj.validDays<0?"text-red":""},[t._v(t._s(t.inquiryDetailObj.validDays)+" 天")])]):t._e(),(5===t.inquiryDetailObj.usestate||6===t.inquiryDetailObj.usestate)&&t.inquiryDetailObj.validDays<0?a("p",{staticClass:"twoRight"},[t._v(" 超期"),a("span",{staticClass:"value",class:t.inquiryDetailObj.validDays<0?"text-red":""},[t._v(t._s(t.inquiryDetailObj.validDays)+" 天")]),t._v("完成 ")]):t._e()]),2===t.inquiryDetailObj.usestate?a("li",{staticClass:"oneLine text-red"},[t._v("请核对财务下发的纸质材料，确认无误后点击下方“确定”！当前操作默认点击“启动询证”")]):t._e(),a("van-field",{staticStyle:{padding:"5px 0px 5px 0px","margin-bottom":"3px"},attrs:{name:"radio",label:"询函结果"},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.inquiryDetailObj.returnFlag,callback:function(e){t.$set(t.inquiryDetailObj,"returnFlag",e)},expression:"inquiryDetailObj.returnFlag"}},[a("van-radio",{attrs:{name:1}},[t._v("一致")]),a("van-radio",{attrs:{name:2}},[t._v("有异")]),a("van-radio",{attrs:{name:3}},[t._v("报错")])],1)]},proxy:!0}])}),6===t.inquiryDetailObj.usestate||t.role?t._e():a("van-uploader",{attrs:{multiple:""},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}}),6===t.inquiryDetailObj.usestate||t.role?t._e():a("li",{staticClass:"button clearfix",staticStyle:{width:"calc(100% - 20px)",position:"absolute",bottom:"10px",display:"flex"}},[a("van-button",{staticClass:"left",staticStyle:{flex:"1"},attrs:{size:"small",type:"info",plain:"",round:""},on:{click:t.afterRead}},[t._v("确定上传")]),t.inquiryDetailObj.validDays<0?a("van-button",{staticClass:"left",staticStyle:{flex:"1","margin-left":"10px"},attrs:{size:"small",type:"info",round:""},on:{click:function(e){t.reasonShow=!0}}},[t._v("反馈原因")]):t._e()],1),t.imgList.length>0?a("van-swipe",{staticStyle:{height:"300px"},on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[a("div",{staticClass:"custom-indicator"},[t._v(t._s(t.current+1)+"//"+t._s(t.imgList.length))])]},proxy:!0}],null,!1,675694441)},t._l(t.imgList,(function(e,s){return a("van-swipe-item",{key:s},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"image"}],staticStyle:{height:"100%",margin:"0 auto",display:"block"},attrs:{src:e},on:{click:function(e){return t.getImg(t.imgList,s)}}})])})),1):a("van-empty",{attrs:{description:"暂无图片"}})],1),a("van-popup",{style:{width:"100%",height:"80%"},attrs:{position:"bottom",round:""},model:{value:t.reasonShow,callback:function(e){t.reasonShow=e},expression:"reasonShow"}},[t.reasonShow?a("exceed-time-reason",{attrs:{confirmadocidProp:t.inquiryDetailObj.confirmadocid}}):t._e()],1)],1)},Gu=[],Hu=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"exceedTimeReason"},[a("div",{staticClass:"header"},[t._v("超期原因"+t._s(t.inquiryDetailObj.filledReasonFlag?"查看":"录入"))]),a("div",{staticClass:"content"},[a("ul",{staticClass:"commonLine",staticStyle:{padding:"10px",positon:"relative",height:"auto",margin:"0px 0px 10px 0px","box-shadow":"0 2px 12px 0 rgba(0, 0, 0, 0.1)","border-radius":"5px"}},[a("li",{staticClass:"oneLine fontSize-16"},[t._v(t._s(t.inquiryDetailObj.credate))]),a("li",{staticClass:"oneLine fontWeight fontSize-16"},[t._v(t._s(t.inquiryDetailObj.customerName))]),t.inquiryDetailObj.contactMan?a("li",{staticClass:"oneLine fontSize-16",staticStyle:{color:"#777"}},[t._v(t._s(t.inquiryDetailObj.contactMan))]):t._e(),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("总单编号：")]),a("span",{staticClass:"value"},[t._v(t._s(t.inquiryDetailObj.confirmadocid))])]),a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("核算单元：")]),a("span",{staticClass:"value"},[t._v(t._s(t.inquiryDetailObj.entryid))])])]),a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("出函金额：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(t.inquiryDetailObj.total)+"元")])]),5!==t.inquiryDetailObj.usestate&&6!==t.inquiryDetailObj.usestate?a("p",{staticClass:"twoRight"},[a("span",{staticClass:"title"},[t._v("剩余：")]),a("span",{staticClass:"value",class:t.inquiryDetailObj.validDays<0?"text-red":""},[t._v(t._s(t.inquiryDetailObj.validDays)+" 天")])]):t._e()])]),t._l(t.inquiryDetailObj.filledReasonList,(function(e,s){return a("ul",{key:s,staticClass:"commonLine",staticStyle:{padding:"10px","box-shadow":"0 2px 12px 0 rgba(0, 0, 0, 0.1)","border-radius":"5px"}},[a("li",{staticClass:"twoLine"},[a("p",{staticClass:"twoLeft"},[a("span",{staticClass:"title"},[t._v("反馈人：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.reasonFilledUserName))])]),a("p",{staticClass:"twoRight",staticStyle:{color:"#AAA"}},[t._v(" "+t._s(e.reasonFillTime)+" ")])]),a("li",[a("span",{staticClass:"title"},[t._v("超期原因：")]),a("span",{staticClass:"value fontWeight"},[t._v(t._s(e.expireReason))])])])})),t.inquiryDetailObj.filledReasonFlag?t._e():a("ul",{staticClass:"reasonWarp"},[a("van-field",{attrs:{rows:"2",autosize:"",label:"超期原因",type:"textarea",placeholder:"请输入超期原因"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1),t.inquiryDetailObj.filledReasonFlag?t._e():a("van-button",{staticStyle:{width:"65%"},attrs:{size:"small",type:"info",plain:"",round:""},on:{click:t._expireReason}},[t._v("提交")])],2)])},Yu=[],Qu=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.role="",t.message="",t.inquiryDetailObj={},t}return Object(o["a"])(a,[{key:"_getConfirmationRequestList",value:function(){var t=this;this.$cancelAxios(["getConfirmationRequestList"]),kn({confirmadocid:this.confirmadocidProp?this.confirmadocidProp:this.$route.query.confirmadocid,pageNum:1,pageSize:1,needLoading:!0}).then((function(e){if("200"===e.code){t.inquiryDetailObj=e.data.list[0];var a=localStorage.getItem("userId");t.inquiryDetailObj.filledReasonList.some((function(t){return t.userId===a}))&&(t.inquiryDetailObj.filledReasonFlag=!0)}}))}},{key:"_expireReason",value:function(){var t=this;xn({managerFlag:this.role,confirmadocId:this.inquiryDetailObj.confirmadocid,expireTextDescription:this.message}).then((function(e){"200"===e.code?t.$toast.success(e.msg):t.$toast.fail(e.msg)}))}},{key:"mounted",value:function(){this.role=this.$route.query.role,this._getConfirmationRequestList()}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Qu.prototype,"confirmadocidProp",void 0),Qu=Object(u["a"])([Object(d["a"])({})],Qu);var Ku=Qu,Ju=Ku,Xu=(a("0959"),Object(V["a"])(Ju,Hu,Yu,!1,null,"48d58cd1",null)),Zu=Xu.exports,td=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.inquiryDetailObj={},t.imgList=[],t.fileList=[],t.reasonShow=!1,t.role="",t.current=0,t}return Object(o["a"])(a,[{key:"afterRead",value:function(){var t=this,e=new FormData;if(0!==this.fileList.length)if(this.inquiryDetailObj.returnFlag){for(var a=[],s=0;s<this.fileList.length;s++){var i=this.fileList[s];i.status="uploading",i.message="上传中...";var n=i.file.name.split("."),r=new File([i.file],"index"+s+"."+n[n.length-1]);a.push(r),e.append("imageList",r)}console.log(a),e.append("confirmadocid",this.inquiryDetailObj.confirmadocid),e.append("customerId",this.inquiryDetailObj.customid),e.append("entryId",this.inquiryDetailObj.entryid),e.append("settleAccountsMonth",this.inquiryDetailObj.usemm),e.append("createId",this.inquiryDetailObj.cremanid),e.append("salesPersonName",this.inquiryDetailObj.salesPersonName),e.append("replyFlag",this.inquiryDetailObj.returnFlag),console.log(e),wn(e).then((function(e){if("200"===e.code){for(var a=0;a<t.fileList.length;a++){var s=t.fileList[a];s.status="success",s.message="上传成功"}t.$toast.success("上传成功"),t.$emit("uploadSuccess")}else for(var i=0;i<t.fileList.length;i++){var n=t.fileList[i];n.status="failed",n.message="上传失败"}}))}else this.$toast.fail("请选择询函结果");else this.$toast.fail("请选择要上传的图片")}},{key:"getImg",value:function(t,e){Object(Ml["a"])({images:t,showIndex:!0,loop:!1,startPosition:e})}},{key:"cancelUp",value:function(){"popup"===this.detailType&&this.$emit("cancelUp")}},{key:"_getConfirmationRequestList",value:function(){var t=this;this.$cancelAxios(["getConfirmationRequestList"]),kn({confirmadocid:"inquiryLetterDetail"===this.$route.name?this.$route.query.confirmadocid:this.confirmadocid,pageNum:1,pageSize:1,needLoading:!0}).then((function(e){if("200"===e.code){console.log(e),t.inquiryDetailObj=e.data.list[0];var a=localStorage.getItem("userId");t.inquiryDetailObj.filledReasonList&&t.inquiryDetailObj.filledReasonList.some((function(t){return t.userId===a}))&&(t.inquiryDetailObj.filledReasonFlag=!0),t._downloadConfirmationRequestPictures()}}))}},{key:"_downloadConfirmationRequestPictures",value:function(){var t=this;Ln({confirmadocid:this.inquiryDetailObj.confirmadocid,entryId:this.inquiryDetailObj.entryid,customerId:this.inquiryDetailObj.customid,settleAccountsMonth:this.inquiryDetailObj.usemm}).then((function(e){t.imgList=e.data}))}},{key:"onChange",value:function(t){this.current=t}},{key:"mounted",value:function(){this.role=this.$route.query.role,this._getConfirmationRequestList()}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],td.prototype,"confirmadocid",void 0),Object(u["a"])([Object(d["b"])({default:"message"})],td.prototype,"detailType",void 0),td=Object(u["a"])([Object(d["a"])({components:{exceedTimeReason:Zu}})],td);var ed=td,ad=ed,sd=(a("b806"),Object(V["a"])(ad,Bu,Gu,!1,null,"004f585a",null)),id=sd.exports,nd=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.searchValue="",t.inquiryType=0,t.inquiryDataList=[],t.finished=!1,t.refreshing=!1,t.getDataLoading=!1,t.page=1,t.calendarShow=!1,t.filterShow=!1,t.validNumber=0,t.validShow=!1,t.validDataList=[],t.validfinished=!1,t.validrefreshing=!1,t.validDataLoading=!1,t.validpage=1,t.filterObj={startTime:"",endTime:"",confirmadocid:"",customerId:"",customName:""},t.pageCustom=1,t.customList=[],t.entryList=[],t.entryChange=!1,t.addShow=!1,t.refreshingCustom=!1,t.finishedCustom=!1,t.getCustomLoading=!1,t.chooseEntry={entryname:"",entryid:""},t.searchValueCustom="",t.showCustomerPicker=!1,t.chooseCustomDetail={customname:"",customid:"",CONTACTID:"",CONTACTMAN:""},t.inquiryMessage="",t.addfileList=[],t.addQueryListShow=!1,t.imgsShow=!1,t.inquiryDetailObj={},t}return Object(o["a"])(a,[{key:"onSearch",value:function(){this.onRefresh()}},{key:"inquiryTypeClick",value:function(t){this.inquiryType=t,this.onRefresh()}},{key:"inquiryDetailClick",value:function(t){this.inquiryDetailObj=t,this.imgsShow=!0}},{key:"uploadSuccess",value:function(){this.imgsShow=!1}},{key:"_getConfirmationRequestList",value:function(){var t=this;this.$cancelAxios(["getConfirmationRequestList"]),1===this.page&&(this.inquiryDataList=[]),kn({startTime:this.filterObj.startTime?this.filterObj.startTime:"",endTime:this.filterObj.endTime?this.filterObj.endTime:"",confirmadocid:this.filterObj.confirmadocid,customerId:this.searchValue?"":this.filterObj.customerId,customName:this.searchValue?"":this.filterObj.customName,type:this.inquiryType,keyWords:this.searchValue,pageNum:this.page,pageSize:8}).then((function(e){"200"===e.code?(t.inquiryDataList=t.inquiryDataList.concat(e.data.list),e.data.hasNextPage?(t.getDataLoading=!1,t.page++):t.finished=!0):t.$toast.fail(e.msg)}))}},{key:"onRefresh",value:function(){this.finished=!1,this.getDataLoading=!1,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.inquiryDataList=[],this.refreshing=!1),this.getDataLoading=!0,this._getConfirmationRequestList()}},{key:"changeStatus",value:function(t){var e=this,a=t.confirmadocid,s=t.statue,i=t.index,n={confirmadocid:a,statue:s};Cn(n).then((function(t){"200"===t.code?(e.$toast.success(t.msg),e.inquiryDataList.splice(i,1)):e.$toast.fail(t.msg)}))}},{key:"superFliter",value:function(){this.filterShow=!0,console.log("高级搜索")}},{key:"filterSubmit",value:function(){this.filterShow=!1,this.$forceUpdate(),this.onRefresh()}},{key:"clearFliter",value:function(){this.filterObj={startTime:"",endTime:"",confirmadocid:"",contactId:"",contactName:"",entryId:"",entryName:"",customerId:"",customName:""},this.filterShow=!1,this.onRefresh()}},{key:"selectCalendar",value:function(t){this.filterObj.startTime=Gs(t[0]),this.filterObj.endTime=Gs(t[1]),this.calendarShow=!1}},{key:"_exceedTimeLimitTask",value:function(t){var e=this;this.validDataLoading=!0,In({pageNum:this.validpage,pageSize:t}).then((function(a){"200"===a.code?(e.validDataLoading=!1,1===t?e.validNumber=a.data.total:(e.validDataList=e.validDataList.concat(a.data.list),a.data.hasNextPage?e.validpage++:e.validfinished=!0)):e.$toast.fail(a.msg)}))}},{key:"onValidRefresh",value:function(){this.validfinished=!1,this.validDataLoading=!1,this.validpage=1,this.onValidLoad()}},{key:"onValidLoad",value:function(){this.validrefreshing&&(this.validpage=1,this.validDataList=[],this.validrefreshing=!1),this.validDataLoading=!0,this._exceedTimeLimitTask(8)}},{key:"validClose",value:function(){this.validfinished=!1,this.validrefreshing=!1,this.validDataLoading=!1,this.validpage=1,this.validDataList=[]}},{key:"queryClick",value:function(){this.addQueryListShow=!0}},{key:"addClick",value:function(){this.addShow=!0,this._queryEntryid()}},{key:"chooseCustom",value:function(){this.chooseEntry.entryid?this.showCustomerPicker=!0:this.$toast.fail("请先选择核算单元")}},{key:"onCustomRefresh",value:function(){this.finishedCustom=!1,this.getCustomLoading=!1,this.pageCustom=1,this._getCustom()}},{key:"chooseCustomClick",value:function(t){var e=t.CONTACTID,a=t.CONTACTMAN,s=t.customid,i=t.customname;this.chooseCustomDetail={CONTACTID:e,CONTACTMAN:a,customid:s,customname:i},this.showCustomerPicker=!1}},{key:"entryChangeClick",value:function(t){this.chooseEntry=t,this.entryChange=!1}},{key:"_queryEntryid",value:function(){var t=this;this.$cancelAxios(["queryEntryid"]),lv().then((function(e){t.entryList=e,1===e.length&&t.entryChangeClick(e[0])}))}},{key:"onCustomLoad",value:function(){this.refreshingCustom&&(this.pageCustom=1,this.customList=[],this.refreshingCustom=!1),this.getCustomLoading=!0,this._getCustom()}},{key:"_getCustom",value:function(){var t=this;this.$cancelAxios(["getCustom"]),1===this.pageCustom&&(this.customList=[]);var e={condition:this.searchValueCustom,entryid:this.chooseEntry.entryid,pageNum:this.pageCustom,pageSize:7};uv(e).then((function(e){t.customList=t.customList.concat(e.list);for(var a=0;a<t.customList.length;a++){var s=t.customList[a];s.contactList&&s.contactList.length>0&&s.contactList.forEach((function(t){var e=0;t.dates&&t.dates.length>0&&(t.dates.forEach((function(t){e?e>new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()&&(e=new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()):e=new Date(new Date(t.ENDDATE).toLocaleDateString()).getTime()})),e<new Date((new Date).toLocaleDateString()).getTime()&&(t.dialyPass=!0,t.miniTime=e))}))}e.hasNextPage?(t.getCustomLoading=!1,t.pageCustom++):t.finishedCustom=!0}))}},{key:"addClose",value:function(){this.addShow=!1,this.chooseEntry={entryid:"",entryname:""},this.pageCustom=1,this.customList=[],this.entryList=[],this.entryChange=!1,this.refreshingCustom=!1,this.finishedCustom=!1,this.getCustomLoading=!1,this.searchValueCustom="",this.inquiryMessage="",this.showCustomerPicker=!1,this.chooseCustomDetail={customname:"",customid:"",CONTACTID:"",CONTACTMAN:""}}},{key:"afterReadSure",value:function(){for(var t=this,e=new FormData,a=[],s=0;s<this.addfileList.length;s++){var i=this.addfileList[s];i.status="uploading",i.message="上传中...";var n=i.file.name.split("."),r=new File([i.file],"index"+s+"."+n[n.length-1]);a.push(r),e.append("imageList",r)}console.log(a),console.log(e),e.append("customerId",this.chooseCustomDetail.customid),e.append("customerName",this.chooseCustomDetail.customname),e.append("entryId",this.chooseEntry.entryid),e.append("entryName",this.chooseEntry.entryname),e.append("contactId",this.chooseCustomDetail.CONTACTID||""),e.append("contactName",this.chooseCustomDetail.CONTACTMAN||""),e.append("confirmationRequestContent",this.inquiryMessage),Sn(e).then((function(e){if("200"===e.code){for(var a=0;a<t.addfileList.length;a++){var s=t.addfileList[a];s.status="success",s.message="上传成功"}t.$toast.success("上传成功"),t.addShow=!1}else for(var i=0;i<t.addfileList.length;i++){var n=t.addfileList[i];n.status="failed",n.message="上传失败"}}))}},{key:"getImg",value:function(t,e){Object(Ml["a"])({images:t,showIndex:!0,loop:!1,startPosition:e})}},{key:"mounted",value:function(){this._exceedTimeLimitTask(1)}}]),a}(d["c"]);nd=Object(u["a"])([Object(d["a"])({components:{inquiryLetterList:wu,customerList:Gc,inquiryAbnormal:Wu,inquiryDetail:id},beforeRouteLeave:function(t,e,a){console.log(this.$refs.inquiryLetterList.imgsShow),this.$refs.inquiryLetterList.imgsShow||this.addShow||this.addQueryListShow?(this.$refs.inquiryLetterList.imgsShow=!1,this.addShow=!1,this.addQueryListShow=!1,a(!1)):a(!0)}})],nd);var rd=nd,od=rd,cd=(a("fc08"),Object(V["a"])(od,vu,fu,!1,null,"106939d6",null)),ld=cd.exports,ud=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"abnormalDetail"},[a("detail",{attrs:{detailVal:t.detailVal,typeValue:"module"}})],1)},dd=[],hd=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.detailVal={},t}return Object(o["a"])(a,[{key:"_getQueryList",value:function(){var t=this;this.$cancelAxios(["initiatedConfirmationRequest"]);var e={ccrId:this.$route.query.ccrId,pageNum:1,pageSize:7};Dn(e).then((function(e){t.detailVal=e.data.list[0]}))}},{key:"mounted",value:function(){this._getQueryList()}}]),a}(d["c"]);hd=Object(u["a"])([Object(d["a"])({components:{detail:qu}})],hd);var pd=hd,md=pd,vd=(a("5c41"),Object(V["a"])(md,ud,dd,!1,null,"3323d84a",null)),fd=vd.exports,gd=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"keyProjects"},[s("van-search",{attrs:{value:e.searchValue,placeholder:e.placeholder},on:{click:function(){t.fullPopShow=!0}}}),e.curCustom.custName?e.nopermit?s("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"网格层级信息未维护，请先去管理后台进行维护"}}):s("div",[s("div",{staticClass:"customer-info"},[s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("客户信息")]),s("div",{staticClass:"customer__content"},[s("div",{staticClass:"customer__name"},[e._v(e._s(e.dataSource.custId?e.dataSource.custId+"/"+e.dataSource.custName:""))]),s("div",{staticClass:"customer__link",on:{click:e.toWorkFollow}},[e._v("[工作跟进]")])])]),s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("联合体")]),s("div",{staticClass:"customer__content"},[s("div",{staticClass:"customer__name"},[e._v(e._s(e.dataSource.communtyId?e.dataSource.communtyId+"/"+e.dataSource.communtyName:"无"))])])]),s("div",{staticClass:"customer__linetwo"},[s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("网格层级")]),s("div",{staticClass:"customer__content"},[e._v(e._s(e.dataSource.gridGrade))])]),s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("项目类型")]),s("div",{staticClass:"customer__content flex"},e._l(e.dataSource.typeList,(function(t,a){return s("div",{key:a,staticClass:"type-item"},[e._v(e._s(t.type[0]))])})),0)])]),s("van-tabs",{directives:[{name:"show",rawName:"v-show",value:e.dataSource.deptList&&e.dataSource.deptList.length>1,expression:"dataSource.deptList && dataSource.deptList.length > 1"}],attrs:{color:"#554d62",ellipsis:!1},on:{change:e.handleClick},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.dataSource.deptList,(function(t,e){return s("van-tab",{key:e,attrs:{title:t.deptName,name:t.deptId}})})),1),s("div",{staticClass:"projects-block"},[s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__title"},[e._v("业务员")]),s("div",{staticClass:"projects-item__content"},[e._v(e._s(e.dataSource.saler))])]),s("div",{staticClass:"projects-item ml-40"},[s("div",{staticClass:"projects-item__title"},[e._v("领航员")]),s("div",{staticClass:"projects-item__content"},[e._v(e._s(e.dataSource.pilotName))])])]),s("div",{staticClass:"projects-btn",on:{click:function(t){return e.onContact(e.dataSource.custId)}}},[s("i",{staticClass:"iconfont ytcrm-shijian"}),s("div",{staticClass:"btn"},[e._v("通知业务员和领航员前来查看")])])],1),s("div",{staticClass:"task-item"},[s("div",{staticClass:"projects-table"},[s("div",{staticClass:"task-item__top"},[s("div",{staticClass:"task-item__title"},[e._v("拜访")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle"}),s("div",{staticClass:"projects-item__theader gray"},[e._v("目标次数")]),s("div",{staticClass:"projects-item__theader gray"},[e._v("当月次数")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle gray"},[s("i",{staticClass:"iconfont ytcrm-quanzibaifang special-icon"}),e._v("个人拜访 ")]),s("div",{staticClass:"projects-item__theader"},[e._v(e._s(e.dataSource.personVisitTarget)+" 次/月")]),s("div",{staticClass:"projects-item__theader",style:e.dataSource.personVisitTimes<e.dataSource.personVisitTarget?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.personVisitTimes)+" 次")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle gray"},[s("i",{staticClass:"iconfont ytcrm-zhuguanxiefang"}),e._v("领导协访 ")]),s("div",{staticClass:"projects-item__theader"},[e._v(e._s(e.dataSource.leaderVisitTarget)+" 次/月")]),s("div",{staticClass:"projects-item__theader",style:e.dataSource.leaderVisitTimes<e.dataSource.leaderVisitTarget?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.leaderVisitTimes)+" 次")])])]),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.infoLoading,expression:"infoLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),s("div",{staticClass:"task-item"},[s("div",{staticClass:"projects-chart"},[s("div",{staticClass:"task-item__top"},[s("div",{staticClass:"task-item__title"},[e._v("GR")])]),s("div",{staticClass:"key-gr"},[s("div",{ref:"keyChart",staticClass:"key-gr__chart"})])]),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.infoLoading,expression:"infoLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),s("div",{staticClass:"task-item"},[s("div",{staticClass:"projects-warmth"},[s("div",{staticClass:"task-item__top"},[s("div",{staticClass:"task-item__title"},[e._v("热力")])]),s("div",{staticClass:"projects-warmth-item"},[s("div",{staticClass:"projects-warmth-item__name"},[e._v("一般")]),s("div",{staticClass:"projects-warmth-item__value"},[e._v(e._s(e.dataSource.normal))]),s("div",{staticClass:"projects-warmth-item__change"},[e._v(e._s((e.dataSource.normalUp>0?"+":"")+(e.dataSource.normalUp||"")))])]),s("div",{staticClass:"projects-warmth-item"},[s("div",{staticClass:"projects-warmth-item__name"},[e._v("进阶")]),s("div",{staticClass:"projects-warmth-item__value"},[e._v(e._s(e.dataSource.lack))]),s("div",{staticClass:"projects-warmth-item__change"},[e._v(e._s((e.dataSource.lackUp>0?"+":"")+(e.dataSource.lackUp||"")))])]),s("div",{staticClass:"projects-warmth-item"},[s("div",{staticClass:"projects-warmth-item__name"},[e._v("未有")]),s("div",{staticClass:"projects-warmth-item__value"},[e._v(e._s(e.dataSource.never))]),s("div",{staticClass:"projects-warmth-item__change"},[e._v(e._s((e.dataSource.neverUp>0?"+":"")+(e.dataSource.neverUp||"")))])])]),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.infoLoading,expression:"infoLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),s("div",{staticClass:"task-item"},[s("div",{staticClass:"projects-table"},[s("div",{staticClass:"task-item__top"},[s("div",{staticClass:"task-item__title"},[e._v("统计")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle",staticStyle:{width:"68px"}}),s("div",{staticClass:"projects-item__theader2 gray"},[e._v("单月目标增速")]),s("div",{staticClass:"projects-item__theader2 gray"},[e._v("本月实际增速")]),s("div",{staticClass:"projects-item__theader2 gray"},[e._v("本年目标增速")]),s("div",{staticClass:"projects-item__theader2 gray"},[e._v("本年实际增速")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle gray",staticStyle:{width:"68px"}},[s("i",{staticClass:"iconfont ytcrm-xiaoshoue"}),e._v("销售额 ")]),s("div",{staticClass:"projects-item__theader2"},[e._v(e._s(e.dataSource.increaseData.saleMonth)+"%")]),s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.saleMonthRate<e.dataSource.increaseData.saleMonth?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.saleMonthRate)+"%")]),s("div",{staticClass:"projects-item__theader2"},[e._v(e._s(e.dataSource.increaseData.saleYear)+"%")]),s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.saleYearRate<e.dataSource.increaseData.saleYear?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.saleYearRate)+"%")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle gray",staticStyle:{width:"68px"}},[s("i",{staticClass:"iconfont ytcrm-organization"}),e._v("联合体 ")]),e.dataSource.increaseData.unionMonth?s("div",{staticClass:"projects-item__theader2"},[e._v(e._s(e.dataSource.increaseData.unionMonth)+"%")]):s("div",{staticClass:"projects-item__theader2"},[e._v("--")]),e.dataSource.increaseData.unionMonthRate?s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.unionMonthRate<e.dataSource.increaseData.unionMonth?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.unionMonthRate)+"%")]):s("div",{staticClass:"projects-item__theader2"},[e._v("--")]),e.dataSource.increaseData.unionYear?s("div",{staticClass:"projects-item__theader2"},[e._v(e._s(e.dataSource.increaseData.unionYear)+"%")]):s("div",{staticClass:"projects-item__theader2"},[e._v("--")]),e.dataSource.increaseData.unionYearRate?s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.unionYearRate<e.dataSource.increaseData.unionYear?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.unionYearRate)+"%")]):s("div",{staticClass:"projects-item__theader2"},[e._v("--")])])]),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.infoLoading,expression:"infoLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),s("div",{staticClass:"task-item"},[s("div",{staticClass:"task-item__top"},[s("div",{staticClass:"task-item__title"},[e._v("最新话题")]),s("div",{staticClass:"task-item__desc",on:{click:e.showMore}},[e._v(" 查看更多 "),s("van-icon",{attrs:{name:"arrow",size:"18px"}})],1)]),e.topicLoading||e.topicList.length?s("div",{staticClass:"projects-topics"},[s("van-pull-refresh",{staticClass:"msg-list",on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[s("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(t){e.error=t},load:e.getTopicList},model:{value:e.topicLoading,callback:function(t){e.topicLoading=t},expression:"topicLoading"}},e._l(e.topicList,(function(t,a){return s("div",{key:a,staticClass:"projects-topic van-clearfix"},[s("div",{staticClass:"projects-topic__top"},[s("div",{staticClass:"projects-topic__name"},[e._v(e._s(t.smallTagName))]),s("div",{staticClass:"projects-topic__time"},[e._v(e._s(t.visitTime))])]),s("div",{staticClass:"projects-topic__content"},[e._v(e._s(t.remark))])])})),0)],1)],1):s("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无相关话题"}})],1)]):s("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"请先输入指定客户"}}),s("full-pop",{directives:[{name:"show",rawName:"v-show",value:e.fullPopShow,expression:"fullPopShow"}],attrs:{placeholder:e.placeholder,loading:e.custLoading,list:e.custList},on:{cancel:function(t){e.fullPopShow=!1},input:e.getCustList,select:e.onSelectCustomer}})],1)},bd=[],yd=a("313e"),_d=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.placeholder="请输入客户ID|名称",t.searchValue="",t.fullPopShow=!1,t.nopermit=!1,t.custLoading=!1,t.custList=[],t.curCustom={},t.dataLoading=!1,t.infoLoading=!1,t.dataSource={increaseData:{}},t.active=-1,t.keyChartInstance=null,t.topicLoading=!1,t.topicList=[],t.finished=!1,t.refreshing=!1,t.error=!1,t.page=1,t.pageSize=10,t}return Object(o["a"])(a,[{key:"getCustList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$cancelAxios(["queryCust"]),this.custList=[],""===e){t.next=8;break}return this.custLoading=!0,t.next=6,Oa({cust:e});case 6:a=t.sent,a.success&&(this.custLoading=!1,this.custList=a.data);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onSelectCustomer",value:function(t){this.curCustom=t,this.searchValue=t.custId+"/"+t.custName,this.fullPopShow=!1,this.getData(t.custId),this.onRefresh()}},{key:"onRefresh",value:function(){this.finished=!1,this.topicLoading=!0,this.topicList=[],this.page=1,this.getTopicList()}},{key:"getData",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s,i,n,r,o,c,l,u,d,h,p,m,v,f,g,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.dataLoading=!0,t.next=3,Ta({custId:e});case 3:if(a=t.sent,s=a.data,i=a.success,this.dataLoading=!1,!i){t.next=19;break}return this.nopermit=!1,n=s.communityVO,r=n.communtyId,o=n.communtyName,c=n.child,l=n.father,t.next=12,ns({custId:e,communtyId:r});case 12:u=t.sent,d=s.gridListVO,h=d.custName,p=d.gridGradeId,m=d.gridGrade,v=d.typeList,f=d.pilotName,g=d.leaderVisitTarget,b=d.personVisitTarget,this.dataSource={communtyId:r,communtyName:o,father:l,child:c||[],custId:s.gridListVO.custId,custName:h,gridGradeId:p,gridGrade:m,typeList:v,pilotName:f,leaderVisitTarget:g,personVisitTarget:b,deptList:s.sale,increaseData:u.data||{saleMonth:"",saleYear:"",saleMonthRate:"",saleYearRate:"",saleLastMonthRate:"",unionMonth:"",unionYear:"",unionMonthRate:"",unionYearRate:"",unionLastMonthRate:""}},this.active=this.dataSource.deptList[0].deptId,this.getSaleInfo(),t.next=20;break;case 19:this.nopermit=!0;case 20:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getSaleInfo",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,n,r,o,c,l,u,d,h,p,m,v,f,g=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.infoLoading=!0,e=this.dataSource.deptList.filter((function(t){return+t.deptId===+g.active}))[0].userId,t.next=4,Na({custId:this.curCustom.custId,saleId:e});case 4:a=t.sent,this.infoLoading=!1,s=a.data,i=s.agrade,n=s.bgrade,r=s.cgrade,o=s.dgrade,c=s.lack,l=s.never,u=s.normal,d=s.neverUp,h=s.lackUp,p=s.normalUp,m=s.userName,v=s.leaderVisit,f=s.personVisit,this.dataSource=Object.assign(this.dataSource,{gradeData:[i,n,r,o],lack:c,never:l,normal:u,neverUp:d,lackUp:h,normalUp:p,saler:m,leaderVisit:v,personVisit:f,leaderVisitTimes:v?v.length:"",personVisitTimes:f?f.length:""}),this.$nextTick((function(){g.initChart()}));case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getTopicList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.topicLoading=!0,e={custId:this.curCustom.custId,pageNum:this.page,pageSize:this.pageSize},t.next=4,Pa(e);case 4:a=t.sent,this.topicLoading=!1,this.refreshing=!1,a.success?(this.topicList=[].concat(Object(y["a"])(this.topicList),Object(y["a"])(a.data.list)),this.finished=!a.data.hasNextPage,this.page++):this.error=!0;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"initChart",value:function(){var t=this.$refs.keyChart;this.keyChartInstance=yd["a"](t),this.keyChartInstance.clear();var e={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:"10px",left:"10px",bottom:"0",containLabel:!0},xAxis:{type:"category",data:["A","B","C","D"]},yAxis:{type:"value"},series:[{data:this.dataSource.gradeData,type:"bar",showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}}]};this.keyChartInstance.setOption(e)}},{key:"toWorkFollow",value:function(){this.$router.replace({name:"keyProjectsFollow",params:this.curCustom})}},{key:"handleClick",value:function(){this.$cancelAxios(["queryBusiness"]),this.getSaleInfo()}},{key:"onContact",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this.dataSource.deptList.filter((function(t){return+t.deptId===+i.active}))[0].userId,t.next=3,es({custId:e,saleId:a});case 3:s=t.sent,s.success&&this.$toast.success("通知成功");case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"showMore",value:function(){this.$router.push({name:"keyTopic",params:{personVisit:this.dataSource.personVisit,leaderVisit:this.dataSource.leaderVisit}})}},{key:"mounted",value:function(){this.curCustom={},this.fullPopShow=!1,this.searchValue=""}},{key:"activated",value:function(){this.$route.params.custId&&(this.curCustom=this.$route.params,this.fullPopShow=!this.curCustom.custId,this.searchValue=this.curCustom.custId+"/"+this.curCustom.custName,this.getData(this.curCustom.custId),this.onRefresh())}}]),a}(d["c"]);_d=Object(u["a"])([Object(d["a"])({components:{fullPop:Ce}})],_d);var kd=_d,Cd=kd,wd=(a("942e"),Object(V["a"])(Cd,gd,bd,!1,null,"760cc282",null)),Ld=wd.exports,xd=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"keyProjectsFollow"},[s("van-search",{attrs:{value:e.searchValue,placeholder:e.placeholder},on:{click:function(){t.fullPopShow=!0}}}),e.curCustom.custName?e.nopermit?s("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"网格层级信息未维护，请先去管理后台进行维护"}}):s("div",[s("div",{staticClass:"customer-info"},[s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("客户信息")]),s("div",{staticClass:"customer__content"},[s("div",{staticClass:"customer__name"},[e._v(e._s(e.dataSource.custId?e.dataSource.custId+"/"+e.dataSource.custName:""))]),e.buttonShow?s("div",{staticClass:"customer__link",on:{click:e.toKeyProjects}},[e._v("[网格化管理]")]):e._e()])]),s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("联合体")]),s("div",{staticClass:"customer__content"},[s("div",{staticClass:"customer__name"},[e._v(e._s(e.dataSource.communtyId?e.dataSource.communtyId+"/"+e.dataSource.communtyName:"无"))])])]),s("div",{staticClass:"customer__linetwo"},[s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("网格层级")]),s("div",{staticClass:"customer__content"},[e._v(e._s(e.dataSource.gridGrade))])]),s("div",{staticClass:"customer__line"},[s("div",{staticClass:"customer__title"},[e._v("项目类型")]),s("div",{staticClass:"customer__content flex"},e._l(e.dataSource.typeList,(function(t,a){return s("div",{key:a,staticClass:"type-item"},[e._v(e._s(t.type[0]))])})),0)])]),s("van-tabs",{directives:[{name:"show",rawName:"v-show",value:e.dataSource.deptList&&e.dataSource.deptList.length>1,expression:"dataSource.deptList && dataSource.deptList.length > 1"}],attrs:{color:"#554d62",ellipsis:!1},on:{change:e.handleClick},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.dataSource.deptList,(function(t,e){return s("van-tab",{key:e,attrs:{title:t.deptName,name:t.deptId}})})),1),s("div",{staticClass:"projects-block"},[s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__title"},[e._v("业务员")]),s("div",{staticClass:"projects-item__content"},[e._v(e._s(e.dataSource.saler))])]),s("div",{staticClass:"projects-item ml-40"},[s("div",{staticClass:"projects-item__title"},[e._v("领航员")]),s("div",{staticClass:"projects-item__content"},[e._v(e._s(e.dataSource.pilotName))])])])],1),s("div",{staticClass:"task-item"},[s("div",{staticClass:"projects-table"},[s("div",{staticClass:"task-item__top"},[s("div",{staticClass:"task-item__title"},[e._v("统计")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle"}),s("div",{staticClass:"projects-item__theader2 gray"},[s("i",{staticClass:"iconfont ytcrm-xiaoshoue"}),e._v("销售额")]),s("div",{staticClass:"projects-item__theader2 gray"},[s("i",{staticClass:"iconfont ytcrm-organization"}),e._v("联合体")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle gray"},[e._v("单月初始增速")]),s("div",{staticClass:"projects-item__theader2"},[e._v(e._s(e.dataSource.increaseData.saleMonth)+"%")]),e.dataSource.increaseData.unionMonth?s("div",{staticClass:"projects-item__theader2"},[e._v(e._s(e.dataSource.increaseData.unionMonth)+"%")]):s("div",{staticClass:"projects-item__theader2"},[e._v("--")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle gray"},[e._v("本月同比增速")]),s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.saleMonthRate<e.dataSource.increaseData.saleMonth?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.saleMonthRate)+"%")]),e.dataSource.increaseData.unionMonthRate?s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.unionMonthRate<e.dataSource.increaseData.unionMonth?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.unionMonthRate)+"%")]):s("div",{staticClass:"projects-item__theader2"},[e._v("--")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle gray"},[e._v("本月环比增速")]),s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.saleLastMonthRate<e.dataSource.increaseData.saleMonth?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.saleLastMonthRate)+"%")]),e.dataSource.increaseData.unionLastMonthRate?s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.unionLastMonthRate<e.dataSource.increaseData.unionMonth?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.unionLastMonthRate)+"%")]):s("div",{staticClass:"projects-item__theader2"},[e._v("--")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle gray"},[e._v("本年初始增速")]),s("div",{staticClass:"projects-item__theader2"},[e._v(e._s(e.dataSource.increaseData.saleYear)+"%")]),e.dataSource.increaseData.unionYear?s("div",{staticClass:"projects-item__theader2"},[e._v(e._s(e.dataSource.increaseData.unionYear)+"%")]):s("div",{staticClass:"projects-item__theader2"},[e._v("--")])]),s("div",{staticClass:"projects-item"},[s("div",{staticClass:"projects-item__thetitle gray"},[e._v("本年实际增速")]),s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.saleYearRate<e.dataSource.increaseData.saleYear?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.saleYearRate)+"%")]),e.dataSource.increaseData.unionYearRate?s("div",{staticClass:"projects-item__theader2",style:e.dataSource.increaseData.unionYearRate<e.dataSource.increaseData.unionYear?"color: #fc923f":"color: #60b770"},[e._v(e._s(e.dataSource.increaseData.unionYearRate)+"%")]):s("div",{staticClass:"projects-item__theader2"},[e._v("--")])])]),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.dataLoading,expression:"dataLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),s("div",{staticClass:"task-item"},[s("div",{staticClass:"projects-header"},[s("van-tabs",{staticStyle:{width:"70%"},attrs:{color:"#554d62"},on:{change:e.onRefresh},model:{value:e.typeActive,callback:function(t){e.typeActive=t},expression:"typeActive"}},[s("van-tab",{attrs:{title:"GR",name:"1"}}),s("van-tab",{attrs:{title:"目标任务",name:"2"}}),s("van-tab",{attrs:{title:"目标品种",name:"3"}})],1),s("i",{staticClass:"iconfont ytcrm-xinzeng add-btn",on:{click:e.toAddPage}})],1),s("van-pull-refresh",{staticClass:"projects-list",on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[s("van-list",{attrs:{finished:e.finished,"immediate-check":!1,"finished-text":"没有更多了",error:e.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(t){e.error=t},load:e.getDataList},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:1===+e.typeActive,expression:"+typeActive === 1"}]},e._l(e.grList,(function(t){return s("div",{key:t.custId,staticClass:"customer-item van-clearfix"},[s("van-swipe-cell",{scopedSlots:e._u([{key:"right",fn:function(){return[s("van-button",{staticClass:"del-btn",attrs:{square:"",type:"info",text:"编辑"},on:{click:function(a){return a.stopPropagation(),e.toEdit(1,t)}}}),s("van-button",{staticClass:"del-btn",attrs:{square:"",type:"danger",text:"删除"},on:{click:function(a){return a.stopPropagation(),e.deleteItem(1,t)}}})]},proxy:!0}],null,!0)},[s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("人员")]),s("div",{staticClass:"customer-item__content"},[e._v(" "+e._s(t.personId)+"/"+e._s(t.personName)+" ")])]),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("职位")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(t.position))])]),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("进度")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(t.content))])]),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("最新")]),t.topicDetailVO.visitTime?s("div",{staticClass:"customer-item__content"},[s("div",[e._v(e._s(t.topicDetailVO.visitTime.slice(0,t.topicDetailVO.visitTime.length-3))),s("span",[e._v(e._s(t.topicDetailVO.smallTagName?"【"+t.topicDetailVO.smallTagName+"】":""))])]),s("div",[e._v(e._s(t.topicDetailVO.remark))])]):s("div",{staticClass:"customer-item__content"},[e._v("无")])])])],1)})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:2===+e.typeActive,expression:"+typeActive === 2"}]},[s("div",{staticClass:"change-btn",on:{click:e.changeStatus}},[e._v(e._s(1===e.targetStatus?"点击显示已完成的目标":"取消"))]),e._l(e.targetList,(function(t){return s("div",{key:t.targetId,staticClass:"customer-item van-clearfix"},[s("van-swipe-cell",{attrs:{disabled:2===e.targetStatus},scopedSlots:e._u([{key:"right",fn:function(){return[s("van-button",{staticClass:"del-btn",attrs:{square:"",type:"info",text:"编辑"},on:{click:function(a){return a.stopPropagation(),e.toEdit(2,t)}}}),s("van-button",{staticClass:"del-btn",attrs:{square:"",type:"danger",text:"删除"},on:{click:function(a){return a.stopPropagation(),e.deleteItem(2,t)}}})]},proxy:!0}],null,!0)},[s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("时间")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(t.targetTime))])]),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("状态")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(0===+t.status?"待完成":1===+t.status?"已完成":""))])]),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("内容")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(t.content))])])])],1)}))],2),s("div",{directives:[{name:"show",rawName:"v-show",value:3===+e.typeActive,expression:"+typeActive === 3"}]},[s("van-form",[s("van-field",{attrs:{label:"时间范围",placeholder:"点击选择时间范围","input-align":"right",readonly:""},on:{click:function(){t.showPickerDate=!0}},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}),s("van-field",{attrs:{label:"关键词",placeholder:"请输入货品ID|名称","input-align":"right",clearable:""},on:{input:e.onRefresh},model:{value:e.goods,callback:function(t){e.goods=t},expression:"goods"}})],1),e._l(e.goodsList,(function(t){return s("div",{key:t.goodsId,staticClass:"customer-item van-clearfix"},[s("van-swipe-cell",{scopedSlots:e._u([{key:"right",fn:function(){return[s("van-button",{staticClass:"del-btn",attrs:{square:"",type:"danger",text:"删除"},on:{click:function(a){return a.stopPropagation(),e.deleteItem(3,t)}}})]},proxy:!0}],null,!0)},[s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title2"},[e._v("货品信息")]),s("div",{staticClass:"customer-item__content text-right"},[e._v(e._s(t.goodsId?t.goodsId+"/"+t.goodsName:""))])]),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title2"},[e._v("加入前6个月销售额")]),s("div",{staticClass:"customer-item__content text-right"},[e._v(e._s(t.saleBefore||0))])]),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title2"},[e._v("本年累计销售额")]),s("div",{staticClass:"customer-item__content text-right"},[e._v(e._s(t.saleAllYear||0))])]),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title2"},[e._v("加入之日（"+e._s(e.formatDate(t.creTime.split(" ")[0]))+"）起销售额")]),s("div",{staticClass:"customer-item__content text-right"},[e._v(e._s(t.saleNow||0))])])])],1)}))],2)])],1)],1)]):s("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"请先输入指定客户"}}),s("full-pop",{directives:[{name:"show",rawName:"v-show",value:e.fullPopShow,expression:"fullPopShow"}],attrs:{placeholder:e.placeholder,loading:e.custLoading,list:e.custList},on:{cancel:function(t){e.fullPopShow=!1},input:e.getCustList,select:e.onSelectCustomer}}),s("van-calendar",{attrs:{type:"range","min-date":e.minDate,maxDate:e.maxDate,color:"#1989fa","allow-same-day":""},on:{confirm:e.onConfirmDate},model:{value:e.showPickerDate,callback:function(t){e.showPickerDate=t},expression:"showPickerDate"}})],1)},Id=[],Sd=Object(h["b"])("commonStore"),Dd=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.placeholder="请输入客户ID|名称",t.searchValue="",t.buttonShow=!1,t.fullPopShow=!1,t.nopermit=!1,t.custLoading=!1,t.custList=[],t.curCustom={},t.dataLoading=!1,t.dataSource={increaseData:{}},t.active=0,t.typeActive="1",t.targetStatus=1,t.pageSize=10,t.page=1,t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.grList=[],t.targetList=[],t.goodsList=[],t.curDept={},t.dateRange="",t.showPickerDate=!1,t.showPickerDateEnd=!1,t.bgDate="",t.endDate="",t.minDate=new Date(2010,0,1),t.maxDate=new Date,t.goods="",t}return Object(o["a"])(a,[{key:"formatDate",value:function(t){return"".concat(t.split("-")[0],"年").concat(t.split("-")[1],"月")}},{key:"formatBeforeSixMonth",value:function(t){var e=+t.split("-")[0],a=+t.split("-")[1];return+a<=6?(a+=6,e-=1):a-=6,"".concat(e,"年").concat(a,"月")}},{key:"formatBeforeMonth",value:function(t){var e=+t.split("-")[0],a=+t.split("-")[1];return 1===+a?(a=12,e-=1):a-=1,"".concat(e,"年").concat(a,"月")}},{key:"formatter",value:function(t,e){return"year"===t?"".concat(e,"年"):"month"===t?"".concat(e,"月"):e}},{key:"onCancelDate",value:function(){this.showPickerDate=!1,this.showPickerDateEnd=!1}},{key:"formatSearchDate",value:function(t){return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate())}},{key:"onConfirmDate",value:function(t){var e=Object(gn["a"])(t,2),a=e[0],s=e[1];this.showPickerDate=!1,this.dateRange="".concat(this.formatSearchDate(a)," 至 ").concat(this.formatSearchDate(s)),this.onRefresh()}},{key:"getCustList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$cancelAxios(["queryCust"]),this.custList=[],""===e){t.next=8;break}return this.custLoading=!0,t.next=6,Oa({cust:e});case 6:a=t.sent,a.success&&(this.custLoading=!1,this.custList=a.data);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onSelectCustomer",value:function(t){this.$cancelAxios(["queryByLeader","queryPlanListByPage","queryTargetListByPage","queryGridGoodsListByPage"]),this.curCustom=t,this.searchValue=t.custId+"/"+t.custName,this.fullPopShow=!1,this.getData(t.custId)}},{key:"getData",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,s,i,n,r,o,c,l,u,d,h,p,m,v,f,g,b,y;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ta({custId:e});case 2:if(a=t.sent,s=a.data,i=a.success,!i){t.next=20;break}return this.nopermit=!1,n=s.communityVO,r=n.communtyId,o=n.communtyName,c=n.child,l=n.father,t.next=10,ns({custId:e,communtyId:r});case 10:u=t.sent,d=s.gridListVO,h=d.ccuId,p=d.custName,m=d.gridGradeId,v=d.gridGrade,f=d.typeList,g=d.pilotName,b=d.leaderVisitTarget,y=d.personVisitTarget,this.dataSource={ccuId:h,communtyId:r,communtyName:o,father:l,child:c||[],custId:s.gridListVO.custId,custName:p,gridGradeId:m,gridGrade:v,typeList:f,pilotName:g,leaderVisitTarget:b,personVisitTarget:y,deptList:s.sale,saler:s.sale[0].userName,increaseData:u.data||{saleMonth:"",saleYear:"",saleMonthRate:"",saleYearRate:"",unionMonth:"",unionYear:"",unionMonthRate:"",unionYearRate:""}},this.curDept=s.sale[0],this.active=0,this.typeActive="1",this.getDataInfo(),this.onRefresh(),t.next=21;break;case 20:this.nopermit=!0;case 21:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDataInfo",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.dataLoading=!0,this.dataLoading=!1;case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onRefresh",value:function(){this.$cancelAxios(["queryPlanListByPage","queryTargetListByPage","queryGridGoodsListByPage"]),this.finished=!1,this.loading=!0,this.page=1,this.grList=[],this.targetList=[],this.goodsList=[],this.getDataList()}},{key:"getDataList",value:function(){1===+this.typeActive?this.getTableData():2===+this.typeActive?this.getTargetList():3===+this.typeActive&&this.getGoodsList()}},{key:"getTableData",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={ccuId:this.dataSource.ccuId,custId:this.curCustom.custId,saleId:this.curDept.userId,pageNum:this.page,pageSize:this.pageSize},t.next=4,Ma(e);case 4:a=t.sent,this.loading=!1,this.refreshing=!1,a.success?(a.data.list.forEach((function(t){t.topicDetailVO||(t.topicDetailVO={smallTagName:"",visitTime:"",remark:""})})),this.grList=[].concat(Object(y["a"])(this.grList),Object(y["a"])(a.data.list)),this.page++,this.finished=!a.data.hasNextPage):this.error=!0;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getTargetList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={ccuId:this.dataSource.ccuId,saleId:this.curDept.userId,pageNum:this.page,pageSize:this.pageSize,status:1===this.targetStatus?0:1},t.next=4,Ba(e);case 4:a=t.sent,this.loading=!1,this.refreshing=!1,a.success?(a.data.list.forEach((function(t,e){t.targetText="目标".concat(e+1)})),this.targetList=[].concat(Object(y["a"])(this.targetList),Object(y["a"])(a.data.list)),this.page++,this.finished=!a.data.hasNextPage):this.error=!0;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getGoodsList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={ccuId:this.dataSource.ccuId,deptId:this.curDept.deptId,saleId:this.curDept.userId,pageNum:this.page,pageSize:this.pageSize,goods:this.goods,start:this.dateRange.split("至")[0],end:this.dateRange.split("至")[1]},t.next=4,ls(e);case 4:a=t.sent,this.loading=!1,this.refreshing=!1,a.success?(this.goodsList=[].concat(Object(y["a"])(this.goodsList),Object(y["a"])(a.data.list)),this.page++,this.finished=!a.data.hasNextPage):this.error=!0;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"toKeyProjects",value:function(){this.$router.replace({name:"keyProjectsIndex",params:this.curCustom})}},{key:"handleClick",value:function(){var t=this;this.curDept=this.dataSource.deptList.filter((function(e){return+e.deptId===+t.active}))[0],this.dataSource.saler=this.curDept.userName,this.typeActive="1",this.getDataInfo(),this.onRefresh()}},{key:"changeStatus",value:function(){this.targetStatus=1===this.targetStatus?2:1,this.onRefresh()}},{key:"toAddPage",value:function(){this.SET_HADDONEONDETAIL(!1),1===+this.typeActive?this.$router.push({name:"keyAddGR",params:{curDept:this.curDept,ccuId:this.dataSource.ccuId,custId:this.dataSource.custId}}):2===+this.typeActive?this.$router.push({name:"keyAddTarget",params:{curDept:this.curDept,ccuId:this.dataSource.ccuId}}):3===+this.typeActive&&this.$router.push({name:"keyAddGoods",params:{curDept:this.curDept,ccuId:this.dataSource.ccuId}})}},{key:"toEdit",value:function(t,e){this.SET_HADDONEONDETAIL(!1),1===t?this.$router.push({name:"keyAddGR",params:{item:Object(b["a"])({},e),curDept:this.curDept,ccuId:this.dataSource.ccuId,custId:this.dataSource.custId}}):2===t?this.$router.push({name:"keyAddTarget",params:{item:Object(b["a"])({},e),curDept:this.curDept,ccuId:this.dataSource.ccuId}}):3===t&&this.$router.push({name:"keyAddGoods",params:e})}},{key:"deleteItem",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e,a){var s,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!==e){t.next=7;break}return t.next=3,za({cupId:a.cupId});case 3:s=t.sent,s.success&&(this.$toast.success(s.msg||"删除成功"),this.onRefresh()),t.next=19;break;case 7:if(2!==e){t.next=14;break}return t.next=10,Ja({cutId:a.cutId});case 10:i=t.sent,i.success&&(this.$toast.success(i.msg||"删除成功"),this.onRefresh()),t.next=19;break;case 14:if(3!==e){t.next=19;break}return t.next=17,ps({cugId:a.cugId});case 17:n=t.sent,n.success&&(this.$toast.success(n.msg||"删除成功"),this.onRefresh());case 19:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){this.curCustom={},this.fullPopShow=!1,this.searchValue="";var t=at(JSON.parse(localStorage.getItem("menuTree")||""),"工作跟进",[]);this.buttonShow=t.some((function(t){return"网格化管理"===t.pmsName}))}},{key:"activated",value:function(){this.$route.params.custId&&(this.curCustom=this.$route.params,this.fullPopShow=!this.curCustom.custId,this.searchValue=this.curCustom.custId+"/"+this.curCustom.custName,this.getData(this.curCustom.custId)),this.hadDoneOnDetail&&this.onRefresh()}}]),a}(d["c"]);Object(u["a"])([Sd.Mutation],Dd.prototype,"SET_HADDONEONDETAIL",void 0),Object(u["a"])([h["a"]],Dd.prototype,"hadDoneOnDetail",void 0),Dd=Object(u["a"])([Object(d["a"])({components:{fullPop:Ce}})],Dd);var Od=Dd,jd=Od,Td=(a("3bc3"),Object(V["a"])(jd,xd,Id,!1,null,"20b70428",null)),Rd=Td.exports,Nd=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"key-addgr"},[a("div",{staticClass:"detail__card"},[a("van-form",{attrs:{"validate-first":""},on:{failed:t.onFailed}},[a("van-field",{attrs:{disabled:!!t.data.cupId,clearable:"",required:"",label:"人员信息",placeholder:"请输入人员信息",rules:[{validator:t.validator,message:"请输入人员信息"}]},on:{click:t.choosePerson},model:{value:t.data.personName,callback:function(e){t.$set(t.data,"personName",e)},expression:"data.personName"}}),a("van-field",{attrs:{disabled:"",clearable:"",required:"",label:"职位",placeholder:"请选择职位",rules:[{validator:t.validator,message:"请选择职位"}]},model:{value:t.data.position,callback:function(e){t.$set(t.data,"position",e)},expression:"data.position"}}),a("van-field",{attrs:{clearable:"",required:"",label:"进度",placeholder:"请输入进度",rules:[{validator:t.validator,message:"请输入进度"}]},model:{value:t.data.content,callback:function(e){t.$set(t.data,"content",e)},expression:"data.content"}}),a("van-field",{attrs:{disabled:"",clearable:"",required:"",label:"事件类型",placeholder:"事件类型"},model:{value:t.data.topicDetailVO.smallTagName,callback:function(e){t.$set(t.data.topicDetailVO,"smallTagName",e)},expression:"data.topicDetailVO.smallTagName"}}),a("van-field",{attrs:{disabled:"",clearable:"",required:"",label:"时间",placeholder:"时间"},model:{value:t.data.topicDetailVO.visitTime,callback:function(e){t.$set(t.data.topicDetailVO,"visitTime",e)},expression:"data.topicDetailVO.visitTime"}}),a("van-field",{attrs:{disabled:"",clearable:"",required:"",label:"备注",placeholder:"备注"},model:{value:t.data.topicDetailVO.remark,callback:function(e){t.$set(t.data.topicDetailVO,"remark",e)},expression:"data.topicDetailVO.remark"}})],1)],1),a("div",{staticClass:"footer"},[a("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit",size:"small",loading:t.submitLoading},on:{click:t.submit}},[t._v("提交")])],1),a("person-pop",{directives:[{name:"show",rawName:"v-show",value:t.personPopShow,expression:"personPopShow"}],attrs:{placeholder:t.placeholder,loading:t.personLoading,list:t.personList},on:{cancel:function(e){t.personPopShow=!1},input:t.getPersonList,select:t.onSelectPerson}})],1)},Ad=[],Pd=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"person-pop"},[a("van-search",{attrs:{autofocus:"","show-action":"",placeholder:t.placeholder||"请输入搜索关键词"},on:{input:t.onInput,cancel:t.cancel},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),a("div",{staticClass:"result-list"},[t._l(t.list,(function(e){return a("div",{key:e.userId,staticClass:"result-item",on:{click:function(a){return t.onSelectPerson(e)}}},[t._v(" "+t._s(e.userId)+"/"+t._s(e.userName)),e.position?a("span",[t._v("（"+t._s(e.position)+"）")]):t._e()])})),a("van-empty",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.list.length&&t.keywords,expression:"!loading && !list.length && keywords"}],staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无数据"}}),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{color:"#1989fa"}})],2)],1)},Ed=[],Md=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.keywords="",t}return Object(o["a"])(a,[{key:"cancel",value:function(){this.$emit("cancel")}},{key:"onInput",value:function(t){this.$emit("input",t)}},{key:"onSelectPerson",value:function(t){this.$emit("select",t)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Md.prototype,"list",void 0),Object(u["a"])([Object(d["b"])()],Md.prototype,"loading",void 0),Object(u["a"])([Object(d["b"])()],Md.prototype,"placeholder",void 0),Md=Object(u["a"])([Object(d["a"])({})],Md);var $d=Md,qd=$d,Vd=(a("5b61"),Object(V["a"])(qd,Pd,Ed,!1,null,"fc2a000e",null)),Ud=Vd.exports,Fd=Object(h["b"])("commonStore"),zd=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.placeholder="请输入人员ID|名称",t.personPopShow=!1,t.personLoading=!1,t.personList=[],t.custName="",t.data={cupId:"",personId:"",personName:"",position:"",content:"",topicDetailVO:{}},t.custId="",t.ccuId="",t.curDept={},t.submitLoading=!1,t}return Object(o["a"])(a,[{key:"choosePerson",value:function(){this.data.cupId||(this.personPopShow=!0)}},{key:"onSelectPerson",value:function(t){console.log(t),this.data.personId=t.userId,this.data.personName=t.userName,this.data.position=t.position,this.personPopShow=!1}},{key:"getPersonList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$cancelAxios(["queryGridPerson"]),this.personList=[],""===e){t.next=8;break}return this.personLoading=!0,t.next=6,Za({custId:this.custId,saleId:this.curDept.userId,person:e});case 6:a=t.sent,a.success&&(this.personLoading=!1,this.personList=a.data);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onSelectGoods",value:function(t){this.data.personId=t.userId,this.data.personName=t.userName,this.data.position=t.position,this.personPopShow=!1}},{key:"onFailed",value:function(t){console.log("failed",t)}},{key:"validator",value:function(t){console.log(t)}},{key:"submit",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.data.personId){t.next=3;break}return this.$toast("人员信息不能为空"),t.abrupt("return");case 3:if(this.data.content){t.next=6;break}return this.$toast("进度不能为空"),t.abrupt("return");case 6:if(e={ccuId:this.ccuId,deptId:this.curDept.deptId,deptName:this.curDept.deptName,saleId:this.curDept.userId,saleName:this.curDept.userName,cupId:this.data.cupId,content:this.data.content,position:this.data.position,personId:this.data.personId,personName:this.data.personName},this.submitLoading=!0,!this.data.cupId){t.next=14;break}return t.next=11,Ua(e);case 11:t.t0=t.sent,t.next=17;break;case 14:return t.next=16,qa(e);case 16:t.t0=t.sent;case 17:a=t.t0,a.success&&(this.SET_HADDONEONDETAIL(!0),this.$toast.success(a.msg||(this.data.cupId?"添加成功":"修改成功")),setTimeout((function(){s.submitLoading=!1,s.$router.back()}),1e3));case 19:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){console.log("=====p====",this.$route.params),this.custId=this.$route.params.custId,this.ccuId=this.$route.params.ccuId,this.curDept=this.$route.params.curDept;var t=this.$route.params.item;t&&t.cupId&&(this.data=this.$route.params.item)}}]),a}(d["c"]);Object(u["a"])([Fd.Mutation],zd.prototype,"SET_HADDONEONDETAIL",void 0),zd=Object(u["a"])([Object(d["a"])({components:{personPop:Ud}})],zd);var Wd=zd,Bd=Wd,Gd=(a("a0ff"),Object(V["a"])(Bd,Nd,Ad,!1,null,"b4ab3dc4",null)),Hd=Gd.exports,Yd=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"key-addtarget"},[s("div",{staticClass:"detail__card"},[s("van-form",{attrs:{"validate-first":""},on:{failed:e.onFailed}},[s("van-field",{attrs:{value:e.status.name,readonly:"",clickable:"",clearable:"",required:"",label:"状态",placeholder:"请选择状态",rules:[{validator:e.validator,message:"请选择状态"}]},on:{click:function(){t.actionShow=!0}}}),s("van-field",{attrs:{value:e.data.targetTime,readonly:"",clearable:"",required:"",label:"时间",placeholder:"请选择时间",rules:[{validator:e.validator,message:"请选择时间"}]},on:{click:function(){t.calendarShow=!0}}}),s("van-field",{attrs:{type:"textarea",clearable:"",required:"",label:"内容",placeholder:"请输入内容",rules:[{validator:e.validator,message:"请输入内容"}]},model:{value:e.data.content,callback:function(t){e.$set(e.data,"content",t)},expression:"data.content"}})],1)],1),s("div",{staticClass:"footer"},[s("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit",size:"small",loading:e.submitLoading},on:{click:e.submit}},[e._v("提交")])],1),s("van-action-sheet",{attrs:{actions:e.statusList,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onStatusChange},model:{value:e.actionShow,callback:function(t){e.actionShow=t},expression:"actionShow"}}),s("van-calendar",{attrs:{color:"#1989fa",title:"选择时间","min-date":e.minDate},on:{confirm:e.onDateChange},model:{value:e.calendarShow,callback:function(t){e.calendarShow=t},expression:"calendarShow"}})],1)},Qd=[],Kd=Object(h["b"])("commonStore"),Jd=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.statusList=[{value:0,name:"待完成"},{value:1,name:"已完成"}],t.actionShow=!1,t.minDate=new Date(2010,0,1),t.calendarShow=!1,t.status={},t.data={cutId:"",status:"",targetTime:"",content:""},t.ccuId="",t.curDept={},t.submitLoading=!1,t}return Object(o["a"])(a,[{key:"onStatusChange",value:function(t){console.log(t),this.status=t,this.data.status=t.value}},{key:"onDateChange",value:function(t){this.calendarShow=!1,this.data.targetTime=Gs(t)}},{key:"onFailed",value:function(t){console.log("failed",t)}},{key:"validator",value:function(t){console.log(t)}},{key:"submit",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0===this.data.status||1===this.data.status){t.next=3;break}return this.$toast("状态不能为空"),t.abrupt("return");case 3:if(this.data.targetTime){t.next=6;break}return this.$toast("时间不能为空"),t.abrupt("return");case 6:if(this.data.content){t.next=9;break}return this.$toast("内容不能为空"),t.abrupt("return");case 9:if(e={ccuId:this.ccuId,cutId:this.data.cutId,content:this.data.content,status:this.data.status,targetTime:this.data.targetTime,deptId:this.curDept.deptId,deptName:this.curDept.deptName,saleId:this.curDept.userId,saleName:this.curDept.userName},this.submitLoading=!0,!this.data.cutId){t.next=17;break}return t.next=14,Qa(e);case 14:t.t0=t.sent,t.next=20;break;case 17:return t.next=19,Ha(e);case 19:t.t0=t.sent;case 20:a=t.t0,a.success&&(this.SET_HADDONEONDETAIL(!0),this.$toast.success(a.msg||(this.data.cupId?"添加成功":"修改成功")),setTimeout((function(){s.submitLoading=!1,s.$router.back()}),1e3));case 22:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){this.ccuId=this.$route.params.ccuId,this.curDept=this.$route.params.curDept;var t=this.$route.params.item;t&&t.cutId&&(this.data=t,this.status={value:+t.status,name:0===+t.status?"待完成":1===+t.status?"已完成":""})}}]),a}(d["c"]);Object(u["a"])([Kd.Mutation],Jd.prototype,"SET_HADDONEONDETAIL",void 0),Jd=Object(u["a"])([Object(d["a"])({})],Jd);var Xd=Jd,Zd=Xd,th=(a("d19f"),Object(V["a"])(Zd,Yd,Qd,!1,null,"9df4c31c",null)),eh=th.exports,ah=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"key-addgoods"},[a("div",{staticClass:"detail__card"},[a("van-form",{attrs:{"validate-first":""},on:{failed:t.onFailed}},[a("van-field",{attrs:{disabled:!!t.data.id,clearable:"",required:"",label:"货品信息",placeholder:"请输入货品信息",rules:[{validator:t.validator,message:"请输入货品信息"}]},on:{click:t.chooseGoods},model:{value:t.goods,callback:function(e){t.goods=e},expression:"goods"}})],1)],1),a("div",{staticClass:"footer"},[a("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit",size:"small",loading:t.submitLoading},on:{click:t.submit}},[t._v("提交")])],1),a("goods-pop",{directives:[{name:"show",rawName:"v-show",value:t.goodsPopShow,expression:"goodsPopShow"}],attrs:{placeholder:t.placeholder,loading:t.goodsLoading,list:t.goodsList},on:{cancel:function(e){t.goodsPopShow=!1},input:t.getGoodsList,select:t.onSelectGoods}})],1)},sh=[],ih=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"goods-pop"},[a("van-search",{attrs:{autofocus:"","show-action":"",placeholder:t.placeholder||"请输入搜索关键词"},on:{input:t.onInput,cancel:t.cancel},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),a("div",{staticClass:"result-list"},[t._l(t.list,(function(e){return a("div",{key:e.goodsId,staticClass:"result-item",on:{click:function(a){return t.onSelectGoods(e)}}},[t._v(" "+t._s(e.goodsId)+"/"+t._s(e.goodsName)+" ")])})),a("van-empty",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.list.length&&t.keywords,expression:"!loading && !list.length && keywords"}],staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无数据"}}),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{color:"#1989fa"}})],2)],1)},nh=[],rh=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.keywords="",t}return Object(o["a"])(a,[{key:"cancel",value:function(){this.$emit("cancel")}},{key:"onInput",value:function(t){this.$emit("input",t)}},{key:"onSelectGoods",value:function(t){this.$emit("select",t)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],rh.prototype,"list",void 0),Object(u["a"])([Object(d["b"])()],rh.prototype,"loading",void 0),Object(u["a"])([Object(d["b"])()],rh.prototype,"placeholder",void 0),rh=Object(u["a"])([Object(d["a"])({})],rh);var oh=rh,ch=oh,lh=(a("34af"),Object(V["a"])(ch,ih,nh,!1,null,"036bf40d",null)),uh=lh.exports,dh=Object(h["b"])("commonStore"),hh=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.placeholder="请输入货品ID|名称",t.goodsPopShow=!1,t.goodsLoading=!1,t.goodsList=[],t.goods="",t.ccuId="",t.curDept={},t.data={cugId:"",goodsId:"",goodsName:""},t.submitLoading=!1,t}return Object(o["a"])(a,[{key:"chooseGoods",value:function(){this.data.id||(this.goodsPopShow=!0)}},{key:"getGoodsList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$cancelAxios(["queryGoods"]),this.goodsList=[],""===e){t.next=8;break}return this.goodsLoading=!0,t.next=6,os({goods:e});case 6:a=t.sent,a.success&&(this.goodsLoading=!1,this.goodsList=a.data);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onSelectGoods",value:function(t){this.goods=t.goodsId+"/"+t.goodsName,this.data.goodsId=t.goodsId,this.data.goodsName=t.goodsName,this.goodsPopShow=!1}},{key:"onFailed",value:function(t){console.log("failed",t)}},{key:"validator",value:function(t){console.log(t)}},{key:"submit",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.data.goodsId){t.next=3;break}return this.$toast("货品信息不能为空"),t.abrupt("return");case 3:return e={ccuId:this.ccuId,deptId:this.curDept.deptId,deptName:this.curDept.deptName,saleId:this.curDept.userId,saleName:this.curDept.userName,cugId:this.data.cugId,goodsId:this.data.goodsId,goodsName:this.data.goodsName},this.submitLoading=!0,t.next=7,ds(e);case 7:a=t.sent,a.success&&(this.SET_HADDONEONDETAIL(!0),this.$toast.success(a.msg||"添加成功"),setTimeout((function(){s.submitLoading=!1,s.$router.back()}),1e3));case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){this.ccuId=this.$route.params.ccuId,this.curDept=this.$route.params.curDept,this.$route.params.cugId&&(this.data=this.$route.params,this.goods=this.data.goodsId+"/"+this.data.goodsName)}}]),a}(d["c"]);Object(u["a"])([dh.Mutation],hh.prototype,"SET_HADDONEONDETAIL",void 0),hh=Object(u["a"])([Object(d["a"])({components:{goodsPop:uh}})],hh);var ph=hh,mh=ph,vh=(a("cc6e"),Object(V["a"])(mh,ah,sh,!1,null,"cfad26e4",null)),fh=vh.exports,gh=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"key-topic"},[a("van-sticky",[a("van-tabs",{attrs:{color:"#554d62"},on:{change:t.handleClick},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("van-tab",{attrs:{title:"个人拜访",name:"1"}}),a("van-tab",{attrs:{title:"领导协防",name:"2"}})],1)],1),t.list&&t.list.length?t._e():a("van-empty",{staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无拜访记录"}}),t._l(t.list,(function(e,s){return a("div",{key:s,staticClass:"customer-item van-clearfix"},[a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__cust",staticStyle:{color:"#333"}},[t._v(t._s(e.labelName))]),a("div",{staticClass:"customer-item__time"},[t._v(t._s(e.visitTime?e.visitTime.slice(0,e.visitTime.length-3):""))])]),a("div",{staticClass:"line"}),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("客户")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.companyName))])]),e.expectTimeStr?a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("预期时间")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.expectTimeStr))])]):t._e(),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("业务员")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.userName))])]),e.togetherUserName?a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v(t._s(1===e.taskType?"随访人":"协访人"))]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.togetherUserName))])]):t._e(),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("备注")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.remark))])])])}))],2)},bh=[],yh=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.active=1,t.list=[],t}return Object(o["a"])(a,[{key:"handleClick",value:function(){this.list=1===+this.active?this.$route.params.personVisit:this.$route.params.leaderVisit}},{key:"mounted",value:function(){document.documentElement.scrollTop=0,console.log("=====p====",this.$route.params),this.active=1,this.list=this.$route.params.personVisit}}]),a}(d["c"]);yh=Object(u["a"])([Object(d["a"])({})],yh);var _h=yh,kh=_h,Ch=(a("2e68"),Object(V["a"])(kh,gh,bh,!1,null,"326330c3",null)),wh=Ch.exports,Lh=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"keyProjects"},[a("div",[a("div",{staticClass:"customer-info"},[a("div",{staticClass:"customer__line"},[a("div",{staticClass:"customer__title"},[t._v("客户信息")]),a("div",{staticClass:"customer__content"},[a("div",{staticClass:"customer__name"},[t._v(t._s(t.dataSource.custId?t.dataSource.custId+"/"+t.dataSource.custName:""))])])]),a("div",{staticClass:"customer__line"},[a("div",{staticClass:"customer__title"},[t._v("联合体")]),a("div",{staticClass:"customer__content"},[a("div",{staticClass:"customer__name"},[t._v(t._s(t.dataSource.communtyId?t.dataSource.communtyId+"/"+t.dataSource.communtyName:""))])])]),a("div",{staticClass:"customer__linetwo"},[a("div",{staticClass:"customer__line"},[a("div",{staticClass:"customer__title"},[t._v("网格层级")]),a("div",{staticClass:"customer__content"},[t._v(t._s(t.dataSource.gridGradeId)+"/"+t._s(t.dataSource.gridGrade))])]),a("div",{staticClass:"customer__line"},[a("div",{staticClass:"customer__title"},[t._v("项目类型")]),a("div",{staticClass:"customer__content flex"},t._l(t.dataSource.typeList,(function(e,s){return a("div",{key:s,staticClass:"type-item"},[t._v(t._s(e.type[0]))])})),0)])]),a("van-tabs",{directives:[{name:"show",rawName:"v-show",value:t.dataSource.deptList&&t.dataSource.deptList.length,expression:"dataSource.deptList && dataSource.deptList.length"}],attrs:{color:"#554d62",ellipsis:!1},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.dataSource.deptList,(function(t,e){return a("van-tab",{key:e,attrs:{title:t.deptName,name:t.deptId}})})),1),a("div",{staticClass:"projects-block"},[a("div",{staticClass:"projects-item"},[a("div",{staticClass:"projects-item__title"},[t._v("业务员")]),a("div",{staticClass:"projects-item__content"},[t._v(t._s(t.dataSource.saler))])]),a("div",{staticClass:"projects-item ml-40"},[a("div",{staticClass:"projects-item__title"},[t._v("领航员")]),a("div",{staticClass:"projects-item__content"},[t._v(t._s(t.dataSource.pilotName))])])])],1),a("div",{staticClass:"task-item"},[a("div",{staticClass:"projects-table"},[t._m(0),t._m(1),a("div",{staticClass:"projects-item"},[t._m(2),a("div",{staticClass:"projects-item__theader"},[t._v(t._s(t.dataSource.personVisitTarget)+" 次/月")]),a("div",{staticClass:"projects-item__theader",style:t.dataSource.personVisitTimes<t.dataSource.personVisitTarget?"color: #fc923f":"color: #60b770"},[t._v(t._s(t.dataSource.personVisitTimes)+" 次")])]),a("div",{staticClass:"projects-item"},[t._m(3),a("div",{staticClass:"projects-item__theader"},[t._v(t._s(t.dataSource.leaderVisitTarget)+" 次/月")]),a("div",{staticClass:"projects-item__theader",style:t.dataSource.leaderVisitTimes<t.dataSource.leaderVisitTarget?"color: #fc923f":"color: #60b770"},[t._v(t._s(t.dataSource.leaderVisitTimes)+" 次")])])]),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.infoLoading,expression:"infoLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),a("div",{staticClass:"task-item"},[a("div",{staticClass:"projects-chart"},[t._m(4),a("div",{staticClass:"key-gr"},[a("div",{ref:"keyChart",staticClass:"key-gr__chart"})])]),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.infoLoading,expression:"infoLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),a("div",{staticClass:"task-item"},[a("div",{staticClass:"projects-warmth"},[t._m(5),a("div",{staticClass:"projects-warmth-item"},[a("div",{staticClass:"projects-warmth-item__name"},[t._v("一般")]),a("div",{staticClass:"projects-warmth-item__value"},[t._v(t._s(t.dataSource.normal))]),a("div",{staticClass:"projects-warmth-item__change"},[t._v(t._s((t.dataSource.normalUp>0?"+":"")+(t.dataSource.normalUp||"")))])]),a("div",{staticClass:"projects-warmth-item"},[a("div",{staticClass:"projects-warmth-item__name"},[t._v("进阶")]),a("div",{staticClass:"projects-warmth-item__value"},[t._v(t._s(t.dataSource.lack))]),a("div",{staticClass:"projects-warmth-item__change"},[t._v(t._s((t.dataSource.lackUp>0?"+":"")+(t.dataSource.lackUp||"")))])]),a("div",{staticClass:"projects-warmth-item"},[a("div",{staticClass:"projects-warmth-item__name"},[t._v("未有")]),a("div",{staticClass:"projects-warmth-item__value"},[t._v(t._s(t.dataSource.never))]),a("div",{staticClass:"projects-warmth-item__change"},[t._v(t._s((t.dataSource.neverUp>0?"+":"")+(t.dataSource.neverUp||"")))])])]),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.infoLoading,expression:"infoLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),a("div",{staticClass:"task-item"},[a("div",{staticClass:"projects-table"},[t._m(6),t._m(7),a("div",{staticClass:"projects-item"},[t._m(8),a("div",{staticClass:"projects-item__theader2"},[t._v(t._s(t.dataSource.increaseData.saleMonth)+"%")]),a("div",{staticClass:"projects-item__theader2",style:t.dataSource.increaseData.saleMonthRate<t.dataSource.increaseData.saleMonth?"color: #fc923f":"color: #60b770"},[t._v(t._s(t.dataSource.increaseData.saleMonthRate)+"%")]),a("div",{staticClass:"projects-item__theader2"},[t._v(t._s(t.dataSource.increaseData.saleYear)+"%")]),a("div",{staticClass:"projects-item__theader2",style:t.dataSource.increaseData.saleYearRate<t.dataSource.increaseData.saleYear?"color: #fc923f":"color: #60b770"},[t._v(t._s(t.dataSource.increaseData.saleYearRate)+"%")])]),a("div",{staticClass:"projects-item"},[t._m(9),a("div",{staticClass:"projects-item__theader2"},[t._v(t._s(t.dataSource.increaseData.unionMonth)+"%")]),a("div",{staticClass:"projects-item__theader2",style:t.dataSource.increaseData.unionMonthRate<t.dataSource.increaseData.unionMonth?"color: #fc923f":"color: #60b770"},[t._v(t._s(t.dataSource.increaseData.unionMonthRate)+"%")]),a("div",{staticClass:"projects-item__theader2"},[t._v(t._s(t.dataSource.increaseData.unionYear)+"%")]),a("div",{staticClass:"projects-item__theader2",style:t.dataSource.increaseData.unionYearRate<t.dataSource.increaseData.unionYear?"color: #fc923f":"color: #60b770"},[t._v(t._s(t.dataSource.increaseData.unionYearRate)+"%")])])]),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.infoLoading,expression:"infoLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1)])])},xh=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-item__top"},[a("div",{staticClass:"task-item__title"},[t._v("拜访")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"projects-item"},[a("div",{staticClass:"projects-item__thetitle"}),a("div",{staticClass:"projects-item__theader gray"},[t._v("目标次数")]),a("div",{staticClass:"projects-item__theader gray"},[t._v("当前次数")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"projects-item__thetitle gray"},[a("i",{staticClass:"iconfont ytcrm-quanzibaifang special-icon"}),t._v("个人拜访 ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"projects-item__thetitle gray"},[a("i",{staticClass:"iconfont ytcrm-zhuguanxiefang"}),t._v("领导协访 ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-item__top"},[a("div",{staticClass:"task-item__title"},[t._v("GR")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-item__top"},[a("div",{staticClass:"task-item__title"},[t._v("热力")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-item__top"},[a("div",{staticClass:"task-item__title"},[t._v("统计")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"projects-item"},[a("div",{staticClass:"projects-item__thetitle",staticStyle:{width:"68px"}}),a("div",{staticClass:"projects-item__theader2 gray"},[t._v("单月目标增速")]),a("div",{staticClass:"projects-item__theader2 gray"},[t._v("本月实际增速")]),a("div",{staticClass:"projects-item__theader2 gray"},[t._v("本年目标增速")]),a("div",{staticClass:"projects-item__theader2 gray"},[t._v("本年实际增速")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"projects-item__thetitle gray",staticStyle:{width:"68px"}},[a("i",{staticClass:"iconfont ytcrm-xiaoshoue"}),t._v("销售额 ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"projects-item__thetitle gray",staticStyle:{width:"68px"}},[a("i",{staticClass:"iconfont ytcrm-organization"}),t._v("联合体 ")])}],Ih=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.custId="",t.saleId="",t.pilotId="",t.infoLoading=!1,t.dataSource={increaseData:{}},t.active=-1,t.keyChartInstance=null,t}return Object(o["a"])(a,[{key:"getData",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,n,r,o,c,l,u,d,h,p,m,v,f,g,b,y,_,k,C,w,L,x,I,S,D,O,j,T,R,N,A=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.infoLoading=!0,t.next=3,ss({custId:this.custId,saleId:this.saleId,pilotId:this.pilotId});case 3:if(e=t.sent,a=e.data,s=e.success,this.infoLoading=!1,!s){t.next=16;break}return i=a.communityVO,n=i.communtyId,r=i.communtyName,o=i.child,c=i.father,t.next=11,ns({custId:this.custId,communtyId:n});case 11:l=t.sent,u=a.gridListVO,d=u.custName,h=u.gridGradeId,p=u.gridGrade,m=u.typeList,v=u.pilotName,f=u.leaderVisitTarget,g=u.personVisitTarget,b=a.gridList,y=b.agrade,_=b.bgrade,k=b.cgrade,C=b.dgrade,w=b.lack,L=b.never,x=b.normal,I=b.neverUp,S=b.lackUp,D=b.normalUp,O=b.userName,j=b.leaderVisit,T=b.personVisit,R=b.deptId,N=b.deptName,this.dataSource={communtyId:n,communtyName:r,father:c,child:o||[],custId:a.gridListVO.custId,custName:d,gridGradeId:h,gridGrade:p,typeList:m,pilotName:v,leaderVisitTarget:f,personVisitTarget:g,deptList:[{deptId:R,deptName:N}],gradeData:[y,_,k,C],lack:w,never:L,normal:x,neverUp:I,lackUp:S,normalUp:D,saler:O,leaderVisit:j,personVisit:T,leaderVisitTimes:j?j.length:"",personVisitTimes:T?T.length:"",increaseData:l.data||{saleMonth:"",saleYear:"",saleMonthRate:"",saleYearRate:"",saleLastMonthRate:"",unionMonth:"",unionYear:"",unionMonthRate:"",unionYearRate:"",unionLastMonthRate:""}},this.active=this.dataSource.deptList[0].deptId;case 16:this.$nextTick((function(){A.initChart()}));case 17:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"initChart",value:function(){var t=this.$refs.keyChart;this.keyChartInstance=yd["a"](t),this.keyChartInstance.clear();var e={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:"10px",left:"10px",bottom:"0",containLabel:!0},xAxis:{type:"category",data:["A","B","C","D"]},yAxis:{type:"value"},series:[{data:this.dataSource.gradeData,type:"bar",showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}}]};this.keyChartInstance.setOption(e)}},{key:"mounted",value:function(){this.custId=this.$route.query.custId,this.saleId=this.$route.query.saleId,this.pilotId=this.$route.query.pilotId,this.getData()}}]),a}(d["c"]);Ih=Object(u["a"])([Object(d["a"])({})],Ih);var Sh=Ih,Dh=Sh,Oh=(a("4437"),Object(V["a"])(Dh,Lh,xh,!1,null,"3bdda91e",null)),jh=Oh.exports,Th=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cabin"},[a("van-search",{attrs:{placeholder:"请输入搜索关键词"},on:{click:t.toSearch}}),a("div",{staticClass:"cabin-div"},[a("div",{staticClass:"cabin-item"},[a("div",{staticClass:"cabin-item__title"},[t._v("当前已收到客情日志")]),a("div",{staticClass:"cabin-item__content"},[a("div",{staticClass:"cabin-item__num"},[t._v(t._s(t.dataInfo.custViewCount))]),a("div",{},[t._v("条")])])]),a("div",{staticClass:"cabin-item"},[a("div",{staticClass:"cabin-item__title"},[t._v("涉及用户单位")]),a("div",{staticClass:"cabin-item__content"},[a("div",{staticClass:"cabin-item__num"},[t._v(t._s(t.dataInfo.custCount))]),a("div",{},[t._v("家")])])]),a("div",{staticClass:"cabin-item"},[a("div",{staticClass:"cabin-item__title"},[t._v("涉及客户(去重)")]),a("div",{staticClass:"cabin-item__content"},[a("div",{staticClass:"cabin-item__num"},[t._v(t._s(t.dataInfo.personCount))]),a("div",{},[t._v("人")])])])]),a("div",{staticClass:"cabin-div"},[a("div",{staticClass:"cabin-item"},[a("div",{staticClass:"cabin-item__title"},[t._v("已激活单位")]),a("div",{staticClass:"cabin-item__content"},[a("div",{staticClass:"cabin-item__num cabin-item__num--orange"},[t._v(t._s(t.dataInfo.actCust))]),a("div",{},[t._v("家")])])]),a("div",{staticClass:"cabin-item"},[a("div",{staticClass:"cabin-item__title"},[t._v("已激活单位⼈员")]),a("div",{staticClass:"cabin-item__content"},[a("div",{staticClass:"cabin-item__num cabin-item__num--orange"},[t._v(t._s(t.dataInfo.actPerson))]),a("div",{},[t._v("人")])])]),a("div",{staticClass:"cabin-item moreButton",on:{click:t.toGlobal}},[a("i",{staticClass:"iconfont ytcrm-a-gengduoshezhicaidan"}),a("span",{staticClass:"cabin-more"},[t._v("更多")])]),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.dataLoading,expression:"dataLoading"}],staticClass:"block-loading2",attrs:{type:"spinner",color:"#1989fa"}})],1),a("div",{staticClass:"cabin-title cabin-title-bg"},[a("div",{staticClass:"cabin-title__label"},[t._v("本周话题")]),t.dataInfo.topicRankList&&t.dataInfo.topicRankList.length>0?a("van-notice-bar",{staticClass:"cabin-title__inner",attrs:{color:"#4D6080",background:"#F5F6F9",scrollable:!1}},[a("van-swipe",{staticClass:"notice-swipe",attrs:{vertical:"",autoplay:3e3,"show-indicators":!1}},t._l(t.dataInfo.topicRankList,(function(e,s){return a("van-swipe-item",{key:s},[t._v(t._s(e.smallTagName)+" "+t._s(e.num)+" 条")])})),1)],1):a("div",{staticClass:"cabin-title__No"},[t._v("暂无话题")])],1),a("div",{staticClass:"entry-pic-wrapper"},[a("div",{ref:"cabinChart",staticClass:"cabin__chart"}),a("div",{staticClass:"entry-pic-tabs"},[a("div",{class:["entry-pic-tabs__item",1===t.timeType?"entry-pic-tabs__item--active":""],on:{click:function(e){return t.changeRate(1)}}},[t._v("单月")]),a("div",{class:["entry-pic-tabs__item",2===t.timeType?"entry-pic-tabs__item--active":""],on:{click:function(e){return t.changeRate(2)}}},[t._v("累计")])]),a("div",{staticClass:"list-board",on:{click:t.toRank}},[a("van-icon",{staticClass:"list-board__arrow",attrs:{name:"down"}}),a("div",{staticClass:"list-board__name"},[t._v("增速榜单")])],1),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.rateLoading,expression:"rateLoading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1),a("div",{staticClass:"cabin-title"},[t._m(0),a("div",{staticClass:"cabin-title__right",on:{click:t.changeFlag}})]),a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e,s){return a("cust-item",{key:s,attrs:{data:e},on:{toDetail:t.toCustDetail}})})),1)],1),a("div",{staticClass:"go-top",on:{click:t.goTop}},[a("van-icon",{attrs:{name:"arrow-up"}})],1),a("div",{staticClass:"go-more",on:{click:t.toCustList}},[t._v(" 更多 ")])],1)},Rh=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cabin-title__left"},[a("div",{staticClass:"cabin-title__name"},[t._v("最新客情")]),a("div",{staticClass:"cabin-title__line"})])}],Nh=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:["wrapper van-clearfix",2===t.data.warmthNum?"border-orange":3===t.data.warmthNum?"border-red":"border-green"],on:{click:function(e){return t.toDetail(t.data)}}},[a("div",{staticClass:"wrapper-left"},[a("div",{staticClass:"wrapper-left__location"},[t._v(t._s(t.data.companyId)+"/"+t._s(t.data.companyName))]),a("div",{staticClass:"wrapper-left__group gray-text"},[a("span",{staticClass:"mr-10"},[t._v(t._s(t.data.visitUserName))]),a("span",[t._v(t._s(t.data.visitUserPosition))])]),t._l(t.data.crmLabelRemarkDtoList,(function(e,s){return a("div",{key:s,staticClass:"wrapper-info"},[a("span",{staticClass:"wrapper-info__title"},[t._v(t._s(e.labelName)),a("span",{directives:[{name:"show",rawName:"v-show",value:e.expectTimeStr,expression:"item.expectTimeStr"}],staticClass:"time"},[t._v("("+t._s(e.expectTimeStr)+")")]),t._v("：")]),a("span",{staticClass:"wrapper-info__content"},[t._v(t._s(e.remark))])])}))],2),a("div",{staticClass:"wrapper-right"},[a("div",{staticClass:"gray-text"},[t._v(t._s(t.data.credate?t.data.credate.slice(0,t.data.credate.length-3):""))]),a("van-icon",{staticClass:"arrow-right",style:"color: "+t.data.color,attrs:{name:"down"}}),2===t.data.taskType?a("div",{staticClass:"wrapper-visit wrapper-visit--bom gray-text"},[a("span",{staticClass:"wrapper-visit__title"},[t._v("拜访人")]),a("span",{staticClass:"wrapper-visit__name"},[t._v(t._s(t.data.creName))])]):t._e(),2===t.data.taskType?a("div",{staticClass:"wrapper-visit gray-text"},[a("span",{staticClass:"wrapper-visit__title"},[t._v("协访人")]),a("span",{staticClass:"wrapper-visit__name"},[t._v(t._s(t.data.togetherUserName))])]):1===t.data.taskType?a("div",{staticClass:"wrapper-visit gray-text"},[a("span",{staticClass:"wrapper-visit__title"},[t._v("个人拜访")]),a("span",{staticClass:"wrapper-visit__name"},[t._v(t._s(t.data.creName))])]):3===t.data.taskType?a("div",{staticClass:"wrapper-visit gray-text"},[a("span",{staticClass:"wrapper-visit__title"},[t._v("接待")]),a("span",{staticClass:"wrapper-visit__name"},[t._v(t._s(t.data.creName))])]):t._e()],1)])},Ah=[],Ph=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"toDetail",value:function(t){this.$emit("toDetail",t)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Ph.prototype,"data",void 0),Ph=Object(u["a"])([Object(d["a"])({})],Ph);var Eh=Ph,Mh=Eh,$h=(a("5857"),Object(V["a"])(Mh,Nh,Ah,!1,null,"4634f368",null)),qh=$h.exports,Vh=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.dataLoading=!1,t.rateLoading=!1,t.timeType=1,t.dataInfo={xaxisData:[],seriesData:[]},t.dataList=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.page=1,t.pageSize=10,t.viewStarFlag=0,t.startTime=Gs(new Date)+" 00:00:00",t.endTime=Gs(new Date)+" 23:59:59",t.chartInstance=null,t}return Object(o["a"])(a,[{key:"getDataInfo",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.dataLoading=!0,t.next=3,Ss({deptId:163});case 3:e=t.sent,this.dataLoading=!1,this.dataInfo=e.data;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getHomeRate",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.rateLoading=!0,t.next=3,Os({time:this.timeType});case 3:e=t.sent,this.rateLoading=!1,a=[],s=[],i=[],e.data.forEach((function(t){"省级医疗机构"===t.type?t.type="省级":"市级医疗机构"===t.type?t.type="市级":"县级医疗机构"===t.type?t.type="县级":"基层医疗机构"===t.type?t.type="基层":"民营医疗机构"===t.type?t.type="民营":"连锁药店"===t.type?t.type="连锁":"单体药店"===t.type?t.type="药店":"对外商业调拨"===t.type&&(t.type="商业"),a.push(t.type),s.push(t.rate),i.push(0)})),this.dataInfo.xaxisData=a,this.dataInfo.seriesData=s,this.dataInfo.baseData=i,this.initChart();case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"changeRate",value:function(t){this.timeType=t,this.getHomeRate()}},{key:"changeFlag",value:function(){this.onRefresh()}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.dataList=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,gs({pageNum:this.page,pageSize:this.pageSize,viewStarFlag:this.viewStarFlag});case 3:e=t.sent,this.loading=!1,this.refreshing=!1,e.success?(a=e.data.list,a.forEach((function(t){t.crmLabelRemarkDtoList=t.crmLabelRemarkDtoList.splice(0,2)})),this.dataList=[].concat(Object(y["a"])(this.dataList),Object(y["a"])(a)),this.finished=!e.data.hasNextPage,this.page++):this.error=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"initChart",value:function(){var t=this.$refs.cabinChart;this.chartInstance=yd["a"](t),this.chartInstance.clear();var e={tooltip:{trigger:"axis",formatter:function(t){for(var e="",a=0;a<t.length;a++){var s=t[a],i=s.name,n=s.value,r=s.color;0===a&&(e+=i+"<br/>"),e+='<span style="    display: inline-block;margin-right: 4px;border-radius: 10px;width: 10px;height: 10px;background-color: '+r+'"></span>',e+="增长率："+n.toFixed(2)+"%"}return e}},legend:{data:["增长"]},grid:{top:"10%",left:"9%",right:"20%"},xAxis:{type:"category",data:this.dataInfo.xaxisData},yAxis:{type:"value"},series:[{data:this.dataInfo.seriesData,showBackground:!0,barWidth:8,itemStyle:{normal:{barBorderRadius:6}},markLine:{symbol:"none",data:[{silent:!1,lineStyle:{type:"solid",color:"#EE6666",width:2},label:{formatter:""},yAxis:100}]},type:"bar",backgroundStyle:{color:"rgba(220, 220, 220, 0.8)"}}]};this.chartInstance.setOption(e)}},{key:"goTop",value:function(){window.scrollTo(0,0)}},{key:"toCustList",value:function(){this.$router.push({name:"CustList"})}},{key:"toCustDetail",value:function(t){this.$router.push({name:"CustDetail",params:t})}},{key:"toRank",value:function(){this.$router.push({name:"CabinRank"})}},{key:"toGlobal",value:function(){this.$router.push({name:"CabinGlobal"})}},{key:"toSearch",value:function(){this.$router.push({name:"CabinSearch"})}},{key:"mounted",value:function(){this.getDataInfo(),this.getHomeRate()}}]),a}(d["c"]);Vh=Object(u["a"])([Object(d["a"])({components:{custItem:qh}})],Vh);var Uh=Vh,Fh=Uh,zh=(a("c3b0"),Object(V["a"])(Fh,Th,Rh,!1,null,"7e231c24",null)),Wh=zh.exports,Bh=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"full-pop"},[a("van-search",{attrs:{autofocus:"","show-action":"",placeholder:"请输入搜索关键词"},on:{input:t.getCustList,cancel:t.goBack},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.keywords,expression:"keywords"}],staticClass:"result-list"},[t._l(t.custList,(function(e){return a("div",{key:e.custId,staticClass:"result-item",on:{click:function(a){return t.onSelectCustomer(e)}}},[t._v(" "+t._s(e.custId)+"/"+t._s(e.custName)+" ")])})),a("van-empty",{directives:[{name:"show",rawName:"v-show",value:!t.custLoading&&!t.custList.length&&t.keywords,expression:"!custLoading && !custList.length && keywords"}],staticClass:"custom-image",attrs:{image:"https://img01.yzcdn.cn/vant/custom-empty-image.png",description:"暂无数据"}}),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.custLoading,expression:"custLoading"}],attrs:{color:"#1989fa"}})],2),a("van-swipe",{directives:[{name:"show",rawName:"v-show",value:!t.keywords,expression:"!keywords"}],staticClass:"rank-list",attrs:{loop:!0,width:t.width,height:t.height,"initial-swipe":t.curIndex},on:{change:t.swipeChange}},t._l(t.typeList,(function(e,s){return a("van-swipe-item",{key:s},[a("div",{staticClass:"rank-div"},[a("div",{staticClass:"rank-div__title"},[t._v(t._s(e.DIC_SELECT_NAME))]),a("div",{staticClass:"rank-div__desc"},[t._v("本月销售规模top10")]),t._l(t.list[e.DIC_SELECT_ID],(function(e,s){return a("div",{key:s,staticClass:"rank-item",on:{click:function(a){return t.onSelectCustomer(e)}}},[a("div",{staticClass:"rank-item__index"},[t._v(t._s(s+1)+" ")]),a("div",{staticClass:"rank-item__title"},[t._v(t._s(e.custName))])])}))],2)])})),1),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],1)},Gh=[],Hh=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.flag=!0,t.loading=!1,t.keywords="",t.custLoading=!1,t.typeList=[],t.curIndex=0,t.list=[],t.custList=[],t.width=0,t.height=0,t}return Object(o["a"])(a,[{key:"goBack",value:function(){this.$router.back()}},{key:"getCustList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$cancelAxios(["queryCustList"]),this.custList=[],""===e){t.next=8;break}return this.custLoading=!0,t.next=6,ys({custom:e});case 6:a=t.sent,a.success&&(this.custLoading=!1,this.custList=a.data);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onSelectCustomer",value:function(t){this.$router.push({name:"CustomerAnalysis",params:t})}},{key:"swipeChange",value:function(t){this.curIndex=t}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,vs({});case 3:e=t.sent,this.loading=!1,this.list=e.data;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getTypeList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={keyword:"",pageNum:1,pageSize:1e4,usestatus:1,typeId:26},t.next=3,Si(e);case 3:a=t.sent,a.success&&(this.typeList=a.data.list.map((function(t){return"省级医疗机构"===t.DIC_SELECT_NAME?t.DIC_SELECT_NAME="省级":"市级医疗机构"===t.DIC_SELECT_NAME?t.DIC_SELECT_NAME="市级":"县级医疗机构"===t.DIC_SELECT_NAME?t.DIC_SELECT_NAME="县级":"基层医疗机构"===t.DIC_SELECT_NAME?t.DIC_SELECT_NAME="基层":"民营医疗机构"===t.DIC_SELECT_NAME?t.DIC_SELECT_NAME="民营":"连锁药店"===t.DIC_SELECT_NAME?t.DIC_SELECT_NAME="连锁":"单体药店"===t.DIC_SELECT_NAME?t.DIC_SELECT_NAME="药店":"对外商业调拨"===t.DIC_SELECT_NAME&&(t.DIC_SELECT_NAME="商业"),t})),this.getDataList());case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){var t=document.documentElement.clientWidth;this.width=285*t/375+12,this.height=510*t/375+12}},{key:"activated",value:function(){this.flag&&this.getTypeList()}},{key:"beforeRouteLeave",value:function(t,e,a){"CustomerAnalysis"===t.name?this.flag=!1:this.flag=!0,a()}}]),a}(d["c"]);Hh=Object(u["a"])([Object(d["a"])({})],Hh);var Yh=Hh,Qh=Yh,Kh=(a("c266"),Object(V["a"])(Qh,Bh,Gh,!1,null,"74d6e9a4",null)),Jh=Kh.exports,Xh=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod"},[a("span",{staticClass:"word-2"},[t._v("增量榜单")]),a("div",{staticClass:"header"},[a("span",{class:["caption__item fs-16",1===t.timeType?"caption__item--active":""],on:{click:function(e){return t.changeTime(1)}}},[t._v("本月")]),a("span",{class:["caption__item fs-16",2===t.timeType?"caption__item--active":""],on:{click:function(e){return t.changeTime(2)}}},[t._v("本年")])]),a("div",{staticClass:"caption"},t._l(t.typeList,(function(e,s){return a("span",{key:s,class:["caption__item fs-14",t.active===s+1?"caption__item--active":""],on:{click:function(e){return t.changeActive(s+1)}}},[t._v(t._s(e.simpleName))])})),0),t._l(t.topList,(function(e,s){return a("div",{key:s,class:["container-inner","container-inner-"+(s+1)],on:{click:function(a){return t.onSelectCustomer(e)}}},[a("div",{staticClass:"rank-main"},[a("div",{staticClass:"rank-main__left text-black"},[a("div",{staticClass:"rank-main__num-1"},[t._v(t._s(s+1))]),a("div",{staticClass:"rank-main__title-1"},[t._v(t._s(e.custName.split("/")[0]))])]),a("div",{class:["rank-main__count",e.rankGrowth>0?"red":e.rankGrowth<0?"green":""]},[a("van-icon",{directives:[{name:"show",rawName:"v-show",value:0!==e.rankGrowth,expression:"item.rankGrowth !== 0"}],class:e.rankGrowth<0?"":"rank-main__up",attrs:{name:"down"}}),t._v(" "+t._s(0===e.rankGrowth?"-":Math.abs(e.rankGrowth))+" ")],1),a("div",{staticClass:"rank-main__right"},[a("div",{staticClass:"rank-main__percent"},[t._v(t._s(e.rate)+"%")]),e.amountGrowth?a("div",{staticClass:"rank-main__price"},[t._v("增量金额 "+t._s(e.amountGrowth))]):t._e()])])])})),a("div",{staticClass:"container-inner"},t._l(t.restList,(function(e,s){return a("div",{key:s,staticClass:"rank-main",on:{click:function(a){return t.onSelectCustomer(e)}}},[a("div",{staticClass:"rank-main__left"},[a("div",{staticClass:"rank-main__num"},[t._v(t._s(s+4))]),a("div",{staticClass:"rank-main__title"},[t._v(t._s(e.custName.split("/")[0]))])]),a("div",{class:["rank-main__count",e.rankGrowth>0?"red":"green"]},[a("van-icon",{class:e.rankGrowth<0?"":"rank-main__up",attrs:{name:"down"}}),t._v(" "+t._s(Math.abs(e.rankGrowth))+" ")],1),a("div",{staticClass:"rank-main__right"},[a("div",{staticClass:"rank-main__percent",staticStyle:{"font-size":"16px"}},[t._v(t._s(e.rate)+"%")]),e.amountGrowth?a("div",{staticClass:"rank-main__price"},[t._v("增量金额 "+t._s(e.amountGrowth))]):t._e()])])})),0),a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}})],2)},Zh=[],tp=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.flag=!0,t.loading=!1,t.timeType=1,t.typeList=[],t.active=1,t.topList=[],t.restList=[],t}return Object(o["a"])(a,[{key:"changeTime",value:function(t){this.timeType=t,this.getDataList()}},{key:"changeActive",value:function(t){this.active=t,this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.typeList[this.active-1],this.topList=[],this.restList=[],this.loading=!0,t.next=6,Ts({time:this.timeType,type:e.DIC_SELECT_NAME});case 6:a=t.sent,this.loading=!1,this.topList=a.data.slice(0,3),this.restList=a.data.slice(3);case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getTypeList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={keyword:"",pageNum:1,pageSize:1e4,usestatus:1,typeId:26},t.next=3,Si(e);case 3:a=t.sent,a.success&&(this.typeList=a.data.list.map((function(t){return"省级医疗机构"===t.DIC_SELECT_NAME?t.simpleName="省级":"市级医疗机构"===t.DIC_SELECT_NAME?t.simpleName="市级":"县级医疗机构"===t.DIC_SELECT_NAME?t.simpleName="县级":"基层医疗机构"===t.DIC_SELECT_NAME?t.simpleName="基层":"民营医疗机构"===t.DIC_SELECT_NAME?t.simpleName="民营":"连锁药店"===t.DIC_SELECT_NAME?t.simpleName="连锁":"单体药店"===t.DIC_SELECT_NAME?t.simpleName="药店":"对外商业调拨"===t.DIC_SELECT_NAME&&(t.simpleName="商业"),t})),this.getDataList());case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onSelectCustomer",value:function(t){this.$router.push({name:"CustomerAnalysis",params:t})}},{key:"activated",value:function(){this.flag&&this.getTypeList()}},{key:"beforeRouteLeave",value:function(t,e,a){"CustomerAnalysis"===t.name?this.flag=!1:this.flag=!0,a()}}]),a}(d["c"]);tp=Object(u["a"])([Object(d["a"])({})],tp);var ep=tp,ap=ep,sp=(a("b566"),Object(V["a"])(ap,Xh,Zh,!1,null,"76223667",null)),ip=sp.exports,np=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"cabin-global"},[s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}}),s("div",{staticClass:"cabin-header"},[s("div",{staticClass:"cabin-header__title"},[e._v("全局数字")]),s("div",{staticClass:"cabin-header__cust",on:{click:function(){t.showPicker=!0}}},[e._v(" "+e._s(e.curCust.text)+" "),s("van-icon",{class:e.showPicker?"infor-more__up":"infor-more__down",attrs:{name:"play"}})],1)]),s("div",{staticClass:"cabin-desc"},[e._v("本表数据截止昨日晚8点，已更新")]),s("div",{staticClass:"cabin-div cabin-list"},[s("div",{staticClass:"cabin-item"},[s("div",{staticClass:"cabin-item__title"},[e._v("当前已经激活客户单位")]),s("div",{staticClass:"cabin-item__content"},[s("div",{staticClass:"cabin-item__num"},[e._v(e._s(e.dataInfo.actCust))]),s("div",{},[e._v("家")])])]),s("div",{staticClass:"cabin-line"}),s("div",{staticClass:"cabin-item"},[s("div",{staticClass:"cabin-item__title"},[e._v("当前已经激活客户人员")]),s("div",{staticClass:"cabin-item__content"},[s("div",{staticClass:"cabin-item__num"},[e._v(e._s(e.dataInfo.actPerson))]),s("div",{},[e._v("名")])])])]),s("div",{staticClass:"cabin-div cabin-list"},[s("div",{staticClass:"cabin-rank"},[s("div",{staticClass:"cabin-rank__content"},[s("div",{staticClass:"cabin-rank__type"},[e._v("A")]),s("div",{staticClass:"cabin-rank__num"},[e._v(e._s(e.dataInfo.aGrade))]),s("div",{},[e._v("名")])]),s("div",{staticClass:"cabin-rank__title"},[e._v("公立院长、书记、法人等/政府正处及以上等/民营资方等")])]),s("div",{staticClass:"cabin-rank"},[s("div",{staticClass:"cabin-rank__content"},[s("div",{staticClass:"cabin-rank__type"},[e._v("C")]),s("div",{staticClass:"cabin-rank__num"},[e._v(e._s(e.dataInfo.cGrade))]),s("div",{},[e._v("名")])]),s("div",{staticClass:"cabin-rank__title"},[e._v("公立科室主任等/政府机构副科级以上/民营管理层分管")])]),s("div",{staticClass:"cabin-rank"},[s("div",{staticClass:"cabin-rank__content"},[s("div",{staticClass:"cabin-rank__type"},[e._v("B")]),s("div",{staticClass:"cabin-rank__num"},[e._v(e._s(e.dataInfo.bGrade))]),s("div",{},[e._v("名")])]),s("div",{staticClass:"cabin-rank__title"},[e._v("公立院长、书记、法人等/政府正处及以上等/民营资方等")])]),s("div",{staticClass:"cabin-rank"},[s("div",{staticClass:"cabin-rank__content"},[s("div",{staticClass:"cabin-rank__type"},[e._v("D")]),s("div",{staticClass:"cabin-rank__num"},[e._v(e._s(e.dataInfo.dGrade))]),s("div",{},[e._v("名")])]),s("div",{staticClass:"cabin-rank__title"},[e._v("公立院长、书记、法人等/政府正处及以上等/民营资方等")])])]),s("div",{staticClass:"cabin-flex"},[s("div",{staticClass:"cabin-div cabin-item w-48 p-10"},[s("div",{staticClass:"cabin-item__title"},[e._v("当前客户覆盖程度")]),s("div",{staticClass:"cabin-item__content"},[s("div",{staticClass:"cabin-item__num"},[e._v(e._s(e.dataInfo.cover||"")+"%")])]),s("div",{staticClass:"cabin-item__desc"},[e._v("还有"+e._s(e.dataInfo.allCust-e.dataInfo.actCust)+"家客户单位未维护")])]),s("div",{staticClass:"cabin-div w-48"},[s("div",{staticClass:"cabin-cust"},[s("div",{staticClass:"cabin-cust__title"},[e._v("一般客情")]),s("div",{staticClass:"cabin-cust__num"},[e._v(e._s(e.dataInfo.normal))]),s("div",{staticClass:"cabin-cust__unit"},[e._v("名")])]),s("div",{staticClass:"cabin-cust"},[s("div",{staticClass:"cabin-cust__title"},[e._v("需进阶客情")]),s("div",{staticClass:"cabin-cust__num"},[e._v(e._s(e.dataInfo.lack))]),s("div",{staticClass:"cabin-cust__unit"},[e._v("名")])]),s("div",{staticClass:"cabin-cust"},[s("div",{staticClass:"cabin-cust__title"},[e._v("未接触客情")]),s("div",{staticClass:"cabin-cust__num"},[e._v(e._s(e.dataInfo.never))]),s("div",{staticClass:"cabin-cust__unit"},[e._v("名")])])])]),s("div",{staticClass:"cabin-flex"},[s("div",{staticClass:"cabin-div cabin-item",staticStyle:{width:"36%"}},[s("div",{staticClass:"cabin-item__title"},[e._v("本周已收到客情日志")]),s("div",{staticClass:"cabin-item__content"},[s("div",{staticClass:"cabin-item__num"},[e._v(e._s(e.dataInfo.custViewCount))]),s("div",{},[e._v("条")])])]),s("div",{staticClass:"cabin-div cabin-item",staticStyle:{width:"28%"}},[s("div",{staticClass:"cabin-item__title"},[e._v("涉及用户单位")]),s("div",{staticClass:"cabin-item__content"},[s("div",{staticClass:"cabin-item__num"},[e._v(e._s(e.dataInfo.custCount))]),s("div",{},[e._v("家")])])]),s("div",{staticClass:"cabin-div cabin-item",staticStyle:{width:"32%"}},[s("div",{staticClass:"cabin-item__title"},[e._v("涉及客户（去重）")]),s("div",{staticClass:"cabin-item__content"},[s("div",{staticClass:"cabin-item__num"},[e._v(e._s(e.dataInfo.personCount))]),s("div",{},[e._v("人")])])])]),s("div",{staticClass:"cabin-div cabin-div-topics"},[e._m(0),s("div",{class:e.showAll?"cabin-topics-full":"cabin-topics"},e._l(e.dataInfo.topicRankList,(function(t,a){return s("div",{key:a,staticClass:"cabin-topic"},[s("div",{staticClass:"cabin-topic__title"},[e._v(e._s(t.smallTagName))]),s("div",{staticClass:"cabin-topic__num"},[e._v(e._s(t.num))]),s("div",{staticClass:"cabin-topic__unit"},[e._v("条")])])})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.dataInfo.topicRankList||!e.dataInfo.topicRankList.length,expression:"!dataInfo.topicRankList || !dataInfo.topicRankList.length"}],staticClass:"no-more"},[e._v("暂无话题")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.dataInfo.topicRankList&&e.dataInfo.topicRankList.length>3,expression:"dataInfo.topicRankList && dataInfo.topicRankList.length > 3"}],staticClass:"infor-more",on:{click:function(t){e.showAll=!e.showAll}}},[s("van-icon",{class:e.showAll?"infor-more__up":"infor-more__down",attrs:{name:"play"}})],1)]),s("div",{staticClass:"cabin-div cabin-div-topics"},[e._m(1),s("div",{staticClass:"cabin-dept"},[e._v(e._s(e.dataInfo.mostAct))])]),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[e.showPicker?s("van-picker",{attrs:{"show-toolbar":"",columns:e.columns,"default-index":e.curIndex},on:{confirm:e.onConfirm,cancel:function(t){e.showPicker=!1}}}):e._e()],1)],1)},rp=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cabin-div__header"},[a("div",{staticClass:"cabin-div__icon cabin-div__icon1"}),a("div",{staticClass:"cabin-div__title"},[t._v("本周反映最多话题")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cabin-div__header"},[a("div",{staticClass:"cabin-div__icon cabin-div__icon2"}),a("div",{staticClass:"cabin-div__title"},[t._v("本周最活跃部门")])])}],op=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.loading=!1,t.showPicker=!1,t.columns=[{value:163,text:"英特药业"}],t.dataInfo={},t.curIndex=0,t.curCust={},t.showAll=!1,t}return Object(o["a"])(a,[{key:"getTypeList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={keyword:"",pageNum:1,pageSize:1e4,usestatus:1,typeId:19},t.next=3,Si(e);case 3:a=t.sent,a.success&&(s=a.data.list.map((function(t){return{value:t.DIC_SELECT_ID,text:t.DIC_SELECT_NAME}})),this.columns=[].concat(Object(y["a"])(this.columns),Object(y["a"])(s)));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getData",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.dataInfo={},this.loading=!0,t.next=4,Ss({deptId:this.curCust.value});case 4:e=t.sent,this.loading=!1,this.dataInfo=e.data,this.dataInfo.cover=0===this.dataInfo.allCust?0:(this.dataInfo.actCust/this.dataInfo.allCust*100).toFixed(0);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onConfirm",value:function(t,e){this.curCust=this.columns[e],this.curIndex=e,this.showPicker=!1,this.getData()}},{key:"mounted",value:function(){this.curCust=this.columns[0],this.getTypeList(),this.getData()}}]),a}(d["c"]);op=Object(u["a"])([Object(d["a"])({})],op);var cp=op,lp=cp,up=(a("f7729"),Object(V["a"])(lp,np,rp,!1,null,"4f82e886",null)),dp=up.exports,hp=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cust-list"},[a("van-sticky",{on:{scroll:t.onStickyChange}},[a("div",{class:t.isFixed?"cust-header--bg":"cust-header"},[a("div",{staticClass:"cust-title"},[a("div",{staticClass:"cust-title__name"},[t._v("最新客情")])]),a("div",{ref:"timeDiv",staticClass:"cust-time",on:{click:t.changeDate}},[t._v(" "+t._s(t.today)+" "),a("i",{staticClass:"iconfont ytcrm-qiehuan"})]),a("div",{staticClass:"cust-filter"},[a("div",{staticClass:"cust-filter__list"},[a("div",{class:["cust-filter__item",1===t.active?"cust-filter__item--active":""],on:{click:function(e){return t.changeActive(1)}}},[t._v(" 今天 "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.dayActive,expression:"dayActive"}],staticClass:"dot"})]),a("div",{class:["cust-filter__item",2===t.active?"cust-filter__item--active":""],on:{click:function(e){return t.changeActive(2)}}},[t._v("本周")]),a("div",{class:["cust-filter__item",3===t.active?"cust-filter__item--active":""],on:{click:function(e){return t.changeActive(3)}}},[t._v("上周")])]),a("div",{staticClass:"warp"},[a("van-icon",{attrs:{color:"#fc923f",name:t.viewStarFlag?"star":"star-o"},on:{click:function(e){return t.changeFlag("star")}}}),a("div",{staticClass:"cust-filter__right right",on:{click:function(e){return t.changeFlag("reload")}}})],1)])])]),0!==t.dateRange.length?a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e,s){return a("cust-item",{key:s,attrs:{data:e},on:{toDetail:t.toCustDetail}})})),1)],1):t._e(),a("van-calendar",{attrs:{type:"range","default-date":t.dateRange,"min-date":new Date(2020,0,1),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{confirm:t.calendarConfirm},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}})],1)},pp=[],mp=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.isFixed=!1,t.today=t.formatDate(new Date),t.dataList=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.page=1,t.pageSize=10,t.active=1,t.dayActive=!0,t.startTime=Gs(new Date)+" 00:00:00",t.endTime=Gs(new Date)+" 23:59:59",t.viewStarFlag=0,t.calendarShow=!1,t.dateRange=[],t}return Object(o["a"])(a,[{key:"onStickyChange",value:function(t){this.isFixed=t.isFixed;var e=this.$refs.timeDiv,a=t.scrollTop>58?58:t.scrollTop,s=a>54?12:20-a/3,i=t.scrollTop>80?-16:64-t.scrollTop;e.style="margin-left: ".concat(a,"px;font-size: ").concat(s,"px;margin-top: ").concat(a<58?10:i,"px;")}},{key:"changeFlag",value:function(t){"star"===t&&(this.viewStarFlag=0===this.viewStarFlag?1:0),this.onRefresh()}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.dataList=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,gs({startTime:Gs(this.dateRange[0])+" 00:00:00",endTime:Gs(this.dateRange[1])+" 23:59:59",pageNum:this.page,pageSize:this.pageSize,viewStarFlag:this.viewStarFlag});case 3:e=t.sent,this.loading=!1,this.refreshing=!1,e.success?(a=e.data.list,a.forEach((function(t){t.crmLabelRemarkDtoList=t.crmLabelRemarkDtoList.splice(0,2)})),this.dataList=[].concat(Object(y["a"])(this.dataList),Object(y["a"])(a)),this.finished=!e.data.hasNextPage,this.page++):this.error=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"toCustDetail",value:function(t){this.$router.push({name:"CustDetail",params:t})}},{key:"formatDate",value:function(t){console.log(t);var e=new Date(t).getMonth()+1,a=new Date(t).getDate();return console.log(e),console.log(a),"".concat(e,"月").concat(a,"日")}},{key:"changeActive",value:function(t){if(this.active=t,1===t)this.startTime=Gs(new Date)+" 00:00:00",this.endTime=Gs(new Date)+" 23:59:59",this.dateRange=[new Date,new Date],this.today=this.formatDate(new Date);else if(2===t)this.startTime=Hs(new Date).replace(/-/g,"/")+" 00:00:00",this.endTime=Ys(new Date).replace(/-/g,"/")+" 23:59:59",this.dateRange=[new Date(this.startTime),new Date(this.endTime)],this.today=this.formatDate(new Date(this.startTime))+"~"+this.formatDate(new Date(this.endTime));else if(3===t){var e=new Date((new Date).getTime()-6048e5);this.startTime=Hs(e).replace(/-/g,"/")+" 00:00:00",this.endTime=Ys(e).replace(/-/g,"/")+" 23:59:59",this.dateRange=[new Date(this.startTime),new Date(this.endTime)],this.today=this.formatDate(new Date(this.startTime))+"~"+this.formatDate(new Date(this.endTime))}this.onRefresh()}},{key:"changeDate",value:function(){this.calendarShow=!0}},{key:"calendarConfirm",value:function(t){this.calendarShow=!1,this.dateRange=t,this.active=-1,this.today=this.formatDate(new Date(this.dateRange[0]))+" ~ "+this.formatDate(new Date(this.dateRange[1])),this.onRefresh()}},{key:"mounted",value:function(){this.dateRange=[new Date,new Date]}},{key:"activated",value:function(){var t=this;0===this.dateRange.length&&this.$nextTick((function(){t.dateRange=[new Date,new Date]}))}}]),a}(d["c"]);mp=Object(u["a"])([Object(d["a"])({components:{custItem:qh},beforeRouteLeave:function(t,e,a){this.calendarShow?(this.calendarShow=!1,a(!1)):"CabinIndex"===t.name?(this.dataList=[],this.today=this.formatDate(new Date),this.page=1,this.active=1,this.viewStarFlag=0,this.dateRange=[],this.startTime=Gs(new Date)+" 00:00:00",this.endTime=Gs(new Date)+" 23:59:59",this.loading=!1,this.finished=!1,this.refreshing=!1,this.error=!1,a(!0)):a(!0)}})],mp);var vp=mp,fp=vp,gp=(a("db35"),Object(V["a"])(fp,hp,pp,!1,null,"3850525a",null)),bp=gp.exports,yp=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod"},[a("span",{staticClass:"detail-1"},[t._v("客情详情")]),a("div",{staticClass:"main"},[a("div",{staticClass:"group-1"},[t.data.isRaisedStarFlag?t._e():a("van-icon",{staticClass:"left",attrs:{name:"star-o"}}),t._l(t.data.starFlag,(function(t){return a("van-icon",{key:t,staticClass:"left",attrs:{name:"star"}})})),0===t.data.whetherLegwork?a("i",{staticClass:"left always iconfont ytcrm-zaigangguanli"}):t._e(),1===t.data.whetherLegwork?a("i",{staticClass:"left need iconfont ytcrm-waiqin"}):t._e()],2),a("span",{staticClass:"location"},[t._v(t._s(t.data.companyId)+"/"+t._s(t.data.companyName))]),a("span",{staticClass:"word"},[t._v(t._s(1===t.data.companyType?"供应商":2===t.data.companyType?"下游客户":3===t.data.companyType?"政府单位":""))]),a("div",{staticClass:"book-wrapper"},[a("span",{staticClass:"book"},[t._v(t._s(t.data.visitUserName))]),a("div",{class:["book__tag",2===t.data.warmthNum?"book__tag--orange":3===t.data.warmthNum?"book__tag--red":"book__tag--green"]})]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.data.visitUserPosition,expression:"data.visitUserPosition"}],staticClass:"title"},[t._v(t._s(t.data.visitUserPosition))]),a("div",{staticClass:"remarks"},t._l(t.data.crmLabelRemarkDtoList,(function(e,s){return a("div",{key:s,staticClass:"remark"},[t._v(" "+t._s(e.labelName)),a("i",{directives:[{name:"show",rawName:"v-show",value:e.expectTimeStr,expression:"item.expectTimeStr"}],staticClass:"time"},[t._v("("+t._s(e.expectTimeStr)+")")]),t._v("："+t._s(e.remark)+" ")])})),0)]),a("div",{staticClass:"wrapper-inner"},[a("span",{staticClass:"tag"},[t._v("批注：")]),t.data.crmVisitCommentDtoList&&t.data.crmVisitCommentDtoList.length?a("div",t._l(t.data.crmVisitCommentDtoList,(function(e,s){return a("span",{key:s,staticClass:"desc"},[t._v(t._s(e.creId)+"/"+t._s(e.creName)+"："+t._s(e.commentRemark))])})),0):a("span",{staticClass:"detail"},[t._v("暂无")]),a("div",{staticClass:"group"},[a("span",{staticClass:"info"},[t._v(t._s(1===t.data.taskType?"个人:自己拜访":2===t.data.taskType?"协访人："+t.data.togetherUserId+"/"+t.data.togetherUserName:"自己拜访"))]),a("span",{staticClass:"meta"},[t._v("录入人："+t._s(t.data.creId)+"/"+t._s(t.data.creName))])]),a("span",{staticClass:"label"},[t._v("定位信息：")]),t.data.cciId?a("span",{staticClass:"summary"},[t._v(t._s(t.data.cciId)+"/"+t._s(t.data.address))]):a("span",{staticClass:"summary"},[t._v("暂无定位信息")])])])},_p=[],kp=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.data={},t}return Object(o["a"])(a,[{key:"mounted",value:function(){this.data=this.$route.params}}]),a}(d["c"]);kp=Object(u["a"])([Object(d["a"])({})],kp);var Cp=kp,wp=Cp,Lp=(a("abbd"),Object(V["a"])(wp,yp,_p,!1,null,"47c6a554",null)),xp=Lp.exports,Ip=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"topic"},["topicSquareErr400"!==t.topicMessage?a("div",{staticClass:"header"},[a("ul",{staticClass:"labelWarp"},[t._l(t.topicList,(function(e,s){return a("li",{key:"topic"+s,staticClass:"labelTab",class:t.rightActive===e.LABEL_ID?"active":"",on:{click:function(a){return t.topicQuickClick(e)}}},[t._v(" #"+t._s(e.LABEL_NAME.length>8?e.LABEL_NAME.substring(0,5)+"...":e.LABEL_NAME)+" ")])})),a("li",{staticClass:"labelTab active",on:{click:t.moreTopicsClick}},[t._v("更多...")])],2)]):t._e(),a("div",{staticClass:"tabs"},[0===t.rightActive||1===t.rightActive||2===t.rightActive?a("ul",{staticClass:"tabsWarp clearfix",class:"topicSquareErr400"===t.topicMessage?"tabsHeight":""},[t._l(t.tabList,(function(e,s){return a("li",{key:"tab"+s,staticClass:"tabsTab left",class:t.rightActive===s?"active":"",on:{click:function(e){return t.tabClick(s)}}},[t._v(t._s(e))])})),a("li",{staticClass:"add",on:{click:function(e){t.addShow=!0}}},[a("van-icon",{staticClass:"fontWeight",attrs:{color:"#264B9D",size:"10px",name:"plus"}})],1)],2):a("ul",{staticClass:"tabsWarp clearfix"},[t._v(" 共 "),a("i",{staticClass:"fontSize-16",staticStyle:{color:"#fc923f"}},[t._v(t._s(t.typeTipNumber))]),t._v(" 条 ")])]),a("div",{staticClass:"list"},[t.reload?a("list",{ref:"list",attrs:{params:t.params},on:{addSubscribeClick:t.addSubscribeClick,dataListClick:t.dataListClick}}):t._e()],1),t.addShow?a("add",{attrs:{addShow:t.addShow},on:{addClose:function(e){t.addShow=!1},submitClick:t.submitClick}}):t._e(),t.detailShow?a("detail",{ref:"detail",attrs:{detailShow:t.detailShow,detailObj:t.detailObj},on:{addSubscribeClick:t.addSubscribeClick,insDiscussSuccess:t.insDiscussSuccess,confirmDialog:t.confirmDialog,detailClose:t.detailClose}}):t._e(),0!==t.rightActive&&1!==t.rightActive&&2!==t.rightActive?a("i",{staticClass:"backButton",on:{click:t.backTopicClick}}):t._e(),t.moreShow?a("more",{attrs:{moreShow:t.moreShow},on:{moreClose:t.moreClose,moreListClick:t.moreListClick}}):t._e(),a("van-popup",{style:"width: 100%;height: 100%",attrs:{position:"right",closeable:""},model:{value:t.moreListShow,callback:function(e){t.moreListShow=e},expression:"moreListShow"}},[a("div",{staticClass:"moreListHeader"},[t._v("#"+t._s(t.moreParams.labelName))]),a("div",{staticClass:"moreListWarp"},[t.moreListShow?a("list",{attrs:{params:t.moreParams},on:{addSubscribeClick:t.addSubscribeClick,dataListClick:t.dataListClick}}):t._e()],1)])],1)},Sp=[];function Dp(t,e,a){return Op.apply(this,arguments)}function Op(){return Op=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,n,r,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=o.length>3&&void 0!==o[3]&&o[3],n=o.length>4&&void 0!==o[4]?o[4]:"",t.next=4,iv({url:e+a,method:"post",data:s,headers:{needOperateLoading:i,msg:encodeURIComponent(n)||encodeURIComponent("请求中，请稍等......")}});case 4:return r=t.sent,t.abrupt("return",r.data);case 6:case"end":return t.stop()}}),t)}))),Op.apply(this,arguments)}function jp(t,e,a){return Tp.apply(this,arguments)}function Tp(){return Tp=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,n,r,o,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=c.length>3&&void 0!==c[3]&&c[3],n=c.length>4&&void 0!==c[4]?c[4]:"",r=new FormData,Object.keys(s).forEach((function(t){r.append(t,s[t]||"")})),t.next=6,iv({url:e+a,method:"post",data:r,headers:{needOperateLoading:i,msg:encodeURIComponent(n)||encodeURIComponent("请求中，请稍等......")}});case 6:return o=t.sent,t.abrupt("return",o.data);case 8:case"end":return t.stop()}}),t)}))),Tp.apply(this,arguments)}var Rp=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Dp(j,"/api/TopicSquare/getTopicNum",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Np=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Dp(j,"/api/TopicSquare/getTopicList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ap=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Dp(j,"/api/TopicSquare/insDiscuss",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Pp=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,jp(j,"/api/TopicSquare/getTopicDiscuss",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ep=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Dp(j,"/api/TopicSquare/addSubscribe",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Mp=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Dp(j,"/api/TopicSquare/getSubscribe",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$p=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Dp(j,"/api/TopicSquare/insSign",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),qp=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Dp(j,"/api/TopicSquare/insTopicPersonal",e,!0,"新增中......");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Vp=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{offset:20,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.getDataLoading,callback:function(e){t.getDataLoading=e},expression:"getDataLoading"}},t._l(t.dataList,(function(e,s){return a("ul",{key:"data"+s,staticClass:"listWarp",on:{click:function(a){return t.dataListClick(e)}}},[a("li",{staticClass:"listUser clearfix"},[a("div",{staticClass:"left"},["ec3e/2021-03-08/tx.jpeg"!==e.createHeadImgUrl?a("img",{staticClass:"imgPeo",attrs:{src:"https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/"+e.createHeadImgUrl,alt:"",srcset:""}}):a("span",{staticClass:"imgPeo"},[t._v(t._s(e.createName.substring(e.createName.length-2,e.createName.length)))])]),a("div",{staticClass:"left paddingLeft-8"},[a("p",{staticClass:"userName"},[t._v(t._s(e.createName))]),a("p",{staticClass:"time"},[t._v(t._s(e.createTime))])])]),a("li",{staticClass:"listTitle"},[t._v(" "+t._s(e.topicTitle)+" ")]),a("li",{staticClass:"listContent"},[t._v(" "+t._s(e.topicContent)+" ")]),a("li",{staticClass:"listOp"},[a("span",{staticClass:"opIcon"},[a("i",{staticClass:"iconfont ytcrm-zanbeifen",style:e.subscribeFlag?"":"color:#d8d8d8",on:{click:function(a){return a.stopPropagation(),t.addSubscribeClick(e)}}}),t._v(" "+t._s(e.subscribeNum)+" ")]),a("span",{staticClass:"opIcon"},[a("i",{staticClass:"iconfont ytcrm-juxing"}),t._v(" "+t._s(e.discussList.length)+" ")]),a("span",{staticClass:"opIcon"},[a("i",{staticClass:"iconfont ytcrm-a-xingzhuang1"}),t._v(" "+t._s(e.signToSignedList.length)+" ")])])])})),0)],1)},Up=[],Fp=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.refreshing=!1,t.getDataLoading=!1,t.finished=!1,t.page=1,t.dataList=[],t}return Object(o["a"])(a,[{key:"onRefresh",value:function(){this.finished=!1,this.getDataLoading=!1,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.dataList=[],this.refreshing=!1),this.queryTopicList()}},{key:"queryTopicList",value:function(){var t=this;this.$cancelAxios(["getTopicList"]),1===this.page&&(this.dataList=[]),this.getDataLoading=!0;var e=Object.assign({pageNum:this.page},this.params);Np(e).then((function(e){"200"===e.code?(t.getDataLoading=!1,t.dataList=t.dataList.concat(e.data.list),e.data.hasNextPage?t.page++:t.finished=!0):t.$toast.fail(e.msg)}))}},{key:"addSubscribeClick",value:function(t){this.$emit("addSubscribeClick",t)}},{key:"dataListClick",value:function(t){this.$emit("dataListClick",t)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Fp.prototype,"params",void 0),Fp=Object(u["a"])([Object(d["a"])({})],Fp);var zp=Fp,Wp=zp,Bp=(a("e11c"),Object(V["a"])(Wp,Vp,Up,!1,null,"7d264618",null)),Gp=Bp.exports,Hp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-popup",{style:"width: 100%;height: 100%",attrs:{position:"right",closeable:t.closeable},on:{close:t.detailClose},model:{value:t.detailShowUse,callback:function(e){t.detailShowUse=e},expression:"detailShowUse"}},[t.detailObj?s("div",{staticClass:"detail"},[s("div",{staticClass:"detailHeader"},[t._v(" 消息详情 ")]),s("ul",{staticClass:"listWarpDetail"},[s("li",{staticClass:"listUser clearfix"},[s("div",{staticClass:"left"},["ec3e/2021-03-08/tx.jpeg"!==t.detailObj.createHeadImgUrl?s("img",{staticClass:"imgPeo",attrs:{src:"https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/"+t.detailObj.createHeadImgUrl,alt:"",srcset:""}}):s("span",{staticClass:"imgPeo"},[t._v(t._s(t.detailObj.createName&&t.detailObj.createName.substring(t.detailObj.createName.length-2,t.detailObj.createName.length)))])]),s("div",{staticClass:"left paddingLeft-8"},[s("p",{staticClass:"userName"},[t._v(t._s(t.detailObj.createName))]),s("p",{staticClass:"time"},[t._v(t._s(t.detailObj.createTime))])])]),s("li",{staticClass:"listTitle"},[t._v(" "+t._s(t.detailObj.topicTitle)+" ")]),s("li",{staticClass:"listContent"},[t._v(" "+t._s(t.detailObj.topicContent)+" ")]),s("li",{staticClass:"listOp"},[s("span",{staticClass:"opIcon",class:1===t.opType?"opline":"",on:{click:function(e){return t.opTabClick(1)}}},[s("i",{staticClass:"iconfont ytcrm-zanbeifen",style:t.detailObj.subscribeFlag?"":"color:#d8d8d8"}),t._v(" "+t._s(t.detailObj.subscribeNum)+" ")]),s("span",{staticClass:"opIcon",class:2===t.opType?"opline":"",on:{click:function(e){return t.opTabClick(2)}}},[s("i",{staticClass:"iconfont ytcrm-juxing"}),t._v(" "+t._s(t.detailObj.discussList&&t.detailObj.discussList.length)+" ")]),s("span",{staticClass:"opIcon",class:3===t.opType?"opline":"",on:{click:function(e){return t.opTabClick(3)}}},[s("i",{staticClass:"iconfont ytcrm-a-xingzhuang1"}),t._v(" "+t._s(t.detailObj.signToSignedList&&t.detailObj.signToSignedList.length)+" ")])])]),s("div",{staticClass:"detailContent"},[t._l(t.detailObj.discussList,(function(e){return s("ul",{directives:[{name:"show",rawName:"v-show",value:2===t.opType,expression:"opType === 2"}],key:"dissItem"+e.ctdId+e.ctsId,staticClass:"discussListWarp"},[s("li",{staticClass:"inforWarp clearfix"},[s("p",{staticClass:"dissAvatar left",style:"ec3e/2021-03-08/tx.jpeg"!==e.discussHeadImgUrl?"":"background: #2362fb;"},["ec3e/2021-03-08/tx.jpeg"!==e.discussHeadImgUrl?s("img",{attrs:{src:"https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/"+e.discussHeadImgUrl,title:e.createName,alt:""}}):s("span",{staticClass:"dissAvatarText",attrs:{title:e.createName}},[t._v(t._s(e.createName.substring(e.createName.length-2,e.createName.length)))])]),s("p",{staticClass:"left"},[s("span",{staticClass:"inforName"},[s("i",[t._v(t._s(e.createName)+"：")]),t._v(" "+t._s(e.discussContent)+" ")]),s("span",{staticClass:"inforTime"},[t._v(" "+t._s(e.createTime)+" "),s("i",{staticClass:"inforBack",on:{click:function(a){return t.backClick(e)}}},[t._v("回复")])])])]),t._l(e.replyList.slice(0,2),(function(e,a){return s("ul",{key:"reply"+a,staticClass:"discussListWarp",staticStyle:{"padding-left":"30px"}},[s("li",{staticClass:"inforWarp clearfix"},[s("p",{staticClass:"dissAvatar left",style:"ec3e/2021-03-08/tx.jpeg"!==e.discussHeadImgUrl?"":"background: #2362fb;"},["ec3e/2021-03-08/tx.jpeg"!==e.discussHeadImgUrl?s("img",{attrs:{src:"https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/"+e.discussHeadImgUrl,title:e.createName,alt:""}}):s("span",{staticClass:"dissAvatarText",attrs:{title:e.createName}},[t._v(t._s(e.createName.substring(e.createName.length-2,e.createName.length)))])]),s("p",{staticClass:"left"},[s("span",{staticClass:"inforName"},[s("i",[t._v(t._s(e.createName)+"：")]),t._v(" "+t._s(e.discussContent)+" ")]),s("span",{staticClass:"inforTime"},[t._v(" "+t._s(e.createTime)+" "),s("i",{staticClass:"inforBack",on:{click:function(a){return t.backClick(e)}}},[t._v("回复")])])])])])})),t._l(e.replyList.slice(2,e.replyList.length),(function(a,i){return s("ul",{directives:[{name:"show",rawName:"v-show",value:e.replyShow,expression:"dissItem.replyShow"}],key:"reply"+i+3,staticClass:"discussListWarp",staticStyle:{"padding-left":"30px"}},[s("li",{staticClass:"inforWarp clearfix"},[s("p",{staticClass:"dissAvatar left",style:"ec3e/2021-03-08/tx.jpeg"!==a.discussHeadImgUrl?"":"background: #2362fb;"},["ec3e/2021-03-08/tx.jpeg"!==a.discussHeadImgUrl?s("img",{attrs:{src:"https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/"+a.discussHeadImgUrl,title:a.createName,alt:""}}):s("span",{staticClass:"dissAvatarText",attrs:{title:a.createName}},[t._v(t._s(a.createName.substring(a.createName.length-2,a.createName.length)))])]),s("p",{staticClass:"left"},[s("span",{staticClass:"inforName"},[s("i",[t._v(t._s(a.createName)+"：")]),t._v(" "+t._s(a.discussContent)+" ")]),s("span",{staticClass:"inforTime"},[t._v(" "+t._s(a.createTime)+" "),s("i",{staticClass:"inforBack",on:{click:function(e){return t.backClick(a)}}},[t._v("回复")])])])])])})),e.replyList.length>3&&!e.replyShow?s("li",{staticStyle:{color:"#AAA9AE","line-height":"34px","padding-left":"30px"},on:{click:function(a){return t.$set(e,"replyShow",!e.replyShow)}}},[t._v(" 查看全部回复 ")]):t._e()],2)})),s("ul",{directives:[{name:"show",rawName:"v-show",value:1===t.opType,expression:"opType === 1"}],staticClass:"subscribeWarp"},t._l(t.detailObj.subscribeList,(function(e,a){return s("li",{key:"subscribeItem"+a},[s("p",{staticClass:"dissAvatar left",style:"ec3e/2021-03-08/tx.jpeg"!==e.headImgUrl?"":"background: #2362fb;"},["ec3e/2021-03-08/tx.jpeg"!==e.headImgUrl?s("img",{attrs:{src:"https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/"+e.headImgUrl,alt:""}}):s("span",{staticClass:"dissAvatarText",attrs:{title:e.userName}},[t._v(t._s(e.userName.substring(e.userName.length-2,e.userName.length)))])]),s("i",[t._v(t._s(e.userName))])])})),0),t._l(t.detailObj.signToSignedList,(function(e,a){return s("ul",{directives:[{name:"show",rawName:"v-show",value:3===t.opType,expression:"opType === 3"}],key:"signToSign"+a,staticClass:"signToSignWarp"},[s("li",[s("p",{staticClass:"dissAvatar left",style:"ec3e/2021-03-08/tx.jpeg"!==e.createHeadImgUrl?"":"background: #2362fb;"},["ec3e/2021-03-08/tx.jpeg"!==e.createHeadImgUrl?s("img",{attrs:{src:"https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/"+e.createHeadImgUrl,alt:"",srcset:""}}):s("span",{staticClass:"dissAvatarText",attrs:{title:e.userName}},[t._v(t._s(e.userName.substring(e.userName.length-2,e.userName.length)))])]),s("i",[t._v(t._s(e.userName)+"@了"+t._s(e.signedName))]),e.signContent?s("i",[t._v("并留言")]):t._e()]),e.signContent?s("li",{staticStyle:{color:"#20469B"}},[t._v("「"+t._s(e.signContent)+"」")]):t._e(),s("li",{staticClass:"signTime"},[t._v(" "+t._s(e.createTime)+" ")])])})),2===t.opType&&0===t.detailObj.discussList.length||1===t.opType&&0===t.detailObj.subscribeList.length||3===t.opType&&0===t.detailObj.signToSignedList.length?s("no-data",{staticStyle:{"padding-top":"30px"},attrs:{message:2===t.opType?"暂无消息":1===t.opType?"暂无人员点击有用":3===t.opType?"暂无@信息":""}}):t._e()],2),s("div",{directives:[{name:"show",rawName:"v-show",value:2===t.opType,expression:"opType === 2"}],staticClass:"buttonAreaWarp"},[s("van-field",{style:t.backMessage?"line-height:18px;padding:0px 10px":"line-height:38px;padding:0px 10px",attrs:{rows:"1",autosize:"",type:"textarea",placeholder:t.placeholder},model:{value:t.backMessage,callback:function(e){t.backMessage=e},expression:"backMessage"}}),s("img",{attrs:{src:a("c014"),alt:""},on:{click:t._insDiscuss}})],1),"请输入评论"!==t.placeholder?s("i",{staticClass:"backPL",on:{click:t.backPLClick}},[t._v("点击评论")]):t._e(),1===t.opType?s("i",{staticClass:"iconfont ytcrm-zanbeifen fixedOp",style:t.detailObj.subscribeFlag?"":"color:#d8d8d8",on:{click:function(e){return t.addSubscribeClick(t.detailObj)}}}):t._e(),3===t.opType?s("i",{staticClass:"iconfont ytcrm-a-xingzhuang1 fixedOp",on:{click:t.signToClick}}):t._e()]):t._e(),t.depPersonShow?s("dep-person",{attrs:{userIdList:t.userIdList,userIdDetailList:t.userIdDetailList,isMultiple:!0,disabled:!0,authorizedFlag:!1,depPersonShow:t.depPersonShow},on:{checkSureClick:t.checkSureClick,closeDepPerson:t.closeDepPerson}}):t._e(),s("van-dialog",{attrs:{"show-cancel-button":"",beforeClose:t.confirmDialog,title:"并留言"},model:{value:t.messageShow,callback:function(e){t.messageShow=e},expression:"messageShow"}},[s("van-field",{attrs:{rows:"2",autosize:"",type:"textarea",placeholder:"请输入留言"},model:{value:t.messageValue,callback:function(e){t.messageValue=e},expression:"messageValue"}})],1)],1)},Yp=[],Qp=(a("498a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"noData"},[t._m(0),a("div",{staticClass:"text"},[t._v(t._s(t.message))])])}),Kp=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"img"},[s("img",{attrs:{src:a("f4f0"),alt:"",srcset:""}})])}],Jp=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return a}(d["c"]);Object(u["a"])([Object(d["b"])({default:"暂无消息"})],Jp.prototype,"message",void 0),Jp=Object(u["a"])([Object(d["a"])({})],Jp);var Xp=Jp,Zp=Xp,tm=(a("9b67"),Object(V["a"])(Zp,Qp,Kp,!1,null,"38f623a3",null)),em=tm.exports,am=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.detailShowUse=!1,t.placeholder="请输入评论",t.backMessage="",t.backObj={},t.opType=2,t.messageShow=!1,t.depPersonShow=!1,t.userIdList=[],t.addUserIdList=[],t.addUserIdDetailList=[],t.messageValue="",t.userIdDetailList=[],t}return Object(o["a"])(a,[{key:"detailClose",value:function(){this.$emit("detailClose")}},{key:"backClick",value:function(t){console.log(t),this.placeholder="回复".concat(t.createName),this.backObj={ctsId:t.ctsId,discussId:t.ctdId,discussType:1,discussedUserId:t.createId,usestatus:0}}},{key:"publishClcik",value:function(){this._insDiscuss()}},{key:"_insDiscuss",value:function(){var t=this,e=Object(b["a"])(Object(b["a"])({},this.backObj),{},{discussContent:this.backMessage});Ap(e).then((function(a){"200"===a.code?(t.$toast.success(a.msg),t.$emit("insDiscussSuccess",e),t.backMessage=""):t.$toast.fail(a.msg)}))}},{key:"backPLClick",value:function(){this.backObj={ctsId:this.detailObj.ctsId,discussType:0,usestatus:0},this.placeholder="请输入评论"}},{key:"opTabClick",value:function(t){this.opType=t,2===t?this.$nextTick((function(){document.getElementsByClassName("detailContent")[0].style.height=document.getElementsByTagName("body")[0].clientHeight-100-document.getElementsByClassName("listWarpDetail")[0].clientHeight+"px"})):this.$nextTick((function(){document.getElementsByClassName("detailContent")[0].style.height=document.getElementsByTagName("body")[0].clientHeight-60-document.getElementsByClassName("listWarpDetail")[0].clientHeight+"px"}))}},{key:"addSubscribeClick",value:function(t){this.$emit("addSubscribeClick",t)}},{key:"checkSureClick",value:function(t){console.log(t),this.userIdDetailList=t.getpersonDetailList,this.userIdList=t.personCheckList;for(var e=0;e<t.getpersonDetailList.length;e++){var a=t.getpersonDetailList[e];a.creId&&(this.addUserIdList.push(a.userId),this.addUserIdDetailList.push({createHeadImgUrl:localStorage.getItem("headImgUrl"),createName:localStorage.getItem("userName"),createId:localStorage.getItem("userId"),createTime:(new Date).toLocaleDateString(),signedId:a.userId,signedName:a.userName,userId:localStorage.getItem("userId"),userName:localStorage.getItem("userName")}))}this.depPersonShow=!1,this.messageShow=!0}},{key:"closeDepPerson",value:function(){this.depPersonShow=!1}},{key:"signToClick",value:function(){var t=this;this.userIdDetailList=[],this.userIdList=[],console.log(this.detailObj);for(var e=function(e){var a=t.detailObj.signToSignedList[e];+a.createId===Number(localStorage.getItem("userId"))&&(t.userIdDetailList.some((function(t){return+t.userId===+a.signedId}))||t.userIdDetailList.push({userId:a.signedId,userName:a.signedName}),t.userIdList.some((function(t){return t===a.signedId}))||t.userIdList.push(a.signedId))},a=0;a<this.detailObj.signToSignedList.length;a++)e(a);this.depPersonShow=!0,console.log(this.userIdDetailList)}},{key:"confirmDialog",value:function(t,e){for(var a={ctsId:this.detailObj.ctsId,signContent:this.messageValue.trim(),userIdList:this.addUserIdList},s=[],i=0;i<this.addUserIdDetailList.length;i++){var n=this.addUserIdDetailList[i];s.push(Object.assign({signContent:this.messageValue},n))}console.log(s),"confirm"===t&&this.$emit("confirmDialog",{params:a,done:e,userDetailList:s}),e()}},{key:"mounted",value:function(){console.log(this.detailObj),this.backObj={ctsId:this.detailObj.ctsId,discussType:0,usestatus:0},this.detailShowUse=this.detailShow,this.$nextTick((function(){document.getElementsByClassName("detailContent")[0].style.height=document.getElementsByTagName("body")[0].clientHeight-100-document.getElementsByClassName("listWarpDetail")[0].clientHeight+"px"}))}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],am.prototype,"detailObj",void 0),Object(u["a"])([Object(d["b"])()],am.prototype,"detailShow",void 0),Object(u["a"])([Object(d["b"])({default:!0})],am.prototype,"closeable",void 0),am=Object(u["a"])([Object(d["a"])({components:{noData:em,depPerson:Ei}})],am);var sm=am,im=sm,nm=(a("8e93"),Object(V["a"])(im,Hp,Yp,!1,null,"b0ca51e0",null)),rm=nm.exports,om=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-popup",{style:"width: 100%;height: 100%",attrs:{position:"right"},on:{close:t.moreClose},model:{value:t.moreShowUse,callback:function(e){t.moreShowUse=e},expression:"moreShowUse"}},[a("div",{staticClass:"moreTopics"},[a("div",{staticClass:"header"},[a("span",{staticClass:"dateWarp fontSize-16",on:{click:t.changeDate}},[t._v(" "+t._s(t.formatDateUse(this.startTime))+"-"+t._s(t.formatDateUse(this.endTime))+" "),a("i",{staticClass:"iconfont ytcrm-qiehuan fontSize-14"})]),a("div",{staticClass:"reloadRight",on:{click:t.reloadClick}},[a("van-icon",{attrs:{name:"replay",size:"20px"}})],1)]),a("div",{staticClass:"main"},[t._l(t.topicList,(function(e,s){return a("ul",{key:"moreTopics"+s,staticClass:"listWarp"},[a("li",{staticClass:"type",style:"业务"===e.MAJOR_LABEL_NAME?"background:#5EA3EF":"采购"===e.MAJOR_LABEL_NAME?"background:#20469B":"拓展"===e.MAJOR_LABEL_NAME?"background:#3874CB":"政府"===e.MAJOR_LABEL_NAME?"background:#5687F6":"返利"===e.MAJOR_LABEL_NAME?"background:#9CC8F5":"风控"===e.MAJOR_LABEL_NAME?"background:#F4BA61":"物流"===e.MAJOR_LABEL_NAME?"background:#D55B26":"QHSE"===e.MAJOR_LABEL_NAME?"background:#F09637":"信息"===e.MAJOR_LABEL_NAME?"background:#F7D38B":""},[t._v(" "+t._s(e.MAJOR_LABEL_NAME)+" ")]),t._l(e.labelList,(function(s,i){return a("li",{key:"topicLabel"+i,staticClass:"moduleList",style:"业务"===e.MAJOR_LABEL_NAME?"color:#5EA3EF":"采购"===e.MAJOR_LABEL_NAME?"color:#20469B":"拓展"===e.MAJOR_LABEL_NAME?"color:#3874CB":"政府"===e.MAJOR_LABEL_NAME?"color:#5687F6":"返利"===e.MAJOR_LABEL_NAME?"color:#9CC8F5":"风控"===e.MAJOR_LABEL_NAME?"color:#F4BA61":"物流"===e.MAJOR_LABEL_NAME?"color:#D55B26":"QHSE"===e.MAJOR_LABEL_NAME?"color:#F09637":"信息"===e.MAJOR_LABEL_NAME?"color:#F7D38B":"",on:{click:function(e){return t.moreListClick(s)}}},[s.todayNum>0?a("span",{staticClass:"todayNum"},[t._v("+"+t._s(s.todayNum))]):t._e(),a("span",{staticClass:"labelTitle fontSize-12"},[t._v(" "+t._s(s.LABEL_NAME)+" ")]),a("span",{staticClass:"topicSquareNum clearfix"},[t._v(" "+t._s(s.topicSquareNum)+" ")]),a("span",{staticClass:"tiao"},[t._v("条")])])}))],2)})),t.topicLoading?a("van-loading",{staticStyle:{margin:"0 30%"},attrs:{color:"#0094ff"}},[t._v("加载中..")]):t._e()],2)]),a("van-calendar",{attrs:{type:"range","default-date":t.dateRange,"min-date":new Date(2020,0,1),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{confirm:t.calendarConfirm},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}})],1)},cm=[],lm=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.calendarShow=!1,t.dateRange=[],t.moreShowUse=!1,t.startTime="",t.endTime="",t.topicMessage="",t.topicList=[],t.topicLoading=!1,t}return Object(o["a"])(a,[{key:"_getTopicNum",value:function(t){return new Promise((function(e,a){Rp(t).then((function(t){"200"===t.code||"topicSquareErr400"===t.code?e(t):a(t)}))}))}},{key:"formatDateUse",value:function(t){var e=new Date(t).getFullYear(),a=new Date(t).getMonth()+1,s=new Date(t).getDate();return"".concat(e,".").concat(a,".").concat(s)}},{key:"moreClose",value:function(){this.$emit("moreClose")}},{key:"changeDate",value:function(){this.calendarShow=!0}},{key:"moreListClick",value:function(t){this.$emit("moreListClick",Object(b["a"])(Object(b["a"])({},t),{},{startTime:this.startTime,endTime:this.endTime}))}},{key:"calendarConfirm",value:function(t){this.calendarShow=!1,this.dateRange=t,this.startTime=Gs(t[0])+" 00:00:00",this.endTime=Gs(t[1])+" 23:59:59",this.init()}},{key:"init",value:function(){var t=this;this.topicList=[],this.topicLoading=!0;var e=this._getTopicNum({startTime:this.startTime,endTime:this.endTime}),a=this._getTopicNum({startTime:Gs(new Date)+" 00:00:00",endTime:Gs(new Date)+" 23:59:59"});Promise.all([e,a]).then((function(e){if(t.topicLoading=!1,t.topicMessage="","200"===e[0].code?t.topicList=e[0].data:"topicSquareErr400"===e[0].code&&(t.topicMessage=e[0].msg),"200"===e[1].code){var a=[];e[1].data.filter((function(t){a=a.concat(t.labelList)}));for(var s=function(e){var s=a[e];t.topicList.map((function(t){t.labelList.map((function(t){t.LABEL_ID===s.LABEL_ID&&(t.todayNum=s.topicSquareNum)}))}))},i=0;i<a.length;i++)s(i);console.log(t.topicList)}else"topicSquareErr400"===e[0].code&&(t.topicMessage=e[0].msg)}))}},{key:"reloadClick",value:function(){this.init()}},{key:"created",value:function(){var t=new Date,e=new Date;e.setTime(e.getTime()-2592e6),this.dateRange=[e,t],this.startTime=Gs(e)+" 00:00:00",this.endTime=Gs(t)+" 23:59:59",this.init()}},{key:"mounted",value:function(){this.moreShowUse=this.moreShow}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],lm.prototype,"moreShow",void 0),lm=Object(u["a"])([Object(d["a"])({})],lm);var um=lm,dm=um,hm=(a("acc2"),Object(V["a"])(dm,om,cm,!1,null,"510092e8",null)),pm=hm.exports,mm=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-popup",{style:"width: 100%;height: 100%",attrs:{position:"right",closeable:""},on:{close:t.addClose},model:{value:t.addShowUse,callback:function(e){t.addShowUse=e},expression:"addShowUse"}},[a("div",{staticClass:"addWarp"},[a("div",{staticClass:"addHeader fontSize-14"},[t._v("新建话题")]),a("div",{staticClass:"addMain"},[a("van-cell-group",[a("van-field",{attrs:{error:t.errorTitle,required:"",label:"",placeholder:"点击输入标题.."},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),a("van-field",{attrs:{readonly:"",clickable:"",error:t.errorLabel,required:"",placeholder:"点击维护事件分类"},on:{click:function(e){t.labelShow=!0}},model:{value:t.activeLabelName,callback:function(e){t.activeLabelName=e},expression:"activeLabelName"}}),a("van-field",{attrs:{rows:"3",autosize:"",label:"",type:"textarea",placeholder:"点击输入话题内容.."},model:{value:t.topicMessage,callback:function(e){t.topicMessage=e},expression:"topicMessage"}})],1)],1),a("ul",{staticClass:"signPeople"},[a("van-cell",{attrs:{"is-link":"",value:0===t.userIdDetailList.length?"":"已选"+t.userIdDetailList.length+"人"},on:{click:t.signClick},scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{staticClass:"changePeo fontSize-14"},[a("i",{staticClass:"iconfont ytcrm-a-xingzhuang1"}),t._v(" 提醒谁看 ")])]},proxy:!0}])}),a("li",{staticClass:"changeList"},[t._l(t.userIdDetailList.slice(0,t.userIdDetailList.length>12?11:12),(function(e,s){return a("span",{key:"user"+s},[t._v(" "+t._s(e.userName)+" "),a("van-icon",{attrs:{name:"cross"},on:{click:function(e){return t.deteleClick(s)}}})],1)})),t.userIdDetailList.length>12?a("span",[t._v("...")]):t._e()],2)],1),t.userIdDetailList.length>0?a("div",{staticClass:"message"},[a("van-field",{attrs:{rows:"3",autosize:"",label:"",type:"textarea",placeholder:"请输入留言"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1):t._e(),a("div",{staticClass:"buttonWarp"},[a("span",{staticClass:"submit",on:{click:t.submitClick}},[t._v("提交")]),a("span",{staticClass:"cancel"},[t._v("取消")])])]),a("van-popup",{style:{height:"65%"},attrs:{round:"",position:"bottom"},model:{value:t.labelShow,callback:function(e){t.labelShow=e},expression:"labelShow"}},[a("van-tree-select",{attrs:{height:"100%",items:t.maplabelTreeList,"main-active-index":t.activeIndex},on:{"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e}},scopedSlots:t._u([{key:"content",fn:function(){return[a("ul",{staticClass:"labelTreeWarp"},t._l(t.maplabelTreeList[t.activeIndex]&&t.maplabelTreeList[t.activeIndex].children,(function(e,s){return a("li",{key:s,on:{click:function(a){return t.labelChangeClick(e)}}},[t._v(" "+t._s(e.LABEL_NAME)+" "),t.activeLabelId===e.LABEL_ID?a("van-icon",{staticClass:"right",attrs:{name:"success"}}):t._e()],1)})),0),t.maplabelTreeList.length>0&&0===t.maplabelTreeList.length?a("van-empty",{attrs:{description:"暂无信息"}}):t._e()]},proxy:!0}])})],1),t.depPersonShow?a("dep-person",{attrs:{userIdList:t.userIdList,userIdDetailList:t.userIdDetailList,isMultiple:!0,disabled:!1,authorizedFlag:!1,depPersonShow:t.depPersonShow},on:{checkSureClick:t.checkSureClick,closeDepPerson:t.closeDepPerson}}):t._e()],1)},vm=[],fm=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.addShowUse=!1,t.labelShow=!1,t.errorTitle=!1,t.errorLabel=!1,t.title="",t.message="",t.topicMessage="",t.maplabelTreeList=[],t.labelTreeList=[],t.activeIndex=0,t.activeLabelId="",t.activeLabelName="",t.depPersonShow=!1,t.userIdList=[],t.userIdDetailList=[],t}return Object(o["a"])(a,[{key:"addClose",value:function(){this.$emit("addClose")}},{key:"mapLabelTree",value:function(){for(var t=0;t<this.labelTreeList.length;t++){var e=this.labelTreeList[t];e.CHILD_LIST?this.maplabelTreeList.push({text:e.LABEL_NAME,index:t,id:e.LABEL_ID,children:e.CHILD_LIST}):this.maplabelTreeList.push({text:e.LABEL_NAME,id:e.LABEL_ID})}}},{key:"_getLabelTree",value:function(){var t=this,e={type:"1"};Ct(e).then((function(e){t.labelTreeList=e.data,t.mapLabelTree()}))}},{key:"labelChangeClick",value:function(t){this.activeLabelId=t.LABEL_ID,this.activeLabelName=t.LABEL_NAME,this.labelShow=!1}},{key:"checkSureClick",value:function(t){console.log(t),this.userIdDetailList=t.getpersonDetailList,this.userIdList=t.personCheckList}},{key:"closeDepPerson",value:function(){this.depPersonShow=!1}},{key:"signClick",value:function(){this.depPersonShow=!0}},{key:"submitClick",value:function(){var t=this;if(this.title)if(this.activeLabelId){var e={labelId:this.activeLabelId,topicContent:this.topicMessage,topicTitle:this.title,isSign:!!this.userIdList.length,signContent:this.message,userIdList:this.userIdList};this.$dialog.confirm({message:"确定新建话题？",allowHtml:!0,confirmButtonText:"确定",beforeClose:function(a,s){"confirm"===a?(t.$emit("submitClick",e),s()):s()}})}else this.errorLabel=!0;else this.errorTitle=!0}},{key:"deteleClick",value:function(t){this.userIdList.splice(t,1),this.userIdDetailList.splice(t,1)}},{key:"mounted",value:function(){this._getLabelTree(),this.addShowUse=this.addShow}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],fm.prototype,"addShow",void 0),fm=Object(u["a"])([Object(d["a"])({components:{depPerson:Ei}})],fm);var gm=fm,bm=gm,ym=(a("6df0"),Object(V["a"])(bm,mm,vm,!1,null,"24cf55fd",null)),_m=ym.exports,km=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.startTime="",t.endTime="",t.topicMessage="",t.topicList=[],t.tabList=["@我的","我@的","我发出的"],t.rightActive=0,t.params={},t.typeTipNumber=0,t.addShow=!1,t.reload=!0,t.detailShow=!1,t.detailObj={},t.moreShow=!1,t.moreListShow=!1,t.moreParams={},t}return Object(o["a"])(a,[{key:"_getTopicNum",value:function(){var t=this;Rp({startTime:this.startTime,endTime:this.endTime}).then((function(e){if(t.topicMessage="","200"===e.code){var a=[];e.data.filter((function(t){a=a.concat(t.labelList)})),a.sort((function(t,e){return e.topicSquareNum-t.topicSquareNum})),t.topicList=a.slice(0,3)}else"topicSquareErr400"===e.code&&(t.topicMessage="topicSquareErr400")}))}},{key:"tabClick",value:function(t){var e=this;this.rightActive=t,this.reload=!1,this.params={startTime:this.startTime,endTime:this.endTime,labelId:"",selectType:this.rightActive+1===1?2:this.rightActive+1===2?1:this.rightActive+1,pageSize:6},this.$nextTick((function(){e.reload=!0}))}},{key:"topicQuickClick",value:function(t){var e=this;this.typeTipNumber=t.topicSquareNum,this.rightActive=t.LABEL_ID,this.reload=!1,this.params={startTime:this.startTime,endTime:this.endTime,labelId:this.rightActive,selectType:0,pageSize:6},this.$nextTick((function(){e.reload=!0}))}},{key:"backTopicClick",value:function(){var t=this;this.rightActive=0,this.reload=!1,this.params={startTime:this.startTime,endTime:this.endTime,labelId:"",selectType:this.rightActive+1===1?2:this.rightActive+1===2?1:this.rightActive+1,pageSize:6},this.$nextTick((function(){t.reload=!0}))}},{key:"dataListClick",value:function(t){this.detailShow=!0,this.detailObj=t}},{key:"detailClose",value:function(){this.detailShow=!1}},{key:"insDiscussSuccess",value:function(t){this._getTopicDiscuss(t.ctsId,t.discussId)}},{key:"_getTopicDiscuss",value:function(t,e){var a=this;Pp({ctsId:t}).then((function(s){console.log(s);for(var i=0;i<a.$refs.list.dataList.length;i++){var n=a.$refs.list.dataList[i];n.ctsId===t&&a.$set(n,"discussList",s.data)}if(a.detailObj.ctdId)for(var r=0;r<s.data.length;r++){var o=s.data[r];o.ctdId===e&&(a.detailObj=JSON.parse(JSON.stringify(o)))}}))}},{key:"addSubscribeClick",value:function(t){var e={objectId:t.ctsId,objectType:0,operateType:t.subscribeFlag?1:0,userId:localStorage.getItem("userId")};this._addSubscribe(e,t)}},{key:"_addSubscribe",value:function(t,e){var a=this;Ep(t).then((function(s){"200"===s.code?(a.$toast.success(e.subscribeFlag?"取消有用成功":"有用成功"),a.$set(e,"subscribeFlag",!e.subscribeFlag),a._getSubscribe({userId:"",objectId:t.objectId,objectType:t.objectType},e)):a.$toast.fail("有用失败")}))}},{key:"_getSubscribe",value:function(t,e){var a=this;Mp(t).then((function(t){"200"===t.code?(a.$set(e,"subscribeList",t.data),a.$set(e,"subscribeNum",e.subscribeFlag?+e.subscribeNum+1:+e.subscribeNum-1)):a.$toast.fail(t.msg)}))}},{key:"confirmDialog",value:function(t){var e=this,a=t.params,s=t.done,i=t.userDetailList;console.log(i),$p(a).then((function(t){"200"===t.code?(s(),e.$toast.success(t.msg),e.$set(e.detailObj,"signToSignedList",e.detailObj.signToSignedList.concat(i)),e.$refs.detail.messageValue="",e.$refs.detail.addUserIdList=[],e.$refs.detail.addUserIdDetailList=[]):e.$toast.fail(t.msg)}))}},{key:"moreTopicsClick",value:function(){this.moreShow=!0}},{key:"moreClose",value:function(){this.moreShow=!1}},{key:"moreListClick",value:function(t){this.moreParams={startTime:t.startTime,endTime:t.endTime,labelId:t.LABEL_ID,labelName:t.LABEL_NAME,selectType:0,pageSize:6},this.moreListShow=!0}},{key:"submitClick",value:function(t){var e=this;qp(t).then((function(t){"200"===t.code?(e.addShow=!1,e.$toast.success(t.msg)):e.$toast.fail(t.msg)}))}},{key:"created",value:function(){var t=new Date,e=new Date;e.setTime(e.getTime()-2592e6),this.startTime=Gs(e)+" 00:00:00",this.endTime=Gs(t)+" 23:59:59",this.params={startTime:this.startTime,endTime:this.endTime,labelId:"",selectType:this.rightActive+1===1?2:this.rightActive+1===2?1:this.rightActive+1,pageSize:6}}},{key:"mounted",value:function(){this._getTopicNum()}}]),a}(d["c"]);km=Object(u["a"])([Object(d["a"])({components:{list:Gp,detail:rm,more:pm,add:_m},beforeRouteLeave:function(t,e,a){this.detailShow?(this.detailShow=!1,a(!1)):this.moreListShow?(this.moreListShow=!1,a(!1)):this.moreShow?(this.moreShow=!1,a(!1)):this.addShow?(this.addShow=!1,a(!1)):a(!0)}})],km);var Cm=km,wm=Cm,Lm=(a("e6b1"),Object(V["a"])(wm,Ip,Sp,!1,null,"1abab928",null)),xm=Lm.exports,Im=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"license-extension"},[s("van-sticky",[s("van-dropdown-menu",{attrs:{"active-color":"#1989fa","close-on-click-outside":!1}},[s("van-dropdown-item",{attrs:{options:e.option},on:{change:e.onTypeChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),s("van-dropdown-item",{ref:"filter",attrs:{title:"筛选"}},[s("van-cell-group",{staticStyle:{padding:"10px 0"}},[s("van-field",{attrs:{clearable:"",label:"客户名称",placeholder:"请输入客户名称|客户ID"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),s("div",{staticClass:"dropdown-opts"},[s("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:e.reset}},[e._v("重置")]),s("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",plain:"",block:"",round:""},on:{click:e.onConfirm}},[e._v("确认")])],1)],1)],1),s("van-tabs",{staticClass:"tabs-div",attrs:{color:"#1989fa"},on:{change:e.onActiveChange},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[s("van-tab",{attrs:{title:"临期"}}),s("van-tab",{attrs:{title:"审批中"}}),s("van-tab",{attrs:{title:"已审批"}})],1)],1),0===e.active?s("div",{staticClass:"change"},[s("div",{staticClass:"change-desc"},[e._v(" 当前待处理"),s("span",{staticClass:"change-desc__value"},[e._v(e._s(e.todoNum))]),e._v("项 ")]),s("div",{staticClass:"change-btn",on:{click:e.changeStatus}},[e._v(e._s(1===e.licenseStatus?"点击显示所有过期证照":"取消"))])]):e._e(),2===e.active?s("div",{staticClass:"status-tabs"},[s("van-tabs",{attrs:{type:"card",color:"#1989fa"}},[s("van-tab",{attrs:{title:"通过"}}),s("van-tab",{attrs:{title:"不通过"}})],1)],1):e._e(),s("van-pull-refresh",{staticClass:"msg-list",on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[s("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(t){e.error=t},load:e.getDataList},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(t,a){return s("div",{key:a,staticClass:"customer-item van-clearfix",on:{click:function(a){return e.toDetail(t)}}},[t.expireDate>=0?s("div",{staticClass:"expire-tag"},[e._v("已过期")]):e._e(),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("核算单元")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(t.entryId?t.entryId+"/"+t.entryName:""))])]),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("单位信息")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(t.companyId?t.companyId+"/"+t.companyName:""))])]),0===e.value?s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("证照信息")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(t.licenseId?t.licenseId+"/"+t.licenseName:""))])]):e._e(),1===e.value?s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("委托人")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(t.agentId?t.agentId+"/"+t.agentName:""))])]):e._e(),1===e.value?s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v("委托书ID")]),s("div",{staticClass:"customer-item__content"},[e._v(e._s(t.seqId||""))])]):e._e(),s("div",{staticClass:"customer-item__line"},[s("div",{staticClass:"customer-item__title"},[e._v(e._s(t.expireDate>=0?"已过期":"过期还剩"))]),s("div",{class:["customer-item__content",t.expireDate<-7?"text-blue":t.expireDate<0?"text-orange":t.expireDate<=30?"text-red":""]},[e._v(e._s(Math.abs(t.expireDate))+"天")])]),0===e.active&&t.expireDate<=30?s("div",{staticClass:"line"}):e._e(),0===e.active&&t.expireDate<=30?s("div",{staticClass:"customer-item__opts"},[s("van-button",{staticClass:"customer-item__btn",attrs:{type:"info",size:"small",round:"",plain:""}},[e._v("申请延期")])],1):e._e()])})),0)],1),s("van-dialog",{attrs:{confirmButtonColor:"#1989fa","show-cancel-button":""},on:{confirm:e.submitLeader},model:{value:e.chooseShow,callback:function(t){e.chooseShow=t},expression:"chooseShow"}},[s("div",{staticClass:"leader"},[s("div",{staticClass:"leader-title"},[e._v("近7天内解锁次数"+e._s(e.target.flag)+"次，需选择部门经理进行复签")]),s("van-field",{staticClass:"leader-select",attrs:{readonly:"",clickable:"",value:e.leader.name,label:"部门经理",placeholder:"点击选择"},on:{click:function(){t.actionShow=!0}}})],1)]),s("van-action-sheet",{attrs:{actions:e.leaderList,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onSelectLeader},model:{value:e.actionShow,callback:function(t){e.actionShow=t},expression:"actionShow"}})],1)},Sm=[],Dm=Object(h["b"])("commonStore"),Om=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.value=0,t.option=[{text:"企业证照",value:0},{text:"客户法人委托书",value:1}],t.keywords="",t.active=0,t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.todoNum=0,t.licenseStatus=1,t.chooseShow=!1,t.actionShow=!1,t.target={},t.leader={},t.leaderList=[],t}return Object(o["a"])(a,[{key:"reset",value:function(){this.keywords=""}},{key:"onConfirm",value:function(){var t=this.$refs.filter;t.toggle(),this.onRefresh()}},{key:"onTypeChange",value:function(){this.active=0,this.licenseStatus=1,this.onRefresh()}},{key:"onActiveChange",value:function(){console.log(this.active),this.onRefresh()}},{key:"changeStatus",value:function(){this.licenseStatus=1===this.licenseStatus?2:1,this.onRefresh()}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t={success:!0,list:[{entryId:16,entryName:"嘉兴英特医药有限公司",companyId:16,companyName:"嘉兴英特医药有限公司",licenseId:16,licenseName:"嘉兴英特医药有限公司",seqId:16,agentId:16,agentName:"嘉兴信息员16",applyManId:16,applyManName:"嘉兴信息员16",useStatus:0,status:1,applyDate:"2021-08-14",validOnDate:"2021-08-14",dateFrom:"2021-08-14",dateTo:"2021-08-14",validEndDate:"2021-08-14",zxtmpDelayTo:"2021-08-14",delayDate:"2021-08-14",applyMemo:"延期",expireDate:16,approvalMemo:"审批",licenseImgList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]},{entryId:16,entryName:"嘉兴英特医药有限公司",companyId:16,companyName:"嘉兴英特医药有限公司",licenseId:16,licenseName:"嘉兴英特医药有限公司",seqId:16,agentId:16,agentName:"嘉兴信息员16",applyManId:16,applyManName:"嘉兴信息员16",useStatus:0,status:2,flag:1,applyDate:"2021-08-14",validOnDate:"2021-08-14",dateFrom:"2021-08-14",dateTo:"2021-08-14",validEndDate:"2021-08-14",zxtmpDelayTo:"2021-08-14",delayDate:"2021-08-14",applyMemo:"延期",expireDate:-6,approvalMemo:"",licenseImgList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]},{entryId:16,entryName:"嘉兴英特医药有限公司",companyId:16,companyName:"嘉兴英特医药有限公司",licenseId:16,licenseName:"嘉兴英特医药有限公司",seqId:16,agentId:16,agentName:"嘉兴信息员16",applyManId:16,applyManName:"嘉兴信息员16",useStatus:0,status:2,applyDate:"2021-08-14",validOnDate:"2021-08-14",dateFrom:"2021-08-14",dateTo:"2021-08-14",validEndDate:"2021-08-14",zxtmpDelayTo:"2021-08-14",delayDate:"2021-08-14",applyMemo:"延期",expireDate:-20,approvalMemo:"",licenseImgList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]},{entryId:16,entryName:"嘉兴英特医药有限公司",companyId:16,companyName:"嘉兴英特医药有限公司",licenseId:16,licenseName:"嘉兴英特医药有限公司",seqId:16,agentId:16,agentName:"嘉兴信息员16",applyManId:16,applyManName:"嘉兴信息员16",useStatus:0,status:2,applyDate:"2021-08-14",validOnDate:"2021-08-14",dateFrom:"2021-08-14",dateTo:"2021-08-14",validEndDate:"2021-08-14",zxtmpDelayTo:"2021-08-14",delayDate:"2021-08-14",applyMemo:"延期",expireDate:-28,approvalMemo:"",licenseImgList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]}]};this.loading=!1,this.refreshing=!1,t.success?(this.list=[].concat(Object(y["a"])(this.list),Object(y["a"])(t.list)),this.page++,this.finished=2===this.page,this.todoNum=8):this.error=!0,0===+this.active&&2===+this.licenseStatus&&this.list.unshift({entryId:16,entryName:"嘉兴英特医药有限公司",companyId:16,companyName:"嘉兴英特医药有限公司",licenseId:16,licenseName:"嘉兴英特医药有限公司",seqId:16,agentId:16,agentName:"嘉兴信息员16",applyManId:16,applyManName:"嘉兴信息员16",useStatus:0,status:1,applyDate:"2021-08-14",validOnDate:"2021-08-14",dateFrom:"2021-08-14",dateTo:"2021-08-14",validEndDate:"2021-08-14",zxtmpDelayTo:"2021-08-14",delayDate:"2021-08-14",applyMemo:"延期",expireDate:66,approvalMemo:"审批",licenseImgList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]})}},{key:"toDetail",value:function(t){t.flag?(this.target=t,this.leader={},this.chooseShow=!0):(this.SET_HADDONEONDETAIL(!1),this.$router.push({name:"LicenseExtensionDetail",params:{listType:"1",licenseType:String(this.value),statusType:String(this.active),item:t}}))}},{key:"getLeaderList",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.leaderList=[],this.leaderList=[{value:1,name:"1/leader1"},{value:2,name:"2/leader2",disabled:!0},{value:3,name:"3/leader3"},{value:4,name:"4/leader4"}];case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onSelectLeader",value:function(t){this.actionShow=!1,this.leader=t}},{key:"submitLeader",value:function(){console.log(this.target),console.log(this.leader),this.chooseShow=!1}},{key:"created",value:function(){this.list=[],this.getDataList(),this.getLeaderList()}},{key:"activated",value:function(){this.hadDoneOnDetail&&this.onRefresh()}}]),a}(d["c"]);Object(u["a"])([Dm.Mutation],Om.prototype,"SET_HADDONEONDETAIL",void 0),Object(u["a"])([h["a"]],Om.prototype,"hadDoneOnDetail",void 0),Om=Object(u["a"])([Object(d["a"])({})],Om);var jm=Om,Tm=jm,Rm=(a("f929"),Object(V["a"])(Tm,Im,Sm,!1,null,"cd0df2a2",null)),Nm=Rm.exports,Am=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"license-extension"},[a("van-sticky",[a("van-dropdown-menu",{attrs:{"active-color":"#1989fa","close-on-click-outside":!1}},[a("van-dropdown-item",{attrs:{options:t.option},on:{change:t.onTypeChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),a("van-dropdown-item",{ref:"filter",attrs:{title:"筛选"}},[a("van-cell-group",{staticStyle:{padding:"10px 0"}},[a("van-field",{attrs:{clearable:"",label:"客户名称",placeholder:"请输入客户名称|客户ID"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}})],1),a("div",{staticClass:"dropdown-opts"},[a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:t.reset}},[t._v("重置")]),a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",plain:"",block:"",round:""},on:{click:t.onConfirm}},[t._v("确认")])],1)],1)],1),a("van-tabs",{staticClass:"tabs-div",attrs:{color:"#1989fa"},on:{change:t.onActiveChange},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("van-tab",{attrs:{title:"待审批"}}),a("van-tab",{attrs:{title:"已审批"}})],1)],1),a("van-pull-refresh",{staticClass:"msg-list",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,s){return a("div",{key:s,staticClass:"customer-item van-clearfix",on:{click:function(a){return t.toDetail(e)}}},[a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("核算单元")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.entryId?e.entryId+"/"+e.entryName:""))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("单位信息")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.companyId?e.companyId+"/"+e.companyName:""))])]),0===t.value?a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("证照信息")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.licenseId?e.licenseId+"/"+e.licenseName:""))])]):t._e(),1===t.value?a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("委托人")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.agentId?e.agentId+"/"+e.agentName:""))])]):t._e(),1===t.value?a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("委托书ID")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.seqId||""))])]):t._e(),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("申请时间")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.applyDate||""))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("申请人")]),a("div",{staticClass:"customer-item__content"},[t._v(t._s(e.applyManId?e.applyManId+"/"+e.applyManName:""))])]),a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v(t._s(e.expireDate>=0?"已过期":"过期还剩"))]),a("div",{class:["customer-item__content",e.expireDate<-7?"text-blue":e.expireDate<0?"text-orange":e.expireDate<=30?"text-red":""]},[t._v(t._s(Math.abs(e.expireDate))+"天")])]),1===t.active?a("div",{staticClass:"customer-item__line"},[a("div",{staticClass:"customer-item__title"},[t._v("审批意见")]),a("div",{class:["customer-item__content",1===e.status?"text-green":2===e.status?"text-red":""]},[t._v(t._s(1===e.status?"通过":2===e.status?"不通过":3===e.status?"审批中":""))])]):t._e()])})),0)],1)],1)},Pm=[],Em=Object(h["b"])("commonStore"),Mm=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.value=0,t.option=[{text:"企业证照",value:0},{text:"客户法人委托书",value:1}],t.keywords="",t.active=0,t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t}return Object(o["a"])(a,[{key:"reset",value:function(){this.keywords=""}},{key:"onConfirm",value:function(){var t=this.$refs.filter;t.toggle(),this.onRefresh()}},{key:"onTypeChange",value:function(){this.active=0,this.onRefresh()}},{key:"onActiveChange",value:function(){console.log(this.active)}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t={success:!0,list:[{entryId:16,entryName:"嘉兴英特医药有限公司",companyId:16,companyName:"嘉兴英特医药有限公司",licenseId:16,licenseName:"嘉兴英特医药有限公司",seqId:16,agentId:16,agentName:"嘉兴信息员16",applyManId:16,applyManName:"嘉兴信息员16",useStatus:0,status:1,applyDate:"2021-08-14",validOnDate:"2021-08-14",dateFrom:"2021-08-14",dateTo:"2021-08-14",validEndDate:"2021-08-14",zxtmpDelayTo:"2021-08-14",delayDate:"2021-08-14",applyMemo:"延期",expireDate:16,approvalMemo:"审批",licenseImgList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]},{entryId:16,entryName:"嘉兴英特医药有限公司",companyId:16,companyName:"嘉兴英特医药有限公司",licenseId:16,licenseName:"嘉兴英特医药有限公司",seqId:16,agentId:16,agentName:"嘉兴信息员16",applyManId:16,applyManName:"嘉兴信息员16",useStatus:0,status:2,flag:1,applyDate:"2021-08-14",validOnDate:"2021-08-14",dateFrom:"2021-08-14",dateTo:"2021-08-14",validEndDate:"2021-08-14",zxtmpDelayTo:"2021-08-14",delayDate:"2021-08-14",applyMemo:"延期",expireDate:-6,approvalMemo:"",licenseImgList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]},{entryId:16,entryName:"嘉兴英特医药有限公司",companyId:16,companyName:"嘉兴英特医药有限公司",licenseId:16,licenseName:"嘉兴英特医药有限公司",seqId:16,agentId:16,agentName:"嘉兴信息员16",applyManId:16,applyManName:"嘉兴信息员16",useStatus:0,status:2,applyDate:"2021-08-14",validOnDate:"2021-08-14",dateFrom:"2021-08-14",dateTo:"2021-08-14",validEndDate:"2021-08-14",zxtmpDelayTo:"2021-08-14",delayDate:"2021-08-14",applyMemo:"延期",expireDate:-20,approvalMemo:"",licenseImgList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]},{entryId:16,entryName:"嘉兴英特医药有限公司",companyId:16,companyName:"嘉兴英特医药有限公司",licenseId:16,licenseName:"嘉兴英特医药有限公司",seqId:16,agentId:16,agentName:"嘉兴信息员16",applyManId:16,applyManName:"嘉兴信息员16",useStatus:0,status:2,applyDate:"2021-08-14",validOnDate:"2021-08-14",dateFrom:"2021-08-14",dateTo:"2021-08-14",validEndDate:"2021-08-14",zxtmpDelayTo:"2021-08-14",delayDate:"2021-08-14",applyMemo:"延期",expireDate:-28,approvalMemo:"",licenseImgList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]}]};this.loading=!1,this.refreshing=!1,t.success?(this.list=[].concat(Object(y["a"])(this.list),Object(y["a"])(t.list)),this.page++,this.finished=2===this.page):this.error=!0}},{key:"toDetail",value:function(t){this.SET_HADDONEONDETAIL(!1),this.$router.push({name:"LicenseExtensionDetail",params:{listType:"2",licenseType:String(this.value),statusType:String(this.active),item:t}})}},{key:"created",value:function(){this.list=[],this.getDataList()}},{key:"activated",value:function(){this.hadDoneOnDetail&&this.onRefresh()}}]),a}(d["c"]);Object(u["a"])([Em.Mutation],Mm.prototype,"SET_HADDONEONDETAIL",void 0),Object(u["a"])([h["a"]],Mm.prototype,"hadDoneOnDetail",void 0),Mm=Object(u["a"])([Object(d["a"])({})],Mm);var $m=Mm,qm=$m,Vm=(a("12af"),Object(V["a"])(qm,Am,Pm,!1,null,"df3a716a",null)),Um=Vm.exports,Fm=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"license-detail"},[s("van-cell-group",{staticClass:"detail__card"},[s("van-cell",{attrs:{title:"核算单元",value:e.formData.entryId?e.formData.entryId+"/"+e.formData.entryName:""}}),s("van-cell",{attrs:{title:"单位信息",value:e.formData.companyId?e.formData.companyId+"/"+e.formData.companyName:""}}),0===+e.licenseType?s("van-cell",{attrs:{title:"证照信息",value:e.formData.licenseId?e.formData.licenseId+"/"+e.formData.licenseName:""}}):e._e(),1===+e.licenseType?[s("van-cell",{attrs:{title:"委托书ID",value:e.formData.seqId}}),s("van-cell",{attrs:{title:"委托人",value:e.formData.agentId?e.formData.agentId+"/"+e.formData.agentName:""}}),s("van-cell",{attrs:{title:"委托人状态",value:0===e.formData.useStatus?"正常":1===e.formData.useStatus?"停用":""}})]:e._e(),2===+e.listType?[s("van-cell",{attrs:{title:"申请时间",value:e.formData.applyDate}}),s("van-cell",{attrs:{title:"申请人",value:e.formData.applyManId?e.formData.applyManId+"/"+e.formData.applyManName:""}})]:e._e(),s("van-cell",{attrs:{title:"有效期起始日期",value:0===+e.licenseType?e.formData.validOnDate:e.formData.dateFrom}}),s("van-cell",{attrs:{title:"有效期至",value:0===+e.licenseType?e.formData.validEndDate>e.formData.zxtmpDelayTo?e.formData.validEndDate:e.formData.zxtmpDelayTo:e.formData.dateTo>e.formData.zxtmpDelayTo?e.formData.dateTo:e.formData.zxtmpDelayTo}}),s("van-cell",{attrs:{title:e.formData.expireDate>=0?"已过期":"过期还剩"}},[[s("span",{class:e.formData.expireDate<-7?"text-blue":e.formData.expireDate<0?"text-orange":e.formData.expireDate<=30?"text-red":""},[e._v(e._s(Math.abs(e.formData.expireDate)+"天"))])]],2),+e.statusType>0||2===+e.listType?[s("van-cell",{attrs:{title:"延期至",value:e.formData.delayDate}}),s("van-cell",{attrs:{title:"延期原因",value:e.formData.applyMemo}}),s("van-cell",{attrs:{title:"照片"}},[[s("div",{staticClass:"img-list"},e._l(e.formData.licenseImgList,(function(t,a){return s("van-image",{key:a,attrs:{width:"90",height:"70",radius:"5",src:t},on:{click:function(t){return e.previewImg(a)}}})})),1)]],2),1===+e.listType||1===+e.statusType?s("van-cell",{attrs:{title:1===+e.listType?"延期审批状态":"审批意见"}},[[s("span",{class:1===e.formData.status?"text-green":2===e.formData.status?"text-red":"text-blue"},[e._v(e._s(1===e.formData.status?"通过":2===e.formData.status?"不通过":3===e.formData.status?"审批中":""))])]],2):e._e(),1!==+e.statusType&&2!==+e.statusType||!e.formData.approvalMemo?e._e():s("van-cell",{attrs:{title:"审批原因",value:e.formData.approvalMemo}})]:e._e()],2),1===+e.listType&&0===+e.statusType&&e.formData.expireDate<=30?s("div",{staticClass:"detail__card"},[s("van-form",{attrs:{"validate-first":""},on:{failed:e.onFailed}},[s("van-field",{attrs:{clickable:"",value:e.date,label:"延期至",placeholder:"点击选择延期时间"},on:{click:function(){t.show=!0}}}),s("van-field",{attrs:{clearable:"",type:"textarea",label:"延期原因",placeholder:"请输入延期原因"},model:{value:e.memo,callback:function(t){e.memo=t},expression:"memo"}}),s("div",{staticClass:"file__title"},[e._v("照片")]),s("van-uploader",{staticClass:"file__upload",attrs:{"after-read":e.afterRead,"upload-icon":"plus"},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1)],1):e._e(),2===+e.listType&&0===+e.statusType?s("div",{staticClass:"detail__card"},[s("van-form",{attrs:{"validate-first":""},on:{failed:e.onFailed}},[s("div",{staticClass:"detail-item"},[s("div",{staticClass:"detail-item__title"},[e._v("是否通过")]),s("van-switch",{attrs:{size:"20px"},model:{value:e.isAgree,callback:function(t){e.isAgree=t},expression:"isAgree"}})],1),s("van-field",{attrs:{clearable:"",type:"textarea",label:"备注",placeholder:"请输入审批原因"},model:{value:e.extensionReson,callback:function(t){e.extensionReson=t},expression:"extensionReson"}})],1)],1):e._e(),1===+e.listType&&0===+e.statusType&&e.formData.expireDate<=30?s("div",{staticClass:"footer"},[s("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit",size:"small",loading:e.publishLoading},on:{click:e.submit}},[e._v("申请延期")])],1):e._e(),2===+e.listType&&0===+e.statusType?s("div",{staticClass:"footer"},[s("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit",size:"small",loading:e.submitLoading},on:{click:e.submitApprove}},[e._v("提交")])],1):e._e(),s("van-calendar",{attrs:{color:"#1989fa","min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.onDateConfirm},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],1)},zm=[],Wm=Object(h["b"])("commonStore"),Bm=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.listType=t.$route.params.listType,t.licenseType=t.$route.params.licenseType,t.statusType=t.$route.params.statusType,t.loading=!1,t.show=!1,t.minDate="",t.maxDate="",t.fileList=[],t.formData={},t.date="",t.memo="",t.publishLoading=!1,t.isAgree="",t.extensionReson="",t.submitLoading=!1,t}return Object(o["a"])(a,[{key:"validator",value:function(t){console.log(t)}},{key:"onFailed",value:function(t){console.log("failed",t)}},{key:"getDetail",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.loading=!0,e={success:!0},setTimeout((function(){a.loading=!1}),2e3),e.success&&(this.formData=this.$route.params.item);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"previewImg",value:function(t){Object(Ml["a"])({images:this.formData.licenseImgList,startPosition:t,closeable:!0})}},{key:"onDateConfirm",value:function(t){console.log(t),this.formData.delayDate=t,this.show=!1}},{key:"afterRead",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log(e),e.status="uploading",e.message="上传中...";case 3:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"submit",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.formData.date){t.next=3;break}return this.$toast("请选择延期时间"),t.abrupt("return");case 3:console.log(this.formData),this.publishLoading=!0,e={success:!0,msg:"成功"},e.success&&(this.SET_HADDONEONDETAIL(!0),this.$toast.success(e.msg||"提交成功"),setTimeout((function(){a.publishLoading=!1,a.$router.back()}),2e3));case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"submitApprove",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log(this.isAgree),console.log(this.extensionReson),console.log(this.formData),this.submitLoading=!0,e={success:!0,msg:"成功"},e.success&&(this.SET_HADDONEONDETAIL(!0),this.$toast.success(e.msg||"提交成功"),setTimeout((function(){a.submitLoading=!1,a.$router.back()}),2e3));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.minDate=new Date((new Date).getTime()+864e5),this.maxDate=new Date((new Date).getTime()+6048e5),this.getDetail()}}]),a}(d["c"]);Object(u["a"])([Wm.Mutation],Bm.prototype,"SET_HADDONEONDETAIL",void 0),Bm=Object(u["a"])([Object(d["a"])({})],Bm);var Gm=Bm,Hm=Gm,Ym=(a("5549"),Object(V["a"])(Hm,Fm,zm,!1,null,"2a1eacab",null)),Qm=Ym.exports;s["a"].use(w["a"]);var Km,Jm=[{path:"/",name:"Layout",component:F,meta:{keepAlive:!0},children:[{path:"/home",name:"Home",component:ct,meta:{keepAlive:!0}},{path:"/message",name:"Message",component:pe,meta:{keepAlive:!0}},{path:"/operationHome",name:"operationHome",component:Il,meta:{keepAlive:!0}},{path:"/taskIndex",name:"TaskIndex",component:An,meta:{keepAlive:!0}},{path:"/cabinIndex",name:"CabinIndex",component:Wh,meta:{keepAlive:!0}},{path:"/user",name:"User",component:ai,meta:{keepAlive:!0}}]},{path:"/customerAnalysis",name:"CustomerAnalysis",component:Ms,meta:{keepAlive:!0}},{path:"/schedule",name:"Schedule",component:Fi,meta:{keepAlive:!1}},{path:"/weekly",name:"Weekly",component:mn,meta:{keepAlive:!1}},{path:"/customerAnalysis/list",name:"CustomerAnalysisList",component:xo,meta:{keepAlive:!0}},{path:"/customerAnalysis/unionlist",name:"CustomerAnalysisUnionList",component:qo,meta:{keepAlive:!1}},{path:"/customerAnalysis/person",name:"CustomerAnalysisPerson",component:Ro,meta:{keepAlive:!0}},{path:"/task/sendlist",name:"TaskSendlist",component:Fn,meta:{keepAlive:!0}},{path:"/task/cancellist",name:"TaskCancellist",component:Kn,meta:{keepAlive:!0}},{path:"/task/receivelist",name:"TaskReceivelist",component:ir,meta:{keepAlive:!0}},{path:"/task/detail",name:"TaskDetail",component:hr,meta:{keepAlive:!1}},{path:"/task/download",name:"TaskFileDownload",component:yr,meta:{keepAlive:!1}},{path:"/task/publish",name:"TaskPublish",component:Sr,meta:{keepAlive:!1}},{path:"/customerUnit",name:"CustomerUnit",component:Pr,meta:{keepAlive:!0}},{path:"/customerUnit/detail",name:"CustomerUnitDetail",component:bo,meta:{keepAlive:!1}},{path:"/customerUnit/share",name:"CustomerShare",component:Fr,meta:{keepAlive:!1}},{path:"/customerUnit/person",name:"CustomerUnitPerson",component:Qr,meta:{keepAlive:!1}},{path:"/customerUnit/personadd",name:"CustomerPersonAdd",component:ao,meta:{keepAlive:!1}},{path:"/customerUnit/personshare",name:"CustomerPersonShare",component:lo,meta:{keepAlive:!1}},{path:"/customerFollow",name:"CustomerFollow",component:tc,meta:{keepAlive:!1}},{path:"/customerFollowDetail",name:"customerFollowDetail",component:oc,meta:{keepAlive:!1}},{path:"/message/taskDetail",name:"MessageTaskDetail",component:vc,meta:{keepAlive:!1}},{path:"/adminLogin",name:"PlaintextLogin",component:wc,meta:{keepAlive:!1}},{path:"/customerHotSit",name:"customerHotSit",component:jc,meta:{keepAlive:!1}},{path:"/twoPinDic",name:"twoPinDic",component:yl,meta:{keepAlive:!0}},{path:"/twoPinDic/customDetail",name:"custom-detail",component:Al,meta:{keepAlive:!0}},{path:"/twoPinDic/goodsDetail",name:"goods-detail",component:zl,meta:{keepAlive:!1}},{path:"/wmsTwoPinDic",name:"wmsTwoPinDic",component:Kl,meta:{keepAlive:!1}},{path:"/message/secSellGoodsDetail",name:"wmsTwoPinMsgDetail",component:su,meta:{keepAlive:!1}},{path:"/inventoryQuery",name:"inventoryQuery",component:mu,meta:{keepAlive:!1}},{path:"/inquiryLetterAssistant",name:"inquiryLetterAssistant",component:ld,meta:{keepAlive:!1}},{path:"/inquiryLetterDetail",name:"inquiryLetterDetail",component:id,meta:{keepAlive:!1}},{path:"/inquiryAbnormalDeal",name:"inquiryAbnormalDeal",component:Wu,meta:{keepAlive:!1}},{path:"/abnormalDetailMsg",name:"abnormalDetailMsg",component:fd,meta:{keepAlive:!1}},{path:"/exceedTimeReason",name:"exceedTimeReason",component:Zu,meta:{keepAlive:!1}},{path:"/keyProjectsIndex",name:"keyProjectsIndex",component:Ld,meta:{keepAlive:!0}},{path:"/keyProjectsFollow",name:"keyProjectsFollow",component:Rd,meta:{keepAlive:!0}},{path:"/keyAddGR",name:"keyAddGR",component:Hd,meta:{keepAlive:!1}},{path:"/keyAddTarget",name:"keyAddTarget",component:eh,meta:{keepAlive:!1}},{path:"/keyAddGoods",name:"keyAddGoods",component:fh,meta:{keepAlive:!1}},{path:"/keyTopic",name:"keyTopic",component:wh,meta:{keepAlive:!1}},{path:"/message/pushGridMsg",name:"MessagePushGridMsg",component:jh,meta:{keepAlive:!1}},{path:"/cabinRank",name:"CabinRank",component:ip,meta:{keepAlive:!0}},{path:"/cabinGlobal",name:"CabinGlobal",component:dp,meta:{keepAlive:!1}},{path:"/custList",name:"CustList",component:bp,meta:{keepAlive:!0}},{path:"/custDetail",name:"CustDetail",component:xp,meta:{keepAlive:!1}},{path:"/cabinSearch",name:"CabinSearch",component:Jh,meta:{keepAlive:!0}},{path:"/topic",name:"Topic",component:xm,meta:{keepAlive:!1}},{path:"/licenseExtensionIndex",name:"LicenseExtensionIndex",component:Nm,meta:{keepAlive:!0}},{path:"/licenseExtensionApprove",name:"LicenseExtensionApprove",component:Um,meta:{keepAlive:!0}},{path:"/licenseExtensionDetail",name:"LicenseExtensionDetail",component:Qm,meta:{keepAlive:!1}}],Xm=new w["a"]({routes:Jm}),Zm=Xm,tv=a("d399"),ev=a("2241");window.canCancelAxios=[],C.a.defaults.withCredentials=!0;var av=C.a.create({timeout:3e5});function sv(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=window;if(t.length>0)t.forEach((function(t){for(var a=0;a<e.canCancelAxios.length;a++)e.canCancelAxios[a].key===t&&(e.canCancelAxios[a].cancel("中断请求"),e.canCancelAxios.splice(a,1),a--)}));else for(var a=0;a<e.canCancelAxios.length;a++)e.canCancelAxios[a].cancel("中断请求"),e.canCancelAxios.splice(a,1),a--}av.interceptors.request.use((function(t){var e=[];return t.url&&e.every((function(e){return!t.url.includes(e)}))&&(t.cancelToken=new C.a.CancelToken((function(e){var a=t.url.split("/");window.canCancelAxios.push({key:a[a.length-1]||"",cancel:e})}))),t.headers["X-TOKEN"]=localStorage.getItem("tokenValue"),t.headers.needOperateLoading&&(Km=tv["a"].loading({message:t.headers.msg?decodeURIComponent(t.headers.msg):"请求中，请稍等......",duration:0,forbidClick:!0})),t}),(function(t){return Promise.reject(t)})),av.interceptors.response.use((function(t){t.config.headers.needOperateLoading&&Km.clear();var e=t.status,a=t.statusText,s=t.data;if(200===e){if("LG00004"===s.code){var i="token已失效，请点击下方“crm”重新登陆";return localStorage.clear(),ev["a"].alert({title:"提示",message:i}),Promise.reject(new Error(s.msg||"Error"))}return Promise.resolve(t)}var n={info:""};switch(e){case 400:n.info="请求无效";break;case 401:n.info="由于长时间未操作，登录已超时，请重新登录",Zm.replace({path:"/"});break;case 403:n.info="拒绝访问";break;case 404:n.info="请求地址出错";break;case 405:n.info="未授权";break;case 408:n.info="请求超时";break;case 500:n.info="服务器内部错误";break;case 501:n.info="服务未实现";break;case 502:n.info="网关错误";break;case 503:n.info="服务不可用";break;case 504:n.info="网关超时";break;case 505:n.info="HTTP版本不受支持";break;default:return Promise.resolve(t)}var r=a?n.info+" "+a:n.info;return Promise.reject(new Error(r||"Error"))}),(function(t){return"中断请求"!==t.message&&ev["a"].alert({title:"错误提示",message:t}),Km&&Km.clear(),Promise.reject(t)}));var iv=av;function nv(t,e,a){return rv.apply(this,arguments)}function rv(){return rv=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,n,r,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=o.length>3&&void 0!==o[3]&&o[3],n=o.length>4&&void 0!==o[4]?o[4]:"",t.next=4,iv({url:e+a,method:"post",data:s,headers:{needOperateLoading:i,msg:encodeURIComponent(n)||encodeURIComponent("请求中，请稍等......")}});case 4:return r=t.sent,t.abrupt("return",r.data);case 6:case"end":return t.stop()}}),t)}))),rv.apply(this,arguments)}function ov(t,e,a){return cv.apply(this,arguments)}function cv(){return cv=Object(_["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,n,r,o,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=c.length>3&&void 0!==c[3]&&c[3],n=c.length>4&&void 0!==c[4]?c[4]:"",r=new FormData,Object.keys(s).forEach((function(t){r.append(t,s[t]||"")})),t.next=6,iv({url:e+a,method:"post",data:r,headers:{needOperateLoading:i,msg:encodeURIComponent(n)||encodeURIComponent("请求中，请稍等......")}});case 6:return o=t.sent,t.abrupt("return",o.data);case 8:case"end":return t.stop()}}),t)}))),cv.apply(this,arguments)}var lv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:O+"/api/secondSell/queryEntryid",method:"post",headers:{needOperateLoading:!0}});case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),uv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/getCustom",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),dv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/getGoods",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),hv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ov(O,"/api/secondSell/queryContact",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),pv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/getGoodsDtl",e,!0,"批号获取中......");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),mv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/cart/addCart",e,!0,"添加中......");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),vv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ov(O,"/api/cart/queryCart",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),fv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ov(O,"/api/order/getWmsCenter",e,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),gv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/order/preCreateInvoice",e,!0,"订单校验中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),bv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/order/createInvoice",e,!0,"订单生成中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),yv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/cart/delCart",e,!0,"删除中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),_v=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/cart/updateCartsQty",e,!0,"修改中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),kv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/getGoodsResell",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Cv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ov(O,"/api/secondSell/getGoodsPrice",e,!0,"价格查询中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),wv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/order/getOrderDoc",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Lv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ov(O,"/api/order/getOrderDtl",e,!0,"细单列表查询中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),xv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/getimgs",e,!0,"图片查询中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Iv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/getCustomersOftenPin",e,!0,"客户查询中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Sv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/sendToWarehouseOperator",e,!0,"提示请求中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Dv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ov(O,"/api/secondSell/getWarehouseOperator",e,!0,"查询中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ov=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ov(O,"/api/order/logisticsInformation",e,!0,"物流查询中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),jv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/getGoodsResellPcqs",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Tv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/getGoodsDtlPcsq",e,!0,"细单查询中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Rv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,nv(O,"/api/secondSell/getimgsPqsc",e,!0,"图片查询中...");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Nv=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,iv({url:O+"/api/secondSell/uploadPhotos",method:"post",data:e});case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Av=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.dataList=[],t.chooseLineResult=[],t.chooseResult=[],t.checkedAll=!1,t.twoPinTotalMemo="",t.getWmsShow=!1,t.wmsList=[],t.contactList=[],t.getContactShow=!1,t.clickIndex="",t.totalPrice=0,t}return Object(o["a"])(a,[{key:"ishandleCheckAll",value:function(){for(var t=this,e=0,a=0,s=0;s<this.dataList.length;s++){var i=this.dataList[s].crmCartDtlVOS;e+=i.length}for(var n=function(e){var s=t.chooseResult[e];t.chooseResult[e]&&t.chooseResult[e].length>0&&(t.chooseResult[e].some((function(t){return t==="all-"+e}))?a+=s.length-1:a+=s.length)},r=0;r<this.chooseResult.length;r++)n(r);return e===a}},{key:"closeShopCart",value:function(){this.$emit("closeShopCart")}},{key:"handleCheckedLine",value:function(t,e){var a=this;this.chooseResult[t]&&this.chooseResult[t].length===e.length&&!this.chooseResult[t].some((function(e){return e==="all-"+t}))?this.chooseResult[t].unshift("all-"+t):this.chooseResult[t]&&this.chooseResult[t].forEach((function(e,s){e==="all-"+t&&a.chooseResult[t].splice(s,1)})),this.checkedAll=this.ishandleCheckAll()}},{key:"handleCheckedAll",value:function(t,e){var a=this.$refs.checkboxGroup;this.chooseResult[t]&&this.chooseResult[t].length===e.length&&!this.chooseResult[t].some((function(e){return e==="all-"+t}))?(a[t].toggleAll(),this.chooseResult[t]=[]):a[t].toggleAll(!0),this.checkedAll=this.ishandleCheckAll()}},{key:"handlecheckAllClick",value:function(){for(var t=this.$refs.checkboxGroup,e=0;e<t.length;e++){var a=t[e];a.toggleAll(this.checkedAll?this.checkedAll:"")}}},{key:"checkAllClick",value:function(){for(var t=this.$refs.checkboxGroup,e=0;e<t.length;e++){var a=t[e];a.toggleAll(this.checkedAll?this.checkedAll:"")}}},{key:"_queryCart",value:function(){var t=this;this.dataList=[];var e={entryId:this.chooseEntry.entryId};vv(e).then((function(e){"200"===e.code?(t.dataList=e.data,t.chooseResult=[],t.checkedAll=!1):t.$toast.fail(e.msg)}))}},{key:"_queryContact",value:function(t){var e=this,a=this.$toast.loading({message:"运输地址查询中，请稍等......",duration:0,forbidClick:!0});hv(t).then((function(t){a.close(),e.contactList=t,e.getContactShow=!0}))}},{key:"_getWmsCenter",value:function(){var t=this;fv({entryId:this.chooseEntry.entryId}).then((function(e){if(t.wmsList=e.data,1===t.wmsList.length)for(var a=0;a<t.dataList.length;a++){var s=t.dataList[a];s.wmsChooseObj=t.wmsList[0]}}))}},{key:"chooseContactClick",value:function(t){this.dataList[this.clickIndex].addressId=t.ADDRESSID,this.dataList[this.clickIndex].addressName=t.ADDRESS,this.getContactShow=!1,this.stepperChange(this.dataList[this.clickIndex],""),this.$forceUpdate()}},{key:"chooseClick",value:function(t){if(!this.clickIndex&&0!==this.clickIndex){for(var e=0;e<this.dataList.length;e++){var a=this.dataList[e];a.logistcenterId=t.wmscenterucode,a.logistcenterName=t.wmscenterucodename}return this.getWmsShow=!1,void this.$forceUpdate()}this.dataList[this.clickIndex].logistcenterId=t.wmscenterucode,this.dataList[this.clickIndex].logistcenterName=t.wmscenterucodename,this.getWmsShow=!1,this.$forceUpdate()}},{key:"chooseWms",value:function(t){this.clickIndex=t,this.getWmsShow=!0}},{key:"chooseContact",value:function(t,e){this.clickIndex=e;var a={entryid:t.entryId,customid:t.customId,contactid:t.contactId};this._queryContact(a)}},{key:"getParams",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e&&0===this.chooseResult.length)return this.$toast.fail("请选择要操作的数据"),!1;for(var a=0;a<this.dataList.length;a++){var s=this.dataList[a];s.crmCartDtlVOS.map((function(e){t.$set(e,"isCheck",!1)}))}for(var i=function(e){var a=t.chooseResult[e];a&&a.map((function(a){var s=a.split("-");if(-1!==s.indexOf("all"))for(var i=0;i<t.dataList[e].crmCartDtlVOS.length;i++){var n=t.dataList[e].crmCartDtlVOS[i];t.$set(n,"isCheck",!0)}else for(var r=0;r<t.dataList[e].crmCartDtlVOS.length;r++){var o=t.dataList[e].crmCartDtlVOS[r];console.log(o),console.log(s),console.log(+o.ccdDtlId===+s[1]),+o.ccdDtlId===+s[1]&&t.$set(o,"isCheck",!0)}}))},n=0;n<this.chooseResult.length;n++)i(n);var r=JSON.parse(JSON.stringify(this.dataList)),o=[];return r.map((function(t){var e=t.crmCartDtlVOS.reduce((function(t,e){return e.isCheck?[].concat(Object(y["a"])(t),[e]):t}),[]);t.crmCartDtlVOS=e,e.length>0&&o.push(t)})),o}},{key:"deleteSubmit",value:function(){var t=this,e=this.getParams()||[];0!==e.length&&yv(e).then((function(e){"200"===e.code?(t.$toast.success("删除成功"),setTimeout((function(){t._queryCart()}))):t.$toast.fail(e.msg)}))}},{key:"onSubmit",value:function(){var t=this.getParams()||[];0!==t.length&&(this._preCreateInvoice(t),this.$emit("onSubmit"))}},{key:"_preCreateInvoice",value:function(t){var e=this;gv(t).then((function(a){if("200"===a.code){var s="";for(var i in a.data)"lockControlInfo"===i?(s+='<div class="lock-info-title">'.concat(e.chooseEntry.entryName,"：</div>"),s+='<div class="lock-info"><div class="lock-left">库存下限：</div>'+(a.data[i].inventoryLowLimitFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].inventoryLowLimit)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">品种销量控制：</div>'+(a.data[i].kindControlFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].kindControl)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">库存信息：</div>'+(a.data[i].goodsqtyInfoFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].goodsqtyInfo)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">近效期：</div>'+(a.data[i].nearlyEffectiveFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].nearlyEffective)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">价格限销：</div>'+(a.data[i].priceLimitFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].priceLimit)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">禁销限销：</div>'+(a.data[i].canNotSellFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].canNotSellInfo)+"</div></div>"):(s+='<div class="border"></div>',s+='<div class="lock-info-title">'.concat(i.split("-")[0],"：</div>"),s+='<div class="lock-info"><div class="lock-left">库存下限：</div>'+(a.data[i].inventoryLowLimitFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].inventoryLowLimit)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">品种销量控制：</div>'+(a.data[i].kindControlFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].kindControl)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">库存信息：</div>'+(a.data[i].goodsqtyInfoFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].goodsqtyInfo)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">近效期：</div>'+(a.data[i].nearlyEffectiveFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].nearlyEffective)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">价格限销：</div>'+(a.data[i].priceLimitFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].priceLimit)+"</div></div>",s+='<div class="lock-info"><div class="lock-left">禁销限销：</div>'+(a.data[i].canNotSellFlag?'<div class="text-green">无限制':'<div class="text-red">'+a.data[i].canNotSellInfo)+"</div></div>");e.$dialog.confirm({message:s,allowHtml:!0,getContainer:"#shopCart",confirmButtonText:"继续下单",beforeClose:function(a,s){"confirm"===a?bv(t).then((function(t){"200"===t.code?(e.$toast.success("下单成功"),e.totalPrice=0,e._queryCart()):e.$toast.fail(t.msg),s()})):s()}})}else e.$toast.fail(a.msg)}))}},{key:"stepperChange",value:function(t,e){var a=this;this.$cancelAxios(["updateCartsQty"]);var s=[];if(e){if(!e.goodsQty)return;s.push({ccdDtlId:e.ccdDtlId,goodsId:e.goodsId,lotId:e.lotId,goodsStatusId:e.goodsStatusId,storageId:e.storageId,goodsQty:e.goodsQty}),this._updateCartsQty(t,e,s)}else(function(){for(var i=[],n=[],r=function(e){var s=a.dataList[e];s.ccdDocId!==t.ccdDocId&&s.crmCartDtlVOS.map((function(t){i.push(Object(b["a"])(Object(b["a"])({},s),{},{goodsId:t.goodsId}))}))},o=0;o<a.dataList.length;o++)r(o);if(t.crmCartDtlVOS.map((function(t){s.push({ccdDtlId:t.ccdDtlId,goodsId:t.goodsId,lotId:t.lotId,goodsStatusId:t.goodsStatusId,storageId:t.storageId,goodsQty:t.goodsQty}),n.push({goodsId:t.goodsId,goodsName:t.goodsName})})),i.some((function(e){return e.customId===t.customId&&e.addressId===t.addressId&&n.some((function(t){return t.goodsId===e.goodsId}))}))){for(var c="".concat(t.customName,"，货品"),l=0;l<n.length;l++){var u=n[l];c+='<i class="fontWeight">'.concat(u.goodsName,"</i>"),l<n.length-1&&(c+="、")}c+="，相同运输地址购物车已存在，确定修改并合并订单吗？",a.$dialog.confirm({message:c,allowHtml:!0,getContainer:"#shopCart",confirmButtonText:"确定修改并合并",beforeClose:function(i,n){"confirm"===i?(a._updateCartsQty(t,e,s,!0),n()):n()}})}else a._updateCartsQty(t,e,s)})()}},{key:"_updateCartsQty",value:function(t,e,a){var s=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=[{ccdDocId:t.ccdDocId,entryId:t.entryId,addressId:t.addressId,addressName:t.addressName,crmCartDtlVOS:a}];setTimeout((function(){_v(n).then((function(t){"200"===t.code?(e?s.chooseChange():i&&s._queryCart(),s.$notify({type:"success",message:"修改成功"})):s.$toast.fail(t.msg)}))}),200)}},{key:"chooseChange",value:function(){var t=this,e=this.getParams(!1);this.totalPrice=0;for(var a=0;a<e.length;a++){var s=e[a];s.crmCartDtlVOS.map((function(e){t.totalPrice+=+(e.goodsQty*+e.price*1e4/100).toFixed(2)}))}}},{key:"overlimit",value:function(){event.stopPropagation()}},{key:"mounted",value:function(){this._queryCart(),this._getWmsCenter()}}]),a}(d["c"]);Object(u["a"])([h["a"]],Av.prototype,"shopCartType",void 0),Object(u["a"])([h["a"]],Av.prototype,"chooseEntry",void 0),Av=Object(u["a"])([Object(d["a"])({})],Av);var Pv=Av,Ev=Pv,Mv=(a("7d98"),Object(V["a"])(Ev,f,g,!1,null,"11fb84c5",null)),$v=Mv.exports,qv=Object(h["b"])("commonStore"),Vv=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.useShopingCartShow=!1,t}return Object(o["a"])(a,[{key:"shopingCartClick",value:function(t){this.SET_SHOPCARTSHOW(t),this.useShopingCartShow=t}},{key:"mounted",value:function(){var t=(localStorage.getItem("userCode")||"登录失效")+"  "+(localStorage.getItem("userName")||"登录失效");if(v.set(t,document.getElementsByTagName("body")[0]),this.useShopingCartShow=this.shopingCartShow,this.$route.path.indexOf("twoPinDic")>=0){if(2===this.shopCartType)return;this.SET_SHOPCARTTYPE(2)}else{if(0===this.shopCartType)return;this.SET_SHOPCARTTYPE(0)}}},{key:"onShopingCartShowChanged",value:function(t){console.log(t),this.useShopingCartShow=t}}]),a}(d["c"]);Object(u["a"])([h["a"]],Vv.prototype,"shopCartType",void 0),Object(u["a"])([h["a"]],Vv.prototype,"chooseEntry",void 0),Object(u["a"])([h["a"]],Vv.prototype,"shopingCartShow",void 0),Object(u["a"])([qv.Mutation],Vv.prototype,"SET_SHOPCARTTYPE",void 0),Object(u["a"])([qv.Mutation],Vv.prototype,"SET_SHOPCARTSHOW",void 0),Object(u["a"])([Object(d["d"])("shopingCartShow")],Vv.prototype,"onShopingCartShowChanged",null),Vv=Object(u["a"])([Object(d["a"])({components:{shopCart:$v}})],Vv);var Uv,Fv=Vv,zv=Fv,Wv=(a("5c0b"),Object(V["a"])(zv,i,n,!1,null,null,null)),Bv=Wv.exports,Gv=a("2f62"),Hv={userInfor:function(t){return t.user.userInfor},depTreeList:function(t){return t.commonStore.depTreeList},dictionariesList:function(t){return t.commonStore.dictionariesList},proTypedictionariesList:function(t){return t.commonStore.proTypedictionariesList},hobbyDicList:function(t){return t.commonStore.hobbyDicList},labelbaseDicList:function(t){return t.commonStore.labelbaseDicList},labelweeklyList:function(t){return t.commonStore.labelweeklyList},labelbasetypeList:function(t){return t.commonStore.labelbasetypeList},customerInfo:function(t){return t.commonStore.customerInfo},hadDoneOnDetail:function(t){return t.commonStore.hadDoneOnDetail},taskDetailInfo:function(t){return t.commonStore.taskDetailInfo},chooseEntry:function(t){return t.commonStore.chooseEntry},shopCartType:function(t){return t.commonStore.shopCartType},getgoodsDetail:function(t){return t.commonStore.getgoodsDetail},shopingCartShow:function(t){return t.commonStore.shopingCartShow}},Yv=Hv,Qv=a("b054"),Kv=a.n(Qv),Jv=a("ade3"),Xv="SET_INFORMATION",Zv="SET_DEPTLIST",tf="SET_DICTIONARIES",ef="SET_PROTYPEDICTIONARIES",af="SET_HOBBYDIC",sf="SET_LABELBASE",nf="SET_LABELWEEKLY",rf="SET_LABELBASETYPE",of="SET_CUSTOMERINFO",cf="SET_HADDONEONDETAIL",lf="SET_TASKDETAILINFO",uf="SET_ENTRYINFOR",df="SET_SHOPCARTTYPE",hf="SET_SHOPCARTSHOW",pf="SET_GOODSDETAIL",mf={namespaced:!0,state:{userInfor:{}},mutations:Object(Jv["a"])({},Xv,(function(t,e){t.userInfor=e})),actions:{actionChangeInfor:function(t,e){var a=t.commit;a("SET_INFORMATION",e)}}},vf=mf,ff={namespaced:!0,state:{depTreeList:"",dictionariesList:[],proTypedictionariesList:[],hobbyDicList:[],labelbaseDicList:[],labelweeklyList:[],labelbasetypeList:[],customerInfo:[],hadDoneOnDetail:!1,taskDetailInfo:{},shopCartType:0,shopingCartShow:!1,chooseEntry:{entryId:"",entryName:""},getgoodsDetail:{}},mutations:(Uv={},Object(Jv["a"])(Uv,Zv,(function(t,e){t.depTreeList=e})),Object(Jv["a"])(Uv,tf,(function(t,e){t.dictionariesList=e})),Object(Jv["a"])(Uv,ef,(function(t,e){t.proTypedictionariesList=e})),Object(Jv["a"])(Uv,af,(function(t,e){t.hobbyDicList=e})),Object(Jv["a"])(Uv,sf,(function(t,e){t.labelbaseDicList=e})),Object(Jv["a"])(Uv,nf,(function(t,e){t.labelweeklyList=e})),Object(Jv["a"])(Uv,rf,(function(t,e){t.labelbasetypeList=e})),Object(Jv["a"])(Uv,of,(function(t,e){t.customerInfo=e})),Object(Jv["a"])(Uv,cf,(function(t,e){t.hadDoneOnDetail=e})),Object(Jv["a"])(Uv,lf,(function(t,e){t.taskDetailInfo=e})),Object(Jv["a"])(Uv,uf,(function(t,e){t.chooseEntry.entryId=e.entryId,t.chooseEntry.entryName=e.entryName})),Object(Jv["a"])(Uv,df,(function(t,e){t.shopCartType=e})),Object(Jv["a"])(Uv,hf,(function(t,e){t.shopingCartShow=e})),Object(Jv["a"])(Uv,pf,(function(t,e){t.getgoodsDetail=e})),Uv),actions:{actionGetDepTree:function(t,e){return Object(_["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=t.commit,a.abrupt("return",new Promise((function(t){xi(e).then((function(e){"200"===e.code?s("SET_DEPTLIST",e.data):tv["a"].fail(e.msg),t(e)}))})));case 2:case"end":return a.stop()}}),a)})))()},actionGetDictionaries:function(t,e){return Object(_["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=t.commit,a.abrupt("return",new Promise((function(t){Si(e).then((function(a){"200"===a.code?14===e.typeId?s("SET_PROTYPEDICTIONARIES",a.data.list):11===e.typeId?s("SET_HOBBYDIC",a.data.list):5===e.typeId?s("SET_LABELBASE",a.data.list):17===e.typeId?s("SET_LABELWEEKLY",a.data.list):18===e.typeId?s("SET_LABELBASETYPE",a.data.list):s("SET_DICTIONARIES",a.data.list):tv["a"].fail(a.msg),t(a)}))})));case 2:case"end":return a.stop()}}),a)})))()}}},gf=ff;s["a"].use(Gv["a"]);var bf=!1,yf=new Gv["a"].Store({modules:{user:vf,commonStore:gf},getters:Yv,strict:bf,plugins:bf?[Kv()()]:[]}),_f=yf,kf=(a("499a"),a("b970")),Cf=a("343b"),wf=(a("157a"),a("2bb3")),Lf=(a("fe43"),a("b311")),xf=a.n(Lf);s["a"].prototype.$Clipboard=xf.a,s["a"].use(kf["a"]),s["a"].use(Cf["a"],{lazyComponent:!0}),s["a"].use(wf["install"]),s["a"].prototype.$cancelAxios=sv,s["a"].config.productionTip=!1,Zm.onError((function(t){var e=/Loading chunk (\d)+ failed/g,a=t.message.match(e),s=Zm.history.pending.fullPath;a&&Zm.replace(s)})),new s["a"]({router:Zm,store:_f,data:function(){return{domainUrl:"https://intmedic-wx.oss-cn-hangzhou.aliyuncs.com/"}},render:function(t){return t(Bv)}}).$mount("#app")},cd95:function(t,e,a){},cfd6:function(t,e,a){},d020:function(t,e,a){},d09c:function(t,e,a){"use strict";a("eae0")},d0c6:function(t,e,a){},d19f:function(t,e,a){"use strict";a("3931")},d5c9:function(t,e,a){"use strict";a("ae08")},d77b:function(t,e,a){},dac8:function(t,e,a){"use strict";a("7c7f")},db35:function(t,e,a){"use strict";a("027f")},dda5:function(t,e,a){},dea5:function(t,e,a){"use strict";a("067d")},df06:function(t,e,a){},e11c:function(t,e,a){"use strict";a("7094")},e66c:function(t,e,a){},e6b1:function(t,e,a){"use strict";a("6472")},e8c1:function(t,e,a){},e9e7:function(t,e,a){"use strict";a("6ed8")},ea45:function(t,e,a){"use strict";a("0316")},ea62:function(t,e,a){"use strict";a("7ef7")},eae0:function(t,e,a){},ec83:function(t,e,a){"use strict";a("e8c1")},ece2:function(t,e,a){"use strict";a("cacf")},ed20:function(t,e,a){"use strict";a("94db")},edd6:function(t,e,a){},edd7:function(t,e,a){},eeeb:function(t,e,a){},f09c:function(t,e,a){},f0ee:function(t,e,a){},f1ed:function(t,e,a){"use strict";a("11b7")},f4f0:function(t,e,a){t.exports=a.p+"static/img/noData.5ca9fda6.png"},f5df4:function(t,e,a){},f714:function(t,e,a){"use strict";a("768d")},f7729:function(t,e,a){"use strict";a("d77b")},f7f3:function(t,e,a){},f7f8:function(t,e,a){"use strict";a("edd6")},f82b:function(t,e,a){},f929:function(t,e,a){"use strict";a("9413")},fc08:function(t,e,a){"use strict";a("b63f")}},[[0,"runtime","npm.echarts","npm.vant","npm.core-js","npm.zrender","npm.axios","npm.vs-tree","npm.vue","npm.vuex","npm.clipboard","npm.jquery","npm.regenerator-runtime","npm.vue-router","vendors~app"]]]);