(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d84a5e4c"],{"3df6":function(t,e,a){"use strict";a("6908")},6908:function(t,e,a){},"7bf4":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pb-100"},[a("van-sticky",[a("van-search",{attrs:{clearable:"",placeholder:"请输入标题|内容|发送人"},on:{search:t.refreshData},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}})],1),a("div",{staticClass:"d-flex inner-block"},[a("div",{class:["type-item mr-2",2===t.taskType?"type-item--active":""],on:{click:function(e){return t.changeTaskType(2)}}},[t._v(" 我收到的 ")]),a("div",{class:["type-item",1===t.taskType?"type-item--active":""],on:{click:function(e){return t.changeTaskType(1)}}},[t._v("我发出的")])]),a("div",{staticClass:"px-10"},[t._v("共"+t._s(t.taskNum)+"条")]),a("van-pull-refresh",{staticClass:"task-list",on:{refresh:t.refreshData},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return a("div",{key:e.cmsId,staticClass:"task-item mt-2 van-clearfix",on:{click:function(a){return t.toDetail(e)}}},[a("van-swipe-cell",{scopedSlots:t._u([1===t.taskType?{key:"right",fn:function(){return[1===+e.useStatus?a("van-button",{staticClass:"task-btn",attrs:{square:"",type:"info",text:"作废"},on:{click:function(a){return t.cancelTask(e)}}}):t._e(),0===+e.useStatus?a("van-button",{staticClass:"task-btn",attrs:{square:"",type:"info",text:"再次发起"},on:{click:function(a){return t.resendTask(e)}}}):t._e()]},proxy:!0}:null],null,!0)},[a("task-piece",{attrs:{data:e,receipt:2===t.taskType,showProgress:1===t.taskType}})],1)],1)})),0)],1),a("div",{staticClass:"footer mt-2 full-width d-flex justify-center"},[a("van-button",{staticClass:"footer__btn2 mr-4",attrs:{size:"large",round:"",plain:"",type:"info",color:"#2271F5"},on:{click:function(e){t.statusShow=!0}}},[a("div",{attrs:{slot:"icon"},slot:"icon"},[a("app-icon",{staticClass:"mr-1",attrs:{name:"#ytcrm-shaixuanfilter1"}})],1),t._v(" "+t._s("全部"===t.taskStatusName?"状态筛选":t.taskStatusName)+" ")]),a("van-button",{staticClass:"footer__addbtn",attrs:{size:"large",color:"#2271F5",round:"",type:"info"},on:{click:t.toPublish}},[a("div",{attrs:{slot:"icon"},slot:"icon"},[a("app-icon",{staticClass:"mr-1",attrs:{name:"#ytcrm-xingzengtask"}})],1),t._v(" 新增任务 ")])],1),a("van-action-sheet",{attrs:{actions:2===t.taskType?t.statusOptions:t.sendStatusOptions,"cancel-text":"取消",description:"状态筛选","close-on-click-action":""},on:{select:t.onSelectStatus},model:{value:t.statusShow,callback:function(e){t.statusShow=e},expression:"statusShow"}})],1)},n=[],i=a("2909"),r=a("1da1"),c=a("d4ec"),o=a("bee2"),u=a("262e"),l=a("2caf"),h=(a("96cf"),a("b0c0"),a("d3b7"),a("159b"),a("d81d"),a("99af"),a("9ab4")),p=a("1b40"),f=a("4bb5"),d=a("f10e"),k=a("2835"),v=Object(f["a"])("app"),b=[{value:"",name:"全部"},{value:1,name:"未读"},{value:2,name:"已读"},{value:0,name:"作废"}],m=[{value:"",name:"全部"},{value:1,name:"进行中"},{value:2,name:"已完成"},{value:0,name:"已作废"}],y=function(t){Object(u["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(c["a"])(this,a),t=e.apply(this,arguments),t.taskType=2,t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.taskStatus="",t.taskStatusName="全部",t.taskNum="",t.keywords="",t.statusShow=!1,t.statusOptions=b,t.sendStatusOptions=m,t}return Object(o["a"])(a,[{key:"changeTaskType",value:function(t){this.taskType=t,this.taskStatus="",this.taskStatusName="全部",this.refreshData()}},{key:"onSelectStatus",value:function(t){this.statusShow=!1,this.taskStatus=t.value,this.taskStatusName=t.name,this.refreshData()}},{key:"refreshData",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={pageNum:this.page,pageSize:this.pageSize,status:this.taskStatus,search:this.keywords},2!==this.taskType){t.next=7;break}return t.next=4,Object(k["h"])(e);case 4:t.t0=t.sent,t.next=10;break;case 7:return t.next=9,Object(k["i"])(e);case 9:t.t0=t.sent;case 10:a=t.t0,this.loading=!1,this.refreshing=!1,a.success?(1===this.taskType&&a.data.list.forEach((function(t){var e=0;t.sendList.map((function(t){t.content&&e++})),t.hasReply=e})),this.list=[].concat(Object(i["a"])(this.list),Object(i["a"])(a.data.list)),this.page++,this.finished=!a.data.hasNextPage,this.taskNum=a.data.total):this.error=!0;case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"toPublish",value:function(){this.SET_HADDONEONDETAIL(!1),this.$router.push({path:"/task/publish"})}},{key:"cancelTask",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(k["b"])({csoId:e.csoId});case 2:a=t.sent,a.success?(this.$toast.success(a.msg||"作废成功"),e.useStatus=0,this.refreshData()):this.$toast.fail(a.msg||"作废失败");case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"resendTask",value:function(t){this.$router.push({name:"TaskPublish",params:{detail:t}})}},{key:"toDetail",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(2!==this.taskType||1!==e.useStatus){t.next=5;break}return t.next=3,Object(k["d"])({csodId:e.csodId});case 3:a=t.sent,a.success&&(e.useStatus=2);case 5:this.SET_DETAILINFOR({type:this.taskType,csoId:e.csoId}),this.SET_HADDONEONDETAIL(!1),this.$router.push({path:"/task/detail"});case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.refreshData()}},{key:"activated",value:function(){this.hadDoneOnDetail&&this.refreshData()}}]),a}(p["d"]);Object(h["a"])([v.Getter],y.prototype,"hadDoneOnDetail",void 0),Object(h["a"])([v.Mutation],y.prototype,"SET_DETAILINFOR",void 0),Object(h["a"])([v.Mutation],y.prototype,"SET_HADDONEONDETAIL",void 0),y=Object(h["a"])([Object(p["a"])({components:{TaskPiece:d["a"]}})],y);var g=y,S=g,O=(a("3df6"),a("2877")),T=Object(O["a"])(S,s,n,!1,null,"172b1dc7",null);e["default"]=T.exports}}]);