(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ea5764ac"],{"98a4":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail"},[a("div",{staticClass:"detail-header px-20 pt-20 pb-3"},[a("div",{staticClass:"d-flex justify-space-between align-center"},[a("div",{staticClass:"d-flex align-center"},[a("span",{staticClass:"font-14 fontWeight"},[e._v(" "+e._s(e.detailObj.companyName?e.detailObj.companyName.indexOf("/").length>2?e.detailObj.companyName.split("/")[0]+"/":e.detailObj.companyName.substring(0,10):"")+" ")]),e.detailObj.address?a("icon-svg",{staticClass:"ml-3",attrs:{size:"small",name:"ytcrm-tuding1"}}):e._e()],1),a("span",{staticClass:"color-second"},[e._v(e._s(e.detailObj.visitTime.substring(0,16)))])]),a("div",{staticClass:"d-flex justify-space-between align-center"},[a("span",{staticStyle:{width:"75%"}},[a("span",{staticClass:"fontWeight font-14"},[e._v(" "+e._s(e.detailObj.companyName?e.detailObj.companyName.indexOf("/").length>2?e.detailObj.companyName.split("/")[1]+"/"+e.detailObj.companyName.split("/")[2]+"/":e.detailObj.companyName.substring(10,e.detailObj.companyName.length):"")+" ")]),a("span",{staticClass:"color-second"},[e._v(e._s(1===e.detailObj.companyType?"供应商":2===e.detailObj.companyType?"下游客户":3===e.detailObj.companyType?"政府单位":""))])]),a("span",[e.detailObj.isRaisedStarFlag?e._e():a("van-icon",{attrs:{size:"16px",name:"star-o",color:"#FBD71B"}}),e._l(e.detailObj.starFlag,(function(e){return a("van-icon",{key:e,attrs:{size:"16px",name:"star",color:"#FBD71B"}})})),0===e.detailObj.whetherLegwork?a("svg",{staticClass:"icon ml-1",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#ytcrm-xingzhuangjiehe"}})]):e._e(),1===e.detailObj.whetherLegwork?a("svg",{staticClass:"icon ml-1",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#ytcrm-buhang"}})]):e._e(),a("span",{staticClass:"list-primaryColor ml-2"},[e._v(e._s(1===e.detailObj.whetherLegwork?"":"非")+"外勤")])],2)]),a("div",{staticClass:"d-flex justify-space-between align-center my-2"},[a("span",[a("span",{staticClass:"fontWeight font-14"},[e._v(e._s(e.detailObj.visitUserName))]),a("svg",{staticClass:"icon ml-1 pr-1",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":1===e.detailObj.warmthNum?"#ytcrm-full-green":2===e.detailObj.warmthNum?"#ytcrm-full-orange":3===e.detailObj.warmthNum?"#ytcrm-full-red":""}})]),a("span",{staticClass:"color-second"},[e._v("（发起人："+e._s(e.detailObj.creName)+"）")])]),a("span",{class:1===e.detailObj.taskType?"tag-primary":2===e.detailObj.taskType?"tag-primary-light":3===e.detailObj.taskType?"tag-primary-plain":""},[e._v(e._s(1===e.detailObj.taskType?"个人拜访":2===e.detailObj.taskType?"协访":3===e.detailObj.taskType?"接待":"")+" ")])])]),a("div",{staticClass:"detail-content pa-10"},[e.detailObj.cciId?a("div",{staticClass:"pa-10 white-block mb-2"},[a("div",{staticClass:"color-second font-14"},[e._v("定位信息")]),a("div",[e._v(e._s(e.detailObj.cciId)+"/"+e._s(e.detailObj.address))])]):e._e(),a("div",{staticClass:"pa-10 white-block"},[a("div",{staticClass:"color-second font-14"},[e._v("客情事件信息")]),e._l(e.detailObj.crmLabelRemarkDtoList.slice(0,3),(function(t){return a("ul",{key:"crmLabelRemark"+t.clrId,staticClass:"px-10 font-12"},[a("li",{staticClass:"primaryColor py-2"},[e._v(" "+e._s(t.labelName)+" "),t.credate?a("span",{staticClass:"pl-2"},[e._v(e._s(t.credate.substring(0,t.credate.length-3)))]):e._e()]),"药事会信息"===t.labelName?[a("li",{staticClass:"pb-2 d-flex"},[a("div",{staticClass:"color-second",staticStyle:{width:"80px"}},[e._v("药事会类型")]),a("div",{staticClass:"primaryColor"},[e._v(" "+e._s(t.medicBoardType?1===t.medicBoardType?"新药会":2===t.medicBoardType?"国谈会":3===t.medicBoardType?t.medicBoardTypeMemo:"":"")+" ")])]),a("li",{staticClass:"pb-2 d-flex"},[a("div",{staticClass:"color-second",staticStyle:{width:"80px"}},[e._v("计划日期")]),a("div",{staticClass:"primaryColor"},[e._v(" "+e._s(t.scheduleMeetingTime?t.scheduleMeetingTime.split(" ")[0]:"")+" ")])]),a("li",{staticClass:"pb-2 color-second"},[e._v("备注")]),a("li",{staticClass:"pb-2"},[e._v(e._s(t.medicBoardMemo))])]:a("li",{staticClass:"pb-2"},[e._v(" "+e._s(t.remark)+" ")])],2)})),e._l(e.detailObj.crmLabelRemarkDtoList.slice(3,e.detailObj.crmLabelRemarkDtoList.length),(function(t){return a("ul",{directives:[{name:"show",rawName:"v-show",value:e.openFlag,expression:"openFlag"}],key:"crmLabelRemark"+t.clrId,staticClass:"px-10 font-12"},[a("li",{staticClass:"primaryColor py-2"},[e._v(" "+e._s(t.labelName)+" "),t.credate?a("span",{staticClass:"pl-2"},[e._v(e._s(t.credate.substring(0,t.credate.length-3)))]):e._e()]),"药事会信息"===t.labelName?[a("li",{staticClass:"pb-2 d-flex"},[a("div",{staticClass:"color-second",staticStyle:{width:"80px"}},[e._v("药事会类型")]),a("div",{staticClass:"primaryColor"},[e._v(" "+e._s(t.medicBoardType?1===t.medicBoardType?"新药会":2===t.medicBoardType?"国谈会":3===t.medicBoardType?t.medicBoardTypeMemo:"":"")+" ")])]),a("li",{staticClass:"pb-2 d-flex"},[a("div",{staticClass:"color-second",staticStyle:{width:"80px"}},[e._v("计划日期")]),a("div",{staticClass:"primaryColor"},[e._v(e._s(t.scheduleMeetingTime))])]),a("li",{staticClass:"pb-2 color-second"},[e._v("备注")]),a("li",{staticClass:"pb-2"},[e._v(e._s(t.medicBoardMemo))])]:a("li",{staticClass:"pb-2"},[e._v(" "+e._s(t.remark)+" ")])],2)})),e.detailObj.crmLabelRemarkDtoList.length>3?a("div",{staticClass:"d-flex justify-center align-center"},[a("span",{staticClass:"color-second",on:{click:function(t){e.openFlag=!e.openFlag}}},[e._v(e._s(e.openFlag?"点击收回":"点击展开"))]),a("icon-Svg",{attrs:{size:"mini",name:e.openFlag?"ytcrm-a-lujing1-copy":"ytcrm-a-lujing1",color:"#323233"},on:{click:function(t){e.openFlag=!e.openFlag}}})],1):e._e()],2),a("div",{staticClass:"pa-10 white-block mt-2"},[a("div",{staticClass:"color-second font-14"},[e._v("批注信息")]),e._l(e.detailObj.crmVisitCommentDtoList.slice(0,3),(function(t){return a("ul",{key:"crmLabelRemark"+t.cvcId,staticClass:"px-10 font-12"},[a("li",{staticClass:"primaryColor py-2"},[e._v(" "+e._s(t.creName)+" "),t.credate?a("span",{staticClass:"pl-2"},[e._v(e._s(t.credate.substring(0,t.credate.length-3)))]):e._e()]),a("li",{staticClass:"pb-2"},[e._v(" "+e._s(t.commentRemark)+" ")])])})),e._l(e.detailObj.crmVisitCommentDtoList.slice(3,e.detailObj.crmVisitCommentDtoList.length),(function(t){return a("ul",{directives:[{name:"show",rawName:"v-show",value:e.openFlagComment,expression:"openFlagComment"}],key:"crmLabelRemark"+t.cvcId,staticClass:"px-10 font-12"},[a("li",{staticClass:"primaryColor py-2"},[e._v(" "+e._s(t.creName)+" "),t.credate?a("span",{staticClass:"pl-2"},[e._v(e._s(t.credate.substring(0,t.credate.length-3)))]):e._e()]),a("li",{staticClass:"pb-2"},[e._v(" "+e._s(t.commentRemark)+" ")])])})),e.detailObj.crmVisitCommentDtoList.length>3?a("div",{staticClass:"d-flex justify-center align-center"},[a("span",{staticClass:"color-second",on:{click:function(t){e.openFlagComment=!e.openFlagComment}}},[e._v(e._s(e.openFlagComment?"点击收回":"点击展开"))]),a("icon-Svg",{attrs:{size:"mini",name:e.openFlagComment?"ytcrm-a-lujing1-copy":"ytcrm-a-lujing1",color:"#323233"},on:{click:function(t){e.openFlagComment=!e.openFlagComment}}})],1):e._e()],2)]),a("div",{staticClass:"commonOpButton-footer"},[a("div",{staticClass:"detail-button d-flex align-center justify-center"},[e.detailObj.isRaisedStarFlag?e._e():a("van-icon",{attrs:{size:"20px",name:"star-o",color:"#2271F5"},on:{click:function(t){return e.addStarClick(e.detailObj)}}}),e.detailObj.isRaisedStarFlag?a("van-icon",{attrs:{size:"20px",name:"star",color:"#FBD71B"}}):e._e(),a("icon-svg",{staticClass:"ml-6 cursorP",attrs:{size:"large",name:"ytcrm-tuding"},nativeOn:{click:function(t){return e.clickChange(e.detailObj)}}}),e.cuvId?e._e():a("icon-svg",{staticClass:"ml-6",attrs:{size:"width:16px;height:20px;fill:#2271F5;",name:"ytcrm-lujing2"},nativeOn:{click:function(t){return e.editClick(e.detailObj)}}})],1),e.cuvId?e._e():a("van-button",{attrs:{round:"",color:"#2271F5",type:"primary"},on:{click:function(t){return e.commentClick(e.detailObj)}}},[a("span",[e._v("点击添加批注")])])],1),e.customerLabelShow?a("custom-label",{attrs:{activeName:0,customerLabelShow:e.customerLabelShow,customerId:e.detailObj.companyId},on:{closeClick:function(t){e.customerLabelShow=!1}}}):e._e(),e.commentShow?a("comment",{attrs:{commentShow:e.commentShow},on:{closeClick:function(t){e.commentShow=!1},sureComment:e.sureComment}}):e._e(),e.showAdressPicker?a("clock-in",{attrs:{detailClock:e.detailObj.cciId,visitDate:e.detailObj.visitTime,showAdressPicker:e.showAdressPicker},on:{adressOnConfirm:e.adressOnConfirm,addressChoose:e.addressChoose,adressCancel:e.adressCancel}}):e._e()],1)},i=[],c=a("d4ec"),n=a("bee2"),o=a("262e"),l=a("2caf"),r=a("9ab4"),d=a("1b40"),m=a("e906"),u=a("e7dd"),p=function(e){Object(o["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(c["a"])(this,a),e=t.apply(this,arguments),e.openFlag=!1,e.openFlagComment=!1,e.cuvId="",e}return Object(n["a"])(a,[{key:"_getUserVisit",value:function(e){var t=this;Object(m["e"])({cuvId:e}).then((function(e){"200"===e.code&&t.SET_DETAILOBJ(e.data.list[0])}))}},{key:"mounted",value:function(){this.cuvId=this.$route.query.cuvid,this.cuvId&&(this.SET_DETAILOBJ({}),this._getUserVisit(this.cuvId))}}]),a}(Object(d["b"])(u["a"]));p=Object(r["a"])([Object(d["a"])({})],p);var b=p,v=b,h=(a("e2a05"),a("2877")),C=Object(h["a"])(v,s,i,!1,null,"88e840ec",null);t["default"]=C.exports},a0eb:function(e,t,a){},d54e:function(e,t,a){"use strict";a("a0eb")},e2a05:function(e,t,a){"use strict";a("f615")},e7dd:function(e,t,a){"use strict";var s=a("1da1"),i=a("2909"),c=a("d4ec"),n=a("bee2"),o=a("262e"),l=a("2caf"),r=(a("96cf"),a("e9c4"),a("99af"),a("9ab4")),d=a("1b40"),m=a("e906"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("van-popup",{style:{width:"100%",height:"40%"},attrs:{position:"bottom",round:"",clearable:""},on:{close:e.closeClick},model:{value:e.innCommentShow,callback:function(t){e.innCommentShow=t},expression:"innCommentShow"}},[a("div",{staticClass:"font-16 fontWeight-500 textAlignC pt-4 pb-2"},[e._v("批注")]),a("van-field",{staticStyle:{height:"calc(100% - 100px)"},attrs:{autosize:"",label:"",type:"textarea",placeholder:"请输入批注","show-word-limit":""},model:{value:e.commentMessage,callback:function(t){e.commentMessage=t},expression:"commentMessage"}}),a("div",{staticClass:"footer full-width d-flex align-center justify-end"},[a("span",{staticClass:"color-main-2 font-14 px-4",on:{click:e.sureComment}},[e._v(" 提交 ")])])],1)},p=[],b=function(e){Object(o["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(c["a"])(this,a),e=t.apply(this,arguments),e.innCommentShow=!1,e.commentMessage="",e}return Object(n["a"])(a,[{key:"closeClick",value:function(){this.$emit("closeClick")}},{key:"sureComment",value:function(){this.commentMessage?this.$emit("sureComment",this.commentMessage):this.$toast.fail("请输入批注内容")}},{key:"mounted",value:function(){this.innCommentShow=this.commentShow}}]),a}(d["d"]);Object(r["a"])([Object(d["c"])()],b.prototype,"commentShow",void 0),b=Object(r["a"])([Object(d["a"])({})],b);var v=b,h=v,C=(a("d54e"),a("2877")),f=Object(C["a"])(h,u,p,!1,null,"7c2d045c",null),O=f.exports,y=a("2efb"),_=a("3df5"),g=a("4bb5"),j=Object(g["a"])("crm"),k=Object(g["a"])("app"),w=function(e){Object(o["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(c["a"])(this,a),e=t.apply(this,arguments),e.commentShow=!1,e.showAdressPicker=!1,e.customerLabelShow=!1,e}return Object(n["a"])(a,[{key:"addStarClick",value:function(e){var t=this;this.$dialog.confirm({title:"确认",confirmButtonColor:"#2271f5",message:"确定要将当前拜访记录提升为星标事件吗？"}).then((function(){Object(m["n"])({cuvId:e.cuvId}).then((function(a){"200"===a.code?(t.$toast({type:"success",message:a.msg}),t.$set(e,"isRaisedStarFlag",!0),t.$set(e,"starFlag",e.starFlag++)):t.$toast.fail(a.msg)}))}))}},{key:"editClick",value:function(e){var t=[],a={userId:e.visitUserId,userName:e.visitUserName,phoneNumber:e.visitUserPhoneNum,hotid:e.warmthNum,starCheck:0,outsideCheck:e.address?1:0,hotValue:1===+e.warmthNum?"业务员一般客情":2===+e.warmthNum?"需要进阶的客情":3===+e.warmthNum?"从未接触的客情":"请选择热力值信息",remarkValueList:Object(i["a"])(e.crmLabelRemarkDtoList),needLabelValueObj:[]};t.push(JSON.parse(JSON.stringify(a))),e.staffMemberCheckDetail=t,this.SET_DETAILOBJ(e),this.customerLabelShow=!0}},{key:"commentClick",value:function(e){this.SET_DETAILOBJ(e),this.commentShow=!0}},{key:"sureComment",value:function(e){var t=[{commentRemark:e,cuvId:this.detailObj.cuvId,cvcId:this.detailObj.cvcId,creName:this.userInfor.userName,credate:this.$dayjs().format("YYYY-MM-DD HH:mm")}];this._insOrUpdComment(t)}},{key:"_insOrUpdComment",value:function(e){var t=this;Object(m["f"])(e).then((function(a){if("200"===a.code){t.$toast({type:"success",message:a.msg});var s=JSON.parse(JSON.stringify(t.detailObj));t.$set(s,"crmVisitCommentDtoList",s.crmVisitCommentDtoList.concat(e)),t.SET_DETAILOBJ(s),t.SET_DATACHANGEOP(!0),t.commentShow=!1}}))}},{key:"clickChange",value:function(e){this.SET_DETAILOBJ(e),this.showAdressPicker=!0}},{key:"adressOnConfirm",value:function(e){this._relateClockIn({cciId:e.cciId,cuvId:this.detailObj.cuvId},e),this.showAdressPicker=!1}},{key:"_relateClockIn",value:function(e,t){var a=this;Object(m["o"])(e).then((function(e){if("200"===e.code){a.$toast.success(e.msg);var s=JSON.parse(JSON.stringify(a.detailObj));a.$set(s,"address",t.address||t.addressDetail),a.$set(s,"cciId",t.cciId||t.addressID),a.SET_DETAILOBJ(s),a.SET_DATACHANGEOP(!0),a.showAdressPicker=!1}else a.$toast.fail(e.msg)}))}},{key:"addressChoose",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this._relateClockIn({cciId:t.addressID,cuvId:this.detailObj.cuvId},t),this.showAdressPicker=!1;case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"adressCancel",value:function(){this.showAdressPicker=!1}}]),a}(d["d"]);Object(r["a"])([j.Mutation],w.prototype,"SET_DETAILOBJ",void 0),Object(r["a"])([k.Getter],w.prototype,"userInfor",void 0),Object(r["a"])([j.Getter],w.prototype,"detailObj",void 0),Object(r["a"])([j.Getter],w.prototype,"dataChangeOp",void 0),Object(r["a"])([j.Mutation],w.prototype,"SET_DATACHANGEOP",void 0),w=Object(r["a"])([Object(d["a"])({components:{comment:O,clockIn:y["a"],customLabel:_["a"]}})],w);t["a"]=w},f615:function(e,t,a){}}]);