(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4cc23ac1"],{"1b81":function(e,t,a){},"437a":function(e,t,a){"use strict";var i=a("bee2"),s=a("d4ec"),r=a("262e"),n=a("2caf"),l=a("9ab4"),o=a("1b40"),c=a("4bb5"),d=Object(c["a"])("app"),u=Object(c["a"])("crm");o["a"].registerHooks(["beforeRouteEnter"]);var b=function(e){Object(r["a"])(a,e);var t=Object(n["a"])(a);function a(){var e;return Object(s["a"])(this,a),e=t.apply(this,arguments),e.filterShow=!1,e.filterActive=!1,e.tabType=0,e}return Object(i["a"])(a)}(o["d"]);Object(l["a"])([d.Getter],b.prototype,"userInfor",void 0),Object(l["a"])([u.Mutation],b.prototype,"SET_DETAILOBJ",void 0),Object(l["a"])([d.Mutation],b.prototype,"SET_QUERYPARAMA",void 0),Object(l["a"])([d.Mutation],b.prototype,"SET_HADDONEONDETAIL",void 0),Object(l["a"])([d.Getter],b.prototype,"hadDoneOnDetail",void 0),b=Object(l["a"])([Object(o["a"])({})],b),t["a"]=b},"53ae":function(e,t,a){"use strict";var i=a("d4ec"),s=a("bee2"),r=a("262e"),n=a("2caf"),l=(a("b0c0"),a("9ab4")),o=a("1b40");o["a"].registerHooks(["beforeRouteEnter"]);var c=function(e){Object(r["a"])(a,e);var t=Object(n["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.page=1,e.total=0,e.dataList=[],e.loading=!1,e.finished=!1,e.refreshing=!1,e.finishText="",e.userIdList=[],e.error=!1,e}return Object(s["a"])(a,[{key:"beforeRouteEnter",value:function(e,t,a){a((function(e){"Home"!==t.name&&"TaskIndex"!==t.name||(e.dataList=[],e.page=1,e.loading=!1,e.finished=!0,e.refreshing=!1,e.$nextTick((function(){e.finished=!1})))}))}}]),a}(o["d"]);c=Object(l["a"])([Object(o["a"])({})],c),t["a"]=c},"59eb":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("van-sticky",[a("div",{staticClass:"header pt-10 white-bg"},[a("div",{staticClass:"px-10"},[a("div",{class:["pa-10 common-filter",e.filterShow?"color-main-2":"",e.filterActive?"common-filter--active":""],on:{click:function(t){e.filterShow=!e.filterShow}}},[a("div",[e._v("条件筛选")]),a("van-icon",{attrs:{name:"arrow-"+(e.filterShow?"up":"down"),size:"16px"}})],1)]),e.queryParams.deptId?a("div",{staticClass:"pl-3 py-1"},[e._v(e._s(e.queryParams.deptId)+"/"+e._s(e.queryParams.deptName))]):e._e()])]),a("div",{attrs:{id:"filterContainer"}},[a("van-pull-refresh",{staticClass:"pt-10 pb-100",on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[a("van-list",{staticClass:"px-2",attrs:{offset:20,finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[e.loading||e.dataList.length?e._e():a("app-empty",{staticClass:"mt-6 white-bg"}),e._l(e.dataList,(function(t,i){return a("div",{key:i,staticClass:"white-block pa-2 mb-2",on:{click:function(a){return e.cardClick(t)}}},[a("div",{staticClass:"d-flex justify-space-between align-center"},[a("div",{staticClass:"d-flex align-center"},[a("span",{staticClass:"font-14 fontWeight"},[e._v(" "+e._s(t.companyName?t.companyName.indexOf("/").length>2?t.companyName.split("/")[0]+"/":t.companyName:"")+" ")])]),a("div",{staticClass:"d-flex flex-column align-end",staticStyle:{"min-width":"110px"}},[a("span",{staticClass:"color-second pb-1"},[e._v(e._s(t.visitTime.substring(0,16)))]),a("span",{class:1===t.taskType?"tag-primary-plain":2===t.taskType?"tag-primary-light":3===t.taskType?"tag-primary":""},[e._v(e._s(1===t.taskType?"个人拜访":2===t.taskType?"协访":3===t.taskType?"接待":"")+" ")])])]),a("div",{staticClass:"d-flex justify-space-between align-center my-2"},[a("span",[a("span",{staticClass:"font-14 pr-2",class:1===t.warmthNum?"color-normal":2===t.warmthNum?"color-advanced":3===t.warmthNum?"color-red":""},[e._v(e._s(t.visitUserName))]),a("span",{staticClass:"fontWeight font-14"},[e._v(e._s(t.visitUserPosition))])]),a("span",{staticClass:"tag-primary-plain"},[e._v(e._s(t.creId)+"/"+e._s(t.creName))])]),a("div",{staticClass:"gray-block pa-2"},[t.crmLabelRemarkDtoList.length?a("ul",{staticClass:"font-14 color-second px-2"},[a("li",{staticClass:"slh"},e._l(t.crmLabelRemarkDtoList,(function(t,i){return a("span",{key:i},[e._v(" "+e._s(t.labelName)+"："+e._s(t.remark)+"。 ")])})),0)]):e._e()])])}))],2)],1)],1),a("van-popup",{attrs:{position:"top","get-container":"#filterContainer"},model:{value:e.filterShow,callback:function(t){e.filterShow=t},expression:"filterShow"}},[a("div",[a("van-field",{attrs:{clickable:"",readonly:"",label:"时间范围",placeholder:"点击选择时间范围","input-align":"right"},on:{click:e.showPickerDateClick},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}),a("van-field",{attrs:{readonly:"",clickable:"",label:"事件分类",value:e.filterObj.labelName,"input-align":"right",placeholder:"点击维护事件分类"},on:{click:function(t){e.labelShow=!0}}}),e.$route.query.companyId?a("van-field",{attrs:{clearable:"",label:"业务员信息","input-align":"right",placeholder:"输入业务员ID/名称"},model:{value:e.filterObj.userIdOrName,callback:function(t){e.$set(e.filterObj,"userIdOrName",t)},expression:"filterObj.userIdOrName"}}):a("van-field",{attrs:{clearable:"",label:"客户信息","input-align":"right",placeholder:"输入客户ID/名称"},model:{value:e.filterObj.customerKeyword,callback:function(t){e.$set(e.filterObj,"customerKeyword",t)},expression:"filterObj.customerKeyword"}}),a("van-field",{attrs:{name:"radio",label:"拜访类型","input-align":"right"},scopedSlots:e._u([{key:"input",fn:function(){return[a("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.filterObj.visitType,callback:function(t){e.$set(e.filterObj,"visitType",t)},expression:"filterObj.visitType"}},[a("van-radio",{attrs:{name:"1","checked-color":"#2271F5","icon-size":"14px"}},[e._v("个人")]),a("van-radio",{attrs:{name:"2","checked-color":"#2271F5","icon-size":"14px"}},[e._v("协访")]),a("van-radio",{attrs:{name:"3","checked-color":"#2271F5","icon-size":"14px"}},[e._v("接待")])],1)]},proxy:!0}])}),a("div",{staticClass:"dropdown-opts"},[a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:e.reset}},[e._v("重置")]),a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",block:"",round:"",color:"#2271F5"},on:{click:e.filterSubmit}},[e._v("确认")])],1)],1)]),e.showPickerDate?a("van-calendar",{attrs:{"default-date":[new Date(e.filterObj.startTime),new Date(e.filterObj.endTime)],"get-container":"#app",type:"range","min-date":e.minDate,maxDate:e.maxDate,color:"#2271F5","allow-same-day":""},on:{confirm:e.onConfirmDate},model:{value:e.showPickerDate,callback:function(t){e.showPickerDate=t},expression:"showPickerDate"}}):e._e(),a("van-popup",{style:{height:"65%"},attrs:{round:"",position:"bottom"},model:{value:e.labelShow,callback:function(t){e.labelShow=t},expression:"labelShow"}},[a("van-tree-select",{attrs:{height:"100%",items:e.labelTreeList,"main-active-index":e.activeIndex},on:{"update:mainActiveIndex":function(t){e.activeIndex=t},"update:main-active-index":function(t){e.activeIndex=t}},scopedSlots:e._u([{key:"content",fn:function(){return[e.labelTreeList.length>0&&e.labelTreeList[e.activeIndex].children?a("ul",{staticClass:"labelTreeWarp"},e._l(e.labelTreeList[e.activeIndex].children,(function(t,i){return a("li",{key:i,class:e.filterObj.labelId===t.LABEL_ID?"active":"",on:{click:function(a){return e.labelTreeItemClick(t)}}},[e._v(" "+e._s(t.LABEL_NAME)+" "),e.filterObj.labelId===t.LABEL_ID?a("van-icon",{staticClass:"right",attrs:{name:"success"}}):e._e()],1)})),0):e._e(),e.labelTreeList.length>0&&0===e.labelTreeList[e.activeIndex].children.length?a("van-empty",{attrs:{description:"暂无信息"}}):e._e()]},proxy:!0}])})],1)],1)},s=[],r=a("3835"),n=a("d4ec"),l=a("bee2"),o=a("262e"),c=a("2caf"),d=(a("99af"),a("fb6a"),a("b0c0"),a("9ab4")),u=a("1b40"),b=a("437a"),f=a("53ae"),h=a("e906"),m=a("4bb5"),p=Object(m["a"])("cdp"),v=Object(m["a"])("app"),y=Object(m["a"])("crm"),O=function(e){Object(o["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(n["a"])(this,a),e=t.apply(this,arguments),e.showPickerDate=!1,e.dateRange="",e.minDate=new Date(2010,0,1),e.maxDate=new Date,e.filterObj={startTime:"",endTime:"",customerKeyword:"",visitType:"",userIdOrName:"",labelId:"",labelName:""},e.activeIndex=0,e.labelShow=!1,e}return Object(l["a"])(a,[{key:"onConfirmDate",value:function(e){var t=Object(r["a"])(e,2),a=t[0],i=t[1];this.filterObj.startTime=this.$dayjs(a).format("YYYY-MM-DD")+" 00:00:00",this.filterObj.endTime=this.$dayjs(i).format("YYYY-MM-DD")+" 23:59:59",this.showPickerDate=!1,this.dateRange="".concat(this.filterObj.startTime.slice(0,10)," 至 ").concat(this.filterObj.endTime.slice(0,10))}},{key:"showPickerDateClick",value:function(){this.showPickerDate=!0}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!1,this.dataList=[],this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.dataList=[],this.refreshing=!1),this.loading=!0,this._chashujuGetUserVisitWx()}},{key:"filterSubmit",value:function(){this.onRefresh(),this.filterShow=!1}},{key:"reset",value:function(){this.filterObj.startTime=this.queryParams.startTime,this.filterObj.endTime=this.queryParams.endTime,this.filterObj.labelId="",this.filterObj.labelName="",this.dateRange="".concat(this.filterObj.startTime.slice(0,10)," 至 ").concat(this.filterObj.endTime.slice(0,10)),this.filterObj.customerKeyword="",this.filterObj.visitType="",this.filterShow=!1,this.onRefresh()}},{key:"_chashujuGetUserVisitWx",value:function(){var e=this;Object(h["b"])({startTime:this.filterObj.startTime,endTime:this.filterObj.endTime,depId:this.queryParams.depId,userIdList:this.queryParams.userIdList,labelIdList:this.filterObj.labelId?[this.filterObj.labelId]:[],companyIdOrName:this.filterObj.customerKeyword,userIdOrName:this.filterObj.userIdOrName,taskType:this.filterObj.visitType,pageNum:this.page,pageSize:20}).then((function(t){var a=t.data.list||[];e.dataList=e.dataList.concat(a),t.data.hasNextPage?e.page++:e.finished=!0,e.loading=!1}))}},{key:"labelTreeItemClick",value:function(e){this.filterObj.labelId=e.LABEL_ID,this.filterObj.labelName=e.LABEL_NAME,this.labelShow=!1}},{key:"cardClick",value:function(e){this.SET_VISITOBJ(e),this.$router.push({name:"salesLineVisitPageDetail"})}},{key:"beforeRouteEnter",value:function(e,t,a){a((function(e){"salesLineSalesman5"!==t.name&&"salesLineSalesman5Inner"!==t.name&&"salesLineVisitPageTotal"!==t.name&&"salesLineCustomerSalesPage"!==t.name&&"salesLineCustomerSalesPage"!==t.name||(e.filterObj={startTime:e.queryParams.startTime,endTime:e.queryParams.endTime,customerKeyword:e.queryParams.companyId,visitType:"",userIdOrName:""},e.dateRange="".concat(e.filterObj.startTime.slice(0,10)," 至 ").concat(e.filterObj.endTime.slice(0,10)),e.filterActive=!0,e.onRefresh(),e.filterShow=!1)}))}},{key:"activated",value:function(){this.labelTreeList.length||this._getLabelTree({type:"1"})}},{key:"created",value:function(){this.filterObj={startTime:this.queryParams.startTime,endTime:this.queryParams.endTime,customerKeyword:this.queryParams.companyId,visitType:"",userIdOrName:this.queryParams.userIdList},this.dateRange="".concat(this.filterObj.startTime.slice(0,10)," 至 ").concat(this.filterObj.endTime.slice(0,10)),this.filterActive=!0}}]),a}(Object(u["b"])(b["a"],f["a"]));Object(d["a"])([p.Mutation],O.prototype,"SET_VISITOBJ",void 0),Object(d["a"])([v.Getter],O.prototype,"queryParams",void 0),Object(d["a"])([y.Getter],O.prototype,"labelTreeList",void 0),Object(d["a"])([y.Action],O.prototype,"_getLabelTree",void 0),O=Object(d["a"])([Object(u["a"])({})],O);var j=O,g=j,k=(a("9878d"),a("2877")),T=Object(k["a"])(g,i,s,!1,null,"b6684d2c",null);t["default"]=T.exports},"9878d":function(e,t,a){"use strict";a("1b81")}}]);