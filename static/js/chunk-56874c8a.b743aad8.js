(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56874c8a"],{"097e":function(e,t,r){"use strict";r("2768")},2768:function(e,t,r){},"3f6f":function(e,t,r){"use strict";r("f42d")},"53ae":function(e,t,r){"use strict";var a=r("d4ec"),n=r("bee2"),i=r("262e"),s=r("2caf"),o=(r("b0c0"),r("9ab4")),u=r("1b40");u["a"].registerHooks(["beforeRouteEnter"]);var c=function(e){Object(i["a"])(r,e);var t=Object(s["a"])(r);function r(){var e;return Object(a["a"])(this,r),e=t.apply(this,arguments),e.page=1,e.total=0,e.dataList=[],e.loading=!1,e.finished=!1,e.refreshing=!1,e.finishText="",e.userIdList=[],e.error=!1,e}return Object(n["a"])(r,[{key:"beforeRouteEnter",value:function(e,t,r){r((function(e){"Home"!==t.name&&"TaskIndex"!==t.name||(e.dataList=[],e.page=1,e.loading=!1,e.finished=!0,e.refreshing=!1,e.$nextTick((function(){e.finished=!1})))}))}}]),r}(u["d"]);c=Object(o["a"])([Object(u["a"])({})],c),t["a"]=c},"6e5a":function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"r",(function(){return o})),r.d(t,"d",(function(){return u})),r.d(t,"l",(function(){return c})),r.d(t,"m",(function(){return l})),r.d(t,"a",(function(){return f})),r.d(t,"i",(function(){return p})),r.d(t,"b",(function(){return h})),r.d(t,"e",(function(){return m})),r.d(t,"f",(function(){return d})),r.d(t,"k",(function(){return v})),r.d(t,"g",(function(){return y})),r.d(t,"h",(function(){return b})),r.d(t,"j",(function(){return g})),r.d(t,"n",(function(){return k})),r.d(t,"q",(function(){return w})),r.d(t,"p",(function(){return S})),r.d(t,"o",(function(){return T}));var a=r("1da1"),n=(r("99af"),r("96cf"),r("b32d")),i=r("90ae"),s=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymCustomerManager/getSzymCustomerMng",t,t.hideloading);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymCustomerManager/updSzymCustomer",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].formDataPost(i["c"],"/api/SzymCustomerManager/getSzymCustomerStaff",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].formDataPost(i["c"],"/api/SzymCustomerManager/getUserByPhoneNum",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymCustomerManager/optSzymCustomerStaff?szymCustomerId="+t.szymCustomerId,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymCustomerManager/dltSzymCustomerStaff?scStaffId="+t.scStaffId,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymUserVisit/getSzymUserVisit",t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].formDataPost(i["c"],"/api/SzymCustomer/getSzymCustomerContact",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].formDataPost(i["c"],"/api/SzymCustomer/getSzymCustomerTransport",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymProjectMng/getSzymProjectMng",t,t.loading);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymUserVisit/getSzymUserVisitStat",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymUserVisit/getSzymUserProjectVisit",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymUserVisit/getSzymUserVisiByUserProject",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].formDataPost(i["c"],"/api/SzymUserVisit/getSzymUserVisitBySuvId",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymUserVisit/optSzymUserVisit",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymUserVisit/optSzymUserVisitPic?suvId=".concat(t.suvId,"&deleteFlag=").concat(t.deleteFlag),t.list);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].post(i["c"],"/api/SzymUserVisit/optSzymUserVisitLabelRemark",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].dataPost(i["c"],"/api/SzymUserVisit/optSzymUserVisitClockIn",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ba59:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"customer-follow"},[r("van-sticky",[r("div",{staticClass:"customer-follow-sticky d-flex"},[r("div",{class:["flex-1 customer-follow-filter justify-space-between px-10",e.filterShow?"color-main-2":"",e.filterActive?"customer-follow-filter--active":""],on:{click:function(t){e.filterShow=!e.filterShow}}},[r("div",[e._v("条件筛选")]),r("van-icon",{attrs:{name:"arrow-"+(e.filterShow?"up":"down"),size:"16px"}})],1)])]),r("van-pull-refresh",{ref:"refreshList",staticClass:"my-container px-10",on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[r("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(t){e.error=t},load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.dataList,(function(t){return r("div",{key:t.suvId,staticClass:"card mb-2 pa-2",on:{click:function(r){return e.toDetail(t)}}},[r("div",{staticClass:"d-flex"},[r("div",{staticClass:"flex-5 d-flex flex-column"},[r("span",{staticClass:"font-14"},[e._v(e._s(t.customerName.split("/")[0]||""))]),t.relCustomerId?r("span",{staticClass:"color-normal"},[e._v("已关联至"+e._s(t.relCustomerId)+"/"+e._s(t.relCustomerName))]):r("span",{staticClass:"color-second"},[e._v("暂未关联至业务系统内客户")])]),r("div",{staticClass:"flex-3 d-flex flex-column align-end"},[r("div",{staticClass:"mb-1"},[e._v(e._s(t.createTime))]),r("div",{staticClass:"mb-1",class:0===t.sourceType?"tag-primary-plain":1===t.sourceType?"tag-text-plain":""},[e._v(" "+e._s(0===t.sourceType?"拓展客户":1===t.sourceType?"业务系统内客户":"")+" ")]),t.customerTypeName?r("div",{staticClass:"tag-primary-plain mb-1"},[e._v(" "+e._s(t&&t.customerTypeName)+" ")]):e._e()])]),r("div",{},[r("div",{staticClass:"font-14 py-2"},[e._v(e._s(t.visitUserName))]),t.szymLabelRemarkDOResList&&t.szymLabelRemarkDOResList.length?r("div",{staticClass:"pa-2 gray-bg d-flex justify-space-between"},[r("div",{},[e._v("已维护客情事件")]),r("div",{staticClass:"font-bold color-main-2 font-16"},[e._v(e._s(t.szymLabelRemarkDOResList.length))])]):r("div",{staticClass:"color-second gray-bg pa-2"},[e._v("暂无客情事件")])])])})),0)],1),r("van-popup",{attrs:{position:"top",round:"","get-container":".my-container"},model:{value:e.filterShow,callback:function(t){e.filterShow=t},expression:"filterShow"}},[r("filter-pop",{attrs:{labelTreeList:e.labelTreeList,customTypeList:e.customTypeList},on:{confirm:e.onConfirm}})],1),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.$route.query.userId,expression:"!$route.query.userId"}],staticClass:"commonOpButton-footer"},[r("van-button",{attrs:{round:"",color:"#2271F5",type:"primary"},on:{click:e.addClick}},[r("span",[e._v("客情新增")])])],1)],1)},n=[],i=r("1da1"),s=r("d4ec"),o=r("bee2"),u=r("262e"),c=r("2caf"),l=(r("99af"),r("d3b7"),r("d81d"),r("b0c0"),r("96cf"),r("9ab4")),f=r("1b40"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("van-form",[r("van-field",{attrs:{clickable:"",readonly:"",label:"时间范围",placeholder:"点击选择时间范围","input-align":"right"},on:{click:e.showPickerDateClick},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}),r("van-field",{attrs:{readonly:"",clickable:"",label:"事件分类",value:e.remarkName,"input-align":"right",placeholder:"点击选择事件分类"},on:{click:function(t){e.labelShow=!0}}}),r("van-field",{attrs:{readonly:"",clickable:"",value:e.relObj.name,label:"标签/关联","input-align":"right",placeholder:"点击选择"},on:{click:function(t){return e.chooseFilter(2)}}}),r("van-field",{attrs:{name:"radio",required:"",label:"拜访类型","input-align":"right"},scopedSlots:e._u([{key:"input",fn:function(){return[r("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.taskType,callback:function(t){e.taskType=t},expression:"taskType"}},[r("van-radio",{attrs:{name:"1","checked-color":"#2271F5","icon-size":"14px"}},[e._v("个人")]),r("van-radio",{attrs:{name:"2","checked-color":"#2271F5","icon-size":"14px"}},[e._v("协访")]),r("van-radio",{attrs:{name:"3","checked-color":"#2271F5","icon-size":"14px"}},[e._v("接待")])],1)]},proxy:!0}])}),r("van-field",{attrs:{readonly:"",clearable:"",label:"客户信息","input-align":"right",placeholder:"点击选择客户信息"},on:{click:e.objChangeClick},model:{value:e.customerName,callback:function(t){e.customerName=t},expression:"customerName"}}),r("van-field",{attrs:{readonly:"",clearable:"",label:"客户职员","input-align":"right",placeholder:"点击选择客户职员"},on:{click:e.staffMemberClick},model:{value:e.visitUserName,callback:function(t){e.visitUserName=t},expression:"visitUserName"}})],1),r("div",{staticClass:"dropdown-opts"},[r("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:e.reset}},[e._v("重置")]),r("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",block:"",round:"",color:"#2271F5"},on:{click:e.onConfirm}},[e._v("确认")])],1),2===e.actionType?r("van-action-sheet",{attrs:{actions:e.relOptions,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onSelectRel},model:{value:e.actionShow,callback:function(t){e.actionShow=t},expression:"actionShow"}}):e._e(),e.showPickerDate?r("van-calendar",{attrs:{"get-container":"#app","default-date":e.dateRangeValue,type:"range","min-date":e.minDate,maxDate:e.maxDate,color:"#2271F5","allow-same-day":""},on:{confirm:e.onConfirmDate},model:{value:e.showPickerDate,callback:function(t){e.showPickerDate=t},expression:"showPickerDate"}}):e._e(),r("van-action-sheet",{attrs:{actions:e.labelTreeList,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onSelectLabel},model:{value:e.labelShow,callback:function(t){e.labelShow=t},expression:"labelShow"}}),r("van-popup",{style:{width:"100%",height:"85%"},attrs:{closeable:"",position:"bottom",round:""},model:{value:e.objShowPicker,callback:function(t){e.objShowPicker=t},expression:"objShowPicker"}},[r("div",{staticClass:"font-16 fontWeight-500 textAlignC pt-4 pb-2"},[e._v("客户信息")]),r("van-tabs",{attrs:{color:"#3561f2"},on:{change:e.onRefresh},model:{value:e.sourceTypeTab,callback:function(t){e.sourceTypeTab=t},expression:"sourceTypeTab"}},e._l(["拓展客户","系统内客户"],(function(e,t){return r("van-tab",{key:t,attrs:{title:e}})})),1),r("van-search",{attrs:{placeholder:"搜索","input-align":"center"},on:{input:e.objSearch},model:{value:e.objSearchValue,callback:function(t){e.objSearchValue=t},expression:"objSearchValue"}}),r("div",{staticClass:"popupWarp overflow-auto"},[e.loading||e.custlistOptions.length?e._e():r("app-empty",{staticClass:"pb-6",attrs:{description:"暂无数据"}}),r("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[r("van-list",{attrs:{offset:"20",finished:e.finished},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[r("van-cell-group",e._l(e.custlistOptions,(function(t,a){return r("van-cell",{key:a,attrs:{clickable:""},on:{click:function(r){return e.changeCust(t)}},scopedSlots:e._u([{key:"default",fn:function(){return[r("div",[e._v(e._s(t.szymCustomerId+"/")+e._s(t.customerName))])]},proxy:!0}],null,!0)})})),1)],1)],1)],1)],1),r("van-popup",{style:{width:"100%",height:"80%"},attrs:{closeable:"",position:"bottom",round:""},on:{close:function(t){e.staffMemberShow=!1}},model:{value:e.staffMemberShow,callback:function(t){e.staffMemberShow=t},expression:"staffMemberShow"}},[r("div",{staticClass:"font-16 fontWeight-500 textAlignC pt-4 pb-2"},[e._v("职员信息选择")]),r("van-search",{attrs:{placeholder:"搜索","input-align":"center"},model:{value:e.staffMemberValue,callback:function(t){e.staffMemberValue=t},expression:"staffMemberValue"}}),r("div",{staticClass:"staffMember-popupWarp overflow-auto"},[r("van-radio-group",{model:{value:e.visitUserId,callback:function(t){e.visitUserId=t},expression:"visitUserId"}},[r("van-cell-group",[e._l(e.userListOptions.filter((function(t){return-1!==(t.userName||t.userId).indexOf(e.staffMemberValue)})),(function(t,a){return r("van-cell",{key:a,attrs:{clickable:""},on:{click:function(r){return e.staffMemberChange(t)}},scopedSlots:e._u([{key:"title",fn:function(){return[r("span",{staticClass:"visitUserName",style:e.visitUserId===t.userId?"color: #2271f5;":""},[e._v(e._s(t.userName))]),r("span",{style:e.visitUserId===t.userId?"color: #2271f5;":""},[e._v(e._s(t.phoneNum))])]},proxy:!0},{key:"right-icon",fn:function(){return[r("van-radio",{attrs:{name:t.userId}})]},proxy:!0}],null,!0)})})),r("van-empty",{directives:[{name:"show",rawName:"v-show",value:!e.userListOptions.filter((function(t){return-1!==(t.userName||t.userId).indexOf(e.staffMemberValue)})).length,expression:"\n              !userListOptions.filter(ele => (ele.userName || ele.userId).indexOf(staffMemberValue) !== -1).length\n            "}],attrs:{description:"暂无职员信息"}})],2)],1)],1)],1)],1)},h=[],m=r("3835"),d=(r("7db0"),r("ac1f"),r("1276"),r("53ae")),v=r("6e5a"),y=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(s["a"])(this,r),e=t.apply(this,arguments),e.taskType="",e.startTime="",e.endTime="",e.dateRange="",e.dateRangeValue=[],e.showPickerDate=!1,e.minDate=new Date(2020,0,1),e.maxDate=new Date,e.remarkId="",e.remarkName="",e.labelShow=!1,e.activeIndex=0,e.relOptions=[{name:"拓展客户-已关联",value:"0-1"},{name:"拓展客户-暂未关联",value:"0-0"},{name:"业务系统内客户",value:"1"}],e.customerName="",e.customerId="",e.objShowPicker=!1,e.sourceTypeTab=0,e.custlistOptions=[],e.objSearchValue="",e.userListOptions=[],e.staffMemberShow=!1,e.visitUserId="",e.visitUserName="",e.staffMemberValue="",e.actionShow=!1,e.actionType=0,e.customerObj={},e.relObj={},e.keywords="",e}return Object(o["a"])(r,[{key:"showPickerDateClick",value:function(){this.showPickerDate=!0}},{key:"onConfirmDate",value:function(e){var t=Object(m["a"])(e,2),r=t[0],a=t[1];this.startTime=this.$dayjs(r).format("YYYY-MM-DD"),this.endTime=this.$dayjs(a).format("YYYY-MM-DD"),this.showPickerDate=!1,this.dateRange="".concat(this.startTime," 至 ").concat(this.endTime)}},{key:"onSelectLabel",value:function(e){this.labelShow=!1,this.remarkId=e.value,this.remarkName=e.name}},{key:"chooseFilter",value:function(e){this.actionShow=!0,this.actionType=e}},{key:"onSelectCustomType",value:function(e){this.customerObj=e}},{key:"onSelectRel",value:function(e){this.relObj=e}},{key:"objSearch",value:function(e){this.page=1,this.custlistOptions=[],e?this.onLoad():this.onRefresh()}},{key:"objChangeClick",value:function(){this.objShowPicker=!0,this.custlistOptions=[],this.objSearchValue="",this.onRefresh()}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.custlistOptions=[],this.refreshing=!1),this.loading=!0,this._getSzymCustomerMng()}},{key:"_getSzymCustomerMng",value:function(){var e=this;1===this.page&&(this.custlistOptions=[]);var t={selectType:0,userIdList:[],sourceType:this.sourceTypeTab,customerType:"",relStatus:"",keyword:this.objSearchValue,pageSize:10,pageNum:this.page};Object(v["c"])(t).then((function(t){"200"===t.code?(e.custlistOptions=e.custlistOptions.concat(t.data.list),t.hasNextPage?e.page++:e.finished=!0,e.loading=!1):e.custlistOptions=[]}))}},{key:"changeCust",value:function(e){var t=this;this.objShowPicker=!1,this.customerId=e.szymCustomerId,this.customerName=e.customerName,this.userListOptions=[];var r=this.custlistOptions.find((function(e){return e.szymCustomerId===t.customerId}));this.getSzymCustomerStaff(r.szymCustomerId,r.customerStaffNum)}},{key:"getSzymCustomerStaff",value:function(e,t){var r=this;Object(v["d"])({szymCustomerId:e,pageNum:1,pageSize:t}).then((function(e){"200"===e.code&&(r.userListOptions=e.data.list)}))}},{key:"staffMemberClick",value:function(){this.customerId?this.staffMemberShow=!0:this.$toast.fail("请先选择单位信息")}},{key:"staffMemberChange",value:function(e){this.visitUserId=e.userId,this.visitUserName=e.userName,this.staffMemberShow=!1}},{key:"reset",value:function(){this.startTime="",this.endTime="",this.customerId="",this.customerName="",this.visitUserId="",this.visitUserName="",this.remarkId="",this.remarkName="",this.taskType="",this.relObj={},this.customerObj={};var e={startTime:this.startTime,endTime:this.endTime,szymCustomerId:this.customerId,visitUserId:this.visitUserId,remarkId:this.remarkId,taskType:this.taskType,sourceType:this.relObj.value&&this.relObj.value.split("-")[0]||"",customerType:this.customerObj.value||"",relStatus:this.relObj.value&&this.relObj.value.split("-")[1]||""};this.$emit("confirm",e)}},{key:"onConfirm",value:function(){var e={startTime:this.startTime,endTime:this.endTime,szymCustomerId:this.customerId,visitUserId:this.visitUserId,remarkId:this.remarkId,taskType:this.taskType,sourceType:this.relObj.value&&this.relObj.value.split("-")[0]||"",customerType:this.customerObj.value||"",relStatus:this.relObj.value&&this.relObj.value.split("-")[1]||""};this.$emit("confirm",e)}}]),r}(Object(f["b"])(d["a"]));Object(l["a"])([Object(f["c"])({type:Array,default:[]})],y.prototype,"labelTreeList",void 0),Object(l["a"])([Object(f["c"])({type:Array,default:[]})],y.prototype,"customTypeList",void 0),y=Object(l["a"])([Object(f["a"])({})],y);var b=y,g=b,k=(r("3f6f"),r("2877")),w=Object(k["a"])(g,p,h,!1,null,"79c21397",null),S=w.exports,T=r("f727"),O=r("4bb5"),j=Object(O["a"])("crm"),x=Object(O["a"])("app"),C=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(s["a"])(this,r),e=t.apply(this,arguments),e.labelTreeList=[],e.filterActive=!1,e.filterShow=!1,e.selectType=0,e.filterData={dateValue:[],followType:"",unitObj:"",unitPerson:"",labelIdList:[],sourceType:"",relStatus:""},e}return Object(o["a"])(r,[{key:"onConfirm",value:function(e){this.filterData={dateValue:e.startTime?[e.startTime,e.endTime]:[],followType:e.taskType,unitObj:e.szymCustomerId,unitPerson:e.visitUserId,labelIdList:e.remarkId?[e.remarkId]:[],sourceType:e.sourceType,relStatus:e.relStatus},this.filterData.dateValue.length>0||this.filterData.followType||this.filterData.unitObj||this.filterData.unitPerson||this.filterData.labelIdList.length>0||this.filterData.sourceType||this.filterData.relStatus?this.filterActive=!0:this.filterActive=!1,this.filterShow=!1,this.onRefresh()}},{key:"toDetail",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.SET_DETAILINFOR(t),this.SET_HADDONEONDETAIL(!1),this.$router.push({name:"medicalCustomerFollowDetail",query:{userId:this.$route.query.userId,projectId:this.$route.query.projectId}});case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!1,this.dataList=[],this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.dataList=[],this.refreshing=!1),this.loading=!0,this.$route.query.userId?this._getSzymUserVisiByUserProject():this._getSzymUserVisit()}},{key:"_getSzymUserVisit",value:function(){var e=this;1===this.page&&(this.dataList=[]),this.loading=!0,Object(v["i"])({selectType:this.selectType,userIdList:[],labelIdList:this.filterData.labelIdList,startTime:this.filterData.dateValue[0]?this.filterData.dateValue[0]+" 00:00:00":"",endTime:this.filterData.dateValue[1]?this.filterData.dateValue[1]+" 23:59:59":"",taskType:this.filterData.followType,szymCustomerId:this.filterData.unitObj,keyword:this.filterData.unitPerson,sourceType:this.filterData.sourceType,relStatus:this.filterData.relStatus,pageNum:this.page,pageSize:10}).then((function(t){e.loading=!1,e.refreshing=!1,t.success?(e.loading=!1,e.dataList=e.dataList.concat(t.data.list),e.page++,e.finished=!t.data.hasNextPage):e.error=!0}))}},{key:"_getSzymUserVisiByUserProject",value:function(){var e=this;this.dataList=[],this.loading=!0,Object(v["h"])({selectType:3,userId:this.$route.query.userId,projectId:this.$route.query.projectId,userIdList:[],labelIdList:this.filterData.labelIdList,startTime:this.filterData.dateValue[0]?this.filterData.dateValue[0]+" 00:00:00":"",endTime:this.filterData.dateValue[1]?this.filterData.dateValue[1]+" 23:59:59":"",taskType:this.filterData.followType,szymCustomerId:this.filterData.unitObj,keyword:this.filterData.unitPerson,sourceType:this.filterData.sourceType,relStatus:this.filterData.relStatus}).then((function(t){t.success?(e.loading=!1,e.dataList=t.data,e.refreshing=!1,e.finished=!0):e.error=!0}))}},{key:"refreshData",value:function(){var e=this;this.filterActive=!1,this.dataList=[],this.page=1,this.finished=!1,this.loading=!1;var t=this.$refs.refreshList;t&&(this.onLoad(),this.customTypeList.length||this.getTypeList(67).then((function(t){e.SET_CUSTOMTYPELIST(t)})))}},{key:"addClick",value:function(){this.$router.push({name:"medicalCustomerFollowAdd"})}},{key:"mounted",value:function(){var e=this,t=JSON.parse(localStorage.getItem("webCRMPermissions")||"");this.selectType=t.some((function(e){return"szymVisit-query-all"===e||"szymVisit-query-entry"===e||"szymVisit-query-dept"===e}))?"":0,this.getTypeList(73).then((function(t){e.labelTreeList=t})),this.customTypeList.length||this.getTypeList(67).then((function(t){e.SET_CUSTOMTYPELIST(t)}))}},{key:"activated",value:function(){this.hadDoneOnDetail&&this.onRefresh()}},{key:"getTypeList",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={},r={full:!0,pageNum:1,pageSize:1e5,usestatus:1,typeId:t},e.next=4,Object(T["d"])(r);case 4:return a=e.sent,n=a.data.list.map((function(e){var t=e.DIC_SELECT_ID,r=e.DIC_SELECT_NAME;return{value:t,name:r}})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"beforeRouteEnter",value:function(e,t,r){r((function(e){if("CrmIndex"===t.name||"medicalVisitRecord"===t.name||"Home"===t.name){e.filterData.dateValue="",e.filterData.followType="",e.filterData.unitObj="",e.filterData.unitPerson="",e.filterData.labelIdList=[],e.filterData.sourceType="",e.filterData.relStatus="",e.filterActive=!1;var r=JSON.parse(localStorage.getItem("webCRMPermissions")||"");e.selectType=r.some((function(e){return"szymVisit-query-all"===e||"szymVisit-query-entry"===e||"szymVisit-query-dept"===e}))?"":0,e.refreshData()}}))}}]),r}(Object(f["b"])(d["a"]));Object(l["a"])([j.Getter],C.prototype,"customTypeList",void 0),Object(l["a"])([x.Getter],C.prototype,"hadDoneOnDetail",void 0),Object(l["a"])([x.Mutation],C.prototype,"SET_DETAILINFOR",void 0),Object(l["a"])([x.Mutation],C.prototype,"SET_HADDONEONDETAIL",void 0),Object(l["a"])([j.Mutation],C.prototype,"SET_CUSTOMTYPELIST",void 0),C=Object(l["a"])([Object(f["a"])({components:{FilterPop:S}})],C);var I=C,D=I,z=(r("097e"),Object(k["a"])(D,a,n,!1,null,"004b6218",null));t["default"]=z.exports},f42d:function(e,t,r){}}]);