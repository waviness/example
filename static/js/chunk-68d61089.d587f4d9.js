(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68d61089"],{"418e":function(e,t,i){"use strict";i.d(t,"d",(function(){return o})),i.d(t,"b",(function(){return s})),i.d(t,"e",(function(){return d})),i.d(t,"a",(function(){return c})),i.d(t,"f",(function(){return l})),i.d(t,"c",(function(){return u}));var a=i("1da1"),n=(i("96cf"),i("90ae")),r=i("b32d"),o=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(n["c"],"/api/WeeklyReport/getReportDtl",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(n["c"],"/api/WeeklyReport/generateReport",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(n["c"],"/api/WeeklyReport/insOrUpdReport",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(n["c"],"/api/WeeklyReport/dltReport",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(n["c"],"/api/WeeklyReport/submitReport",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].post(n["c"],"/api/UserDep/getLeader",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},"4a8d":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"add"},[i("div",{staticClass:"add-header font-14 pt-10 pl-10 pb-4"},[e._v("周报新增")]),i("div",{staticClass:"add-content"},[i("van-form",[e._l(e.addList,(function(t,a){return i("div",{key:"addItem"+a,staticClass:"addWarp mb-2"},[i("van-swipe-cell",{scopedSlots:e._u([{key:"right",fn:function(){return[i("van-button",{staticClass:"delete-button",attrs:{square:"",text:"删除",type:"danger"},on:{click:function(t){return e.deleteItem(a)}}})]},proxy:!0}],null,!0)},[i("van-field",{attrs:{readonly:"",required:"",name:"labelType",rules:[{required:!0}],label:"周报标签分类","input-align":"right",placeholder:"点击选择分类"},nativeOn:{click:function(t){e.addOpIndex=a,e.labelShow=!0}},model:{value:t.labelTypeText,callback:function(i){e.$set(t,"labelTypeText",i)},expression:"addItem.labelTypeText"}}),10041===+t.labelTypeId?i("van-field",{attrs:{name:"exceptTimeStr",autosize:"","input-align":"right",label:"预期时间",placeholder:"请输入预期时间"},model:{value:t.exceptTimeStr,callback:function(i){e.$set(t,"exceptTimeStr",i)},expression:"addItem.exceptTimeStr"}}):e._e(),10070!==t.labelTypeId&&10074!==t.labelTypeId?i("van-field",{attrs:{readonly:"",required:"",name:"objType","input-align":"right",rules:[{required:!0}],label:"单位类型",placeholder:"点击选择单位类型"},on:{click:function(t){e.addOpIndex=a,e.objTypeShowPicker=!0}},model:{value:t.objTypeText,callback:function(i){e.$set(t,"objTypeText",i)},expression:"addItem.objTypeText"}}):e._e(),10070!==t.labelTypeId&&10074!==t.labelTypeId?i("van-field",{attrs:{readonly:"",required:"",name:"objName",rules:[{required:!0}],label:"单位信息","input-align":"right",placeholder:"点击选择单位信息"},on:{click:function(t){e.addOpIndex=a,e.objChangeClick()}},model:{value:t.objName,callback:function(i){e.$set(t,"objName",i)},expression:"addItem.objName"}}):e._e(),10070===t.labelTypeId?i("van-field",{attrs:{readonly:"",required:"",rules:[{required:!0}],value:t.objName,"input-align":"right",placeholder:"请选择任务类型",label:"任务类型"},on:{click:function(t){e.addOpIndex=a,e.labelShowPicker=!0}}}):e._e(),10074===t.labelTypeId?i("van-field",{attrs:{readonly:"",required:"",rules:[{required:!0}],value:t.objName,"input-align":"right",placeholder:"请选择任务类型",label:"任务类型"},on:{click:function(t){e.addOpIndex=a,e.labelShowPicker1=!0}}}):e._e(),i("van-field",{attrs:{type:"textarea",rows:"3",name:"labelRemark",autosize:"","input-align":"right",label:"备注",placeholder:"请输入备注"},model:{value:t.labelRemark,callback:function(i){e.$set(t,"labelRemark",i)},expression:"addItem.labelRemark"}})],1)],1)})),i("div",{staticClass:"commonButton-footer d-flex justify-center"},[i("van-button",{attrs:{size:"small",round:"",plain:""},on:{click:e.cancelClick}},[e._v("取消")]),i("van-button",{attrs:{size:"small",color:"#2271F5",type:"info",round:""},on:{click:e.onSubmit}},[e._v("暂存")])],1)],2)],1),i("div",{staticClass:"add-Click textAlignC mt-2"},[i("icon-svg",{attrs:{name:"ytcrm-tianjia",color:"#2271F5",size:"width:30px;height:30px;"},nativeOn:{click:function(t){return e.addListClick.apply(null,arguments)}}})],1),i("van-popup",{style:{height:"65%"},attrs:{round:"",position:"bottom"},model:{value:e.labelShow,callback:function(t){e.labelShow=t},expression:"labelShow"}},[i("van-tree-select",{attrs:{height:"100%",items:e.labelTreeList,"active-id":e.activeId,"main-active-index":e.activeIndex},on:{"click-item":e.clickLabelItem,"click-nav":e.clickLabelNav,"update:activeId":function(t){e.activeId=t},"update:active-id":function(t){e.activeId=t},"update:mainActiveIndex":function(t){e.activeIndex=t},"update:main-active-index":function(t){e.activeIndex=t}}})],1),i("van-action-sheet",{attrs:{actions:e.needOptions,"cancel-text":"取消",description:"任务类型选择","close-on-click-action":""},on:{select:e.labelTypeSelect},model:{value:e.labelShowPicker,callback:function(t){e.labelShowPicker=t},expression:"labelShowPicker"}}),i("van-action-sheet",{attrs:{actions:e.needOptions1,"cancel-text":"取消",description:"任务类型选择","close-on-click-action":""},on:{select:e.labelTypeSelect},model:{value:e.labelShowPicker1,callback:function(t){e.labelShowPicker1=t},expression:"labelShowPicker1"}}),i("van-action-sheet",{attrs:{actions:e.objTypeActions,"cancel-text":"取消",description:"单位类型选择","close-on-click-action":""},on:{select:e.objTypeSelect},model:{value:e.objTypeShowPicker,callback:function(t){e.objTypeShowPicker=t},expression:"objTypeShowPicker"}}),i("van-popup",{style:{width:"100%",height:"85%"},attrs:{closeable:"",position:"bottom",round:""},model:{value:e.objShowPicker,callback:function(t){e.objShowPicker=t},expression:"objShowPicker"}},[i("div",{staticClass:"font-16 fontWeight-500 textAlignC pt-4 pb-2"},[e._v("单位信息")]),i("van-search",{attrs:{placeholder:"搜索","input-align":"center"},on:{input:e.objSearch},model:{value:e.objSearchValue,callback:function(t){e.objSearchValue=t},expression:"objSearchValue"}}),i("div",{staticClass:"popupWarp overflow-auto"},[i("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[i("van-list",{attrs:{offset:"20",finished:e.finished,"finished-text":e.finishText},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[e.addList[e.addOpIndex]&&2===e.addList[e.addOpIndex].objTypeId?i("van-cell-group",[e.loading||0!==e.custlistOptions.length?e._e():i("app-empty",{attrs:{description:"暂无数据"}}),e._l(e.custlistOptions,(function(t,a){return i("van-cell",{key:a,attrs:{clickable:""},on:{click:function(i){return e.changeCust(t)}},scopedSlots:e._u([{key:"default",fn:function(){return[i("div",[e._v(e._s(t.custId+"/")+e._s(t.custName))])]},proxy:!0}],null,!0)})}))],2):e._e(),e.addList[e.addOpIndex]&&1===e.addList[e.addOpIndex].objTypeId?i("van-cell-group",e._l(e.providerInforOptions,(function(t,a){return i("van-cell",{key:a,attrs:{clickable:"",title:t.cpiId+"/"+t.providerName},on:{click:function(i){return e.changeProvider(t)}}})})),1):e._e(),e.addList[e.addOpIndex]&&3===e.addList[e.addOpIndex].objTypeId?i("van-cell-group",e._l(e.goverListOptions,(function(t,a){return i("van-cell",{key:a,attrs:{clickable:"",title:t.govAttributeId+"/"+t.govAttributeName+"("+t.orgnizationName+") --- "+t.ssqCodeName},on:{click:function(i){return e.changeGover(t)}}})})),1):e._e()],1)],1)],1)],1)],1)},n=[],r=i("2909"),o=i("1da1"),s=i("5530"),d=i("d4ec"),c=i("bee2"),l=i("262e"),u=i("2caf"),p=(i("96cf"),i("b0c0"),i("d3b7"),i("4de4"),i("7db0"),i("d81d"),i("99af"),i("a434"),i("9ab4")),h=i("1b40"),b=i("f727"),f=i("53ae"),v=i("e906"),m=i("418e"),y=i("4bb5"),I=Object(y["a"])("crm"),k={firstLabelTypeId:"",firstLabelTypeName:"",labelTypeId:"",labelTypeText:"",exceptTimeStr:"",objTypeId:"",objTypeText:"",objId:"",objName:"",labelRemark:""},g=function(e){Object(l["a"])(i,e);var t=Object(u["a"])(i);function i(){var e;return Object(d["a"])(this,i),e=t.apply(this,arguments),e.needOptions=[{name:"客户拜访",id:10052},{name:"品种进院",id:10051},{name:"厂家协同",id:10050},{name:"货款催收",id:10049},{name:"其他事务",id:10048}],e.needOptions1=[{name:"市场调研",id:10063},{name:"区域开发",id:10052},{name:"部门交办",id:10064}],e.addList=[Object(s["a"])({},k)],e.addOpIndex=0,e.labelShow=!1,e.activeId=-1,e.activeIndex=0,e.labelTreeList=[],e.objTypeActions=[{name:"下游客户",typeNum:1,id:2},{name:"政府单位",typeNum:34,id:3},{name:"供应商",typeNum:11,id:1}],e.objTypeShowPicker=!1,e.objShowPicker=!1,e.objSearchValue="",e.custlistOptions=[],e.goverListOptions=[],e.providerInforOptions=[],e.labelShowPicker=!1,e.labelShowPicker1=!1,e}return Object(c["a"])(i,[{key:"objTypeSelect",value:function(e){var t=this;this.addList[this.addOpIndex].objTypeId!==e.id&&this.addList[this.addOpIndex].objId?this.$dialog.confirm({title:"提示",message:"切换单位类型将清空已有单位信息，确定要切换吗？",confirmButtonColor:"#2271f5",beforeClose:function(i,a){"confirm"===i?(t.addList[t.addOpIndex].objTypeId=e.id,t.addList[t.addOpIndex].objTypeText=e.name,t.addList[t.addOpIndex].objId="",t.addList[t.addOpIndex].objName="",a()):a()}}):(this.addList[this.addOpIndex].objTypeId=e.id,this.addList[this.addOpIndex].objTypeText=e.name)}},{key:"labelTypeSelect",value:function(e){this.addList[this.addOpIndex].objId=e.id,this.addList[this.addOpIndex].objName=e.name}},{key:"addClose",value:function(){this.$emit("addClose")}},{key:"onSubmit",value:function(){this.addList.some((function(e){return!e.objId||!e.labelTypeId}))||this.addSubmit(this.addList)}},{key:"addSubmit",value:function(e){var t=this,i=[];e.filter((function(e){i.push({tableType:10070===e.labelTypeId||10074===e.labelTypeId?4:3,cwrdocId:t.$route.query.cwrdocId,exceptTimeStr:e.exceptTimeStr,labelRemark:e.labelRemark,objId:e.objId,objName:e.objName,objType:e.objTypeId,firstClassType:e.firstLabelTypeId,firstClassName:e.firstLabelTypeName,secondClassType:e.labelTypeId,secondClassTypeName:e.labelTypeText})})),this._insOrUpdReport(i)}},{key:"_insOrUpdReport",value:function(e){var t=this;Object(m["e"])(e).then((function(e){"200"===e.code&&(t.$toast({type:"success",message:e.msg}),t.$router.go(-1),t.SET_DATACHANGEOP("add"))}))}},{key:"cancelClick",value:function(){this.$router.go(-1)}},{key:"clickLabelNav",value:function(e){var t=this.labelTreeList.find((function(t){return+t.id===+e+1}));this.addList[this.addOpIndex].firstLabelTypeId=t.id,this.addList[this.addOpIndex].firstLabelTypeName=t.text}},{key:"clickLabelItem",value:function(e){this.addList[this.addOpIndex].labelTypeId=e.id,this.addList[this.addOpIndex].labelTypeText=e.text,10070===e.id&&(this.addList[this.addOpIndex].objTypeId=5),10074===e.id&&(this.addList[this.addOpIndex].objTypeId=5),this.labelShow=!1}},{key:"_getLabelTree",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={type:"0"},e.next=3,Object(b["e"])(t);case 3:i=e.sent,this.labelTreeList=i.data.map((function(e){var t=[];return e.CHILD_LIST.length&&(t=e.CHILD_LIST.map((function(e){return{id:e.LABEL_ID,text:e.LABEL_NAME}}))),{id:e.LABEL_ID,text:e.LABEL_NAME,children:Object(r["a"])(t)}})),this.addList[this.addOpIndex].firstLabelTypeId=this.labelTreeList[0].id,this.addList[this.addOpIndex].firstLabelTypeName=this.labelTreeList[0].text;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"objSearch",value:function(e){this.page=1,this.providerInforOptions=[],this.custlistOptions=[],e?this.onLoad():this.onRefresh()}},{key:"onRefresh",value:function(){this.finished=!1,this.objSearchValue="",this.loading=!0,this.page=1,this.onLoad()}},{key:"onLoad",value:function(){var e=this;this.refreshing&&(this.page=1,this.providerInforOptions=[],this.custlistOptions=[],this.goverListOptions=[],this.refreshing=!1),1===this.addList[this.addOpIndex].objTypeId?(this.loading=!0,this._queryProviderForVisit().then((function(t){t.hasNextPage?e.page++:e.finished=!0,e.loading=!1}))):2===this.addList[this.addOpIndex].objTypeId?(this.loading=!0,this._queryCustListByUserId().then((function(t){t.hasNextPage?e.page++:e.finished=!0,e.loading=!1}))):3===this.addList[this.addOpIndex].objTypeId&&(this.loading=!0,this._getGoverList())}},{key:"_queryCustListByUserId",value:function(){var e=this;1===this.page&&(this.providerInforOptions=[]);var t={pageNum:this.page,pageSize:10,cust:this.objSearchValue,type:1};return new Promise((function(i){Object(v["i"])(t).then((function(t){"200"===t.code&&(e.custlistOptions=e.custlistOptions.length>0?e.custlistOptions.concat(t.data.list):t.data.list,i(t.data))}))}))}},{key:"_queryProviderForVisit",value:function(){var e=this;1===this.page&&(this.providerInforOptions=[]);var t={providerNameOrId:this.objSearchValue,useridList:[],pageSize:10,pageNum:this.page};return new Promise((function(i){Object(v["m"])(t).then((function(t){"200"===t.code&&(e.providerInforOptions=e.providerInforOptions.length>0?e.providerInforOptions.concat(t.data.list):t.data.list,i(t.data))}))}))}},{key:"_getGoverList",value:function(){var e=this,t={orgnizationKeyword:this.objSearchValue};Object(v["j"])(t).then((function(t){"200"===t.code&&(e.goverListOptions=t.data),e.finished=!0,e.loading=!1}))}},{key:"objChangeClick",value:function(){this.addList[this.addOpIndex].objTypeId?(this.custlistOptions=[],this.goverListOptions=[],this.providerInforOptions=[],this.objSearchValue="",this.onRefresh(),this.objShowPicker=!0):this.$toast.fail("请先选择单位类型")}},{key:"changeCust",value:function(e){this.addList[this.addOpIndex].objId=e.custId,this.addList[this.addOpIndex].objName=e.custName,this.objShowPicker=!1}},{key:"changeProvider",value:function(e){this.addList[this.addOpIndex].objId=e.cpiId,this.addList[this.addOpIndex].objName=e.providerName,this.objShowPicker=!1}},{key:"changeGover",value:function(e){this.addList[this.addOpIndex].objId=e.cgId,this.addList[this.addOpIndex].objName=e.govAttributeId+"/"+e.govAttributeName+"("+e.orgnizationName+")",this.objShowPicker=!1}},{key:"addListClick",value:function(){k.firstLabelTypeId=this.labelTreeList[0].id,k.firstLabelTypeName=this.labelTreeList[0].text,this.addList.push(Object(s["a"])({},k))}},{key:"deleteItem",value:function(e){var t=this;this.$dialog.confirm({title:"提示",message:"确定删除当前新增信息？",confirmButtonColor:"#2271f5",beforeClose:function(i,a){"confirm"===i?(t.addList.splice(e,1),a()):a()}})}},{key:"mounted",value:function(){this._getLabelTree()}}]),i}(Object(h["b"])(f["a"]));Object(p["a"])([I.Mutation],g.prototype,"SET_DATACHANGEOP",void 0),g=Object(p["a"])([Object(h["a"])({})],g);var x=g,j=x,O=(i("fd73"),i("2877")),T=Object(O["a"])(j,a,n,!1,null,"4c9b85ff",null);t["default"]=T.exports},"53ae":function(e,t,i){"use strict";var a=i("d4ec"),n=i("bee2"),r=i("262e"),o=i("2caf"),s=(i("b0c0"),i("9ab4")),d=i("1b40");d["a"].registerHooks(["beforeRouteEnter"]);var c=function(e){Object(r["a"])(i,e);var t=Object(o["a"])(i);function i(){var e;return Object(a["a"])(this,i),e=t.apply(this,arguments),e.page=1,e.total=0,e.dataList=[],e.loading=!1,e.finished=!1,e.refreshing=!1,e.finishText="",e.userIdList=[],e.error=!1,e}return Object(n["a"])(i,[{key:"beforeRouteEnter",value:function(e,t,i){i((function(e){"Home"!==t.name&&"TaskIndex"!==t.name||(e.dataList=[],e.page=1,e.loading=!1,e.finished=!0,e.refreshing=!1,e.$nextTick((function(){e.finished=!1})))}))}}]),i}(d["d"]);c=Object(s["a"])([Object(d["a"])({})],c),t["a"]=c},"623b":function(e,t,i){},fd73:function(e,t,i){"use strict";i("623b")}}]);