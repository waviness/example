(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-021be89d"],{"08de":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("van-popup",{staticClass:"full-height d-flex flex-column",attrs:{position:"top"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("van-search",{attrs:{placeholder:"搜索","input-align":"center"},on:{input:e.onInput},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),e.keywords?i("div",{staticClass:"flex-1 overflow-y-auto"},[e.isSelect&&e.searchList.length?i("van-checkbox-group",{ref:"checkboxGroup",model:{value:e.checkedIdList,callback:function(t){e.checkedIdList=t},expression:"checkedIdList"}},e._l(e.searchList,(function(t,s){return i("van-checkbox",{key:s,staticClass:"font-14 font-bold mx-4 my-3",attrs:{"icon-size":"16px","checked-color":"#2271F5",name:t.userId}},[e._v(e._s(t.userName))])})),1):e._e(),!e.isSelect&&e.userDataList.length?i("van-radio-group",{model:{value:e.checkedId,callback:function(t){e.checkedId=t},expression:"checkedId"}},e._l(e.searchList,(function(t){return i("van-radio",{key:t.userId,ref:"checkboxes",refInFor:!0,staticClass:"font-14 font-bold mt-6",attrs:{"icon-size":"16px","checked-color":"#2271F5",name:t.userId}},[e._v(e._s(t.userName))])})),1):e._e(),e.searchList.length||e.loading?e._e():i("app-empty",{staticClass:"mt-7",attrs:{description:"暂无人员"}}),i("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{type:"spinner",color:"#2271F5"}})],1):[i("div",{staticClass:"font-14 color-main-2 px-4 py-1 tree-shadow"},e._l(e.breadList,(function(t,s){return i("span",{key:t.depId,on:{click:function(i){return e.changeBread(t,s)}}},[e._v(e._s(t.depName)),i("van-icon",{attrs:{name:"arrow"}})],1)})),0),i("div",{staticClass:"flex-1 d-flex px-4 py-3 overflow-hidden"},[i("div",{staticClass:"flex-2 full-height"},[i("van-collapse",{staticClass:"dep-collapse",attrs:{border:!1},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[i("van-collapse-item",{attrs:{title:e.curDeptObj.depName,name:"1","label-class":"pa-0",border:!1}},e._l(e.curDeptObj.childList,(function(t){return i("div",{key:t.depId,staticClass:"d-flex align-center justify-space-between mt-3 mb-6",on:{click:function(i){return e.changeDept(t)}}},[i("div",{staticClass:"color-black-2"},[e._v(e._s(t.depName))]),i("van-icon",{staticClass:"font-16",attrs:{name:"arrow-down"}})],1)})),0)],1)],1),i("div",{staticClass:"tree-div__line"}),i("div",{staticClass:"flex-1 full-height pl-4 overflow-y-auto"},[e.isSelect?i("div",{staticClass:"color-main-2 font-14",on:{click:e.onAllCheckClick}},[e._v(" "+e._s(e.selectAll?"取消全选":"全选")+" ")]):e._e(),e.isSelect&&e.userDataList.length?i("van-checkbox-group",{ref:"checkboxGroup",model:{value:e.checkedIdList,callback:function(t){e.checkedIdList=t},expression:"checkedIdList"}},e._l(e.userDataList,(function(t){return i("van-checkbox",{key:t.userId,ref:"checkboxes",refInFor:!0,staticClass:"font-14 font-bold mt-6",attrs:{"icon-size":"16px","checked-color":"#2271F5",name:t.userId}},[e._v(e._s(t.userName))])})),1):e._e(),!e.isSelect&&e.userDataList.length?i("van-radio-group",{model:{value:e.checkedId,callback:function(t){e.checkedId=t},expression:"checkedId"}},e._l(e.userDataList,(function(t){return i("van-radio",{key:t.userId,ref:"checkboxes",refInFor:!0,staticClass:"font-14 font-bold mt-6",attrs:{"icon-size":"16px","checked-color":"#2271F5",name:t.userId}},[e._v(e._s(t.userName))])})),1):e._e(),e.userDataList.length||e.loading?e._e():i("app-empty",{staticClass:"mt-7",attrs:{description:"暂无人员",size:"100px"}}),i("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{type:"spinner",color:"#2271F5"}})],1)])],i("div",{staticClass:"d-flex align-center px-4 py-10",staticStyle:{background:"#f7f8fa"}},[e.isSelect?i("div",{staticClass:"flex-1 color-main-2 font-14 d-flex align-center",on:{click:function(t){e.checkedShow=!0}}},[e._v(" 已选"+e._s(e.allCheckedList.length)+"人 "),i("van-icon",{staticClass:"ml-3",attrs:{name:"arrow-"+(e.checkedShow?"up":"down"),size:"16px"}})],1):e._e(),e.isSelect?e._e():i("div",{staticClass:"flex-1 color-main-2 font-14 d-flex align-center"}),i("van-button",{staticStyle:{width:"72px"},attrs:{size:"small",block:"",round:""},on:{click:e.cancel}},[e._v("取消")]),i("van-button",{staticClass:"ml-4",staticStyle:{width:"72px"},attrs:{type:"info",size:"small",block:"",round:"",color:"#3561F2"},on:{click:e.onTreeConfirm}},[e._v("确认")])],1),i("van-popup",{style:{height:"60%"},attrs:{position:"bottom",round:"",closeable:""},model:{value:e.checkedShow,callback:function(t){e.checkedShow=t},expression:"checkedShow"}},[i("div",{staticClass:"font-16 font-bold textAlignC my-3"},[e._v("已选"+e._s(e.allCheckedList.length)+"人")]),i("div",{staticClass:"overflow-y-auto",staticStyle:{height:"calc(100% - 125px)"}},e._l(e.allCheckedList,(function(t){return i("van-cell",{key:t.userId,attrs:{clickable:""},scopedSlots:e._u([{key:"title",fn:function(){return[i("span",[e._v(e._s(t.userId)+"/"+e._s(t.userName))])]},proxy:!0},{key:"right-icon",fn:function(){return[i("van-icon",{attrs:{name:"cross",size:"20px"},nativeOn:{click:function(i){return i.stopPropagation(),e.deletePerson(t)}}})]},proxy:!0}],null,!0)})})),1),i("div",{staticClass:"dropdown-opts"},[i("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:function(t){e.checkedShow=!1}}},[e._v("取消")]),i("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",block:"",round:"",color:"#2271F5"},on:{click:function(t){e.checkedShow=!1}}},[e._v("确认")])],1)])],2)},a=[],n=i("2909"),r=i("d4ec"),o=i("bee2"),c=i("262e"),l=i("2caf"),u=(i("d81d"),i("d3b7"),i("caad"),i("2532"),i("a434"),i("b64b"),i("4de4"),i("6062"),i("3ca3"),i("ddb0"),i("99af"),i("9ab4")),d=i("1b40"),h=function(e){Object(c["a"])(i,e);var t=Object(l["a"])(i);function i(){var e;return Object(r["a"])(this,i),e=t.apply(this,arguments),e.keywords="",e.checkedShow=!1,e.checkedIdList=[],e.checkedId="",e.checkedName="",e.breadList=[],e.curDeptObj={},e.activeNames=["1"],e.allCheckedList=[],e}return Object(o["a"])(i,[{key:"userDataList",get:function(){var e,t=this.curDeptObj.depId||"";return(null===(e=this.deptUserData[t])||void 0===e?void 0:e.userList)||[]}},{key:"selectAll",get:function(){var e=this,t=this.userDataList.map((function(e){return e.userId})),i=!!t.length&&t.every((function(t){return e.checkedIdList.includes(t)}));return i}},{key:"onInput",value:function(){this.$emit("search",this.keywords)}},{key:"changeBread",value:function(e,t){this.breadList.splice(t+1),this.curDeptObj=e}},{key:"changeDept",value:function(e){var t=e.depId,i=e.depName,s=e.childList;this.breadList.push({depId:t,depName:i,childList:s}),this.curDeptObj=e,Object.keys(this.deptUserData).includes(String(e.depId))||this.$emit("refresh",e)}},{key:"onAllCheckClick",value:function(){var e=this.userDataList.map((function(e){return e.userId}));this.checkedIdList=this.selectAll?this.checkedIdList.filter((function(t){return!e.includes(t)})):Object(n["a"])(new Set([].concat(Object(n["a"])(this.checkedIdList),Object(n["a"])(e))))}},{key:"deletePerson",value:function(e){this.checkedIdList=this.checkedIdList.filter((function(t){return t!==e.userId}))}},{key:"onTreeConfirm",value:function(){if(this.isSelect)if(this.needName){var e=(this.allCheckedList.length>0?this.allCheckedList[0].userName:"")+(this.allCheckedList.length>1?","+this.allCheckedList[1].userName:"")+(this.allCheckedList.length>2?"等":"");this.$emit("confirm",{list:this.checkedIdList,name:e})}else this.$emit("confirm",this.checkedIdList);else{if(this.keywords){for(var t=0;t<this.searchList.length;t++)if(this.searchList[t].userId==this.checkedId){this.checkedName=this.searchList[t].userName;break}}else for(var i=0;i<this.userDataList.length;i++)if(this.userDataList[i].userId==this.checkedId){this.checkedName=this.userDataList[i].userName;break}this.$emit("confirm",this.checkedId,this.checkedName)}}},{key:"cancel",value:function(){this.$emit("cancel")}},{key:"mounted",value:function(){var e=this.depTreeList[0],t=e.depId,i=e.depName,s=e.childList;this.breadList=[{depId:t,depName:i,childList:s}],this.curDeptObj=this.depTreeList[0]}},{key:"onCheckedIdListChange",value:function(e){var t,i=this.depTreeList[0].depId,s=(null===(t=this.deptUserData[i])||void 0===t?void 0:t.userList)||[];this.allCheckedList=s.filter((function(t){return e.includes(t.userId)}))}}]),i}(d["d"]);Object(u["a"])([Object(d["c"])({type:Boolean,default:!0})],h.prototype,"isSelect",void 0),Object(u["a"])([Object(d["c"])({type:Boolean,default:!1})],h.prototype,"needName",void 0),Object(u["a"])([Object(d["c"])({type:Boolean,default:!1})],h.prototype,"show",void 0),Object(u["a"])([Object(d["c"])({type:Boolean,default:!1})],h.prototype,"loading",void 0),Object(u["a"])([Object(d["c"])({type:Array,default:[]})],h.prototype,"depTreeList",void 0),Object(u["a"])([Object(d["c"])({type:Object,default:{}})],h.prototype,"deptUserData",void 0),Object(u["a"])([Object(d["c"])({type:Array,default:[]})],h.prototype,"searchList",void 0),Object(u["a"])([Object(d["e"])("checkedIdList",{deep:!0,immediate:!0})],h.prototype,"onCheckedIdListChange",null),h=Object(u["a"])([Object(d["a"])({})],h);var p=h,f=p,v=(i("3da8"),i("2877")),y=Object(v["a"])(f,s,a,!1,null,"331fe828",null);t["a"]=y.exports},"0942":function(e,t,i){},"1ea0":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"customer-unit"},[i("van-sticky",[i("div",{staticClass:"customer-unit-sticky d-flex"},[i("div",{class:["flex-1 customer-unit-filter justify-space-between px-10",e.filterShow?"color-main-2":"",e.filterActive?"customer-unit-filter--active":""],on:{click:function(t){e.changeTypeShow=!1,e.filterShow=!e.filterShow}}},[i("div",[e._v("条件筛选")]),i("van-icon",{attrs:{name:"arrow-"+(e.filterShow?"up":"down"),size:"16px"}})],1),e.hasDept?i("div",{class:["ml-2 customer-unit-filter justify-space-around",e.changeTypeShow?"color-main-2":"",2===e.value?"customer-unit-filter--active":""],staticStyle:{width:"103px"},on:{click:function(t){e.filterShow=!1,e.changeTypeShow=!e.changeTypeShow}}},[i("div",[e._v(e._s(1===e.value?"本人":"已选"+(e.checkedUsers.length>99?"99+":e.checkedUsers.length)+"人"))]),i("van-icon",{attrs:{name:"arrow-"+(e.changeTypeShow?"up":"down"),size:"16px"}})],1):e._e()])]),i("van-pull-refresh",{staticClass:"my-container px-10",on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[i("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(t){e.error=t},load:e.getDataList},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(t,s){return i("div",{key:s,staticClass:"gray-block box-shadow mb-2 van-clearfix",on:{click:function(i){return e.toDetail(t,1)}}},[i("div",{staticClass:"white-block d-flex justify-space-between inner-block"},[i("div",{staticClass:"font-bold"},[i("div",[e._v(e._s(t.custId)+"/")]),i("div",[e._v(e._s(t.custName||""))])]),i("div",{staticClass:"d-flex flex-column justify-space-between",staticStyle:{"margin-left":"90px","min-width":"fit-content"}},[i("div",{staticClass:"font-bold textAlignR"},[e._v(e._s(t.hospitalLevel||""))]),i("div",{staticClass:"d-flex align-baseline mt-1"},[i("div",{staticClass:"mr-2"},[e._v("维护人")]),i("div",{staticClass:"font-bold color-gray-4"},[e._v(e._s(t.cceId&&t.creName?t.creName:"暂未维护"))])])])]),t.isShare?e._e():i("div",{staticClass:"d-flex justify-space-between pa-10"},[i("div",{},[e._v("已维护人数")]),i("div",{staticClass:"font-bold color-main-2"},[e._v(e._s(t.personNum))])]),t.isShare?e._e():i("div",{staticClass:"d-flex justify-space-between px-10 pt-1 pb-2"},[i("div",{},[e._v("一般客情热力值")]),i("div",{staticClass:"font-bold color-normal"},[e._v(e._s(t.warmthPersonNum))])]),i("div",{staticClass:"line"}),t.hasNoOpts||1!==e.value?2===e.value?i("div",{staticClass:"inner-block textAlignR"},[e.canEdit&&t.creId===e.userInfor.userId?[i("van-button",{staticClass:"ml-3 px-10",attrs:{type:"info",size:"mini",round:"",color:"#2271F5"},on:{click:function(i){return i.stopPropagation(),e.toDetail(t,2)}}},[e._v("编辑")]),t.cceId&&!t.isShare?i("van-button",{staticClass:"ml-3 px-10",attrs:{type:"default",size:"mini",round:""},on:{click:function(i){return i.stopPropagation(),e.toShare(t)}}},[e._v("分享至")]):e._e()]:e._e(),e.canEdit&&t.creId===e.userInfor.userId?i("van-button",{staticClass:"ml-3 px-10",attrs:{type:"default",size:"mini",round:"",plain:""},on:{click:function(i){return i.stopPropagation(),e.toPerson(t,1)}}},[e._v("人员维护")]):i("van-button",{staticClass:"ml-3 px-10",attrs:{type:"default",size:"mini",round:"",plain:""},on:{click:function(i){return i.stopPropagation(),e.toPerson(t,2)}}},[e._v("查看人员")])],2):e._e():i("div",{staticClass:"inner-block textAlignR"},[i("van-button",{staticClass:"ml-3 px-10",attrs:{type:"info",size:"mini",round:"",color:"#2271F5"},on:{click:function(i){return i.stopPropagation(),e.toDetail(t,2)}}},[e._v("编辑")]),t.cceId&&!t.isShare?i("van-button",{staticClass:"ml-3 px-10",attrs:{type:"default",size:"mini",round:""},on:{click:function(i){return i.stopPropagation(),e.toShare(t)}}},[e._v("分享至")]):e._e(),i("van-button",{staticClass:"ml-3 px-10",attrs:{type:"default",size:"mini",round:"",plain:""},on:{click:function(i){return i.stopPropagation(),e.toPerson(t,1)}}},[e._v("人员维护")])],1)])})),0)],1),2===e.value&&e.hasDept?i("fix-button",{attrs:{title:"本人",icon:"#ytcrm-juxing1"},on:{click:e.toSelfData}}):e._e(),i("van-popup",{attrs:{position:"top",round:"","get-container":e.getContainer},model:{value:e.filterShow,callback:function(t){e.filterShow=t},expression:"filterShow"}},[i("filter-pop",{attrs:{hosTypeList:e.hosTypeList,saleTypeList:e.saleTypeList,learnTypeList:e.learnTypeList,roleTypeList:e.roleTypeList,isProfitList:e.isProfitList},on:{confirm:e.onConfirm}})],1),e.hasDept?i("dept-user",{attrs:{show:e.changeTypeShow,loading:e.getUserListLoading,depTreeList:e.depTreeList,deptUserData:e.deptUserData,searchList:e.userDataList},on:{search:e.refreshUserByKeywords,refresh:e.refreshUserByDepts,confirm:e.onTreeConfirm,cancel:function(t){e.changeTypeShow=!1}}}):e._e()],1)},a=[],n=(i("9a83"),i("f564")),r=i("2909"),o=i("3835"),c=i("1da1"),l=i("d4ec"),u=i("bee2"),d=i("262e"),h=i("2caf"),p=(i("96cf"),i("d3b7"),i("3ca3"),i("ddb0"),i("d81d"),i("159b"),i("7db0"),i("99af"),i("9ab4")),f=i("1b40"),v=i("4bb5"),y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("van-form",[i("van-field",{attrs:{clearable:"",label:"客户名称","input-align":"right",placeholder:"请输入客户名称|客户ID"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),i("van-field",{attrs:{readonly:"",clickable:"",value:e.hosType.name,label:"医院等级","input-align":"right",placeholder:"点击选择"},on:{click:function(t){return e.chooseFilter(1)}}}),i("van-field",{attrs:{readonly:"",clickable:"",value:e.saleType.name,label:"销售规模","input-align":"right",placeholder:"点击选择"},on:{click:function(t){return e.chooseFilter(2)}}}),i("van-field",{attrs:{readonly:"",clickable:"",value:e.learnType.name,label:"学术专线","input-align":"right",placeholder:"点击选择"},on:{click:function(t){return e.chooseFilter(3)}}}),i("van-field",{attrs:{readonly:"",clickable:"",value:e.isProfit.name,label:"经营性质","input-align":"right",placeholder:"点击选择"},on:{click:function(t){return e.chooseFilter(4)}}})],1),i("div",{staticClass:"dropdown-opts"},[i("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:e.reset}},[e._v("重置")]),i("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",block:"",round:"",color:"#2271F5"},on:{click:e.onConfirm}},[e._v("确认")])],1),1===e.actionType?i("van-action-sheet",{attrs:{actions:e.hosTypeList,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onSelectHosType},model:{value:e.actionShow,callback:function(t){e.actionShow=t},expression:"actionShow"}}):e._e(),2===e.actionType?i("van-action-sheet",{attrs:{actions:e.saleTypeList,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onSelectSaleType},model:{value:e.actionShow,callback:function(t){e.actionShow=t},expression:"actionShow"}}):e._e(),3===e.actionType?i("van-action-sheet",{attrs:{actions:e.learnTypeList,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onSelectLearnType},model:{value:e.actionShow,callback:function(t){e.actionShow=t},expression:"actionShow"}}):e._e(),4===e.actionType?i("van-action-sheet",{attrs:{actions:e.isProfitList,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onSelectProfit},model:{value:e.actionShow,callback:function(t){e.actionShow=t},expression:"actionShow"}}):e._e()],1)},m=[],k=function(e){Object(d["a"])(i,e);var t=Object(h["a"])(i);function i(){var e;return Object(l["a"])(this,i),e=t.apply(this,arguments),e.actionShow=!1,e.actionType=0,e.hosType={},e.saleType={},e.learnType={},e.isProfit={},e.keywords="",e}return Object(u["a"])(i,[{key:"chooseFilter",value:function(e){this.actionShow=!0,this.actionType=e}},{key:"onSelectHosType",value:function(e){this.hosType=e}},{key:"onSelectSaleType",value:function(e){this.saleType=e}},{key:"onSelectLearnType",value:function(e){this.learnType=e}},{key:"onSelectProfit",value:function(e){this.isProfit=e}},{key:"reset",value:function(){this.hosType={},this.saleType={},this.learnType={},this.isProfit={},this.keywords=""}},{key:"onConfirm",value:function(){var e={custom:this.keywords,hospitalLevel:this.hosType.value||"",yearSalesVolume:this.saleType.value||"",scienceLine:this.learnType.value||"",isProfit:this.isProfit.value||""};this.$emit("confirm",e)}}]),i}(f["d"]);Object(p["a"])([Object(f["c"])({type:Array,default:[]})],k.prototype,"hosTypeList",void 0),Object(p["a"])([Object(f["c"])({type:Array,default:[]})],k.prototype,"saleTypeList",void 0),Object(p["a"])([Object(f["c"])({type:Array,default:[]})],k.prototype,"learnTypeList",void 0),Object(p["a"])([Object(f["c"])({type:Array,default:[]})],k.prototype,"roleTypeList",void 0),Object(p["a"])([Object(f["c"])({type:Array,default:[]})],k.prototype,"isProfitList",void 0),k=Object(p["a"])([Object(f["a"])({})],k);var b=k,g=b,L=(i("6b86"),i("2877")),w=Object(L["a"])(g,y,m,!1,null,"9fdfa762",null),_=w.exports,T=i("08de"),x=i("f727"),I=i("74d2"),S=Object(v["a"])("app"),O=Object(v["a"])("crm");f["a"].registerHooks(["beforeRouteLeave"]);var C=function(e){Object(d["a"])(i,e);var t=Object(h["a"])(i);function i(){var e;return Object(l["a"])(this,i),e=t.apply(this,arguments),e.filterActive=!1,e.filterShow=!1,e.changeTypeShow=!1,e.getUserListLoading=!1,e.userDataList=[],e.checkedUsers=[],e.value=1,e.hasDept=!1,e.page=1,e.pageSize=10,e.list=[],e.loading=!1,e.finished=!1,e.refreshing=!1,e.error=!1,e.hosTypeList=[],e.saleTypeList=[],e.learnTypeList=[],e.roleTypeList=[],e.isProfitList=[{value:1,name:"政府办"},{value:2,name:"非政府办营利"},{value:3,name:"非政府办非营利"}],e.filterVal={custom:"",hospitalLevel:"",yearSalesVolume:"",scienceLine:"",isProfit:""},e.deptUserData={},e.canEdit=!1,e}return Object(u["a"])(i,[{key:"getContainer",value:function(){return document.querySelector(".my-container")}},{key:"getSearchList",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,i,s,a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.hosTypeList=[],this.saleTypeList=[],this.learnTypeList=[],this.roleTypeList=[],e.next=6,Promise.all([this.getTypeList(12),this.getTypeList(13),this.getTypeList(1),this.getTypeList(2,1)]);case 6:t=e.sent,i=Object(o["a"])(t,4),s=i[0],a=i[1],n=i[2],r=i[3],this.hosTypeList=s,this.saleTypeList=a,this.learnTypeList=n,this.roleTypeList=r;case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getTypeList",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,i){var s,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={},s=i?{full:!0,pageNum:1,pageSize:1e5,typeId:t,usestatus:1,typeSecondId:i}:{full:!0,pageNum:1,pageSize:1e5,usestatus:1,typeId:t},e.next=4,Object(x["d"])(s);case 4:return a=e.sent,n=a.data.list.map((function(e){var t=e.DIC_SELECT_ID,i=e.DIC_SELECT_NAME;return{value:t,name:i}})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));function t(t,i){return e.apply(this,arguments)}return t}()},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.list=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,i,s,a,n,o,c,l,u,d=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.filterVal,i=t.custom,s=t.hospitalLevel,a=t.yearSalesVolume,n=t.scienceLine,o=t.isProfit,c={type:this.value,custom:i,hospitalLevel:s,yearSalesVolume:a,scienceLine:n,isProfit:o,pageNum:this.page,pageSize:this.pageSize},2===this.value&&(c.userList=this.checkedUsers),e.next=5,Object(I["B"])(c);case 5:l=e.sent,this.loading=!1,this.refreshing=!1,l.success?(u=[],l.data.list.forEach((function(e){if(e.custExbandInfoVOList.length){var t=e.custExbandInfoVOList.find((function(e){return!e.isShare}));if(t){var i=Object.assign({},e,t);u.push(i)}else u.push(e);e.custExbandInfoVOList.forEach((function(i){if(!t||i.cceId!==t.cceId){var s=Object.assign({},e,{hasNoOpts:!0},i);u.push(s)}}))}else{var s=Object.assign({personNum:0,warmthPersonNum:0,creId:d.userInfor.userId,creName:d.userInfor.userName},e);u.push(s)}})),this.list=[].concat(Object(r["a"])(this.list),u),this.page++,this.finished=!l.data.hasNextPage):this.error=!0;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onConfirm",value:function(e){var t=e.custom,i=e.hospitalLevel,s=e.yearSalesVolume,a=e.scienceLine,n=e.isProfit;this.filterActive=!!(t||i||s||a||n),this.filterVal=e,this.filterShow=!1,this.refreshData()}},{key:"onTreeConfirm",value:function(e){this.changeTypeShow=!1,this.value=2,this.checkedUsers=e,this.refreshData()}},{key:"refreshData",value:function(){this.list=[],this.page=1,this.finished=!1,this.loading=!0,this.getDataList()}},{key:"toDetail",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,i){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.onlyRead=2===this.value&&(!this.canEdit||t.creId!==this.userInfor.userId),this.SET_DETAILINFOR(t),this.SET_HADDONEONDETAIL(!1),this.$router.push({name:"CustomerUnitDetail",params:{item:t,type:String(i)}});case 4:case"end":return e.stop()}}),e,this)})));function t(t,i){return e.apply(this,arguments)}return t}()},{key:"toShare",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.SET_HADDONEONDETAIL(!1),this.SET_DETAILINFOR(t),this.$router.push({name:"CustomerShare",params:{shareType:"1"}});case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"toPerson",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,i){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.orgRoleId){e.next=3;break}return Object(n["a"])({type:"warning",message:"请先维护科室角色，再新增人员信息"}),e.abrupt("return");case 3:t.onlyRead=2===i,this.SET_HADDONEONDETAIL(!1),this.SET_DETAILINFOR(t),this.$router.push({name:"CustomerUnitPerson"});case 7:case"end":return e.stop()}}),e,this)})));function t(t,i){return e.apply(this,arguments)}return t}()},{key:"_getDepTree",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{treeType:1,authorizedFlag:!0};this.actionGetDepTree(t).then((function(t){0===t.data.length?e.hasDept=!1:(e._getUserByParams({depIdList:e.mapTreeList(e.depTreeList,[]),leaderFlag:!1,authorizedFlag:!0},e.depTreeList[0].depId),e.hasDept=!0)}))}},{key:"mapTreeList",value:function(e,t){for(var i=0;i<e.length;i++){var s,a=e[i];a.operationFlag&&t.push(a.depId),null!==(s=a.childList)&&void 0!==s&&s.length&&this.mapTreeList(a.childList,t)}return t}},{key:"_getUserByParams",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,i){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.getUserListLoading=!0,e.next=3,Object(x["h"])(t);case 3:s=e.sent,"200"===s.code&&(this.getUserListLoading=!1,this.userDataList=s.data.map((function(e){var t=e.userId,i=e.userName;return{userId:t,userName:i}})),t.depIdList&&t.depIdList.length&&this.$set(this.deptUserData,i,{userList:this.userDataList,selectList:[]}));case 5:case"end":return e.stop()}}),e,this)})));function t(t,i){return e.apply(this,arguments)}return t}()},{key:"refreshUserByKeywords",value:function(e){this._getUserByParams({keyword:e,leaderFlag:!1,authorizedFlag:!0})}},{key:"refreshUserByDepts",value:function(e){this._getUserByParams({depIdList:this.mapTreeList([e],[]),leaderFlag:!1,authorizedFlag:!0},e.depId)}},{key:"toSelfData",value:function(){this.value=1,this.refreshData()}},{key:"created",value:function(){this.list=[],this.getSearchList(),this.depTreeList?0===this.depTreeList.length?this.hasDept=!1:(this._getUserByParams({depIdList:this.mapTreeList(this.depTreeList,[]),leaderFlag:!1,authorizedFlag:!0},this.depTreeList[0].depId),this.hasDept=!0):this._getDepTree();var e=JSON.parse(localStorage.getItem("permissions")||"");this.canEdit=e.some((function(e){return"CustomerUnitEditWx"===e}))}},{key:"activated",value:function(){this.hadDoneOnDetail&&this.refreshData()}}]),i}(f["d"]);Object(p["a"])([S.Mutation],C.prototype,"SET_DETAILINFOR",void 0),Object(p["a"])([O.Action],C.prototype,"actionGetDepTree",void 0),Object(p["a"])([O.Getter],C.prototype,"depTreeList",void 0),Object(p["a"])([S.Mutation],C.prototype,"SET_HADDONEONDETAIL",void 0),Object(p["a"])([S.Getter],C.prototype,"hadDoneOnDetail",void 0),Object(p["a"])([S.Getter],C.prototype,"userInfor",void 0),C=Object(p["a"])([Object(f["a"])({components:{FilterPop:_,DeptUser:T["a"]}})],C);var j=C,D=j,N=(i("845e"),Object(L["a"])(D,s,a,!1,null,"ff5a321a",null));t["default"]=N.exports},"3da8":function(e,t,i){"use strict";i("ddf6")},"568c":function(e,t,i){},"6b86":function(e,t,i){"use strict";i("568c")},"845e":function(e,t,i){"use strict";i("0942")},ddf6:function(e,t,i){}}]);