(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20520b04"],{"0465":function(t,e,a){"use strict";a("2ca4")},"2ca4":function(t,e,a){},d187:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pb-100 background-color-white"},[a("van-sticky",[a("div",{staticClass:"header d-flex align-center"},[a("div",{staticClass:"flex-1 d-flex flex-column"},[a("div",{staticClass:"dept-name"},[t._v("集采看板")]),a("span",{staticClass:"font-12 color-gray-5"},[t._v(t._s(t.entryObj.name))])]),a("div",{on:{click:t.calendarClick}},[a("span",{staticClass:"time"},[t._v(t._s(t.$dayjs(t.csjNowTime).format("YYYY-MM-DD")))]),a("van-icon",{staticClass:"pl-1",attrs:{size:"14px",name:"arrow-down"}})],1)])]),a("van-calendar",{attrs:{"default-date":t.csjNowTime,"min-date":new Date(2021,0,1),"max-date":new Date((new Date).getTime()-864e5),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{select:t.selectCalendar},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}}),a("div",{staticClass:"button-group"},[a("div",{staticClass:"button-row"},t._l(t.buttons.slice(0,3),(function(e,i){return a("button",{key:i,class:["filter-button",{active:t.activeButton===i}],on:{click:function(e){return t.selectButton(i)}}},[t._v(" "+t._s(e)+" ")])})),0),a("div",{staticClass:"button-row"},t._l(t.buttons.slice(3),(function(e,i){return a("button",{key:i+3,class:["filter-button",{active:t.activeButton===i+3}],on:{click:function(e){return t.selectButton(i+3)}}},[t._v(" "+t._s(e)+" ")])})),0)]),a("div",{staticClass:"pb-100"},[t.loading?a("div",{staticClass:"d-flex justify-center pa-8"},[a("van-loading",{attrs:{type:"spinner",color:"#3561F2"}})],1):t._e(),a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("div",{staticClass:"card-list"},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.cardData.length&&!t.loading,expression:"cardData.length == 0 && !loading"}],staticClass:"white-block pb-3 mb-4"},[a("app-empty",{staticClass:"py-7",attrs:{description:"暂无数据"}})],1),t._l(t.cardData,(function(e,i){return a("div",{key:i,staticClass:"card-wrapper"},[a("div",{staticClass:"px-4 d-flex justify-space-between",on:{click:function(e){return t.jumpToJcDetail(i)}}},[a("div",{staticClass:"py-10 pr-4",on:{click:function(e){return e.stopPropagation(),t.toggleCard(i)}}},[a("span",{staticClass:"font-14 pr-4"},[t._v(" "+t._s(e.batchName))]),a("van-icon",{attrs:{size:"18px",name:e.expanded?"arrow-up":"arrow-down"}})],1),a("div",{staticClass:"py-10"},[a("van-icon",{attrs:{size:"18px",name:"arrow"}})],1)]),a("div",{staticClass:"summary-all"},[a("div",{staticClass:"font-14"},[t._v("集采看板")]),a("div",{staticClass:"total-sales"},[t._v(t._s(e.totalSales)+"万元")]),a("div",{class:["growth-rate",e.growthRate>0?"positive":"negative"]},[t._v(" "+t._s(e.growthRate>0?"+":"")+t._s(e.growthRate)+"% ")])]),e.expanded?a("div",{staticClass:"card-content"},[a("div",{staticClass:"summary"},[a("div",{staticClass:"progress-bar"},[a("div",{staticClass:"progress-inner",style:{width:e.winningProgress+"%"}})]),a("div",{staticClass:"summary-item"},[a("span",[t._v("中标品种")]),a("span",{staticClass:"value"},[t._v(t._s(e.winningSales)+"万元")]),a("span",{class:["growth-rate",e.winningGrowthRate>0?"positive":"negative"]},[t._v(" "+t._s(e.winningGrowthRate>0?"+":"")+t._s(e.winningGrowthRate)+"% ")])])]),a("div",{staticClass:"divider"}),a("div",{staticClass:"summary"},[a("div",{staticClass:"progress-bar"},[a("div",{staticClass:"progress-inner",style:{width:e.nonWinningProgress+"%"}})]),a("div",{staticClass:"summary-item"},[a("span",[t._v("备选和未中选品种")]),a("span",{staticClass:"value"},[t._v(t._s(e.nonWinningSales)+"万元")]),a("span",{class:["growth-rate",e.nonWinningGrowthRate>0?"positive":"negative"]},[t._v(" "+t._s(e.nonWinningGrowthRate>0?"+":"")+t._s(e.nonWinningGrowthRate)+"% ")])])])]):t._e()])}))],2)])],1)],1)},s=[],n=a("5530"),r=a("1da1"),c=a("d4ec"),o=a("bee2"),l=a("262e"),d=a("2caf"),u=(a("96cf"),a("d81d"),a("b680"),a("b0c0"),a("9ab4")),h=a("1b40"),v=a("4388"),p=a("2279"),f=a("5b92"),m=function(t){Object(l["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(c["a"])(this,a),t=e.apply(this,arguments),t.calendarShow=!1,t.buttons=["国家集采(含续约)","浙江省集采","江西联盟","全国中成药联盟"],t.activeButton=0,t.entryObj={},t.dateTime="",t.type="国家集采(含续约)",t.cardData=[],t.refreshing=!1,t.loading=!1,t.finished=!1,t}return Object(o["a"])(a,[{key:"_queryJiCaiList",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={date:this.dateTime,deptId:this.entryObj.id,flag:1,type:this.type},this.cardData=[],this.loading=!0,this.refreshing=!1,t.next=6,Object(p["db"])(e);case 6:a=t.sent,this.loading=!1,200==a.code&&a.data&&(this.cardData=a.data.map((function(t){return{batchName:t.batch,expanded:!1,totalSales:Object(f["d"])(t.sale,1),growthRate:(100*t.saleTb).toFixed(1),winningSales:Object(f["d"])(t.bidSale,1),winningGrowthRate:(100*t.bidSaleTb).toFixed(1),winningProgress:(t.bidSale/t.sale*100).toFixed(1),nonWinningSales:Object(f["d"])(t.noBidSale,1),nonWinningGrowthRate:(100*t.noBidSaleTb).toFixed(1),nonWinningProgress:(t.noBidSale/t.sale*100).toFixed(1)}})),this.cardData.length>0&&(this.cardData[0].expanded=!0));case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.entryObj=this.$route.query,this.dateTime=this.$dayjs(this.csjNowTime).format("YYYY-MM-DD")}},{key:"activated",value:function(){this.dateTime&&this.dateTime!==this.$dayjs(this.csjNowTime).format("YYYY-MM-DD")&&(this.dateTime=this.$dayjs(this.csjNowTime).format("YYYY-MM-DD"),this.onRefresh())}},{key:"mounted",value:function(){this._queryJiCaiList()}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!1,this.cardData=[],this._queryJiCaiList()}},{key:"calendarClick",value:function(){this.calendarShow=!0}},{key:"selectCalendar",value:function(t){this.calendarConfirm(t)}},{key:"calendarConfirm",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.calendarShow=!1,this.dateTime=this.$dayjs(e).format("YYYY-MM-DD"),this.SET_CSJNOWTIME(e),this.SET_CSJCHANGETIME(!0),this._queryJiCaiList();case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"selectButton",value:function(t){this.activeButton=t,this.type=this.buttons[t],this._queryJiCaiList()}},{key:"jumpToJcDetail",value:function(t){this.$router.push({name:"JcDetail",query:{type:this.type,deptId:this.entryObj.id,batch:t+1,date:this.dateTime,role:this.$route.query.role}})}},{key:"toggleCard",value:function(t){this.cardData[t].expanded=!this.cardData[t].expanded,this.$set(this.cardData,t,Object(n["a"])({},this.cardData[t]))}}]),a}(Object(h["b"])(v["a"]));m=Object(u["a"])([Object(h["a"])({beforeRouteEnter:function(t,e,a){a((function(t){"salesLineHighRise0"!==e.name&&"salesLineHighRise0Inner"!==e.name&&"salesLineHighRise1"!==e.name&&"salesLineHighRise1Inner"!==e.name&&"salesLineMiddleRise2"!==e.name&&"salesLineMiddleRise2Inner"!==e.name&&"salesLineMiddleRise3"!==e.name&&"salesLineMiddleRise3Inner"!==e.name||(t.cardData=[],t.entryObj=Object(n["a"])({},t.$route.query),t.onRefresh(),t._queryJiCaiList())}))}})],m);var g=m,w=g,b=(a("0465"),a("2877")),y=Object(b["a"])(w,i,s,!1,null,"6e2e1ed8",null);e["default"]=y.exports}}]);