(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c54a4f6"],{"53ae":function(e,t,a){"use strict";var s=a("d4ec"),n=a("bee2"),i=a("262e"),r=a("2caf"),o=(a("b0c0"),a("9ab4")),c=a("1b40");c["a"].registerHooks(["beforeRouteEnter"]);var l=function(e){Object(i["a"])(a,e);var t=Object(r["a"])(a);function a(){var e;return Object(s["a"])(this,a),e=t.apply(this,arguments),e.page=1,e.total=0,e.dataList=[],e.loading=!1,e.finished=!1,e.refreshing=!1,e.finishText="",e.userIdList=[],e.error=!1,e}return Object(n["a"])(a,[{key:"beforeRouteEnter",value:function(e,t,a){a((function(e){"Home"!==t.name&&"TaskIndex"!==t.name||(e.dataList=[],e.page=1,e.loading=!1,e.finished=!0,e.refreshing=!1,e.$nextTick((function(){e.finished=!1})))}))}}]),a}(c["d"]);l=Object(o["a"])([Object(c["a"])({})],l),t["a"]=l},"6c1c":function(e,t,a){"use strict";a("8a2e")},"718c":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"background-color-white"},[a("van-sticky",[a("div",{staticClass:"header px-4 d-flex align-center"},[a("div",{staticClass:"flex-3 d-flex flex-column"},[a("span",{staticClass:"font-24 fontWeight color-black-1",staticStyle:{"font-family":"'HarmonyOS Sans SC Black'"}},[e._v("品牌集合")]),a("span",{staticClass:"font-12 color-gray-5"},[e._v(e._s(e.entryObj.name))])]),a("div",{staticClass:"flex-2 textAlignR pr-8",staticStyle:{"font-family":"'HarmonyOS Sans SC Bold'"},on:{click:e.calendarClick}},[a("span",{staticClass:"time color-gray-4 fontWeight"},[e._v(e._s(e.dateTime))]),a("van-icon",{staticClass:"pl-1",attrs:{size:"14px",name:"arrow-down"}})],1)]),a("van-search",{attrs:{shape:"round",placeholder:"搜索","input-align":"center"},on:{input:e.onRefresh},model:{value:e.brandSearchValue,callback:function(t){e.brandSearchValue=t},expression:"brandSearchValue"}})],1),a("div",{staticClass:"pa-10"},[a("van-pull-refresh",{staticClass:"pt-10 pb-100",on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[a("van-list",{attrs:{offset:20,finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.dataList,(function(t,s){return a("div",{key:s,staticClass:"card mb-2"},[a("div",{staticClass:"d-flex",class:t.isExp?"borderBottom":"",on:{click:function(a){return e.detailClick(t.brandId,t.brandName)}}},[a("div",{staticClass:"topWarp d-flex justify-center",class:[0===s?"topWarp-bg1":1===s?"topWarp-bg2":2===s?"topWarp-bg3":"topWarp-bg4",t.isExp?"topWarp-radius1":"topWarp-radius"]},[a("span",{staticClass:"font-30"},[e._v(e._s(t.topNumber))])]),a("div",{staticClass:"d-flex flex-column flex-2"},[a("div",{staticClass:"d-flex justify-space-between"},[a("div",{staticClass:"pl-10 py-10 pr-4",on:{click:function(a){return a.stopPropagation(),e.isExpClick(t)}}},[a("span",{staticClass:"font-14 pr-4"},[e._v(" "+e._s(t.brandName))]),a("van-icon",{attrs:{size:"18px",name:t.isExp?"arrow-up":"arrow-down"}})],1),a("div",{staticClass:"pr-10 py-10"},[a("van-icon",{attrs:{size:"18px",name:"arrow"}})],1)]),a("div",{staticClass:"d-flex justify-space-between align-center"},[a("span",{staticClass:"totalNumber pl-10 font-28"},[e._v(e._s(t.value)+"万元")]),a("span",{staticClass:"font-16 pr-10 d-flex align-center"},[a("app-icon",{staticClass:"iconSvg",attrs:{name:t.increment<0?"#ytcrm-rise-red":"#ytcrm-fall-green"}}),a("span",{staticClass:"pl-1",class:e.getColor(t.increment)},[e._v(" "+e._s(Math.abs(t.increment).toFixed(1))+"%")])],1)])])]),t.isExp?a("div",{staticClass:"isExpWarp positionR"},[a("van-loading",{directives:[{name:"show",rawName:"v-show",value:t["loading"],expression:"data['loading']"}],staticClass:"block-loading",attrs:{type:"spinner",color:"#1989fa"}}),e._l(t.top3GoodsStatList,(function(t,s){return a("div",{key:"goods"+s,staticClass:"mx-4 pt-10"},[a("van-progress",{staticClass:"mb-1",attrs:{percentage:t.progress,color:"#3561F2","show-pivot":!1,"stroke-width":"12"}}),a("div",{staticClass:"d-flex justify-space-between align-center font-14 py-10"},[a("span",{staticClass:"flex-3 slh"},[e._v(e._s(t.goodsId)+"/"+e._s(t.goodsName))]),a("span",{staticClass:"color-main-3 flex-2 pl-1"},[e._v(e._s(t.value)+"万元")]),a("span",{staticClass:"flex-1 textAlignR",class:e.getColor(t.increment)},[e._v(e._s(e.getFH(t.increment))+e._s(t.increment)+"%")])])],1)}))],2):e._e()])})),0)],1)],1),a("div",{staticClass:"commonOpButton-footer"},[a("van-button",{attrs:{round:"",type:"primary",color:"#3561F2"},on:{click:function(t){e.orderTypeFlag=!0}}},[e._v(" 排序方式 ")])],1),a("van-action-sheet",{attrs:{actions:[{name:"销售实绩正序",id:"1-1",color:e.sortField+"-"+e.sortOrder==="1-1"?"#2271F5":""},{name:"销售实绩倒序",id:"1-2",color:e.sortField+"-"+e.sortOrder==="1-2"?"#2271F5":""},{name:"同比增幅正序",id:"3-1",color:e.sortField+"-"+e.sortOrder==="3-1"?"#2271F5":""},{name:"同比增幅倒序",id:"3-2",color:e.sortField+"-"+e.sortOrder==="3-2"?"#2271F5":""}],"cancel-text":"取消","get-container":"body","close-on-click-action":""},on:{select:e.orderTypeSelect},model:{value:e.orderTypeFlag,callback:function(t){e.orderTypeFlag=t},expression:"orderTypeFlag"}}),a("van-calendar",{attrs:{"default-date":e.csjNowTime,"min-date":new Date(2021,0,1),"max-date":new Date((new Date).getTime()-864e5),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{select:e.calendarConfirm},model:{value:e.calendarShow,callback:function(t){e.calendarShow=t},expression:"calendarShow"}})],1)},n=[],i=a("2909"),r=a("1da1"),o=a("5530"),c=a("d4ec"),l=a("bee2"),d=a("262e"),u=a("2caf"),p=(a("96cf"),a("ac1f"),a("5319"),a("d81d"),a("99af"),a("4de4"),a("d3b7"),a("1276"),a("b0c0"),a("9ab4")),f=a("1b40"),h=a("2279"),g=a("5b92"),b=a("53ae"),m=a("b32d"),v=a("7909"),y=a("4bb5"),x=Object(y["a"])("app"),C=function(e){Object(d["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(c["a"])(this,a),e=t.apply(this,arguments),e.entryObj={},e.calendarShow=!1,e.dateTime="",e.brandSearchValue="",e.brandList=[],e.orderTypeFlag=!1,e.sortField=1,e.sortOrder=2,e}return Object(l["a"])(a,[{key:"getColor",get:function(){return function(e){if(e){var t=String(e).replace(",","");return+t>0?"color-normal":"color-never"}}}},{key:"getFH",get:function(){return function(e){if(e){var t=String(e).replace(",","");return+t>0?"+":""}}}},{key:"calendarClick",value:function(){this.calendarShow=!0}},{key:"isExpClick",value:function(e){e.isExp=!e.isExp,e.top3GoodsStatList&&e.top3GoodsStatList.length||this._getAllListByBrand(e)}},{key:"detailClick",value:function(e,t){this.$router.push({name:"brandCollectionPageDetail",query:Object(o["a"])(Object(o["a"])({},this.entryObj),{},{brandId:e,brandName:t})})}},{key:"calendarConfirm",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.calendarShow=!1,this.SET_CSJNOWTIME(t),this.SET_CSJCHANGETIME(!0),this.dateTime=this.$dayjs(t).format("YYYY-MM-DD"),this.onRefresh();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!1,this.dataList=[],this.page=1,this.onLoad()}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.dataList=[],this.refreshing=!1),this.loading=!0,this._getStatListByDept()}},{key:"_getStatListByDept",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["N"])({date:this.dateTime,deptId:this.entryObj.id,queryTop3Flag:0,pageFlag:1,pageSize:8,pageNum:this.page,sortField:this.sortField,sortOrder:this.sortOrder,brandKeyword:this.brandSearchValue});case 2:t=e.sent,this.loading=!1,this.refreshing=!1,t.success?(a=t.data.list.map((function(e,t){return e.loading=!1,{brandId:e.brandId,brandName:e.brandName,loading:e.loading,topNumber:t+1+8*(s.page-1),value:Object(g["d"])(e.yearAmount,1),increment:Object(g["d"])(e.yearOnPercent,2),isExp:1===s.page&&(0===t||1===t)}})),this.dataList=this.dataList.concat(a),1===this.page&&(this._getAllListByBrand(this.dataList[0]),this._getAllListByBrand(this.dataList[1])),this.total=t.data.total,t.data.hasNextPage&&this.page++,this.finished=!t.data.hasNextPage):this.error=!0;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_getAllListByBrand",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.$set(t,"loading",!0),e.next=3,Object(h["d"])({brandId:t.brandId,goodsKeyword:"",date:this.dateTime,deptId:this.entryObj.id,pageFlag:1,queryTop3Flag:1,full:!0});case 3:a=e.sent,"200"===a.code&&(s=a.data.list.map((function(e){return e.totalValueArr=[],a.data.list.filter((function(t){e.totalValueArr.push(t.yearAmount)})),{goodsId:e.goodsId,goodsName:e.goodsName,value:Object(g["d"])(e.yearAmount,1),increment:Object(g["d"])(e.yearOnPercent,2),progress:v["d"](v["c"](e.yearAmount,v["g"](Object(i["a"])(e.totalValueArr))),100)}})),this.$set(t,"loading",!1),this.$set(t,"top3GoodsStatList",s));case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"orderTypeSelect",value:function(e){var t=e.id.split("-");this.sortField=t[0],this.sortOrder=t[1],this.onRefresh()}},{key:"created",value:function(){this.entryObj=this.$route.query,this.dateTime=this.$dayjs(this.csjNowTime).format("YYYY-MM-DD")}},{key:"activated",value:function(){this.dateTime&&this.dateTime!==this.$dayjs(this.csjNowTime).format("YYYY-MM-DD")&&(this.dateTime=this.$dayjs(this.csjNowTime).format("YYYY-MM-DD"),this.onRefresh())}}]),a}(Object(f["b"])(b["a"]));Object(p["a"])([x.Getter],C.prototype,"csjNowTime",void 0),Object(p["a"])([x.Getter],C.prototype,"csjChangeTime",void 0),Object(p["a"])([x.Mutation],C.prototype,"SET_CSJNOWTIME",void 0),Object(p["a"])([x.Mutation],C.prototype,"SET_CSJCHANGETIME",void 0),C=Object(p["a"])([Object(f["a"])({beforeRouteEnter:function(e,t,a){a((function(e){"salesLineHighRise0"!==t.name&&"salesLineHighRise1"!==t.name&&"salesLineHighRise1Inner"!==t.name&&"salesLineMiddleRise2"!==t.name&&"salesLineMiddleRise2Inner"!==t.name&&"salesLineMiddleRise3"!==t.name&&"salesLineMiddleRise3Inner"!==t.name||(e.dataList=[],e.brandSearchValue="",e.onRefresh(),e.entryObj=Object(o["a"])({},e.$route.query))}))},beforeRouteLeave:function(e,t,a){"brandCollectionPageDetail"!==e.name&&Object(m["b"])(),a()}})],C);var O=C,j=O,k=(a("6c1c"),a("2877")),w=Object(k["a"])(j,s,n,!1,null,"3c1ac00f",null);t["default"]=w.exports},"8a2e":function(e,t,a){}}]);