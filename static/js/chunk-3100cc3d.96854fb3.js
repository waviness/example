(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3100cc3d"],{"18d1":function(t,e,a){"use strict";a("66b5")},"39bf":function(t,e,a){},4728:function(t,e,a){"use strict";a("39bf")},6613:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cust-list"},[a("van-sticky",{on:{scroll:t.onStickyChange}},[a("div",{class:t.isFixed?"cust-header--bg":"cust-header"},[a("div",{staticClass:"cust-title"},[a("div",{staticClass:"cust-title__name"},[t._v("最新客情")])]),a("div",{ref:"timeDiv",staticClass:"cust-time",on:{click:t.changeDate}},[t._v(" "+t._s(t.today)+" "),a("app-icon",{attrs:{name:"#ytcrm-qiehuan"}})],1),a("div",{staticClass:"cust-filter"},[a("div",{staticClass:"cust-filter__list"},[a("div",{class:["cust-filter__item",1===t.active?"cust-filter__item--active":""],on:{click:function(e){return t.changeActive(1)}}},[t._v(" 今天 "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.dayActive,expression:"dayActive"}],staticClass:"dot"})]),a("div",{class:["cust-filter__item",2===t.active?"cust-filter__item--active":""],on:{click:function(e){return t.changeActive(2)}}},[t._v(" 本周 ")]),a("div",{class:["cust-filter__item",3===t.active?"cust-filter__item--active":""],on:{click:function(e){return t.changeActive(3)}}},[t._v(" 上周 ")])]),a("div",{staticClass:"warp"},[a("van-icon",{attrs:{color:"#fc923f",name:t.viewStarFlag?"star":"star-o"},on:{click:function(e){return t.changeFlag("star")}}}),a("div",{staticClass:"cust-filter__right right",on:{click:function(e){return t.changeFlag("reload")}}})],1)])])]),0!==t.dateRange.length?a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.getDataList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e,i){return a("cust-item",{key:i,attrs:{data:e},on:{toDetail:t.toCustDetail}})})),1)],1):t._e(),a("van-calendar",{attrs:{type:"range","default-date":t.dateRange,"min-date":new Date(2020,0,1),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{confirm:t.calendarConfirm},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}})],1)},n=[],s=a("2909"),r=a("1da1"),c=a("d4ec"),o=a("bee2"),l=a("262e"),u=a("2caf"),d=(a("96cf"),a("99af"),a("d3b7"),a("159b"),a("a434"),a("ac1f"),a("5319"),a("b0c0"),a("9ab4")),h=a("1b40"),f=a("93bd"),v=a("d926"),g=a("74d2"),p=function(t){Object(l["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(c["a"])(this,a),t=e.apply(this,arguments),t.isFixed=!1,t.today=t.formatDate(new Date),t.dataList=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.page=1,t.pageSize=10,t.active=1,t.dayActive=!0,t.startTime=Object(v["c"])(new Date)+" 00:00:00",t.endTime=Object(v["c"])(new Date)+" 23:59:59",t.viewStarFlag=0,t.calendarShow=!1,t.dateRange=[],t}return Object(o["a"])(a,[{key:"onStickyChange",value:function(t){this.isFixed=t.isFixed;var e=this.$refs.timeDiv,a=t.scrollTop>58?58:t.scrollTop,i=a>54?12:20-a/3,n=t.scrollTop>80?-16:64-t.scrollTop;e.style="margin-left: ".concat(a,"px;font-size: ").concat(i,"px;margin-top: ").concat(a<58?10:n,"px;")}},{key:"changeFlag",value:function(t){"star"===t&&(this.viewStarFlag=0===this.viewStarFlag?1:0),this.onRefresh()}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!0,this.dataList=[],this.page=1,this.getDataList()}},{key:"getDataList",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,Object(g["o"])({startTime:Object(v["c"])(this.dateRange[0])+" 00:00:00",endTime:Object(v["c"])(this.dateRange[1])+" 23:59:59",pageNum:this.page,pageSize:this.pageSize,viewStarFlag:this.viewStarFlag});case 3:e=t.sent,this.loading=!1,this.refreshing=!1,e.success?(a=e.data.list,a.forEach((function(t){t.crmLabelRemarkDtoList=t.crmLabelRemarkDtoList.splice(0,2)})),this.dataList=[].concat(Object(s["a"])(this.dataList),Object(s["a"])(a)),this.finished=!e.data.hasNextPage,this.page++):this.error=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"toCustDetail",value:function(t){this.$router.push({name:"CustDetail",params:t})}},{key:"formatDate",value:function(t){var e=new Date(t).getMonth()+1,a=new Date(t).getDate();return"".concat(e,"月").concat(a,"日")}},{key:"changeActive",value:function(t){if(this.active=t,1===t)this.startTime=Object(v["c"])(new Date)+" 00:00:00",this.endTime=Object(v["c"])(new Date)+" 23:59:59",this.dateRange=[new Date,new Date],this.today=this.formatDate(new Date);else if(2===t)this.startTime=Object(v["j"])(new Date).replace(/-/g,"/")+" 00:00:00",this.endTime=Object(v["i"])(new Date).replace(/-/g,"/")+" 23:59:59",this.dateRange=[new Date(this.startTime),new Date(this.endTime)],this.today=this.formatDate(new Date(this.startTime))+"~"+this.formatDate(new Date(this.endTime));else if(3===t){var e=new Date((new Date).getTime()-6048e5);this.startTime=Object(v["j"])(e).replace(/-/g,"/")+" 00:00:00",this.endTime=Object(v["i"])(e).replace(/-/g,"/")+" 23:59:59",this.dateRange=[new Date(this.startTime),new Date(this.endTime)],this.today=this.formatDate(new Date(this.startTime))+"~"+this.formatDate(new Date(this.endTime))}this.onRefresh()}},{key:"changeDate",value:function(){this.calendarShow=!0}},{key:"calendarConfirm",value:function(t){this.calendarShow=!1,this.dateRange=t,this.active=-1,this.today=this.formatDate(new Date(this.dateRange[0]))+" ~ "+this.formatDate(new Date(this.dateRange[1])),this.onRefresh()}},{key:"mounted",value:function(){this.dateRange=[new Date,new Date]}},{key:"activated",value:function(){var t=this;0===this.dateRange.length&&this.$nextTick((function(){t.dateRange=[new Date,new Date]}))}}]),a}(h["d"]);p=Object(d["a"])([Object(h["a"])({components:{CustItem:f["a"]},beforeRouteLeave:function(t,e,a){this.calendarShow?(this.calendarShow=!1,a(!1)):"CabinIndex"===t.name?(this.dataList=[],this.today=this.formatDate(new Date),this.page=1,this.active=1,this.viewStarFlag=0,this.dateRange=[],this.startTime=Object(v["c"])(new Date)+" 00:00:00",this.endTime=Object(v["c"])(new Date)+" 23:59:59",this.loading=!1,this.finished=!1,this.refreshing=!1,this.error=!1,a(!0)):a(!0)}})],p);var w=p,D=w,m=(a("18d1"),a("2877")),_=Object(m["a"])(D,i,n,!1,null,"5e22b0e7",null);e["default"]=_.exports},"66b5":function(t,e,a){},"93bd":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:["wrapper van-clearfix",2===t.data.warmthNum?"border-orange":3===t.data.warmthNum?"border-red":"border-green"],on:{click:function(e){return t.toDetail(t.data)}}},[a("div",{staticClass:"wrapper-left"},[a("div",{staticClass:"wrapper-left__location"},[t._v(t._s(t.data.companyId)+"/"+t._s(t.data.companyName))]),a("div",{staticClass:"wrapper-left__group gray-text"},[a("span",{staticClass:"mr-10"},[t._v(t._s(t.data.visitUserName))]),a("span",[t._v(t._s(t.data.visitUserPosition))])]),t._l(t.data.crmLabelRemarkDtoList,(function(e,i){return a("div",{key:i,staticClass:"wrapper-info"},[a("span",{staticClass:"wrapper-info__title"},[t._v(t._s(e.labelName)),a("span",{directives:[{name:"show",rawName:"v-show",value:e.expectTimeStr,expression:"item.expectTimeStr"}],staticClass:"time"},[t._v("("+t._s(e.expectTimeStr)+")")]),t._v("：")]),a("span",{staticClass:"wrapper-info__content"},[t._v(t._s(e.remark))])])}))],2),a("div",{staticClass:"wrapper-right"},[a("div",{staticClass:"gray-text"},[t._v(t._s(t.data.credate?t.data.credate.slice(0,t.data.credate.length-3):""))]),a("van-icon",{staticClass:"arrow-right",style:"color: "+t.data.color,attrs:{name:"down"}}),2===t.data.taskType?a("div",{staticClass:"wrapper-visit wrapper-visit--bom gray-text"},[a("span",{staticClass:"wrapper-visit__title"},[t._v("拜访人")]),a("span",{staticClass:"wrapper-visit__name"},[t._v(t._s(t.data.creName))])]):t._e(),2===t.data.taskType?a("div",{staticClass:"wrapper-visit gray-text"},[a("span",{staticClass:"wrapper-visit__title"},[t._v("协访人")]),a("span",{staticClass:"wrapper-visit__name"},[t._v(t._s(t.data.togetherUserName))])]):1===t.data.taskType?a("div",{staticClass:"wrapper-visit gray-text"},[a("span",{staticClass:"wrapper-visit__title"},[t._v("个人拜访")]),a("span",{staticClass:"wrapper-visit__name"},[t._v(t._s(t.data.creName))])]):3===t.data.taskType?a("div",{staticClass:"wrapper-visit gray-text"},[a("span",{staticClass:"wrapper-visit__title"},[t._v("接待")]),a("span",{staticClass:"wrapper-visit__name"},[t._v(t._s(t.data.creName))])]):t._e()],1)])},n=[],s=a("d4ec"),r=a("bee2"),c=a("262e"),o=a("2caf"),l=a("9ab4"),u=a("1b40"),d=function(t){Object(c["a"])(a,t);var e=Object(o["a"])(a);function a(){return Object(s["a"])(this,a),e.apply(this,arguments)}return Object(r["a"])(a,[{key:"toDetail",value:function(t){this.$emit("toDetail",t)}}]),a}(u["d"]);Object(l["a"])([Object(u["c"])()],d.prototype,"data",void 0),d=Object(l["a"])([Object(u["a"])({})],d);var h=d,f=h,v=(a("4728"),a("2877")),g=Object(v["a"])(f,i,n,!1,null,"75c321c6",null);e["a"]=g.exports},d926:function(t,e,a){"use strict";a.d(e,"c",(function(){return d})),a.d(e,"d",(function(){return h})),a.d(e,"j",(function(){return f})),a.d(e,"i",(function(){return v})),a.d(e,"k",(function(){return g})),a.d(e,"b",(function(){return p})),a.d(e,"e",(function(){return w})),a.d(e,"g",(function(){return D})),a.d(e,"f",(function(){return m})),a.d(e,"a",(function(){return _})),a.d(e,"h",(function(){return b}));a("d3b7"),a("25f0"),a("ac1f"),a("1276");var i=a("5a0c"),n=a.n(i),s=new Date,r=s.getDay(),c=s.getDate(),o=s.getMonth(),l=s.getYear();l+=l<2e3?1900:0;var u=new Date;function d(t){var e=new Date(t),a=e.getFullYear(),i=(e.getMonth()+1).toString(),n=e.getDate().toString();return+i<10&&(i="0"+i),+n<10&&(n="0"+n),a+"-"+i+"-"+n}function h(t){var e=new Date(t),a=e.getFullYear(),i=(e.getMonth()+1).toString(),n=e.getDate().toString();return+i<10&&(i="0"+i),+n<10&&(n="0"+n),a+"/"+i+"/"+n}function f(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var a=new Date(e),i=a.getDay();i=0===i?7:i;var n=a.getDate(),s=a.getMonth(),u=a.getYear();u+=u<2e3?1900:0,t=new Date(u,s,n-(i-1))}else t=new Date(l,o,c-(r-1));return d(t)}function v(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var a=new Date(e),i=a.getDay();i=0===i?7:i;var n=a.getDate(),s=a.getMonth(),u=a.getYear();u+=u<2e3?1900:0,t=new Date(u,s,n+(6-(i-1)))}else t=new Date(l,o,c+(6-(r-1)));return d(t)}function g(t){return 0===n()(t).day()?n()(t).startOf("week").subtract(6,"day").format("YYYY-MM-DD"):n()(t).startOf("week").add(1,"day").format("YYYY-MM-DD")}function p(t){return 0===n()(t).day()?n()(t).endOf("week").subtract(6,"day").format("YYYY-MM-DD"):n()(t).endOf("week").add(1,"day").format("YYYY-MM-DD")}u.setDate(1),u.setMonth(u.getMonth()-1);var w=function(t,e){var a=[],i=t.split("-"),n=e.split("-"),s=new Date(i+" 08:00:00");s.setUTCFullYear(i[0],i[1]-1,i[2]);var r=new Date(n+" 08:00:00");r.setUTCFullYear(n[0],n[1]-1,n[2]);var c,o=s.getTime(),l=r.getTime(),u=864e5;for(c=o;c<=l;)a.push(d(new Date(parseInt(String(c))))),c+=u;return a},D=function(t,e){var a=new Date(t),i="";a.setDate(a.getDate()+e);var n=a.getFullYear(),s=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,r=a.getDate()<10?"0"+a.getDate():a.getDate();return i=n+"-"+s+"-"+r,i},m=function(t){var e,a,i,n,s=new Date(t+"-01-01"),r=s.getFullYear(),c={result0:[],result1:[],result2:[],result3:[],result4:[],result5:[],result6:[]};for(e=1;e<=12;e++){switch(e){case 1:case 3:case 5:case 7:case 8:case 10:case 12:n=31;break;case 4:case 6:case 9:case 11:n=30;break;case 2:n=r%4===0&&r%100!==0||r%400===0?29:28;break}for(a=1;a<=n;a++){s.setMonth(e-1,a),i=s.getDay();var o=s.getFullYear(),l=s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1,u=s.getDate()<10?"0"+s.getDate():s.getDate();c["result"+i].push(o+"-"+l+"-"+u)}}return c};function _(t){switch(t){case 0:return"日";case 1:return"一";case 2:return"二";case 3:return"三";case 4:return"四";case 5:return"五";case 6:return"六";default:break}}var b=function(t){var e=new Date,a=e.getFullYear(),i=e.getMonth()+1,n=e.getDate(),s=t.split("-"),r=0;if(i>parseInt(s[0])||i==parseInt(s[0])&&n>parseInt(s[1])){var c=new Date(a+1,parseInt(s[0])-1,parseInt(s[1])).toLocaleDateString(),o=Date.parse(c),l=Date.parse(e.toLocaleDateString());r=(o-l)/864e5}else{var u=new Date(a,parseInt(s[1])-1,parseInt(s[2])).toLocaleDateString(),d=Date.parse(u),h=Date.parse(e.toLocaleDateString());r=(d-h)/864e5}if(r<0){var f=a+1,v=f%4===0&&f%100!==0||f%400===0?366:365;r+=v}return r}}}]);