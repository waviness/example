(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ed79a6a"],{"21b0":function(e,t,a){},"2cbb":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"background-color-white"},[a("van-sticky",[a("div",{staticClass:"header px-4 d-flex align-center background-color-white"},[a("div",{staticClass:"flex-3 d-flex flex-column"},[a("span",{staticClass:"font-24 fontWeight color-black-1",staticStyle:{"font-family":"'HarmonyOS Sans SC Black'"}},[e._v(" "+e._s(e.entryObj.brandId)+"/ "+e._s(e.entryObj.brandName)+" ")]),a("span",{staticClass:"font-12 color-gray-5"},[e._v(e._s(e.entryObj.deptName)+"/"+e._s(e.entryObj.businessForm))])]),a("div",{staticClass:"flex-2 textAlignR",staticStyle:{"font-family":"'HarmonyOS Sans SC Bold'"},on:{click:e.calendarClick}},[a("span",{staticClass:"time color-gray-4 fontWeight font-16"},[e._v(e._s(e.dateTime))]),a("van-icon",{staticClass:"pl-1",attrs:{size:"14px",name:"arrow-down"}})],1)]),a("div",{staticClass:"d-flex background-color-white"},[a("van-search",{staticClass:"flex-2",attrs:{shape:"round",placeholder:"搜索","input-align":"center"},on:{input:e.businessSearchInput},model:{value:e.businessSearchDetailValue,callback:function(t){e.businessSearchDetailValue=t},expression:"businessSearchDetailValue"}}),a("div",{staticClass:"d-flex flex-1 align-center justify-center",on:{click:function(t){e.showAreaPicker=!0}}},[a("span",{staticClass:"time color-gray-4 fontWeight font-16"},[e._v(" "+e._s(e.areaArr[0]?e.areaArr[1].split("市")[0]+"地区":"地区: 全部"))]),a("van-icon",{staticClass:"pl-1",attrs:{size:"14px",name:"arrow-down"}})],1)],1)]),a("div",{staticClass:"px-10 pt-10"},[a("div",{staticClass:"card py-2 pl-4 d-flex align-center positionR"},[e.totalLoading?a("div",{staticClass:"block-loading d-flex justify-center pa-8"},[a("van-loading",{attrs:{type:"spinner",color:"#3561F2"}})],1):e._e(),a("ul",{staticClass:"salesWarp d-flex flex-column"},[e._m(0),a("li",{staticClass:"d-flex flex-column"},[a("span",{staticClass:"font-28 fontWeight",staticStyle:{"font-family":"HarmonyOS_Sans_SC_Black"}},[e._v(e._s(e.yearAmountTotal)+" ")]),a("span",{staticClass:"color-main-2 font-14"},[e._v(e._s(e.getFH(e.yearNetIncreaseTotal))+e._s(e.yearNetIncreaseTotal))])])]),a("div",{staticClass:"d-flex align-center echarts",on:{click:e.areaClick}},[a("div",{attrs:{id:"businessEcharts"}}),a("van-icon",{staticClass:"pr-1",attrs:{size:"14px",name:"arrow"}})],1)])]),a("div",{staticClass:"px-4 pb-100"},[a("van-pull-refresh",{staticClass:"pt-10",on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[a("van-list",{staticClass:"px-2",attrs:{offset:20,finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.dataList,(function(t,s){return a("div",{key:s,on:{click:function(a){return e.dataClick(t)}}},[a("div",{staticClass:"color-gray-5 font-14 d-flex justify-space-between py-10",staticStyle:{"font-family":"HarmonyOS_Sans_SC_Medium"}},[a("span",{staticClass:"flex-5 color-main-3"},[e._v(e._s(t.customerId)+"/"+e._s(t.customerName))]),a("span",{staticClass:"flex-3 textAlignR"},[e._v("地区:"+e._s(t.areaShow)+" "),a("van-icon",{staticClass:"pl-1",attrs:{size:"18px",name:"arrow"}})],1)]),a("div",{staticClass:"borderBottom d-flex justify-space-between pb-10"},[a("div",{staticClass:"d-flex flex-1 flex-column"},[a("span",{staticClass:"color-gray-4 font-14"},[e._v("销售实绩")]),a("span",{staticClass:"color-gray-5 font-16 pt-1"},[e._v(e._s(t.yearAmount))])]),a("div",{staticClass:"d-flex flex-1 flex-column"},[a("span",{staticClass:"color-gray-4 font-14"},[e._v("较同期净增")]),a("span",{staticClass:"font-16 pt-1",class:e.getColor(t.yearNetIncrease)},[e._v(e._s(e.getFH(t.yearNetIncrease))+e._s(t.yearNetIncrease))])]),a("div",{staticClass:"d-flex flex-column pl-2"},[a("span",{staticClass:"color-gray-4 font-14"},[e._v("同比增幅")]),a("span",{staticClass:"font-16 pt-1",class:e.getColor(t.yearOnPercent)},[e._v(e._s(e.getFH(t.yearOnPercent))+e._s(t.yearOnPercent)+"%")])])])])})),0)],1)],1),a("div",{staticClass:"commonOpButton-footer"},[a("van-button",{attrs:{round:"",type:"primary",color:"#3561F2"},on:{click:function(t){e.orderTypeFlag=!0}}},[e._v(" 排序方式 ")])],1),a("van-action-sheet",{attrs:{actions:[{name:"销售实绩正序",id:"1-1",color:e.sortField+"-"+e.sortOrder==="1-1"?"#2271F5":""},{name:"销售实绩倒序",id:"1-2",color:e.sortField+"-"+e.sortOrder==="1-2"?"#2271F5":""},{name:"同比增幅正序",id:"3-1",color:e.sortField+"-"+e.sortOrder==="3-1"?"#2271F5":""},{name:"同比增幅倒序",id:"3-2",color:e.sortField+"-"+e.sortOrder==="3-2"?"#2271F5":""}],"cancel-text":"取消","get-container":"body","close-on-click-action":""},on:{select:e.orderTypeSelect},model:{value:e.orderTypeFlag,callback:function(t){e.orderTypeFlag=t},expression:"orderTypeFlag"}}),a("van-calendar",{attrs:{"default-date":e.csjNowTime,"min-date":new Date(2021,0,1),"max-date":new Date((new Date).getTime()-864e5),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{select:e.calendarConfirm},model:{value:e.calendarShow,callback:function(t){e.calendarShow=t},expression:"calendarShow"}}),a("van-popup",{attrs:{position:"bottom"},model:{value:e.showAreaPicker,callback:function(t){e.showAreaPicker=t},expression:"showAreaPicker"}},[a("van-picker",{attrs:{"show-toolbar":"",columns:e.areaList},on:{confirm:e.areaConfirm}})],1)],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("li",{staticClass:"color-gray-4 font-14"},[e._v("销售实绩"),a("span",{staticClass:"font-12"},[e._v("(万元)")])])}],i=a("5530"),n=a("1da1"),o=a("d4ec"),c=a("bee2"),l=a("262e"),d=a("2caf"),u=(a("96cf"),a("ac1f"),a("5319"),a("d81d"),a("1276"),a("99af"),a("d3b7"),a("7db0"),a("b680"),a("b0c0"),a("9ab4")),h=a("1b40"),f=a("53ae"),m=a("313e"),b=a("5b92"),y=a("2279"),p=a("4bb5"),v=Object(p["a"])("app"),g=function(e){Object(l["a"])(a,e);var t=Object(d["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.orderTypeFlag=!1,e.sortField=1,e.sortOrder=2,e.entryObj={},e.calendarShow=!1,e.dateTime="",e.businessSearchDetailValue="",e.myChart=null,e.brandHeaderObj={},e.middleList=[],e.totalLoading=!1,e.showAreaPicker=!1,e.areaList=[],e.areaArr=["",""],e.echartsList=[],e.yearAmountTotal=0,e.yearNetIncreaseTotal=0,e}return Object(c["a"])(a,[{key:"getColor",get:function(){return function(e){if(e){var t=String(e).replace(",","");return+t>0?"color-normal":"color-never"}}}},{key:"getFH",get:function(){return function(e){if(e){var t=String(e).replace(",","");return+t>0?"+":""}}}},{key:"businessSearchInput",value:function(){this.onRefresh()}},{key:"calendarConfirm",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.calendarShow=!1,this.SET_CSJNOWTIME(t),this.SET_CSJCHANGETIME(!0),this.dateTime=this.$dayjs(t).format("YYYY-MM-DD"),this.onRefresh(),this.init();case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"calendarClick",value:function(){this.calendarShow=!0}},{key:"getEcharts",value:function(e){this.myChart&&this.myChart.clear();var t,a=document.getElementById("businessEcharts");this.myChart=m["b"](a),t={legend:{type:"scroll",orient:"vertical",icon:"circle",itemWidth:9,itemHeight:9,selectedMode:!1,textStyle:{fontSize:10},right:10,top:"center"},series:[{name:"Access From",type:"pie",radius:["50%","80%"],center:["30%","50%"],avoidLabelOverlap:!1,itemStyle:{borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},data:e}]},t&&this.myChart.setOption(t)}},{key:"onRefresh",value:function(){this.finished=!1,this.loading=!1,this.dataList=[],this.page=1,this.onLoad()}},{key:"dataClick",value:function(e){this.$router.push({name:"brandCollectionPageCustomDetail",query:{brandId:this.entryObj.brandId,brandName:this.entryObj.brandName,deptId:this.entryObj.deptId,deptName:this.entryObj.deptName,customerId:e.customerId,customerName:e.customerName,businessForm:this.entryObj.businessForm,dateTime:this.dateTime}})}},{key:"onLoad",value:function(){this.refreshing&&(this.page=1,this.dataList=[],this.refreshing=!1),this.loading=!0,this._getStatList()}},{key:"_getStatList",value:function(){var e=this;Object(y["M"])({brandId:this.entryObj.brandId,businessForm:this.entryObj.businessForm,date:this.dateTime,deptId:this.entryObj.deptId,pageNum:this.page,pageSize:8,area:"",city:this.areaArr[1],province:this.areaArr[0],customerKeyword:this.businessSearchDetailValue,sortField:this.sortField,sortOrder:this.sortOrder}).then((function(t){if(e.loading=!1,e.refreshing=!1,t.success){var a=t.data.list.map((function(e){return{areaShow:e.city.split("市")[0]+"地区",area:e.area,city:e.city,province:e.province,customerId:e.customerId,customerName:e.customerName,yearAmount:Object(b["d"])(e.yearAmount,1),yearNetIncrease:Object(b["d"])(e.yearNetIncrease,1),yearOnAmount:Object(b["d"])(e.yearOnAmount,1),yearOnPercent:Object(b["d"])(e.yearOnPercent,2)}}));e.dataList=e.dataList.concat(a),e.total=t.data.total,t.data.hasNextPage&&e.page++,e.finished=!t.data.hasNextPage}else e.error=!0}))}},{key:"buildRegionTree",value:function(e){return e.reduce((function(e,t){var a=t.province,s=t.city,r=e.find((function(e){return e.text===a}));return r||(r={text:a,children:[]},e.push(r)),r.children.some((function(e){return e.text===s}))||r.children.push({text:s,children:null}),e}),[])}},{key:"_getDynamicRegionList",value:function(){var e=this;Object(y["r"])({brandId:this.entryObj.brandId,businessForm:this.entryObj.businessForm,date:this.dateTime,deptId:this.entryObj.deptId}).then((function(t){e.areaList=[{text:"全部",children:[{text:"全部"}]}],e.areaList=e.areaList.concat(e.buildRegionTree(t.data))}))}},{key:"_getRegionStatList",value:function(){var e=this;Object(y["F"])({brandId:this.entryObj.brandId,businessForm:this.entryObj.businessForm,date:this.dateTime,deptId:this.entryObj.deptId,pageNum:1,pageSize:5}).then((function(t){e.echartsList=[];for(var a=0,s=0,r=0;r<t.data.list.length;r++){var i=t.data.list[r];a=e.$arithmetic.add(a,i.yearAmount).toFixed(2),s=e.$arithmetic.add(s,i.yearNetIncrease).toFixed(2),e.echartsList.push({name:i.city.split("市")[0]+"地区",value:i.yearAmount})}e.yearAmountTotal=Object(b["d"])(a,1),e.yearNetIncreaseTotal=Object(b["d"])(s,1),e.getEcharts(e.echartsList)}))}},{key:"areaConfirm",value:function(e){"全部"===e[0]?this.areaArr=["",""]:this.areaArr=e,this.showAreaPicker=!1,this.onRefresh()}},{key:"orderTypeSelect",value:function(e){var t=e.id.split("-");this.sortField=t[0],this.sortOrder=t[1],this.onRefresh()}},{key:"areaClick",value:function(){this.$router.push({name:"brandCollectionBusinessArea",query:{brandId:this.entryObj.brandId,brandName:this.entryObj.brandName,deptId:this.entryObj.deptId,deptName:this.entryObj.deptName,businessForm:this.entryObj.businessForm,dateTime:this.dateTime}})}},{key:"activated",value:function(){this.dateTime&&this.dateTime!==this.$dayjs(this.csjNowTime).format("YYYY-MM-DD")&&(this.dateTime=this.$dayjs(this.csjNowTime).format("YYYY-MM-DD"),this.onRefresh(),this.init())}},{key:"created",value:function(){this.entryObj=this.$route.query,this.dateTime=this.entryObj.date}},{key:"init",value:function(){this._getDynamicRegionList(),this._getRegionStatList()}},{key:"mounted",value:function(){document.documentElement.scrollTop=0,this.init()}}]),a}(Object(h["b"])(f["a"]));Object(u["a"])([v.Getter],g.prototype,"csjNowTime",void 0),Object(u["a"])([v.Getter],g.prototype,"csjChangeTime",void 0),Object(u["a"])([v.Mutation],g.prototype,"SET_CSJNOWTIME",void 0),Object(u["a"])([v.Mutation],g.prototype,"SET_CSJCHANGETIME",void 0),g=Object(u["a"])([Object(h["a"])({beforeRouteEnter:function(e,t,a){a((function(e){"brandCollectionPageDetail"===t.name&&(e.entryObj=Object(i["a"])({},e.$route.query),e.dataList=[],e.businessSearchDetailValue="",e.onRefresh(),e.init(),e.dateTime=e.entryObj.date)}))}})],g);var O=g,C=O,j=(a("528b"),a("2877")),k=Object(j["a"])(C,s,r,!1,null,"0ebf1117",null);t["default"]=k.exports},"528b":function(e,t,a){"use strict";a("21b0")},"53ae":function(e,t,a){"use strict";var s=a("d4ec"),r=a("bee2"),i=a("262e"),n=a("2caf"),o=(a("b0c0"),a("9ab4")),c=a("1b40");c["a"].registerHooks(["beforeRouteEnter"]);var l=function(e){Object(i["a"])(a,e);var t=Object(n["a"])(a);function a(){var e;return Object(s["a"])(this,a),e=t.apply(this,arguments),e.page=1,e.total=0,e.dataList=[],e.loading=!1,e.finished=!1,e.refreshing=!1,e.finishText="",e.userIdList=[],e.error=!1,e}return Object(r["a"])(a,[{key:"beforeRouteEnter",value:function(e,t,a){a((function(e){"Home"!==t.name&&"TaskIndex"!==t.name||(e.dataList=[],e.page=1,e.loading=!1,e.finished=!0,e.refreshing=!1,e.$nextTick((function(){e.finished=!1})))}))}}]),a}(c["d"]);l=Object(o["a"])([Object(c["a"])({})],l),t["a"]=l}}]);