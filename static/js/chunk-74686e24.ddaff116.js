(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74686e24"],{"146a":function(t,e,a){"use strict";a("585c")},3355:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flex justify-space-between align-baseline"},[a("div",{staticClass:"color-gray-4",style:"width: "+t.titleWidth+"px"},[t._v(t._s(t.title))]),a("div",{staticClass:"flex-1 textAlignR"},[a("span",{class:t.contentClass},[t._v(t._s(t.content))]),t.hasCopy?a("app-icon",{staticClass:"color-main-2 ml-1 copy-content",attrs:{name:"#ytcrm-fuzhi","data-clipboard-text":t.content},on:{click:t.copy}}):t._e()],1),t._t("default")],2)},s=[],i=a("d4ec"),r=a("bee2"),c=a("262e"),o=a("2caf"),l=(a("a9e3"),a("9ab4")),u=a("1b40"),d=function(t){Object(c["a"])(a,t);var e=Object(o["a"])(a);function a(){return Object(i["a"])(this,a),e.apply(this,arguments)}return Object(r["a"])(a,[{key:"copy",value:function(){var t=this,e=new this.$Clipboard(".copy-content");e.on("success",(function(a){t.$toast.success("复制成功"),e.destroy()})),e.on("error",(function(a){t.$toast.fail("该浏览器不支持自动复制"),e.destroy()}))}}]),a}(u["d"]);Object(l["a"])([Object(u["c"])({type:String,default:""})],d.prototype,"title",void 0),Object(l["a"])([Object(u["c"])({type:[String,Number],default:""})],d.prototype,"content",void 0),Object(l["a"])([Object(u["c"])({type:String,default:"color-black-2"})],d.prototype,"contentClass",void 0),Object(l["a"])([Object(u["c"])({type:Number,default:80})],d.prototype,"titleWidth",void 0),Object(l["a"])([Object(u["c"])({type:Boolean,default:!1})],d.prototype,"hasCopy",void 0),d=Object(l["a"])([Object(u["a"])({})],d);var f=d,p=f,h=a("2877"),g=Object(h["a"])(p,n,s,!1,null,null,null);e["a"]=g.exports},"585c":function(t,e,a){},6986:function(t,e,a){"use strict";a("c89b")},"7cdc":function(t,e,a){},c2b1:function(t,e,a){},c89b:function(t,e,a){},d926:function(t,e,a){"use strict";a.d(e,"c",(function(){return d})),a.d(e,"d",(function(){return f})),a.d(e,"j",(function(){return p})),a.d(e,"i",(function(){return h})),a.d(e,"k",(function(){return g})),a.d(e,"b",(function(){return v})),a.d(e,"e",(function(){return m})),a.d(e,"g",(function(){return y})),a.d(e,"f",(function(){return b})),a.d(e,"a",(function(){return k})),a.d(e,"h",(function(){return w}));a("d3b7"),a("25f0"),a("ac1f"),a("1276");var n=a("5a0c"),s=a.n(n),i=new Date,r=i.getDay(),c=i.getDate(),o=i.getMonth(),l=i.getYear();l+=l<2e3?1900:0;var u=new Date;function d(t){var e=new Date(t),a=e.getFullYear(),n=(e.getMonth()+1).toString(),s=e.getDate().toString();return+n<10&&(n="0"+n),+s<10&&(s="0"+s),a+"-"+n+"-"+s}function f(t){var e=new Date(t),a=e.getFullYear(),n=(e.getMonth()+1).toString(),s=e.getDate().toString();return+n<10&&(n="0"+n),+s<10&&(s="0"+s),a+"/"+n+"/"+s}function p(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var a=new Date(e),n=a.getDay();n=0===n?7:n;var s=a.getDate(),i=a.getMonth(),u=a.getYear();u+=u<2e3?1900:0,t=new Date(u,i,s-(n-1))}else t=new Date(l,o,c-(r-1));return d(t)}function h(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var a=new Date(e),n=a.getDay();n=0===n?7:n;var s=a.getDate(),i=a.getMonth(),u=a.getYear();u+=u<2e3?1900:0,t=new Date(u,i,s+(6-(n-1)))}else t=new Date(l,o,c+(6-(r-1)));return d(t)}function g(t){return 0===s()(t).day()?s()(t).startOf("week").subtract(6,"day").format("YYYY-MM-DD"):s()(t).startOf("week").add(1,"day").format("YYYY-MM-DD")}function v(t){return 0===s()(t).day()?s()(t).endOf("week").subtract(6,"day").format("YYYY-MM-DD"):s()(t).endOf("week").add(1,"day").format("YYYY-MM-DD")}u.setDate(1),u.setMonth(u.getMonth()-1);var m=function(t,e){var a=[],n=t.split("-"),s=e.split("-"),i=new Date(n+" 08:00:00");i.setUTCFullYear(n[0],n[1]-1,n[2]);var r=new Date(s+" 08:00:00");r.setUTCFullYear(s[0],s[1]-1,s[2]);var c,o=i.getTime(),l=r.getTime(),u=864e5;for(c=o;c<=l;)a.push(d(new Date(parseInt(String(c))))),c+=u;return a},y=function(t,e){var a=new Date(t),n="";a.setDate(a.getDate()+e);var s=a.getFullYear(),i=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,r=a.getDate()<10?"0"+a.getDate():a.getDate();return n=s+"-"+i+"-"+r,n},b=function(t){var e,a,n,s,i=new Date(t+"-01-01"),r=i.getFullYear(),c={result0:[],result1:[],result2:[],result3:[],result4:[],result5:[],result6:[]};for(e=1;e<=12;e++){switch(e){case 1:case 3:case 5:case 7:case 8:case 10:case 12:s=31;break;case 4:case 6:case 9:case 11:s=30;break;case 2:s=r%4===0&&r%100!==0||r%400===0?29:28;break}for(a=1;a<=s;a++){i.setMonth(e-1,a),n=i.getDay();var o=i.getFullYear(),l=i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1,u=i.getDate()<10?"0"+i.getDate():i.getDate();c["result"+n].push(o+"-"+l+"-"+u)}}return c};function k(t){switch(t){case 0:return"日";case 1:return"一";case 2:return"二";case 3:return"三";case 4:return"四";case 5:return"五";case 6:return"六";default:break}}var w=function(t){var e=new Date,a=e.getFullYear(),n=e.getMonth()+1,s=e.getDate(),i=t.split("-"),r=0;if(n>parseInt(i[0])||n==parseInt(i[0])&&s>parseInt(i[1])){var c=new Date(a+1,parseInt(i[0])-1,parseInt(i[1])).toLocaleDateString(),o=Date.parse(c),l=Date.parse(e.toLocaleDateString());r=(o-l)/864e5}else{var u=new Date(a,parseInt(i[1])-1,parseInt(i[2])).toLocaleDateString(),d=Date.parse(u),f=Date.parse(e.toLocaleDateString());r=(d-f)/864e5}if(r<0){var p=a+1,h=p%4===0&&p%100!==0||p%400===0?366:365;r+=h}return r}},db1b8:function(t,e,a){"use strict";a("7cdc")},e2dc:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"full-HW"},[a("van-sticky",[a("filter-pop",{attrs:{formData:t.filterObj,type:t.msgType,taskType:t.taskType},on:{confirm:t.onFilterChange}}),a("van-tabs",{attrs:{color:"#2271F5"},on:{change:t.onTabChange},model:{value:t.msgType,callback:function(e){t.msgType=e},expression:"msgType"}},[a("van-tab",{attrs:{title:"工作流",name:2,badge:t.flowCount>0?t.flowCount>99?"99+":t.flowCount:""}}),a("van-tab",{attrs:{title:"通用任务",name:1,badge:t.taskCount>0?t.taskCount>99?"99+":t.taskCount:""}})],1)],1),a("div",{staticClass:"overflow-x-hidden card-list"},[a("van-pull-refresh",{staticStyle:{"min-height":"100%"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{staticClass:"pb-100 pt-1",attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,n){return a("div",{key:n},[a("div",{staticClass:"color-gray-5 textAlignC mb-10"},[t._v(t._s(e.sendTime))]),2===t.msgType?a("flow-card",{staticClass:"mb-10",attrs:{data:e},on:{handleClick:function(a){return t.toFlowDetail(e)}}}):a("task-card",{staticClass:"mb-10",attrs:{taskType:t.taskType,data:e},on:{handleClick:function(a){return t.toDetail(e)}}})],1)})),0)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.msgType,expression:"msgType === 2"}],staticClass:"commonOpButton-footer"},[a("van-button",{attrs:{round:"",color:"#2271F5",type:"primary"},on:{click:function(e){t.showTag=!0}}},[t._v(" 标签筛选 ")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.msgType,expression:"msgType === 1"}],staticClass:"commonOpButton-footer"},[a("ul",{staticClass:"d-flex"},[a("li",{staticClass:"flex-1",class:2===t.taskType?"active":"",on:{click:function(e){return t.changeTaskType(2)}}},[t._v("我收到的")]),a("li",{staticClass:"flex-1",class:1===t.taskType?"active":"",on:{click:function(e){return t.changeTaskType(1)}}},[t._v("我发出的")])])]),a("div",{staticClass:"fix-btn fix-btn__read d-flex flex-column align-center justify-center color-gray-4",on:{click:t.readAll}},[a("app-icon",{staticClass:"font-16",attrs:{name:"#ytcrm-a-qingchu_clear1"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.msgType,expression:"msgType === 1"}],staticClass:"fix-btn fix-btn__add d-flex flex-column align-center justify-center color-gray-4",on:{click:t.toPublish}},[a("van-icon",{attrs:{size:"20px",name:"plus"}})],1),a("van-popup",{attrs:{position:"bottom",round:"",closeable:""},model:{value:t.showTag,callback:function(e){t.showTag=e},expression:"showTag"}},[a("div",{staticClass:"textAlignC py-4 font-16 fontWeight"},[t._v("标签筛选")]),a("van-tree-select",{attrs:{items:t.tagItems,"active-id":t.activeIds,"main-active-index":t.activeIndex},on:{"update:activeId":function(e){t.activeIds=e},"update:active-id":function(e){t.activeIds=e},"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e},"click-item":t.onClickTags}}),a("div",{staticClass:"px-4 py-2"},[a("van-button",{staticClass:"background-color-main-2",attrs:{type:"info",block:"",round:""},on:{click:t.onConfirmTag}},[t._v("确认")])],1)],1)],1)},s=[],i=a("5530"),r=a("2909"),c=a("1da1"),o=a("d4ec"),l=a("bee2"),u=a("262e"),d=a("2caf"),f=(a("96cf"),a("4de4"),a("d3b7"),a("99af"),a("caad"),a("2532"),a("159b"),a("c740"),a("a434"),a("d81d"),a("b64b"),a("9ab4")),p=a("1b40"),h=a("4bb5"),g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"filter d-flex"},[a("div",{class:["filter-item justify-space-between px-10",t.filterShow?"color-main-2":"",t.filterSome?"background-color-main-2 color-white":""],on:{click:function(e){t.filterShow=!t.filterShow}}},[a("div",[t._v("条件筛选")]),a("van-icon",{attrs:{name:"arrow-"+(t.filterShow?"up":"down"),size:"16px"}})],1)]),a("van-popup",{staticClass:"pop-filter",attrs:{position:"top",round:"","get-container":t.getContainer},model:{value:t.filterShow,callback:function(e){t.filterShow=e},expression:"filterShow"}},[a("van-form",[a("van-field",{attrs:{readonly:"",clickable:"",value:t.filterVal.startTime?t.filterVal.startTime+" 至 "+t.filterVal.endTime:"",label:"日期选择","input-align":"right",placeholder:"点击选择日期"},on:{click:function(e){return t.chooseFilter(1)}}}),1===t.type?a("van-field",{attrs:{readonly:"",clickable:"",value:t.filterVal.urgency.name,label:"紧急程度","input-align":"right",placeholder:"点击选择紧急程度"},on:{click:function(e){return t.chooseFilter(2)}}}):t._e(),1===t.type?a("van-field",{attrs:{readonly:"",clickable:"",value:t.filterVal.useStatus.name,label:"任务状态","input-align":"right",placeholder:"点击选择任务状态"},on:{click:function(e){return t.chooseFilter(3)}}}):t._e(),a("van-field",{attrs:{clearable:"",label:1===t.type?"标题/内容/发送人":"内容","input-align":"right",placeholder:"点击输入关键字"},model:{value:t.filterVal.keyword,callback:function(e){t.$set(t.filterVal,"keyword",e)},expression:"filterVal.keyword"}})],1),a("div",{staticClass:"dropdown-opts"},[a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"default",size:"small",block:"",round:""},on:{click:t.reset}},[t._v("重置")]),a("van-button",{staticClass:"dropdown-opts__btn",attrs:{type:"info",size:"small",block:"",round:"",color:"#2271F5"},on:{click:t.onConfirm}},[t._v("确认")])],1),1===t.selectType?a("van-calendar",{attrs:{"show-confirm":!1,color:"#2271F5",type:"range","min-date":t.minDate},on:{confirm:t.onDateConfirm},model:{value:t.selectShow,callback:function(e){t.selectShow=e},expression:"selectShow"}}):t._e(),2===t.selectType?a("van-action-sheet",{attrs:{actions:t.urgencyOptions,"cancel-text":"取消",description:"紧急程度选择","close-on-click-action":""},on:{select:t.onSelectUrgency},model:{value:t.selectShow,callback:function(e){t.selectShow=e},expression:"selectShow"}}):t._e(),3===t.selectType?a("van-action-sheet",{attrs:{actions:2===t.taskType?t.useStatusOptions:t.sendStatusOptions,"cancel-text":"取消",description:"过期状态选择","close-on-click-action":""},on:{select:t.onSelectStatus},model:{value:t.selectShow,callback:function(e){t.selectShow=e},expression:"selectShow"}}):t._e()],1)],1)},v=[],m=(a("b0c0"),a("a9e3"),a("d926")),y=[{value:"",name:"全部"},{value:2,name:"未读"},{value:1,name:"已读"},{value:0,name:"作废"}],b=[{value:"",name:"全部"},{value:1,name:"进行中"},{value:2,name:"已完成"},{value:0,name:"已作废"}],k=[{value:"",name:"全部"},{value:1,name:"普通"},{value:2,name:"重要"},{value:3,name:"紧急"}],w=function(t){Object(u["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.filterShow=!1,t.selectShow=!1,t.selectType=0,t.useStatusOptions=y,t.sendStatusOptions=b,t.urgencyOptions=k,t.minDate=new Date(2010,0,1),t.filterVal={startTime:"",endTime:"",urgency:{},useStatus:{},keyword:""},t}return Object(l["a"])(a,[{key:"getContainer",value:function(){return document.querySelector(".my-container")}},{key:"filterSome",get:function(){return!(this.filterShow||!(this.filterVal.startTime||this.filterVal.urgency.name||this.filterVal.useStatus.name||this.filterVal.keyword))}},{key:"chooseFilter",value:function(t){this.selectShow=!0,this.selectType=t}},{key:"onSelectStatus",value:function(t){this.selectShow=!1,this.filterVal.useStatus=t}},{key:"onSelectUrgency",value:function(t){this.selectShow=!1,this.filterVal.urgency=t}},{key:"onDateConfirm",value:function(t){this.selectShow=!1,this.filterVal.startTime=Object(m["c"])(t[0]),this.filterVal.endTime=Object(m["c"])(t[1])}},{key:"reset",value:function(){this.filterVal={startTime:"",endTime:"",urgency:{},useStatus:{},keyword:""}}},{key:"onConfirm",value:function(){this.filterShow=!1,this.$emit("confirm",this.filterVal)}},{key:"onFormDataChange",value:function(){this.filterVal=this.formData}}]),a}(p["d"]);Object(f["a"])([Object(p["c"])({type:Number,default:0})],w.prototype,"type",void 0),Object(f["a"])([Object(p["c"])({type:Number,default:0})],w.prototype,"taskType",void 0),Object(f["a"])([Object(p["c"])({type:Object,default:{}})],w.prototype,"formData",void 0),Object(f["a"])([Object(p["e"])("formData")],w.prototype,"onFormDataChange",null),w=Object(f["a"])([Object(p["a"])({})],w);var O=w,T=O,C=(a("db1b8"),a("2877")),j=Object(C["a"])(T,g,v,!1,null,"27f63294",null),x=j.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flow-card background-color-white",on:{click:t.onClick}},[a("div",{staticClass:"d-flex align-baseline px-4 py-3"},[a("div",{class:t.menuColor},[t._v(t._s(t.data.menuLevelTWOName))]),a("div",{staticClass:"flex-1 ml-2"},[t._v(t._s(t.data.content))])]),a("div",{staticClass:"item-line"}),a("div",{staticClass:"py-3 px-4 d-flex justify-space-between align-center"},[a("div",{staticClass:"lineHeight-20"},[t._v("点击查看更多信息")]),a("van-icon",{attrs:{name:"arrow"}})],1)])},D=[],_=a("3355"),I=function(t){Object(u["a"])(a,t);var e=Object(d["a"])(a);function a(){return Object(o["a"])(this,a),e.apply(this,arguments)}return Object(l["a"])(a,[{key:"menuColor",get:function(){return"锁控管理"===this.data.menuLevelOneName?"tag-red":"订单管理"===this.data.menuLevelOneName?"tag-orange":"tag-blue"}},{key:"onClick",value:function(){this.$emit("handleClick")}}]),a}(p["d"]);Object(f["a"])([Object(p["c"])({type:Object,default:{}})],I.prototype,"data",void 0),Object(f["a"])([Object(p["c"])({type:Number,default:2})],I.prototype,"flowType",void 0),I=Object(f["a"])([Object(p["a"])({components:{InfoItem:_["a"]}})],I);var M=I,R=M,E=(a("6986"),Object(C["a"])(R,S,D,!1,null,"7b635e15",null)),F=E.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-card background-color-white",on:{click:t.onClick}},[a("div",{staticClass:"d-flex justify-space-between px-4 py-3"},[a("div",[a("div",{class:t.emergencyColor},[t._v(t._s(t.emergencyLevelText[t.data.emergencyLevel]))]),a("div",{staticClass:"tag-default ml-2"},[t._v(t._s(t.data.smallTagName))])]),a("div",{class:t.textColor},[t._v(t._s(t.useStatusText))])]),a("div",{staticClass:"item-line"}),a("div",{staticClass:"py-10 px-4 d-flex justify-space-between align-center"},[a("div",[a("div",{staticClass:"font-bold"},[t._v(t._s(t.data.title))]),a("div",{staticClass:"color-gray-5 mt-1"},[t._v(t._s(t.data.content))]),2===t.taskType?a("div",{staticClass:"color-gray-4 mt-2 d-flex align-center"},[a("app-icon",{staticClass:"mr-1",attrs:{name:"#ytcrm-fajianren"}}),t._v("发件人:"+t._s(t.data.sendUserName)+" ")],1):t._e(),1===t.taskType?a("div",{class:["mt-2 d-flex align-center color-gray-5"]},[a("div",{staticClass:"progress mr-2"},[a("div",{class:["progress",1===+t.data.useStatus?"progress--inner":"progress--innerf"],style:"width: "+(2===+t.data.useStatus?100:t.replyRate)+"%"})]),t._v(" "+t._s(t.replyRate)+"% ")]):t._e(),t.data.eventAgeingEnd?a("div",{staticClass:"color-gray-4 mt-2 d-flex align-center"},[a("app-icon",{staticClass:"mr-1",attrs:{name:"#ytcrm-shijian2"}}),t._v(t._s(t.data.eventAgeingEnd.split(" ")[0])+"截止 ")],1):t._e()]),a("van-icon",{attrs:{name:"arrow"}})],1)])},N=[],Y=function(t){Object(u["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.emergencyLevelText=["","普通","重要","紧急"],t}return Object(l["a"])(a,[{key:"useStatusText",get:function(){var t=["作废","已读","未读"],e=["已作废","进行中","已完成"];return 2===this.taskType?t[+this.data.useStatus]:e[+this.data.useStatus]}},{key:"emergencyColor",get:function(){return 3===+this.data.emergencyLevel?"tag-red":1===+this.data.emergencyLevel?"tag-green":2===+this.data.emergencyLevel?"tag-orange":""}},{key:"textColor",get:function(){var t=["tag-red","tag-green","tag-default"],e=["tag-red","tag-blue","tag-green"];return 2===this.taskType?t[+this.data.useStatus]:e[+this.data.useStatus]}},{key:"onClick",value:function(){this.$emit("handleClick")}},{key:"replyRate",get:function(){return Math.ceil(this.data.dealNum/this.data.totalNum*100)}}]),a}(p["d"]);Object(f["a"])([Object(p["c"])({type:Object,default:{}})],Y.prototype,"data",void 0),Object(f["a"])([Object(p["c"])({type:Number,default:2})],Y.prototype,"taskType",void 0),Y=Object(f["a"])([Object(p["a"])({components:{InfoItem:_["a"]}})],Y);var V=Y,$=V,A=(a("f37c"),Object(C["a"])($,L,N,!1,null,"cea11b44",null)),U=A.exports,z=a("e5fc"),B=Object(h["a"])("app"),G=function(t){Object(u["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.msgType=2,t.page=1,t.pageSize=10,t.list=[],t.loading=!1,t.finished=!1,t.refreshing=!1,t.error=!1,t.showTag=!1,t.tagItems=[],t.activeIds=[],t.activeIndex=0,t.filterObj={startTime:"",endTime:"",urgency:{},useStatus:{},keyword:""},t.show=!1,t.taskType=2,t.flowCount=0,t.taskCount=0,t}return Object(l["a"])(a,[{key:"init",value:function(){this.msgType=2,this.taskType=2,this.filterObj={startTime:"",endTime:"",urgency:{},useStatus:{},keyword:""},this.onRefresh()}},{key:"onRefresh",value:function(){this.page=1,this.finished=!1,this.refreshing=!1,this.loading=!0,this.list=[],this._getDataList()}},{key:"onLoad",value:function(){var t=this;this.$nextTick((function(){t._getDataList()}))}},{key:"_getDataList",value:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a,n,s,i,r,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return 1===this.page&&(this.list=[]),e=this.filterObj,a=e.startTime,n=e.endTime,s=e.urgency,i=e.useStatus,r=e.keyword,c={startTime:a,endTime:n,keyword:r,messageType:this.msgType,pageNum:this.page,pageSize:10},1===this.msgType?(c.emergencyLevel=s.value,c.useStatus=i.value,c.receiveSendFlag=1===this.taskType?1:0):c.menuLevelTwoList=this.activeIds.filter((function(t){return t>0})),t.next=6,Object(z["a"])(c);case 6:o=t.sent,o.success&&o.data||(this.finished=!0,this.loading=!1,this.$toast.fail(o.msg)),this.list=this.list.concat(o.data.list),this.loading=!1,o.data.hasNextPage?this.page++:this.finished=!0;case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onClickTags",value:function(t){var e=this;t.id<0&&(this.activeIds.includes(t.id)?-11===t.id?(this.activeIds=[],this.tagItems.forEach((function(t){t.children.forEach((function(t){e.activeIds.push(t.id)}))}))):this.tagItems[this.activeIndex].children.forEach((function(t){e.activeIds.includes(t.id)||e.activeIds.push(t.id)})):-11===t.id?this.activeIds=[]:this.tagItems[this.activeIndex].children.forEach((function(t){var a=e.activeIds.findIndex((function(e){return e===t.id}));-1!==a&&e.activeIds.splice(a,1)})))}},{key:"onConfirmTag",value:function(){this.showTag=!1,this.onRefresh()}},{key:"toFlowDetail",value:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.url){t.next=3;break}return this.$toast("该消息暂时无法跳转"),t.abrupt("return");case 3:if(2!==e.useStatus){t.next=8;break}return t.next=6,Object(z["c"])({cmsId:e.cmsId});case 6:a=t.sent,a.success&&(e.useStatus=1,this.SET_MSGOBJ({unReadMsgCount:this.msgObj.unReadMsgCount-1,wordflowUnReadMsgCount:this.flowCount-1,commonTaskUnReadMsgCount:this.taskCount}));case 8:window.location.href=e.url;case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"changeTaskType",value:function(t){this.filterObj={startTime:"",endTime:"",urgency:{},useStatus:{},keyword:""},this.taskType=t,this.onRefresh()}},{key:"onFilterChange",value:function(t){this.filterObj=t,this.onRefresh()}},{key:"onTabChange",value:function(){this.filterObj={startTime:"",endTime:"",urgency:{},useStatus:{},keyword:""},this.activeIds=[],this.activeIndex=0,this.taskType=2,this.onRefresh()}},{key:"toDetail",value:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.csoId){t.next=3;break}return this.$toast("历史消息暂时无法跳转"),t.abrupt("return");case 3:if(2!==this.taskType||2!==e.useStatus){t.next=8;break}return t.next=6,Object(z["c"])({cmsId:e.cmsId});case 6:a=t.sent,a.success&&(e.useStatus=1,this.SET_MSGOBJ({unReadMsgCount:this.msgObj.unReadMsgCount-1,wordflowUnReadMsgCount:this.flowCount,commonTaskUnReadMsgCount:this.taskCount-1}));case 8:this.SET_DETAILINFOR({type:this.taskType,csoId:e.csoId}),this.SET_HADDONEONDETAIL(!1),this.$router.push({path:"/task/detail"});case 11:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"toPublish",value:function(){this.SET_HADDONEONDETAIL(!1),this.$router.push({path:"/task/publish"})}},{key:"getUnread",value:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(z["b"])({messageType:2});case 2:return e=t.sent,this.flowCount=e.data,t.next=6,Object(z["b"])({messageType:1});case 6:a=t.sent,this.taskCount=a.data;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"readAll",value:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定全部标记已读?",confirmButtonColor:"#2271F5"}).then(Object(c["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(z["c"])({messageType:t.msgType});case 2:a=e.sent,t.$toast.success(a.msg||"标记成功"),t.onRefresh(),t.SET_MSGOBJ({unReadMsgCount:2===t.msgType?t.msgObj.unReadMsgCount-t.flowCount:t.msgObj.unReadMsgCount-t.taskCount,wordflowUnReadMsgCount:2===t.msgType?0:t.flowCount,commonTaskUnReadMsgCount:1===t.msgType?0:t.taskCount});case 6:case"end":return e.stop()}}),e)})))).catch((function(){}))}},{key:"mounted",value:function(){var t=this;this.tagItems=Object.keys(this.userInfor.ywzx).map((function(e){var a=t.userInfor.ywzx[e],n=[];return a.arr.length&&a.arr.forEach((function(t){var e=n.some((function(e){return e.id===t.pmsId}));e||n.push({id:t.pmsId,text:437===t.pmsId?"锁控(业务)":445===t.pmsId?"锁控(采购)":t.pmsName})})),{id:e,text:a.title[0],children:[{id:-e-2,text:"全部"}].concat(n)}})),this.tagItems.unshift({id:1,text:"全部",children:[{id:-11,text:"全部"}]})}},{key:"onMsgObj",value:function(t){t.crmMessageRes&&this.msgType===t.crmMessageRes.messageType&&2===this.taskType&&(this.list=[Object(i["a"])({},t.crmMessageRes)].concat(Object(r["a"])(this.list))),this.flowCount=t.wordflowUnReadMsgCount,this.taskCount=t.commonTaskUnReadMsgCount}}]),a}(p["d"]);Object(f["a"])([B.Mutation],G.prototype,"SET_DETAILINFOR",void 0),Object(f["a"])([B.Mutation],G.prototype,"SET_HADDONEONDETAIL",void 0),Object(f["a"])([B.Mutation],G.prototype,"SET_MSGOBJ",void 0),Object(f["a"])([B.Getter],G.prototype,"userInfor",void 0),Object(f["a"])([B.Getter],G.prototype,"msgObj",void 0),Object(f["a"])([Object(p["e"])("msgObj")],G.prototype,"onMsgObj",null),G=Object(f["a"])([Object(p["a"])({components:{FlowCard:F,FilterPop:x,TaskCard:U},beforeRouteEnter:function(t,e,a){"/operationHome"===e.path&&a((function(t){t.init(),t.getUnread()})),a()}})],G);var H=G,J=H,P=(a("146a"),Object(C["a"])(J,n,s,!1,null,"1cd25136",null));e["default"]=P.exports},e5fc:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return u}));var n=a("1da1"),s=(a("96cf"),a("b32d")),i=a("90ae");function r(t){return c.apply(this,arguments)}function c(){return c=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].post(i["c"],"/api/message/getCrmMessageList",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function o(t){return l.apply(this,arguments)}function l(){return l=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].formDataPost(i["c"],"/api/message/getUnReadCount",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}function u(t){return d.apply(this,arguments)}function d(){return d=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].get(i["c"],"/api/message/readMessage",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}},f37c:function(t,e,a){"use strict";a("c2b1")}}]);