(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52c0e7be"],{"3b1e":function(e,t,a){},"7f96":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pb-100 background-color-white"},[a("van-sticky",[a("div",{staticClass:"header d-flex align-center"},[a("div",{staticClass:"flex-1 d-flex keep-center"},[a("span",{staticClass:"dept-name"},[e._v(e._s(e.currentYear)+"年新药")])]),a("div",{on:{click:e.calendarClick}},[a("span",{staticClass:"time"},[e._v(e._s(e.$dayjs(e.csjNowTime).format("YYYY-MM-DD")))]),a("van-icon",{staticClass:"pl-1",attrs:{size:"14px",name:"arrow-down"}})],1)])]),a("van-sticky",{attrs:{"offset-top":74}},[a("van-search",{staticClass:"custom-search",attrs:{shape:"round","input-align":"center",placeholder:"搜索",background:"white"},on:{input:e.onSearchInput},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),a("div",{staticClass:"tab-div"},[a("van-tabs",{staticClass:"custom-tabs",attrs:{active:e.activeTabIndex,swipeable:""},on:{change:e.onTabChange}},e._l(e.years,(function(e){return a("van-tab",{key:e,staticClass:"custom-tab",attrs:{title:e+"年新药"}})})),1)],1),a("van-calendar",{attrs:{"default-date":e.csjNowTime,"min-date":new Date(2021,0,1),"max-date":new Date((new Date).getTime()-864e5),"first-day-of-week":"1",color:"#1989fa","show-confirm":!1},on:{select:e.selectCalendar},model:{value:e.calendarShow,callback:function(t){e.calendarShow=t},expression:"calendarShow"}}),a("div",{staticClass:"year-content"},[a("div",{staticClass:"goods-satisfaction"},[a("div",{staticClass:"card"},[e._m(0),a("div",{directives:[{name:"show",rawName:"v-show",value:e.cdloading,expression:"cdloading"}],staticClass:"d-flex py-8 justify-center align-center"},[a("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1),e.cdloading?e._e():a("div",{staticClass:"card-body"},[a("div",{staticClass:"sale-num"},[e._v(e._s(e.cardData.sales||"--")+"万元")]),a("div",{staticClass:"right-content"},[a("i",{class:e.cardData.growthRate>0?"rank-up-icon":"rank-down-icon"}),a("span",{staticClass:"change-value",class:e.cardData.growthRate>0?"positive":"negative"},[e._v(" "+e._s(Math.abs(e.cardData.growthRate))+"% ")])])]),e.cdloading?e._e():a("div",{staticClass:"progress-bar"},[a("div",{staticClass:"progress-inner",style:{width:e.cardData.progress+"%"}})])])])]),a("div",{staticClass:"table-div"},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.listItems.length&&!e.filterParams.loading,expression:"listItems.length == 0 && !filterParams.loading"}],staticClass:"white-block pb-3 mb-4"},[a("app-empty",{staticClass:"py-7",attrs:{description:"暂无数据"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.filterParams.loading,expression:"filterParams.loading"}],staticClass:"d-flex py-8 justify-center align-center"},[a("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1),a("div",{staticClass:"table-body background-color-white mt-2"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.listItems.length>0,expression:"listItems.length > 0"}],staticClass:"table-line d-flex font-14 color-gray-5 lineHeight-20 align-center py-3"},[a("div",{staticClass:"table-div-1"},[e._v("品种ID/品种名称")]),a("div",{staticClass:"table-div-2"},[e._v("品牌")]),a("div",{staticClass:"table-div-3"},[e._v("营运品种分类")]),a("div",{staticClass:"table-div-4"},[e._v("产地")]),a("div",{staticClass:"table-div-5"},[e._v("销售实绩（万元）")]),a("div",{staticClass:"table-div-5"},[e._v("较同期净增长（万元）")]),a("div",{staticClass:"table-div-6"},[e._v("同比增幅")])]),e.listItems.length>0?a("div",{staticClass:"table-content"},e._l(e.listItems,(function(t,s){return a("div",{key:s+"pz",staticClass:"table-line d-flex font-14 color-black-2 lineHeight-20 align-center py-3",style:s%2===0?"background-color: #F7F7F7":""},[a("div",{staticClass:"table-div-1"},[e._v(e._s(t.goodsId)+"/"+e._s(t.goodsName))]),a("div",{staticClass:"table-div-2"},[e._v(e._s(t.brandName))]),a("div",{staticClass:"table-div-3"},[e._v(e._s(t.goodsOpClassName))]),a("div",{staticClass:"table-div-4"},[e._v(e._s(t.goodsProdArea))]),a("div",{staticClass:"table-div-5"},[e._v(e._s(t.salesAmount))]),a("div",{staticClass:"table-div-5"},[e._v(e._s(t.periodCompareNetIncrease))]),a("div",{staticClass:"table-div-6"},[e._v(e._s(t.periodComparePercent)+"%")])])})),0):e._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.listItems.length>0,expression:"listItems.length > 0"}],staticClass:"py-4 background-color-white"},[a("van-pagination",{attrs:{"force-ellipses":!0,"total-items":e.filterParams.total,"items-per-page":e.filterParams.pageSize},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"prev-text",fn:function(){return[a("van-icon",{attrs:{name:"arrow-left"}})]},proxy:!0},{key:"next-text",fn:function(){return[a("van-icon",{attrs:{name:"arrow"}})]},proxy:!0},{key:"page",fn:function(t){var a=t.text;return[e._v(e._s(a))]}}]),model:{value:e.filterParams.currentPage,callback:function(t){e.$set(e.filterParams,"currentPage",t)},expression:"filterParams.currentPage"}})],1)]),a("div",{staticClass:"commonOpButton-footer"},[a("van-button",{staticClass:"bg-blue",attrs:{round:""},on:{click:e.openFilter}},[a("div",{staticClass:"d-flex align-center"},[a("div",{staticClass:"color-white font-12 fontWeight-500"},[e._v("排序方式")])])])],1),a("van-action-sheet",{attrs:{actions:e.sortTypes,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onSortConfirm},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.action;return[a("div",{style:{color:s.color}},[e._v(e._s(s.name))])]}}]),model:{value:e.showSortPopup,callback:function(t){e.showSortPopup=t},expression:"showSortPopup"}})],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-header"},[a("div",{staticClass:"unit-name"},[e._v("销售实绩")])])}],i=a("2909"),n=a("1da1"),o=a("d4ec"),c=a("bee2"),l=a("262e"),d=a("2caf"),u=(a("96cf"),a("a9e3"),a("4e82"),a("d81d"),a("b680"),a("d3b7"),a("159b"),a("7db0"),a("b0c0"),a("9ab4")),m=a("1b40"),p=a("4388"),v=a("2279"),h=a("5b92"),f=function(e){Object(l["a"])(a,e);var t=Object(d["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.searchValue="",e.currentYear=Number(e.$route.query.year),e.activeYear=e.currentYear,e.calendarShow=!1,e.years=[],e.cardData={},e.maxSaleAmount=0,e.dateTime="",e.cdloading=!1,e.allYearData=[],e.listItems=[],e.activeTabIndex=0,e.filterParams={total:0,currentPage:1,pageSize:10,loading:!1},e.showSortPopup=!1,e.sortTypes=[{name:"销售实绩升序",orderColumn:"salesAmount",orderType:1},{name:"销售实绩倒序",orderColumn:"salesAmount",orderType:0},{name:"较同期净增升序",orderColumn:"periodCompareNetIncrease",orderType:1},{name:"较同期净增倒序",orderColumn:"periodCompareNetIncrease",orderType:0},{name:"同比增幅升序",orderColumn:"periodComparePercent",orderType:1},{name:"同比增幅倒序",orderColumn:"periodComparePercent",orderType:0}],e.selectedSort=e.sortTypes[1],e}return Object(c["a"])(a,[{key:"mounted",value:function(){this.sortTypes[1].color="#2271F5",this.fetchAllData(),this._getNewGoodList()}},{key:"onTabChange",value:function(e){if(this.activeTabIndex!==e){this.activeTabIndex=e;var t=this.years[e];this.activeYear=t,this.currentYear=t,this.updateCardData(t),this._getNewGoodList()}}},{key:"onSearchInput",value:function(){this.filterParams.currentPage=1,this._getNewGoodList()}},{key:"fetchAllData",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={selectedDate:this.$dayjs(this.csjNowTime).format("YYYY-MM-DD"),deptId:this.$route.query.deptId,timeDimFlag:1},this.cdloading=!0,e.next=5,Object(v["k"])(t);case 5:a=e.sent,this.cdloading=!1,200==a.code&&a.data&&(s=a.data[1],this.years=s.map((function(e){return e.yearNum})).sort((function(e,t){return t-e})),this.activeTabIndex=this.years.indexOf(this.currentYear),this.maxSaleAmount=Math.max.apply(Math,Object(i["a"])(s.map((function(e){return e.salesAmount})))),this.allYearData=s,this.updateCardData(this.currentYear)),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"_getNewGoodList",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.filterParams.loading=!0,e.prev=1,this.listItems=[],t={deptId:this.$route.query.deptId,goodsCategoryList:[],keyword:this.searchValue,orderColumn:this.selectedSort.orderColumn,orderType:this.selectedSort.orderType,pageNum:this.filterParams.currentPage,pageSize:this.filterParams.pageSize,selectDate:this.$dayjs(this.csjNowTime).format("YYYY-MM-DD"),timeDimFlag:"1",yearNum:this.currentYear},this.filterParams.loading=!0,e.next=7,Object(v["l"])(t);case 7:a=e.sent,this.filterParams.loading=!1,200==a.code&&a.data&&(this.listItems=a.data.list.map((function(e){return{goodsId:e.goodsId,goodsName:e.goodsName,brandName:e.brandList.length>0?e.brandList[0].brandName:"-",goodsOpClassName:e.goodsOpClassName,goodsProdArea:e.goodsProdArea?e.goodsProdArea:"-",salesAmount:null!=e.salesAmount?Object(h["d"])(e.salesAmount,1):"-",periodCompareNetIncrease:null!=e.periodCompareNetIncrease?Object(h["d"])(e.periodCompareNetIncrease,1):"-",periodComparePercent:null!=e.periodComparePercent?(100*e.periodComparePercent).toFixed(1):"-"}})),this.filterParams.total=a.data.total||0),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1);case 15:return e.prev=15,this.filterParams.loading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleTableChange",value:function(e){this.filterParams.currentPage=e,this._getNewGoodList()}},{key:"onSortConfirm",value:function(e){this.sortTypes.forEach((function(e){e.color=""}));var t=this.sortTypes.find((function(t){return t.name===e.name&&t.orderColumn===e.orderColumn&&t.orderType===e.orderType}));t&&(t.color="#2271F5"),this.selectedSort=e,this.showSortPopup=!1,this.filterParams.currentPage=1,this._getNewGoodList()}},{key:"openFilter",value:function(){this.showSortPopup=!0}},{key:"updateCardData",value:function(e){var t=this.allYearData.find((function(t){return t.yearNum==e}));t&&(this.cardData={year:t.yearNum,sales:Object(h["d"])(t.salesAmount,1),growthRate:Object(h["d"])(t.periodComparePercent,2),progress:(t.salesAmount/this.maxSaleAmount*100).toFixed(2)})}},{key:"calendarClick",value:function(){this.calendarShow=!0}},{key:"selectCalendar",value:function(e){this.calendarConfirm(e)}},{key:"calendarConfirm",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.calendarShow=!1,this.dateTime=this.$dayjs(t).format("YYYY-MM-DD"),this.SET_CSJNOWTIME(t),this.SET_CSJCHANGETIME(!0),this.fetchAllData(),this._getNewGoodList();case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),a}(Object(m["b"])(p["a"]));f=Object(u["a"])([Object(m["a"])({})],f);var g=f,b=g,C=(a("b38f"),a("2877")),y=Object(C["a"])(b,s,r,!1,null,"c83aa1c4",null);t["default"]=y.exports},b38f:function(e,t,a){"use strict";a("3b1e")}}]);